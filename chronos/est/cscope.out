cscope 15 $HOME/sudiptac/unified_cache/est -q 0000002660 0000520621
	@address.c

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<°d¨g.h
>

6 
	~<as£π.h
>

7 
	~"tcfg.h
"

8 
	~"addªss.h
"

9 
	~"lo›s.h
"

10 
	~"comm⁄.h
"

11 
	~"ö„asibÀ.h
"

14 
tcfg_node_t
** 
tcfg
;

15 
num_tcfg_nodes
;

18 
lo›_t
** 
	glo›_m≠
;

21 
iß_t
* 
iß
;

22 
dumpAddªss
(
tcfg_node_t
* 
bb
);

23 
upd©eSuc˚ss‹Aloc
(
tcfg_node_t
* 
bbi
, * 
ch™ge
);

24 
checkEquÆôy
(
ric_p
 
¨g1
,Ñic_∞
¨g2
);

25 
FILE
* 
	gaFûe
;

28 
™Æyze_t›
();

29 
™Æyze
(
tcfg_node_t
* 
bbi
);

30 
¶i°_p
 
™Æyze_lo›_t›
(
lo›_t
* 
lo›
, 
lo›_id
);

31 
™Æyze_lo›
(
tcfg_node_t
* 
bbi
, 
lo›_id
);

32 
joöMem‹yAloc
(
abs_mem_p
 
mem1
,ábs_mem_p* 
mem2
);

35 * 
	g™Æyzed
;

36 * 
	g™Æyzed_lo›
;

39 
	gcou¡
 = 0;

42 
ric_p
 
	$gëAddrBa£Off£t
(
de_ö°_t
* 
ö°
, 
ba£
, 
off£t
, 
›t
)

44 
ric_p
* 
abs_ªg
 = 
ö°
->abs_reg;

45 
ric_p
 
nAddr
;

47 #ifde‡
_DEBUG


48 if(!
abs_ªg
)

50 
	`¥ötf
("Somê¥obÀm o‡ab°ø˘i⁄áàö°ru˘i⁄ %x\n", 
ö°
->
addr
);

54 
	`as£π
(
abs_ªg
);

56 if(
›t
 && 
ö°
->
mod_addr
)

58 #ifde‡
_DEBUG


59 
	`¥ötf
("modifõdáddªs†(0x%x,0x%x,0x%x)\n", 
ö°
->
mod_addr
->
lowî_bound
,

60 
ö°
->
mod_addr
->
uµî_bound
, in°->mod_addr->
°ride
);

62  
ö°
->
mod_addr
;

65 if(
abs_ªg
[
ba£
])

67 
nAddr
 = (
ric_p
)
	`mÆloc
((
ric_s
));

68 #ifde‡
_DEBUG


72 
nAddr
->
lowî_bound
 = 
abs_ªg
[
ba£
]->lowî_bound + 
off£t
;

73 
nAddr
->
uµî_bound
 = 
abs_ªg
[
ba£
]->uµî_bound + 
off£t
;

75 if(
ba£
 == 28)

76 
nAddr
->
°ride
 = 0;

78 
nAddr
->
°ride
 = 
abs_ªg
[
ba£
]->stride;

79  
nAddr
;

82  
NULL
;

83 
	}
}

86 
ric_p
 
	$gëAddrBa£Index
(
de_ö°_t
* 
ö°
, 
ba£
, 
ödex
, 
›t
)

88 
ric_p
* 
abs_ªg
 = 
ö°
->abs_reg;

89 
ric_p
 
nAddr
;

91 #ifde‡
_DEBUG


92 if(!
abs_ªg
)

94 
	`¥ötf
("Somê¥obÀm o‡ab°ø˘i⁄áàö°ru˘i⁄ %x\n", 
ö°
->
addr
);

98 
	`as£π
(
abs_ªg
);

100 if(
›t
 && 
ö°
->
mod_addr
)

102 #ifde‡
_DEBUG


103 
	`¥ötf
("modifõdáddªs†(0x%x,0x%x,0x%x)\n", 
ö°
->
mod_addr
->
lowî_bound
,

104 
ö°
->
mod_addr
->
uµî_bound
, in°->mod_addr->
°ride
);

106  
ö°
->
mod_addr
;

109 if(
abs_ªg
[
ba£
] &&ábs_ªg[
ödex
])

111 
nAddr
 = (
ric_p
)
	`mÆloc
((
ric_s
));

112 
nAddr
->
lowî_bound
 = 
abs_ªg
[
ba£
]->lower_bound +

113 
abs_ªg
[
ödex
]->
lowî_bound
;

114 
nAddr
->
uµî_bound
 = 
abs_ªg
[
ba£
]->upper_bound +

115 
abs_ªg
[
ödex
]->
uµî_bound
;

116 
nAddr
->
°ride
 = 
	`gcd
(
abs_ªg
[
ba£
]->°ride,ábs_ªg[
ödex
]->stride);

117  
nAddr
;

120  
NULL
;

121 
	}
}

126 
	$gëLo›Bound
(
lo›_t
* 
lo›
)

129 
tcfg_node_t
* 
èû
;

130 
de_ö°_t
* 
cmp_ö°
;

132 
	`as£π
(
lo›
);

135 
èû
 = 
lo›
->tail;

137 
	`as£π
(
èû
);

139 if(
èû
->
exec_cou¡
 != -1)

141 
lo›_t
* 
∑ª¡
 = 
lo›
->parent;

143 if(
∑ª¡
 &&Ö¨ít->
hód
->
exec_cou¡
 != -1)

144  (
èû
->
exec_cou¡
 / 
∑ª¡
->
hód
->exec_count);

146  
èû
->
exec_cou¡
;

149 
öf_lo›_t
* 
öf_lo›s
;

150 
öf_lo›_t
* 
Õ
;

152 
Õ
 = &(
öf_lo›s
[
lo›
->
id
]);

153 
	`as£π
(
Õ
);

167 if(
Õ
 &&Üp->
bound
 >= 0)

170 
	`¥ötf
("ªtu∫ög %d f‹Üo›Åaû %d\n", 
Õ
->
bound
, 
èû
->
id
);

172  
Õ
->
bound
;

176 
	`¥ötf
("Loop boundÇot constant...Örovideá constraint...Éxiting\n");

177 
	`exô
(-1);

186 
	}
}

189 
	$gcd
 ( 
a
, 
b
 )

191 
c
;

193 if(! 
a
Ë 
b
;

194 if(! 
b
Ë 
a
;

196  
a
 != 0 ) {

197 
c
 = 
a
;á = 
b
%a; b = c;

199  
b
;

200 
	}
}

203 
	$maxof
(
n_¨gs
, ...){

204 
i
;

205 
max
, 
a
;

206 
va_li°
 
≠
;

208 
	`va_°¨t
(
≠
, 
n_¨gs
);

209 
max
 = 
	`va_¨g
(
≠
, );

211 
i
 = 2; i <
n_¨gs
; i++) {

212 if((
a
 = 
	`va_¨g
(
≠
, )Ë> 
max
)

213 
max
 = 
a
;

216 
	`va_íd
(
≠
);

218  
max
;

219 
	}
}

222 
	$möof
(
n_¨gs
, ...){

223 
i
;

224 
mö
, 
a
;

225 
va_li°
 
≠
;

227 
	`va_°¨t
(
≠
, 
n_¨gs
);

228 
mö
 = 
	`va_¨g
(
≠
, );

230 
i
 = 2; i <
n_¨gs
; i++) {

231 if((
a
 = 
	`va_¨g
(
≠
, )Ë< 
mö
)

232 
mö
 = 
a
;

235 
	`va_íd
(
≠
);

237  
mö
;

238 
	}
}

241 
ric_p
 
	$makeRIC
(
ric_p
 
¨g
)

243 
ric_p
 
nRIC
;

245 if(! 
¨g
)

246  
NULL
;

247 
nRIC
 = (
ric_p
)
	`mÆloc
((
ric_s
));

248 if(! 
nRIC
)

249 
	`Áèl
("Out of memory");

250 
nRIC
->
lowî_bound
 = 
¨g
->lower_bound;

251 
nRIC
->
uµî_bound
 = 
¨g
->upper_bound;

252 
nRIC
->
°ride
 = 
¨g
->stride;

254  
nRIC
;

255 
	}
}

258 
	$makeRICPîIn°ru˘i⁄
(
de_ö°_t
* 
ö°
, 
ric_p
* 
abs_ªg
)

260 
i
;

262 if(! 
ö°
->
abs_ªg
)

264 
ö°
->
abs_ªg
 = (
ric_p
 *)
	`mÆloc
(
MAX_NO_REGISTERS
 * (ric_p));

265 if(! 
ö°
->
abs_ªg
)

266 
	`Áèl
("Out of memory");

267 
	`mem£t
(
ö°
->
abs_ªg
, 0, 
MAX_NO_REGISTERS
 * (
ric_p
));

269 
i
 = 0; i < 
MAX_NO_REGISTERS
; i++)

271 if(! 
abs_ªg
[
i
])

273 if(! 
ö°
->
abs_ªg
[
i
])

275 
ö°
->
abs_ªg
[
i
] = (
ric_p
)
	`mÆloc
((
ric_s
));

276 if(! 
ö°
->
abs_ªg
[
i
])

277 
	`Áèl
("Out of memory");

279 
ö°
->
abs_ªg
[
i
]->
lowî_bound
 =ábs_reg[i]->lower_bound;

280 
ö°
->
abs_ªg
[
i
]->
uµî_bound
 =ábs_reg[i]->upper_bound;

281 
ö°
->
abs_ªg
[
i
]->
°ride
 =ábs_reg[i]->stride;

283 
	}
}

285 
	$upd©eRICMul
(
ric_p
* 
hi
,Ñic_p* 
lo
,Ñic_∞
§c1
,Ñic_∞
§c2
)

287 
lowî_bound
, 
uµî_bound
;

289 if(! (*
hi
))

290 *
hi
 = (
ric_p
)
	`mÆloc
((
ric_s
));

291 if(! 
hi
)

292 
	`Áèl
("Out of memory");

293 if(! (*
lo
))

294 *
lo
 = (
ric_p
)
	`mÆloc
((
ric_s
));

295 if(! 
lo
)

296 
	`Áèl
("Out of memory");

298 if(
§c1
 && 
§c2
)

301 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

303 
lowî_bound
 = 
	`möof
(4, 
§c1
->lowî_bound * 
§c2
->lower_bound,

304 
§c1
->
lowî_bound
 * 
§c2
->
uµî_bound
,

305 
§c1
->
uµî_bound
 * 
§c2
->upper_bound,

306 
§c1
->
uµî_bound
 * 
§c2
->
lowî_bound
);

307 
uµî_bound
 = 
	`maxof
(4, 
§c1
->
lowî_bound
 * 
§c2
->lower_bound,

308 
§c1
->
lowî_bound
 * 
§c2
->
uµî_bound
,

309 
§c1
->
uµî_bound
 * 
§c2
->upper_bound,

310 
§c1
->
uµî_bound
 * 
§c2
->
lowî_bound
);

311 (*
hi
)->
lowî_bound
 = ()(lower_bound >> 32);

312 (*
hi
)->
uµî_bound
 = ()(upper_bound >> 32);

313 (*
hi
)->
°ride
 = 1;

315 if(! ((*
hi
)->
uµî_bound
)) {

316 (*
lo
)->
uµî_bound
 = ()upper_bound;

317 (*
lo
)->
lowî_bound
 = ()lower_bound;

318 (*
lo
)->
°ride
 = ()(
	`gcd
(gcd(
§c1
->°ridê* 
§c2
->stride,

319 
§c1
->
lowî_bound
 * 
§c2
->
°ride
),

320 
§c2
->
lowî_bound
 * 
§c1
->
°ride
));

323 (*
lo
)->
uµî_bound
 = 0;

324 (*
lo
)->
lowî_bound
 = 0;

325 (*
lo
)->
°ride
 = -1;

333 (*
hi
)->
lowî_bound
 = (*hi)->
uµî_bound
 = 0;

334 (*
lo
)->
lowî_bound
 = (*lo)->
uµî_bound
 = 0;

335 (*
hi
)->
°ride
 = -1;

336 (*
lo
)->
°ride
 = -1;

340 (*
hi
)->
lowî_bound
 = (*hi)->
uµî_bound
 = 0;

341 (*
lo
)->
lowî_bound
 = (*lo)->
uµî_bound
 = 0;

342 (*
hi
)->
°ride
 = -1;

343 (*
lo
)->
°ride
 = -1;

345 
	}
}

347 
	$upd©eRICSub
(
ric_p
* 
de°
,Ñic_∞
§c1
,Ñic_∞
§c2
)

349 if(! (*
de°
))

350 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

351 if(! 
de°
)

352 
	`Áèl
("Out of memory");

353 if(
§c1
 && 
§c2
)

356 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

358 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound - 
§c2
->
uµî_bound
;

359 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound - 
§c2
->
lowî_bound
;

360 (*
de°
)->
°ride
 = 
	`gcd
(
§c1
->°ride, 
§c2
->stride);

367 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

368 (*
de°
)->
°ride
 = -1;

372 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

373 (*
de°
)->
°ride
 = -1;

375 
	}
}

377 
	$upd©eRICBoﬁ
(
ric_p
* 
de°
,Ñic_∞
§c1
,Ñic_∞
§c2
)

379 if(! (*
de°
))

380 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

381 if(! 
de°
)

382 
	`Áèl
("Out of memory");

383 if(
§c1
 && 
§c2
)

386 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

388 if(
§c1
->
uµî_bound
 < 
§c2
->
lowî_bound
)

389 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 1;

391 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

392 (*
de°
)->
°ride
 = 0;

395 (*
de°
)->
lowî_bound
 = 0;

396 (*
de°
)->
uµî_bound
 = 1;

397 (*
de°
)->
°ride
 = 1;

401 (*
de°
)->
lowî_bound
 = 0;

402 (*
de°
)->
uµî_bound
 = 1;

403 (*
de°
)->
°ride
 = 1;

405 
	}
}

407 
	$upd©eRICBoﬁU
(
ric_p
* 
de°
)

409 if(! (*
de°
))

410 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

411 if(! 
de°
)

412 
	`Áèl
("Out of memory");

413 (*
de°
)->
lowî_bound
 = 0;

414 (*
de°
)->
uµî_bound
 = 1;

415 (*
de°
)->
°ride
 = 1;

416 
	}
}

418 
	$upd©eRICBoﬁImm
(
ric_p
* 
de°
,Ñic_∞
§c1
, 
imm
)

420 if(! (*
de°
))

421 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

422 if(! 
de°
)

423 
	`Áèl
("Out of memory");

424 if(
§c1
)

427 if(
§c1
->
°ride
 != -1)

429 if(
§c1
->
uµî_bound
 < 
imm
)

430 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 1;

432 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

433 (*
de°
)->
°ride
 = 0;

436 (*
de°
)->
lowî_bound
 = 0;

437 (*
de°
)->
uµî_bound
 = 1;

438 (*
de°
)->
°ride
 = 1;

442 (*
de°
)->
lowî_bound
 = 0;

443 (*
de°
)->
uµî_bound
 = 1;

444 (*
de°
)->
°ride
 = 1;

446 
	}
}

448 
	$upd©eRICAdd
(
ric_p
* 
de°
,Ñic_∞
§c1
,Ñic_∞
§c2
)

450 if(! (*
de°
))

451 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

452 if(! 
de°
)

453 
	`Áèl
("Out of memory");

454 if(
§c1
 && 
§c2
)

457 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

459 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound + 
§c2
->lower_bound;

460 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound + 
§c2
->upper_bound;

463 (*
de°
)->
°ride
 = 
	`gcd
(
§c1
->°ride, 
§c2
->stride);

470 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

471 (*
de°
)->
°ride
 = -1;

475 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

476 (*
de°
)->
°ride
 = -1;

478 
	}
}

481 
ric_p
 
	$widíRICJoö
(
ric_p
 
§c1
,Ñic_∞
§c2
)

483 
ric_p
 
ªsu…
;

485 
ªsu…
 = (
ric_p
)
	`mÆloc
((
ric_s
));

487 if(! 
ªsu…
)

488 
	`Áèl
("Out of memory");

490 
	`mem£t
(
ªsu…
, 0, (
ric_s
));

492 if(
§c1
 && 
§c2
)

495 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

497 
ªsu…
->
lowî_bound
 = (
§c2
->lowî_bound < 
§c1
->lower_bound)

498 ? -
INFINITY


499 : 
§c1
->
lowî_bound
;

500 
ªsu…
->
uµî_bound
 = 
§c2
->uµî_bound > 
§c1
->upper_bound

501 ? 
INFINITY


502 : 
§c1
->
uµî_bound
;

503 
ªsu…
->
°ride
 = 
	`gcd
(
§c1
->°ride, 
§c2
->stride);

505 if(! 
ªsu…
->
°ride
)

506 
ªsu…
->
°ride
 = 
	`abs
(
§c1
->
lowî_bound
 - 
§c2
->lower_bound);

513 
ªsu…
->
lowî_bound
 =Ñesu…->
uµî_bound
 = 0;

514 
ªsu…
->
°ride
 = -1;

516 } if(
§c1
 || 
§c2
)

518 
ªsu…
->
lowî_bound
 =Ñesu…->
uµî_bound
 = 0;

519 
ªsu…
->
°ride
 = -1;

521  
NULL
;

523  
ªsu…
;

524 
	}
}

527 
ric_p
 
	$upd©eRICJoö
(
ric_p
 
§c1
,Ñic_∞
§c2
)

529 
ric_p
 
ªsu…
;

530 
diff1
, 
diff2
, 
diff3
, 
diff4
;

532 
ªsu…
 = (
ric_p
)
	`mÆloc
((
ric_s
));

534 if(! 
ªsu…
)

535 
	`Áèl
("Out of memory");

537 
	`mem£t
(
ªsu…
, 0, (
ric_s
));

539 if(
§c1
 && 
§c2
)

542 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

544 if(!
§c1
->
lowî_bound
 && !§c1->
uµî_bound
 && src1->
°ride
) {

545 
ªsu…
->
lowî_bound
 = 
§c2
->lower_bound;

546 
ªsu…
->
uµî_bound
 = 
§c2
->upper_bound;

547 
ªsu…
->
°ride
 = 
§c2
->stride;

549 if(!
§c2
->
lowî_bound
 && !§c2->
uµî_bound
 && src2->
°ride
) {

550 
ªsu…
->
lowî_bound
 = 
§c1
->lower_bound;

551 
ªsu…
->
uµî_bound
 = 
§c1
->upper_bound;

552 
ªsu…
->
°ride
 = 
§c1
->stride;

556 
ªsu…
->
lowî_bound
 = 
	`möof
(2, 
§c1
->lowî_bound, 
§c2
->lower_bound);

557 
ªsu…
->
uµî_bound
 = 
	`maxof
(2, 
§c1
->uµî_bound, 
§c2
->upper_bound);

559 if(! 
§c1
->
°ride
 && !
§c2
->stride &&

560 
ªsu…
->
lowî_bound
 !ªsu…->
uµî_bound
)

561 
ªsu…
->
°ride
 = 
	`abs
(
§c1
->
lowî_bound
 - 
§c2
->lower_bound);

563 
diff1
 = 
	`abs
(
§c1
->
lowî_bound
 - 
§c2
->lower_bound);

564 
diff2
 = 
	`abs
(
§c1
->
lowî_bound
 - 
§c2
->
uµî_bound
);

565 
diff3
 = 
	`abs
(
§c1
->
uµî_bound
 - 
§c2
->
lowî_bound
);

566 
diff4
 = 
	`abs
(
§c1
->
uµî_bound
 - 
§c2
->upper_bound);

567 
ªsu…
->
°ride
 = 
	`gcd
(gcd(gcd(gcd(gcd(
diff1
, 
diff2
),

568 
diff3
), 
diff4
), 
§c1
->
°ride
), 
§c2
->stride);

577 
ªsu…
->
lowî_bound
 =Ñesu…->
uµî_bound
 = 0;

578 
ªsu…
->
°ride
 = -1;

580 } if(
§c1
 || 
§c2
)

582 
ªsu…
->
lowî_bound
 =Ñesu…->
uµî_bound
 = 0;

583 
ªsu…
->
°ride
 = -1;

585  
NULL
;

587  
ªsu…
;

588 
	}
}

591 
ric_p
 
	$ªtu∫Mem‹yAloc
(
ric_s
 
mem
, 
abs_mem_p
 
abs_mem_°
)

593 
abs_mem_p
 
ôî
;

594 
ric_p
 
ªsu…
;

595 
found
 = 0;

596 
ric_s
 
t_addr
;

597 
ric_p
 
p_addr
;

599 
ªsu…
 = (
ric_p
)
	`mÆloc
((
ric_s
));

601 if(! 
ªsu…
)

602 
	`Áèl
("Out of memory");

604 
t_addr
.
lowî_bound
 =Å_addr.
uµî_bound
 = 0;

605 
t_addr
.
°ride
 = 1;

606 
p_addr
 = &
t_addr
;

608 
	`mem£t
(
ªsu…
, 0, (
ric_s
));

609 
ªsu…
->
°ride
 = 1;

611 
ôî
 = 
abs_mem_°
; iãr; iã∏ôî->
√xt
) {

612 if(!
ôî
->
vÆid
)

614 if(
mem
.
lowî_bound
 >
ôî
->
addr
->lower_bound &&

615 
mem
.
uµî_bound
 <
ôî
->
addr
->upper_bound &&

616 
mem
.
°ride
 =
ôî
->
addr
->stride &&

617 
	`abs
(
mem
.
lowî_bound
 - 
ôî
->
addr
->lowî_boundË% mem.
°ride
 == 0) {

618 
found
 = 1;

619 
ªsu…
 = 
	`upd©eRICJoö
‘esu…, 
ôî
->
vÆue
);

621 if(
mem
.
lowî_bound
 <
ôî
->
addr
->lower_bound &&

622 
mem
.
uµî_bound
 >
ôî
->
addr
->upper_bound &&

623 
mem
.
°ride
 =
ôî
->
addr
->stride &&

624 
	`abs
(
mem
.
lowî_bound
 - 
ôî
->
addr
->lowî_boundË% mem.
°ride
 == 0) {

625 
p_addr
 = 
	`upd©eRICJoö
’_addr, 
ôî
->
addr
);

626 
ªsu…
 = 
	`upd©eRICJoö
‘esu…, 
ôî
->
vÆue
);

630 if(!
found
 && !
	`checkEquÆôy
(
p_addr
, &
mem
)) {

632 
ªsu…
->
lowî_bound
 =Ñesu…->
uµî_bound
 = 0;

633 
ªsu…
->
°ride
 = -1;

636  
ªsu…
;

637 
	}
}

639 
	$upd©eRICLﬂdIndex
(
ric_p
* 
de°
,Ñic_∞
§c1
,Ñic_∞
§c2
,

640 
abs_mem_p
 
abs_mem_°
, 
size
)

642 
ric_p
 
mem_Æoc
;

644 if(! (*
de°
))

645 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

646 if(! 
de°
)

647 
	`Áèl
("Out of memory");

649 if(
§c1
 && 
§c2
)

652 if(
§c1
->
°ride
 != -1)

654 
ric_s
 
ãmp
;

655 
	`‰ì
(*
de°
);

656 
ãmp
.
lowî_bound
 = 
§c1
->lowî_bound + 
§c2
->lower_bound;

657 
ãmp
.
uµî_bound
 = 
§c1
->uµî_bound + 
§c2
->upper_bound;

658 
ãmp
.
°ride
 = 
size
;

659 *
de°
 = 
	`ªtu∫Mem‹yAloc
(
ãmp
, 
abs_mem_°
);

662 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

663 (*
de°
)->
°ride
 = -1;

667 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

668 (*
de°
)->
°ride
 = -1;

670 
	}
}

672 
	$upd©eRICLﬂd
(
ric_p
* 
de°
,Ñic_∞
§c1
, 
imm
, 
abs_mem_p
 
abs_mem_°
,

673 
size
)

675 
ric_p
 
mem_Æoc
;

677 if(! (*
de°
))

678 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

679 if(! 
de°
)

680 
	`Áèl
("Out of memory");

682 if(
§c1
)

685 if(
§c1
->
°ride
 != -1)

687 
ric_s
 
ãmp
;

688 
	`‰ì
(*
de°
);

689 
ãmp
.
lowî_bound
 = 
§c1
->lowî_bound + 
imm
;

690 
ãmp
.
uµî_bound
 = 
§c1
->uµî_bound + 
imm
;

691 
ãmp
.
°ride
 = 
size
;

692 *
de°
 = 
	`ªtu∫Mem‹yAloc
(
ãmp
, 
abs_mem_°
);

699 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

700 (*
de°
)->
°ride
 = -1;

704 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

705 (*
de°
)->
°ride
 = -1;

707 
	}
}

709 
abs_mem_p
 
	$¸óãMem‹yAloc
(
ric_s
 
addr
, 
ric_p
 
vÆue
)

711 
abs_mem_p
 
nE¡ry
 = (abs_mem_p)
	`mÆloc
((
abs_mem_s
));

712 if(!
nE¡ry
)

713 
	`Áèl
("Out of Memory");

714 
	`mem£t
(
nE¡ry
, 0, (
abs_mem_s
));

715 
nE¡ry
->
addr
 = (
ric_p
)
	`mÆloc
((
ric_s
));

716 if(! 
nE¡ry
->
addr
)

717 
	`Áèl
("Out of Memory");

718 
nE¡ry
->
vÆue
 = (
ric_p
)
	`mÆloc
((
ric_s
));

719 if(! 
nE¡ry
->
vÆue
)

720 
	`Áèl
("Out of Memory");

721 
nE¡ry
->
addr
->
lowî_bound
 =áddr.lower_bound;

722 
nE¡ry
->
addr
->
uµî_bound
 =áddr.upper_bound;

723 
nE¡ry
->
addr
->
°ride
 =áddr.stride;

724 if(
vÆue
)

726 
nE¡ry
->
vÆue
->
lowî_bound
 = value->lower_bound;

727 
nE¡ry
->
vÆue
->
uµî_bound
 = value->upper_bound;

728 
nE¡ry
->
vÆue
->
°ride
 = value->stride;

732 
nE¡ry
->
vÆue
->
lowî_bound
 = 0;

733 
nE¡ry
->
vÆue
->
uµî_bound
 = 0;

734 
nE¡ry
->
vÆue
->
°ride
 = -1;

736 
nE¡ry
->
√xt
 = 
NULL
;

738  
nE¡ry
;

739 
	}
}

741 
	$övÆid©eMem‹yAloc
(
abs_mem_p
 
abs_mem_°
)

743 
abs_mem_p
 
ôî
;

746 
ôî
 = 
abs_mem_°
; iãr; iã∏ôî->
√xt
) {

747 if(!
ôî
->
vÆid
 || !ôî->
vÆue
)

749 
ôî
->
vÆue
->
lowî_bound
 = iãr->vÆue->
uµî_bound
 = 0;

750 
ôî
->
vÆue
->
°ride
 = -1;

752 
	}
}

755 
	$widíMem‹yAloc
(
ric_s
 
mem
, 
abs_mem_p
* 
abs_mem_°
, 
ric_p
 
vÆue
)

757 
abs_mem_p
 
ôî
;

758 
found
 = 0;

760 
ôî
 = *
abs_mem_°
; iãr; iã∏ôî->
√xt
) {

761 if(
mem
.
lowî_bound
 >
ôî
->
addr
->lower_bound &&

762 
mem
.
uµî_bound
 <
ôî
->
addr
->upper_bound &&

763 
mem
.
°ride
 =
ôî
->
addr
->stride &&

764 
	`abs
(
mem
.
lowî_bound
 - 
ôî
->
addr
->lowî_boundË% mem.
°ride
 == 0) {

765 
found
 = 1;

766 
ôî
->
vÆue
 = 
	`widíRICJoö
(value, iter->value);

767 } if((! 
ôî
->
addr
->
lowî_bound
 >
mem
.
uµî_bound
 + mem.
°ride
 &&

768 !
mem
.
lowî_bound
 >
ôî
->
addr
->
uµî_bound
 + iãr->addr->
°ride
)){

769 
found
 = 1;

771 
ôî
->
vÆue
->
lowî_bound
 = iãr->vÆue->
uµî_bound
 = 0;

772 
ôî
->
vÆue
->
°ride
 = -1;

776 if(!
found
) {

777 
abs_mem_p
 
nE¡ry
 = 
	`¸óãMem‹yAloc
(
mem
,
vÆue
);

778 
nE¡ry
->
√xt
 = *
abs_mem_°
;

779 *
abs_mem_°
 = 
nE¡ry
;

781 
	}
}

783 
	$upd©eMem‹yAloc
(
ric_s
 
mem
, 
abs_mem_p
* 
abs_mem_°
, 
ric_p
 
vÆue
,

784 
addr
)

786 
abs_mem_p
 
ôî
;

787 
found
 = 0;

789 
ôî
 = *
abs_mem_°
; iãr; iã∏ôî->
√xt
) {

790 if(!
ôî
->
vÆid
 && !(ôî->
ö°_addr
 =
addr
))

792 if(
ôî
->
ö°_addr
 =
addr
)

794 if(!
ôî
->
vÆid
)

796 
ôî
->
vÆid
 = 1;

797 
ôî
->
addr
 = 
	`makeRIC
(&
mem
);

798 
ôî
->
vÆue
 = 
	`makeRIC
(value);

802 
ôî
->
addr
->
lowî_bound
 = 
mem
.lower_bound;

803 
ôî
->
addr
->
uµî_bound
 = 
mem
.upper_bound;

804 
ôî
->
addr
->
°ride
 = 
mem
.stride;

805 
ôî
->
vÆue
 = 
	`upd©eRICJoö
(value, iter->value);

808 if(
mem
.
lowî_bound
 >
ôî
->
addr
->lower_bound &&

809 
mem
.
uµî_bound
 <
ôî
->
addr
->upper_bound &&

810 
mem
.
°ride
 =
ôî
->
addr
->stride &&

811 
	`abs
(
mem
.
lowî_bound
 - 
ôî
->
addr
->lowî_boundË% mem.
°ride
 == 0) {

812 #ifde‡
_DEBUG


815 
found
 = 1;

816 
ôî
->
vÆue
 = 
	`upd©eRICJoö
(value, iter->value);

817 } if((! 
ôî
->
addr
->
lowî_bound
 >
mem
.
uµî_bound
 + mem.
°ride
 &&

818 !
mem
.
lowî_bound
 >
ôî
->
addr
->
uµî_bound
 + iãr->addr->
°ride
)){

819 
found
 = 1;

820 #ifde‡
_DEBUG


823 
ôî
->
vÆue
->
lowî_bound
 = iãr->vÆue->
uµî_bound
 = 0;

824 
ôî
->
vÆue
->
°ride
 = -1;

826 
cou¡
++;

841 
	}
}

843 
	$upd©eRICSt‹eIndex
(
ric_p
 
vÆue
,Ñic_∞
ba£
,Ñic_∞
ödex
,

844 
abs_mem_p
* 
abs_mem_°
, 
size
, 
addr
)

846 
ric_p
 
mem_Æoc
;

848 if(
ba£
)

851 if(
ba£
->
°ride
 !-1 && 
	`gcd
(gcd(ba£->°ride, 
ödex
->stride),

852 
size
) == size)

854 
ric_s
 
ãmp
;

855 
ãmp
.
lowî_bound
 = 
ba£
->lowî_bound + 
ödex
->lower_bound;

856 
ãmp
.
uµî_bound
 = 
ba£
->uµî_bound + 
ödex
->upper_bound;

857 
ãmp
.
°ride
 = 
size
;

858 
	`upd©eMem‹yAloc
(
ãmp
, 
abs_mem_°
, 
vÆue
, 
addr
);

865 
	`övÆid©eMem‹yAloc
(*
abs_mem_°
);

869 
	`övÆid©eMem‹yAloc
(*
abs_mem_°
);

871 
	}
}

873 
	$upd©eRICSt‹e
(
ric_p
 
vÆue
,Ñic_∞
ba£
, 
imm
, 
abs_mem_p
* 
abs_mem_°
,

874 
size
, 
addr
)

876 
ric_p
 
mem_Æoc
;

878 if(
ba£
)

881 if(
ba£
->
°ride
 !-1 && 
	`gcd
(ba£->°ride, 
size
) == size)

883 
ric_s
 
ãmp
;

884 
ãmp
.
lowî_bound
 = 
ba£
->lowî_bound + 
imm
;

885 
ãmp
.
uµî_bound
 = 
ba£
->uµî_bound + 
imm
;

886 
ãmp
.
°ride
 = 
size
;

887 
	`upd©eMem‹yAloc
(
ãmp
, 
abs_mem_°
, 
vÆue
, 
addr
);

894 
	`övÆid©eMem‹yAloc
(*
abs_mem_°
);

898 
	`övÆid©eMem‹yAloc
(*
abs_mem_°
);

900 
	}
}

902 
	$upd©eRICRightShi·V
(
ric_p
* 
de°
,Ñic_∞
§c1
,Ñic_∞
§c2
)

904 if(! (*
de°
))

905 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

906 if(! 
de°
)

907 
	`Áèl
("Out of memory");

908 if(
§c1
 && 
§c2
)

911 if(
§c1
->
°ride
 !-1 && 
§c2
->stride != -1)

913 if(
§c1
->
uµî_bound
 <= 0) {

914 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound >> 
§c2
->lower_bound;

915 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound >> 
§c2
->upper_bound;

916 } if(
§c1
->
lowî_bound
 <0 && src1->
uµî_bound
 > 0) {

917 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound >> 
§c2
->lower_bound;

918 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound >> 
§c2
->
lowî_bound
;

919 } if(
§c1
->
lowî_bound
 > 0) {

920 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound >> 
§c2
->
uµî_bound
;

921 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound >> 
§c2
->
lowî_bound
;

923 (*
de°
)->
°ride
 = 1;

930 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

931 (*
de°
)->
°ride
 = -1;

935 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

936 (*
de°
)->
°ride
 = -1;

938 
	}
}

940 
	$upd©eRICLe·Shi·
(
ric_p
* 
de°
,Ñic_∞
§c1
, 
imm
)

942 if(! (*
de°
))

943 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

944 if(! 
de°
)

945 
	`Áèl
("Out of memory");

946 if(
§c1
)

949 if(
§c1
->
°ride
 != -1)

951 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound << 
imm
;

952 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound << 
imm
;

953 if(
§c1
->
°ride
 != 0)

954 (*
de°
)->
°ride
 = 
§c1
->°ridê<< 
imm
;

956 (*
de°
)->
°ride
 = 
§c1
->stride;

963 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

964 (*
de°
)->
°ride
 = -1;

968 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

969 (*
de°
)->
°ride
 = -1;

971 
	}
}

973 
	$upd©eRICRightShi·
(
ric_p
* 
de°
,Ñic_∞
§c1
, 
imm
)

975 if(! (*
de°
))

976 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

977 if(! 
de°
)

978 
	`Áèl
("Out of memory");

979 if(
§c1
)

982 if(
§c1
->
°ride
 != -1)

984 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound >> 
imm
;

985 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound >> 
imm
;

986 (*
de°
)->
°ride
 = 
§c1
->°ridê>> 
imm
;

993 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

994 (*
de°
)->
°ride
 = -1;

998 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

999 (*
de°
)->
°ride
 = -1;

1001 
	}
}

1003 
	$upd©eRICAddImm
(
ric_p
* 
de°
,Ñic_∞
§c1
, 
imm
)

1005 if(! (*
de°
))

1006 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

1007 if(! 
de°
)

1008 
	`Áèl
("Out of memory");

1009 if(
§c1
)

1012 if(
§c1
->
°ride
 != -1)

1014 (*
de°
)->
lowî_bound
 = 
§c1
->lowî_bound + 
imm
;

1015 (*
de°
)->
uµî_bound
 = 
§c1
->uµî_bound + 
imm
;

1016 (*
de°
)->
°ride
 = 
§c1
->stride;

1023 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

1024 (*
de°
)->
°ride
 = -1;

1028 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

1029 (*
de°
)->
°ride
 = -1;

1031 
	}
}

1033 
	$upd©eRICImm
(
ric_p
* 
de°
, 
imm
)

1035 if(! (*
de°
))

1036 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

1037 if(! 
de°
)

1038 
	`Áèl
("Out of memory");

1040 (*
de°
)->
lowî_bound
 = 
imm
;

1041 (*
de°
)->
uµî_bound
 = 
imm
;

1042 (*
de°
)->
°ride
 = 0;

1043 
	}
}

1045 
	$upd©eRIC
(
ric_p
* 
de°
,Ñic_∞
§c1
)

1047 if(! (*
de°
))

1048 *
de°
 = (
ric_p
)
	`mÆloc
((
ric_s
));

1049 if(! 
de°
)

1050 
	`Áèl
("Out of memory");

1051 if(
§c1
)

1054 if(
§c1
->
°ride
 != -1)

1056 (*
de°
)->
lowî_bound
 = 
§c1
->lower_bound;

1057 (*
de°
)->
uµî_bound
 = 
§c1
->upper_bound;

1058 (*
de°
)->
°ride
 = 
§c1
->stride;

1065 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

1066 (*
de°
)->
°ride
 = -1;

1070 (*
de°
)->
lowî_bound
 = (*de°)->
uµî_bound
 = 0;

1071 (*
de°
)->
°ride
 = -1;

1073 
	}
}

1075 
	$å™sf‹mAloc
(
tcfg_node_t
* 
bbi
, * 
ch™ge
)

1077 
de_ö°_t
* 
ö°
;

1078 * 
iß_«me
;

1079 
rs
,
π
,
rd
,
imm
;

1080 
n_ö°
;

1081 
ric_p
* 
abs_ªg_vÆue
 = 
NULL
;

1082 
abs_mem_p
 
abs_mem_vÆue
 = 
NULL
;

1083 
abs_mem_p
 
ôî
;

1084 
i
;

1086 
	`as£π
(
bbi
);

1087 
	`as£π
(
bbi
->
bb
);

1088 
ö°
 = 
bbi
->
bb
->
code
;

1093 if(! 
bbi
->
bb
->
ö_abs_ªg_vÆue
)

1095 
bbi
->
bb
->
ö_abs_ªg_vÆue
 = (
ric_p
 *)
	`mÆloc
(
MAX_NO_REGISTERS


1096 * (
ric_p
));

1097 if(! 
bbi
->
bb
->
ö_abs_ªg_vÆue
)

1098 
	`Áèl
("Out of memory");

1099 
	`mem£t
(
bbi
->
bb
->
ö_abs_ªg_vÆue
, 0, 
MAX_NO_REGISTERS
 *

1100 (
ric_p
));

1102 
bbi
->
bb
->
ö_abs_ªg_vÆue
[0] = (
ric_p
)
	`mÆloc
((
ric_s
));

1103 
	`mem£t
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[0], 0, (
ric_s
));

1104 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28] = (
ric_p
)
	`mÆloc
((
ric_s
));

1105 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]);

1106 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
lowî_bound
 = 
GLOBAL_START
;

1107 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
uµî_bound
 = 
GLOBAL_START
;

1108 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
°ride
 = 0;

1110 if(! 
bbi
->
bb
->
out_abs_ªg_vÆue
)

1112 
bbi
->
bb
->
out_abs_ªg_vÆue
 = (
ric_p
 *)
	`mÆloc
(
MAX_NO_REGISTERS


1113 * (
ric_p
));

1115 if(! 
bbi
->
bb
->
out_abs_ªg_vÆue
)

1116 
	`Áèl
("Out of memory");

1117 
	`mem£t
(
bbi
->
bb
->
out_abs_ªg_vÆue
, 0, 
MAX_NO_REGISTERS
 *

1118 (
ric_p
));

1120 
bbi
->
bb
->
out_abs_ªg_vÆue
[0] = (
ric_p
)
	`mÆloc
((
ric_s
));

1121 
	`mem£t
(
bbi
->
bb
->
out_abs_ªg_vÆue
[0], 0, (
ric_s
));

1122 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28] = (
ric_p
)
	`mÆloc
((
ric_s
));

1123 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]);

1124 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
lowî_bound
 = 
GLOBAL_START
;

1125 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
uµî_bound
 = 
GLOBAL_START
;

1126 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
°ride
 = 0;

1129 
i
 = 0; i < 
MAX_NO_REGISTERS
; i++)

1131 if(
bbi
->
bb
->
ö_abs_ªg_vÆue
[
i
])

1132 
bbi
->
bb
->
out_abs_ªg_vÆue
[
i
] = 
	`makeRIC
(bbi->bb->
ö_abs_ªg_vÆue
[i]);

1134 
bbi
->
bb
->
out_abs_mem_vÆue
 = 
NULL
;

1135 
ôî
 = 
bbi
->
bb
->
ö_abs_mem_vÆue
; iãr; iã∏ôî->
√xt
)

1137 
abs_mem_p
 
nE¡ry
 = (abs_mem_p)
	`mÆloc
((
abs_mem_s
));

1138 
	`mem£t
(
nE¡ry
, 0, (
abs_mem_s
));

1139 
nE¡ry
->
ö°_addr
 = 
ôî
->inst_addr;

1140 
nE¡ry
->
vÆid
 = 
ôî
->valid;

1141 
nE¡ry
->
addr
 = 
	`makeRIC
(
ôî
->addr);

1142 
nE¡ry
->
vÆue
 = 
	`makeRIC
(
ôî
->value);

1143 
nE¡ry
->
√xt
 = 
bbi
->
bb
->
out_abs_mem_vÆue
;

1144 
bbi
->
bb
->
out_abs_mem_vÆue
 = 
nE¡ry
;

1148 
abs_ªg_vÆue
 = 
bbi
->
bb
->
out_abs_ªg_vÆue
;

1150 
abs_mem_vÆue
 = 
bbi
->
bb
->
out_abs_mem_vÆue
;

1152 
n_ö°
 = 0;Ç_ö° < 
bbi
->
bb
->
num_ö°
;Ç_inst++)

1154 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1158 
	`makeRICPîIn°ru˘i⁄
(
ö°
, 
abs_ªg_vÆue
);

1160 if(! 
	`°rcmp
(
iß_«me
, "add") || ! strcmp(isa_name, "addu"))

1163 
rs
 = *(
ö°
->
ö
);

1164 
π
 = *(
ö°
->
ö
 + 1);

1165 
rd
 = *(
ö°
->
out
);

1166 
	`upd©eRICAdd
(&
abs_ªg_vÆue
[
rd
],ábs_ªg_vÆue[
rs
],

1167 
abs_ªg_vÆue
[
π
]);

1168 } if(! 
	`°rcmp
(
iß_«me
, "addi") || ! strcmp(isa_name, "addiu"))

1171 
rs
 = *(
ö°
->
ö
);

1172 
imm
 = 
ö°
->imm;

1173 
rd
 = *(
ö°
->
out
);

1174 
	`upd©eRICAddImm
(&
abs_ªg_vÆue
[
rd
],ábs_ªg_vÆue[
rs
],

1175 
imm
);

1176 } if(! 
	`°rcmp
(
iß_«me
, "sub") || ! strcmp(isa_name, "subu"))

1179 
rs
 = *(
ö°
->
ö
);

1180 
π
 = *(
ö°
->
ö
 + 1);

1181 
rd
 = *(
ö°
->
out
);

1182 
	`upd©eRICSub
(&
abs_ªg_vÆue
[
rd
],ábs_ªg_vÆue[
rs
],

1183 
abs_ªg_vÆue
[
π
]);

1184 } if(! 
	`°rcmp
(
iß_«me
, "mult"))

1186 
rs
 = *(
ö°
->
ö
);

1187 
π
 = *(
ö°
->
ö
 + 1);

1188 
	`upd©eRICMul
(&
abs_ªg_vÆue
[
HI
], &abs_ªg_vÆue[
LO
],

1189 
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
]);

1190 } if(! 
	`°rcmp
(
iß_«me
, "multu")) {

1191 
rs
 = *(
ö°
->
ö
);

1192 
π
 = *(
ö°
->
ö
 + 1);

1193 } if(! 
	`°rcmp
(
iß_«me
, "div"))

1195 
rs
 = *(
ö°
->
ö
);

1196 
π
 = *(
ö°
->
ö
 + 1);

1197 } if(! 
	`°rcmp
(
iß_«me
, "divu")) {

1198 
rs
 = *(
ö°
->
ö
);

1199 
π
 = *(
ö°
->
ö
 + 1);

1200 } if(! 
	`°rcmp
(
iß_«me
, "mfhi")) {

1201 
rd
 = *(
ö°
->
out
);

1202 
	`upd©eRIC
(&(
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
HI
]);

1203 } if(! 
	`°rcmp
(
iß_«me
, "mflo")) {

1204 
rd
 = *(
ö°
->
out
);

1205 
	`upd©eRIC
(&(
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
LO
]);

1206 } if(! 
	`°rcmp
(
iß_«me
, "mthi")) {

1207 
rs
 = *(
ö°
->
ö
);

1208 
	`upd©eRIC
(&(
abs_ªg_vÆue
[
HI
]),ábs_ªg_vÆue[
rs
]);

1209 } if(! 
	`°rcmp
(
iß_«me
, "mtlo")) {

1210 
rs
 = *(
ö°
->
ö
);

1211 
	`upd©eRIC
(&(
abs_ªg_vÆue
[
LO
]),ábs_ªg_vÆue[
rs
]);

1212 } if(! 
	`°rcmp
(
iß_«me
, "lui")) {

1213 
π
 = *(
ö°
->
out
);

1214 
imm
 = 
ö°
->imm;

1215 
	`upd©eRICImm
(&(
abs_ªg_vÆue
[
π
]), 
imm
 << 16);

1216 } i‡(! 
	`°rcmp
(
iß_«me
, "slt")) {

1217 
rs
 = *(
ö°
->
ö
);

1218 
π
 = *(
ö°
->
ö
 + 1);

1219 
rd
 = *(
ö°
->
out
);

1220 
	`upd©eRICBoﬁ
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1221 
abs_ªg_vÆue
[
π
]);

1222 } i‡(! 
	`°rcmp
(
iß_«me
, "slti")) {

1223 
rs
 = *(
ö°
->
ö
);

1224 
imm
 = 
ö°
->imm;

1225 
rd
 = *(
ö°
->
out
);

1226 
	`upd©eRICBoﬁImm
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1227 
imm
);

1228 } i‡(! 
	`°rcmp
(
iß_«me
, "sltu") || ! strcmp(isa_name, "sltiu")) {

1229 
rd
 = *(
ö°
->
out
);

1230 
	`upd©eRICBoﬁU
(& (
abs_ªg_vÆue
[
rd
]));

1231 } i‡(! 
	`°rcmp
(
iß_«me
, "sra") || !strcmp(isa_name, "srl")) {

1232 
rs
 = *(
ö°
->
ö
);

1233 
imm
 = 
ö°
->imm;

1234 
rd
 = *(
ö°
->
out
);

1235 
	`upd©eRICRightShi·
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1236 
imm
);

1237 } i‡(! 
	`°rcmp
(
iß_«me
, "srav")) {

1238 
rs
 = *(
ö°
->
ö
);

1239 
π
 = *(
ö°
->
ö
 + 1);

1240 
rd
 = *(
ö°
->
out
);

1241 
	`upd©eRICRightShi·V
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1242 
abs_ªg_vÆue
[
π
]);

1243 } if(! 
	`°rcmp
(
iß_«me
, "sll")) {

1244 
rs
 = *(
ö°
->
ö
);

1245 
rd
 = *(
ö°
->
out
);

1246 
imm
 = 
ö°
->imm;

1247 
	`as£π
(
imm
 >= 0);

1248 
	`upd©eRICLe·Shi·
(&
abs_ªg_vÆue
[
rd
],ábs_ªg_vÆue[
rs
], 
imm
);

1249 } if(! 
	`°rcmp
(
iß_«me
, "lb")) {

1250 if(
ö°
->
num_ö
 <= 1) {

1251 
rs
 = *(
ö°
->
ö
);

1252 
imm
 = 
ö°
->imm;

1253 
rd
 = *(
ö°
->
out
);

1254 
	`upd©eRICLﬂd
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1255 
imm
, 
abs_mem_vÆue
, 
SIZE_OF_BYTE
);

1256 } if(
ö°
->
num_ö
 == 2) {

1257 
rs
 = *(
ö°
->
ö
);

1258 
π
 = *(
ö°
->
ö
 + 1);

1259 
rd
 = *(
ö°
->
out
);

1260 
	`upd©eRICLﬂdIndex
(& (
abs_ªg_vÆue
[
rd
]),

1261 
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1262 
abs_mem_vÆue
, 
SIZE_OF_BYTE
);

1264 } if(! 
	`°rcmp
(
iß_«me
, "lh")) {

1265 if(
ö°
->
num_ö
 <= 1) {

1266 
rs
 = *(
ö°
->
ö
);

1267 
imm
 = 
ö°
->imm;

1268 
rd
 = *(
ö°
->
out
);

1269 
	`upd©eRICLﬂd
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1270 
imm
, 
abs_mem_vÆue
, 
SIZE_OF_HALF_WORD
);

1271 } if(
ö°
->
num_ö
 == 2) {

1272 
rs
 = *(
ö°
->
ö
);

1273 
π
 = *(
ö°
->
ö
 + 1);

1274 
rd
 = *(
ö°
->
out
);

1275 
	`upd©eRICLﬂdIndex
(& (
abs_ªg_vÆue
[
rd
]),

1276 
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1277 
abs_mem_vÆue
, 
SIZE_OF_HALF_WORD
);

1279 } if(! 
	`°rcmp
(
iß_«me
, "lw")) {

1280 if(
ö°
->
num_ö
 <= 1) {

1281 
rs
 = *(
ö°
->
ö
);

1282 
imm
 = 
ö°
->imm;

1283 
rd
 = *(
ö°
->
out
);

1284 
	`upd©eRICLﬂd
(& (
abs_ªg_vÆue
[
rd
]),ábs_ªg_vÆue[
rs
],

1285 
imm
, 
abs_mem_vÆue
, 
SIZE_OF_WORD
);

1286 } if(
ö°
->
num_ö
 == 2) {

1287 
rs
 = *(
ö°
->
ö
);

1288 
π
 = *(
ö°
->
ö
 + 1);

1289 
rd
 = *(
ö°
->
out
);

1290 
	`upd©eRICLﬂdIndex
(& (
abs_ªg_vÆue
[
rd
]),

1291 
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1292 
abs_mem_vÆue
, 
SIZE_OF_WORD
);

1294 } if(!
	`°rcmp
(
iß_«me
, "lwl") || !strcmp(isa_name, "lwr")

1295 || !
	`°rcmp
(
iß_«me
, "swl") || !strcmp(isa_name, "swr") ||

1296 !
	`°rcmp
(
iß_«me
, "lhu")) {

1298 
rs
 = *(
ö°
->
ö
);

1299 
imm
 = 
ö°
->imm;

1300 
rd
 = *(
ö°
->
out
);

1301 if(! 
abs_ªg_vÆue
[
rd
])

1302 
abs_ªg_vÆue
[
rd
] = (
ric_p
)
	`mÆloc
((
ric_s
));

1303 
	`CHECK_MEM
(
abs_ªg_vÆue
[
rd
]);

1305 
abs_ªg_vÆue
[
rd
]->
lowî_bound
 =ábs_ªg_vÆue[rd]->
uµî_bound
 = 0;

1306 
abs_ªg_vÆue
[
rd
]->
°ride
 = -1;

1308 if(! 
	`°rcmp
(
iß_«me
, "sb")) {

1309 if(
ö°
->
num_ö
 <= 2) {

1310 
rs
 = *(
ö°
->
ö
);

1311 
imm
 = 
ö°
->imm;

1312 
π
 = *(
ö°
->
ö
 + 1);

1313 
	`upd©eRICSt‹e
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1314 
imm
, &
abs_mem_vÆue
, 
SIZE_OF_BYTE
, 
ö°
->
addr
);

1315 } if(
ö°
->
num_ö
 == 3) {

1316 
rs
 = *(
ö°
->
ö
);

1317 
rd
 = *(
ö°
->
ö
 + 1);

1318 
π
 = *(
ö°
->
ö
 + 2);

1319 
	`upd©eRICSt‹eIndex
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1320 
abs_ªg_vÆue
[
rd
], &
abs_mem_vÆue
, 
SIZE_OF_BYTE
,

1321 
ö°
->
addr
);

1323 } if(! 
	`°rcmp
(
iß_«me
, "sh")) {

1324 if(
ö°
->
num_ö
 <= 2) {

1325 
rs
 = *(
ö°
->
ö
);

1326 
imm
 = 
ö°
->imm;

1327 
π
 = *(
ö°
->
ö
 + 1);

1328 
	`upd©eRICSt‹e
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1329 
imm
, &
abs_mem_vÆue
, 
SIZE_OF_HALF_WORD
, 
ö°
->
addr
);

1330 } if(
ö°
->
num_ö
 == 3) {

1331 
rs
 = *(
ö°
->
ö
);

1332 
rd
 = *(
ö°
->
ö
 + 1);

1333 
π
 = *(
ö°
->
ö
 + 2);

1334 
	`upd©eRICSt‹eIndex
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1335 
abs_ªg_vÆue
[
rd
], &
abs_mem_vÆue
, 
SIZE_OF_HALF_WORD
,

1336 
ö°
->
addr
);

1338 } if(! 
	`°rcmp
(
iß_«me
, "sw")) {

1339 if(
ö°
->
num_ö
 <= 2) {

1340 
rs
 = *(
ö°
->
ö
);

1341 
imm
 = 
ö°
->imm;

1342 
π
 = *(
ö°
->
ö
 + 1);

1343 
	`upd©eRICSt‹e
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1344 
imm
, &
abs_mem_vÆue
, 
SIZE_OF_WORD
, 
ö°
->
addr
);

1345 } if(
ö°
->
num_ö
 == 3) {

1346 
rs
 = *(
ö°
->
ö
);

1347 
rd
 = *(
ö°
->
ö
 + 1);

1348 
π
 = *(
ö°
->
ö
 + 2);

1349 
	`upd©eRICSt‹eIndex
(
abs_ªg_vÆue
[
rs
],ábs_ªg_vÆue[
π
],

1350 
abs_ªg_vÆue
[
rd
], &
abs_mem_vÆue
, 
SIZE_OF_WORD
,

1351 
ö°
->
addr
);

1355 if(! 
	`°rcmp
(
iß_«me
, "l.d") || ! strcmp(isa_name, "s.d") ||

1356 !
	`°rcmp
(
iß_«me
, "l.s") || !strcmp(isa_name, "s.s")) {

1358 
rs
 = *(
ö°
->
ö
);

1359 
imm
 = 
ö°
->imm;

1360 
rd
 = *(
ö°
->
out
);

1361 if(! 
abs_ªg_vÆue
[
rd
])

1362 
abs_ªg_vÆue
[
rd
] = (
ric_p
)
	`mÆloc
((
ric_s
));

1363 
	`CHECK_MEM
(
abs_ªg_vÆue
[
rd
]);

1368 if(! 
	`°rcmp
(
iß_«me
, "beq")) {

1369 
rs
 = *(
ö°
->
ö
);

1370 
π
 = *(
ö°
->
ö
 + 1);

1372 } if(! 
	`°rcmp
(
iß_«me
, "bne")) {

1373 
rs
 = *(
ö°
->
ö
);

1374 
π
 = *(
ö°
->
ö
 + 1);

1381 
ö°
++;

1384 
bbi
->
bb
->
out_abs_mem_vÆue
 = 
abs_mem_vÆue
;

1385 #ifde‡
_DEBUG


1388 
	`upd©eSuc˚ss‹Aloc
(
bbi
, 
ch™ge
);

1389 
bbi
->
™Æ_cou¡
++;

1390 
	}
}

1393 
	$checkEquÆôy
(
ric_p
 
¨g1
,Ñic_∞
¨g2
)

1397 
	#EQUAL
(
x
,
y
Ë((x)==(y))

	)

1399  !((
¨g1
 && 
¨g2
 && 
	`EQUAL
◊rg1->
lowî_bound
,árg2->lower_bound)

1400 && 
	`EQUAL
(
¨g1
->
uµî_bound
, 
¨g2
->upper_bound)

1401 && 
¨g1
->
°ride
 =
¨g2
->stride)

1402 || (! 
¨g1
 && !
¨g2
)

1404 
	}
}

1408 
	$JoöPªdAloc
(
tcfg_node_t
* 
succ
,Åcfg_node_t* 
bbi
, * 
ch™ge_Êag
)

1410 
i
;

1411 
de_ö°_t
* 
l_ö°
, *
¥ev_ö°
;

1414 if(! 
succ
->
bb
->
ö_abs_ªg_vÆue
) {

1415 *
ch™ge_Êag
 = 1;

1416 
l_ö°
 = 
bbi
->
bb
->
code
 + bbi->bb->
num_ö°
 - 1;

1417 
¥ev_ö°
 = 
succ
->
bb
->
code
 - 1;

1418 
succ
->
bb
->
ö_abs_ªg_vÆue
 = (
ric_p
 *)
	`mÆloc
(
MAX_NO_REGISTERS
 * (ric_p));

1419 if(! 
succ
->
bb
->
ö_abs_ªg_vÆue
)

1420 
	`Áèl
("Out of memory");

1421 
	`mem£t
(
succ
->
bb
->
ö_abs_ªg_vÆue
, 0, 
MAX_NO_REGISTERS
 * (
ric_p
));

1423 
succ
->
bb
->
ö_abs_ªg_vÆue
[0] = (
ric_p
)
	`mÆloc
(
MAX_NO_REGISTERS
 * (
ric_s
));

1424 
	`mem£t
(
succ
->
bb
->
ö_abs_ªg_vÆue
[0], 0, (
ric_s
));

1425 
i
 = 1; i < 
MAX_NO_REGISTERS
; i++)

1427 if(!
	`°rcmp
(
iß
[
l_ö°
->
›_íum
].
«me
, "jr") &&

1428 !
	`°rcmp
(
iß
[
¥ev_ö°
->
›_íum
].
«me
, "jal") &&

1429 ((
i
 >= 16 && i <=23) || (i == 29)))

1431 
succ
->
bb
->
ö_abs_ªg_vÆue
[
i
] = 
	`makeRIC
(
¥ev_ö°
->
abs_ªg
[i]);

1433 if(
bbi
->
bb
->
out_abs_ªg_vÆue
[
i
])

1434 
succ
->
bb
->
ö_abs_ªg_vÆue
[
i
] = 
	`makeRIC
(
bbi
->bb->
out_abs_ªg_vÆue
[i]);

1439 
i
 = 1; i < 
MAX_NO_REGISTERS
; i++)

1441 
ric_p
 
ãmp
;

1446 
l_ö°
 = 
bbi
->
bb
->
code
 + bbi->bb->
num_ö°
 - 1;

1447 
¥ev_ö°
 = 
succ
->
bb
->
code
 - 1;

1448 if(!
	`°rcmp
(
iß
[
l_ö°
->
›_íum
].
«me
, "jr") &&

1449 !
	`°rcmp
(
iß
[
¥ev_ö°
->
›_íum
].
«me
, "jal") &&

1450 ((
i
 >= 16 && i <=23) || (i == 29)))

1452 
ãmp
 = 
	`makeRIC
(
¥ev_ö°
->
abs_ªg
[
i
]);

1457 
ãmp
 = 
	`upd©eRICJoö
(
succ
->
bb
->
ö_abs_ªg_vÆue
[
i
],

1458 
bbi
->
bb
->
out_abs_ªg_vÆue
[
i
]);

1465 
succ
->
bb
->
ö_abs_ªg_vÆue
[
i
] = 
ãmp
;

1469 if(! 
succ
->
bb
->
ö_abs_mem_vÆue
)

1471 
abs_mem_p
 
ôî
;

1473 
ôî
 = 
bbi
->
bb
->
out_abs_mem_vÆue
; iãr; iã∏ôî->
√xt
)

1475 
abs_mem_p
 
nE¡ry
 = 
	`¸óãMem‹yAloc
(*(
ôî
->
addr
), iãr->
vÆue
);

1476 
nE¡ry
->
√xt
 = 
succ
->
bb
->
ö_abs_mem_vÆue
;

1477 
succ
->
bb
->
ö_abs_mem_vÆue
 = 
nE¡ry
;

1487 
	`joöMem‹yAloc
(
bbi
->
bb
->
out_abs_mem_vÆue
,

1488 &(
succ
->
bb
->
ö_abs_mem_vÆue
));

1494 
	}
}

1496 
	$upd©eSuc˚ss‹Aloc
(
tcfg_node_t
* 
bbi
, * 
ch™ge_Êag
)

1498 
tcfg_edge_t
* 
ôî
;

1499 
found
 = 0;

1501 
ôî
 = 
bbi
->
out
; iãr; iã∏ôî->
√xt_out
)

1503 
	`JoöPªdAloc
(
ôî
->
d°
, 
bbi
, 
ch™ge_Êag
);

1505 
	}
}

1507 #ifde‡
_DEBUG


1509 
	$dumpAlocSètus
(
tcfg_node_t
* 
bbi
, 
FILE
* 
Â
)

1511 
ric_p
* 
ªg
 = 
bbi
->
bb
->
ö_abs_ªg_vÆue
;

1512 
num_ªgs
;

1513 
abs_mem_p
 
ôî
;

1514 
l
[20],
u
[20];

1516 
	`Ârötf
(
Â
,"\n****Priniting Input informationÅoÅhe basic block****\n");

1517 
	`Ârötf
(
Â
,"*****Printing Abstract Register Values*****\n\n");

1518 
	`Ârötf
(
Â
, "Basic block startáddress = 0x%x, Endáddress = 0x%x\n",

1519 
bbi
->
bb
->
ß
, bbi->bb->ß + bbi->bb->
size
);

1520 
num_ªgs
 = 0;Çum_ªg†< 
MAX_NO_REGISTERS
;Çum_regs++)

1522 if(! 
ªg
[
num_ªgs
])

1524 
	`Ârötf
(
Â
, "Regi°î %d::\n", 
num_ªgs
);

1525 if(
ªg
[
num_ªgs
]->
lowî_bound
 =-
INFINITY
)

1526 
	`•rötf
(
l
, "-inf");

1528 
	`•rötf
(
l
, "%d", 
ªg
[
num_ªgs
]->
lowî_bound
);

1529 if(
ªg
[
num_ªgs
]->
uµî_bound
 =
INFINITY
)

1530 
	`•rötf
(
u
, "inf");

1532 
	`•rötf
(
u
, "%d", 
ªg
[
num_ªgs
]->
uµî_bound
);

1533 
	`Ârötf
(
Â
, "(%s,%s,%d)\n", 
l
, 
u
, 
ªg
[
num_ªgs
]->
°ride
);

1536 
	`Ârötf
(
Â
,"\n*****End Printing Abstract Register Values*****\n\n");

1537 
	`Ârötf
(
Â
,"\n*****Printing Abstract Memory Locations*****\n\n");

1539 
ôî
 = 
bbi
->
bb
->
ö_abs_mem_vÆue
; iãr; iã∏ôî->
√xt
)

1541 
	`Ârötf
(
Â
, "Addªs†%x\n", 
ôî
->
ö°_addr
);

1542 if(!
ôî
->
vÆid
)

1544 
	`Ârötf
(
Â
,"Not valid\n");

1547 
	`Ârötf
(
Â
, "Address Range::");

1548 if(
ôî
->
addr
->
lowî_bound
 =-
INFINITY
)

1549 
	`•rötf
(
l
, "-inf");

1551 
	`•rötf
(
l
, "%d", 
ôî
->
addr
->
lowî_bound
);

1552 if(
ôî
->
addr
->
uµî_bound
 =
INFINITY
)

1553 
	`•rötf
(
u
, "inf");

1555 
	`•rötf
(
u
, "%d", 
ôî
->
addr
->
uµî_bound
);

1556 
	`Ârötf
(
Â
, "(%s,%s,%dË ", 
l
, 
u
, 
ôî
->
addr
->
°ride
);

1557 
	`Ârötf
(
Â
, "Value Range::");

1558 if(!
ôî
->
vÆue
)

1560 
	`Ârötf
(
Â
, "(UNKNOWN)\n");

1563 if(
ôî
->
vÆue
->
lowî_bound
 =-
INFINITY
)

1564 
	`•rötf
(
l
, "-inf");

1566 
	`•rötf
(
l
, "%d", 
ôî
->
vÆue
->
lowî_bound
);

1567 if(
ôî
->
vÆue
->
uµî_bound
 =
INFINITY
)

1568 
	`•rötf
(
u
, "inf");

1570 
	`•rötf
(
u
, "%d", 
ôî
->
vÆue
->
uµî_bound
);

1571 
	`Ârötf
(
Â
, "(%s,%s,%d)\n", 
l
, 
u
, 
ôî
->
vÆue
->
°ride
);

1574 
	`Ârötf
(
Â
,"\n*****End Printing Abstract Memory Locations*****\n\n");

1576 
ªg
 = 
bbi
->
bb
->
out_abs_ªg_vÆue
;

1578 
	`Ârötf
(
Â
,"\n****Priniting Output informationÅoÅhe basic block****\n");

1579 
	`Ârötf
(
Â
,"*****Printing Abstract Register Values*****\n\n");

1580 
	`Ârötf
(
Â
, "Basic block startáddress = 0x%x, Endáddress = 0x%x\n",

1581 
bbi
->
bb
->
ß
, bbi->bb->ß + bbi->bb->
size
);

1582 
num_ªgs
 = 0;Çum_ªg†< 
MAX_NO_REGISTERS
;Çum_regs++)

1584 if(! 
ªg
[
num_ªgs
])

1586 
	`Ârötf
(
Â
, "Regi°î %d::\n", 
num_ªgs
);

1587 if(
ªg
[
num_ªgs
]->
lowî_bound
 =-
INFINITY
)

1588 
	`•rötf
(
l
, "-inf");

1590 
	`•rötf
(
l
, "%d", 
ªg
[
num_ªgs
]->
lowî_bound
);

1591 if(
ªg
[
num_ªgs
]->
uµî_bound
 =
INFINITY
)

1592 
	`•rötf
(
u
, "inf");

1594 
	`•rötf
(
u
, "%d", 
ªg
[
num_ªgs
]->
uµî_bound
);

1595 
	`Ârötf
(
Â
, "(%s,%s,%d)\n", 
l
, 
u
, 
ªg
[
num_ªgs
]->
°ride
);

1598 
	`Ârötf
(
Â
,"\n*****End Printing Abstract Register Values*****\n\n");

1599 
	`Ârötf
(
Â
,"\n*****Printing Abstract Memory Locations*****\n\n");

1601 
ôî
 = 
bbi
->
bb
->
out_abs_mem_vÆue
; iãr; iã∏ôî->
√xt
)

1603 
	`Ârötf
(
Â
, "Addªs†%x\n", 
ôî
->
ö°_addr
);

1604 if(!
ôî
->
vÆid
)

1606 
	`Ârötf
(
Â
,"Not valid\n");

1609 
	`Ârötf
(
Â
, "Address Range::");

1610 if(
ôî
->
addr
->
lowî_bound
 =-
INFINITY
)

1611 
	`•rötf
(
l
, "-inf");

1613 
	`•rötf
(
l
, "%d", 
ôî
->
addr
->
lowî_bound
);

1614 if(
ôî
->
addr
->
uµî_bound
 =
INFINITY
)

1615 
	`•rötf
(
u
, "inf");

1617 
	`•rötf
(
u
, "%d", 
ôî
->
addr
->
uµî_bound
);

1618 
	`Ârötf
(
Â
, "(%s,%s,%dË ", 
l
, 
u
, 
ôî
->
addr
->
°ride
);

1619 
	`Ârötf
(
Â
, "Value Range::");

1620 if(!
ôî
->
vÆue
)

1622 
	`Ârötf
(
Â
, "(UNKNOWN)\n");

1625 if(
ôî
->
vÆue
->
lowî_bound
 =-
INFINITY
)

1626 
	`•rötf
(
l
, "-inf");

1628 
	`•rötf
(
l
, "%d", 
ôî
->
vÆue
->
lowî_bound
);

1629 if(
ôî
->
vÆue
->
uµî_bound
 =
INFINITY
)

1630 
	`•rötf
(
u
, "inf");

1632 
	`•rötf
(
u
, "%d", 
ôî
->
vÆue
->
uµî_bound
);

1633 
	`Ârötf
(
Â
, "(%s,%s,%d)\n", 
l
, 
u
, 
ôî
->
vÆue
->
°ride
);

1636 
	`Ârötf
(
Â
,"\n*****End Printing Abstract Memory Locations*****\n\n");

1637 
	}
}

1641 
	$dumpAddªss
(
tcfg_node_t
* 
bbi
)

1643 
de_ö°_t
* 
ö°
;

1644 
i
;

1646 if(! 
aFûe
)

1647 
aFûe
 = 
	`f›í
("aloc.dump", "w");

1648 if(!
aFûe
)

1649 
	`Áèl
("Internal file opening failed");

1650 
	`Ârötf
(
aFûe
, "Printingábstract value ofÑegistersánd memoryÜocations\n");

1652 
	`dumpAlocSètus
(
bbi
, 
aFûe
);

1653 
	}
}

1657 * 
	$ªmoveO√FromW‹kLi°
(
w‹kli°_p
* 
Wli°
)

1659 
w‹kli°_p
 
ãmp
 = *
Wli°
;

1660 *
Wli°
 = (*Wli°)->
√xt
;

1662  
ãmp
->
d©a
;

1663 
	}
}

1666 
	$addToW‹kLi°
(
w‹kli°_p
* 
Wli°
, * 
d©a
)

1668 
w‹kli°_p
 
ãmp
 = (w‹kli°_p)
	`mÆloc
((
w‹kli°_s
));

1669 
ãmp
->
d©a
 = data;

1670 
ãmp
->
√xt
 = *
Wli°
;

1671 *
Wli°
 = 
ãmp
;

1672 
	}
}

1675 
	$isEm±y
(
w‹kli°_p
 
Wli°
)

1677  (
Wli°
 =
NULL
);

1678 
	}
}

1681 
¶i°_p
 
	$gëAŒLo›Nodes
(
lo›_id
)

1683 
¶i°_p
 
hód
 = 
NULL
;

1684 
lo›_t
* 
Õ¨ít
;

1685 
i
;

1687 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1689 if(!
lo›_m≠
[
i
])

1691 if(
lo›_m≠
[
i
]->
id
 =
lo›_id
)

1693 
¶i°_p
 
ãmp
 = (¶i°_p)
	`mÆloc
((
¶i°_s
));

1694 
ãmp
->
d°
 = (
tcfg_node_t
 *)
tcfg
[
i
];

1695 
ãmp
->
√xt
 = 
hód
;

1696 
hód
 = 
ãmp
;

1700 
Õ¨ít
 = 
lo›_m≠
[
i
]->
∑ª¡
;

1701 
Õ¨ít
 &&Ü∑ª¡->
id
 != 0)

1703 if(
Õ¨ít
->
id
 =
lo›_id
)

1705 
¶i°_p
 
ãmp
 = (¶i°_p)
	`mÆloc
((
¶i°_s
));

1706 
ãmp
->
d°
 = (
tcfg_node_t
 *)
tcfg
[
i
];

1707 
ãmp
->
√xt
 = 
hód
;

1708 
hód
 = 
ãmp
;

1711 
Õ¨ít
 =Ü∑ª¡->
∑ª¡
;

1716  
hód
;

1717 
	}
}

1721 
	$™Æyze
(
tcfg_node_t
* 
bbi
)

1723 
i
, 
j
, 
n
;

1724 
¶i°_p
 
l_nodes
, 
ôî
;

1725 
ch™ge
;

1728 i‡(
™Æyzed
[
bbi
->
id
] || !
lo›_m≠
[bbi->id])

1731 
i
 = 
bbi
->
id
;

1737 if(
lo›_m≠
[
i
]->
id
 != 0)

1740 
n
 = 
	`gëLo›Bound
(
lo›_m≠
[
i
]);

1741 
j
 = 0; j < 
n
; j++)

1743 
	`™Æyze_lo›_t›
(
lo›_m≠
[
i
],Üo›_m≠[i]->
id
);

1745 
l_nodes
 = 
	`gëAŒLo›Nodes
(
lo›_m≠
[
i
]->
id
);

1748 
ôî
 = 
l_nodes
; iãr; iã∏ôî->
√xt
)

1750 
™Æyzed
[((
tcfg_node_t
 *)
ôî
->
d°
)->
id
] = 1;

1755 
tcfg_edge_t
* 
edge
;

1758 
edge
 = 
bbi
->
ö
;Édge;Édgêedge->
√xt_ö
)

1760 
	`™Æyze
(
edge
->
§c
);

1763 
	`å™sf‹mAloc
(
bbi
, &
ch™ge
);

1765 
™Æyzed
[
bbi
->
id
] = 1;

1767 
	}
}

1770 
	$™Æyze_lo›
(
tcfg_node_t
* 
ôî
, 
lo›_id
)

1772 
n
, 
i
, 
ch™ge
;

1776 if(
™Æyzed_lo›
[
ôî
->
id
])

1779 if(
lo›_m≠
[
ôî
->
id
]->id !
lo›_id
)

1782 
n
 = 
	`gëLo›Bound
(
lo›_m≠
[
ôî
->
id
]);

1786 
i
 = 0; i < 
n
; i++)

1788 
	`™Æyze_lo›_t›
(
lo›_m≠
[
ôî
->
id
],

1789 
lo›_m≠
[
ôî
->
id
]->id);

1794 
tcfg_edge_t
* 
¥ed
;

1797 
¥ed
 = 
ôî
->
ö
;Öªd;Öªd =Öªd->
√xt_ö
)

1800 if(
¥ed
->
§c
->
id
 =
ôî
->id || 
	`bbi_backedge
(pred) ||

1801 !
lo›_m≠
[
¥ed
->
§c
->
id
])

1803 if(!
lo›_m≠
[
¥ed
->
§c
->
id
])

1805 
™Æyzed
[
¥ed
->
§c
->
id
] = 1;

1806 
™Æyzed_lo›
[
¥ed
->
§c
->
id
] = 1;

1813 if(
lo›_m≠
[
¥ed
->
§c
->
id
]->id == 0)

1814 
	`™Æyze
(
¥ed
->
§c
);

1817 
	`™Æyze_lo›
(
¥ed
->
§c
, 
lo›_m≠
[¥ed->§c->
id
]->id);

1823 
	`å™sf‹mAloc
(
ôî
, &
ch™ge
);

1826 
™Æyzed_lo›
[
ôî
->
id
] = 1;

1827 
	}
}

1830 
¶i°_p
 
	$™Æyze_lo›_t›
(
lo›_t
* 
lo›
, 
lo›_id
)

1832 
¶i°_p
 
ôî
;

1833 
¶i°_p
 
lo›_nodes
;

1835 
lo›_nodes
 = 
	`gëAŒLo›Nodes
(
lo›_id
);

1837 
ôî
 = 
lo›_nodes
; iãr; iã∏ôî->
√xt
)

1839 
™Æyzed_lo›
[((
tcfg_node_t
 *)
ôî
->
d°
)->
id
] = 0;

1841 
ôî
 = 
lo›_nodes
; iãr; iã∏ôî->
√xt
)

1843 
	`™Æyze_lo›
(((
tcfg_node_t
 *)
ôî
->
d°
), 
lo›_id
);

1846  
lo›_nodes
;

1847 
	}
}

1850 
	$™Æyze_t›
()

1852 
i
;

1854 
™Æyzed
 = (*)
	`mÆloc
(
num_tcfg_nodes
 * ());

1855 
™Æyzed_lo›
 = (*)
	`mÆloc
(
num_tcfg_nodes
 * ());

1856 
	`mem£t
(
™Æyzed
, 0, 
num_tcfg_nodes
 * ());

1857 
	`mem£t
(
™Æyzed_lo›
, 0, 
num_tcfg_nodes
 * ());

1859 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1861 
	`™Æyze
(
tcfg
[
i
]);

1863 
	}
}

1866 
	$joöMem‹yAloc
(
abs_mem_p
 
mem1
,ábs_mem_p* 
mem2
)

1868 
abs_mem_p
 
ôî1
;

1870 
ôî1
 = 
mem1
; iãr1; iãr1 = iãr1->
√xt
)

1872 if(!
ôî1
->
vÆid
)

1874 
	`upd©eMem‹yAloc
(*(
ôî1
->
addr
), 
mem2
, iãr1->
vÆue
, iãr1->
ö°_addr
);

1876 
	}
}

1878 
	$¸óã_Æoc
()

1880 
tcfg_node_t
* 
bbi
;

1881 
de_ö°_t
* 
ö°
;

1882 * 
iß_«me
;

1883 
ric_p
 
addr
;

1884 
i
, 
j
, 
k
;

1885 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

1886 
FILE
* 
Â
;

1887 
x
 = 0;

1888 
ö°_addr
[4096];

1890 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1892 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

1894 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

1896 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1901 if(! 
	`°rcmp
(
iß_«me
, "sw") || !strcmp(isa_name, "sh")

1902 || !
	`°rcmp
(
iß_«me
, "sb"))

1904 
ö°_addr
[
x
++] = 
ö°
->
addr
;

1906 
ö°
++;

1909 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1911 
k
 = 0; k < 
x
; k++)

1913 
abs_mem_p
 
ãmp
 = (abs_mem_p)
	`mÆloc
((
abs_mem_s
));

1914 
	`mem£t
(
ãmp
, 0, (
abs_mem_s
));

1915 
ãmp
->
ö°_addr
 = in°_addr[
k
];

1916 
ãmp
->
vÆid
 = 0;

1917 
ãmp
->
√xt
 = 
tcfg
[
i
]->
bb
->
ö_abs_mem_vÆue
;

1918 
tcfg
[
i
]->
bb
->
ö_abs_mem_vÆue
 = 
ãmp
;

1921 
	}
}

1923 #ifde‡
_DEBUG


1924 
	$dump
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
, 
FILE
* 
Â
)

1926 
	`Ârötf
(
Â
, "==========================================================\n");

1927 
	`Ârötf
(
Â
, "InstructionÇame = %s, Address = %x, Immediate = %d\n",

1928 
iß
[
ö°
->
›_íum
].
«me
, in°->
addr
, in°->
imm
);

1929 
	`Ârötf
(
Â
, "==========================================================\n");

1930 if(
addr
)

1931 
	`Ârötf
(
Â
, "Addªs†(0x%x,0x%x,0x%x)\n", 
addr
->
lowî_bound
,áddr->
uµî_bound
,

1932 
addr
->
°ride
);

1934 
	`Ârötf
(
Â
, "UNKNOWN\n");

1935 
	}
}

1939 
	$dump_d©a_addªss
()

1941 
tcfg_node_t
* 
bbi
;

1942 
de_ö°_t
* 
ö°
;

1943 * 
iß_«me
;

1944 
ric_p
 
addr
;

1945 
i
, 
j
;

1946 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

1947 
FILE
* 
Â
;

1949 
Â
 = 
	`f›í
("address.dump", "w");

1950 if(!
Â
)

1951 
	`Áèl
("Internal file opening failed");

1953 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1955 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

1957 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

1959 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1964 if(! 
	`°rcmp
(
iß_«me
, "sw") || !strcmp(isa_name, "sh")

1965 || !
	`°rcmp
(
iß_«me
, "sb") || !strcmp(isa_name, "swl")

1966 || !
	`°rcmp
(
iß_«me
, "swr") || !strcmp(isa_name, "s.d")

1967 || !
	`°rcmp
(
iß_«me
,"s.s"))

1969 if(
ö°
->
num_ö
 <= 2)

1971 
imm
 = 
ö°
->imm;

1972 
ba£
 = *(
ö°
->
ö
 + 1);

1973 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 0);

1974 
	`dump
(
ö°
, 
addr
, 
Â
);

1976 if(
ö°
->
num_ö
 == 3)

1978 
ba£
 = *(
ö°
->
ö
 + 1);

1979 
ödex
 = *(
ö°
->
ö
 + 2);

1980 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 0);

1981 
	`dump
(
ö°
, 
addr
, 
Â
);

1984 if(! 
	`°rcmp
(
iß_«me
, "lw") || !strcmp(isa_name, "lh")

1985 || !
	`°rcmp
(
iß_«me
, "lb") || !strcmp(isa_name, "lwl")

1986 || !
	`°rcmp
(
iß_«me
, "lwr") || !strcmp(isa_name, "lhu")

1987 || !
	`°rcmp
(
iß_«me
, "l.d") || !strcmp(isa_name, "l.s")

1988 || !
	`°rcmp
(
iß_«me
, "s.s"))

1990 if(
ö°
->
num_ö
 <= 1)

1992 
imm
 = 
ö°
->imm;

1993 
ba£
 = *(
ö°
->
ö
);

1994 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 0);

1995 
	`dump
(
ö°
, 
addr
, 
Â
);

1997 if(
ö°
->
num_ö
 == 2)

1999 
ba£
 = *(
ö°
->
ö
);

2000 
ödex
 = *(
ö°
->
ö
 + 1);

2001 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 0);

2002 
	`dump
(
ö°
, 
addr
, 
Â
);

2005 
ö°
++;

2009 
	`f˛o£
(
Â
);

2011 
	}
}

2013 
	$dump_mod_d©a_addªss
()

2015 
tcfg_node_t
* 
bbi
;

2016 
de_ö°_t
* 
ö°
;

2017 * 
iß_«me
;

2018 
ric_p
 
addr
;

2019 
i
, 
j
;

2020 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2021 
FILE
* 
Â
;

2023 
Â
 = 
	`f›í
("address.dump", "a");

2024 if(!
Â
)

2025 
	`Áèl
("Internal file opening failed");

2027 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2029 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2031 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2033 if(
ö°
->
mod_addr
)

2035 
	`Ârötf
(
Â
, "modifiedáddressát 0x%x = (0x%x,0x%x,0x%x)\n",

2036 
ö°
->
r_addr
,

2037 
ö°
->
mod_addr
->
lowî_bound
,

2038 
ö°
->
mod_addr
->
uµî_bound
,

2039 
ö°
->
mod_addr
->
°ride
);

2041 
ö°
++;

2045 
	`f˛o£
(
Â
);

2047 
	}
}

2050 
	$™Æyze_addªss
()

2055 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

2056 
tcfg_edge_t
* 
edge
;

2057 
w‹kli°_p
 
Wli°
 = 
NULL
;

2058 
ch™ge_Êag
 = 0, 
glob_ch™ge_Êag
 = 1;

2059 
i
;

2087 
bbi
->
bb
->
ö_abs_ªg_vÆue
 = (
ric_p
 *)
	`mÆloc
(
MAX_NO_REGISTERS


2088 * (
ric_p
));

2089 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
);

2090 
	`mem£t
(
bbi
->
bb
->
ö_abs_ªg_vÆue
, 0, 
MAX_NO_REGISTERS
 *

2091 (
ric_p
));

2093 
bbi
->
bb
->
ö_abs_ªg_vÆue
[0] = (
ric_p
)
	`mÆloc
((
ric_s
));

2094 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[0]);

2095 
	`mem£t
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[0], 0, (
ric_s
));

2096 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28] = (
ric_p
)
	`mÆloc
((
ric_s
));

2097 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]);

2098 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
lowî_bound
 = 
GLOBAL_START
;

2099 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
uµî_bound
 = 
GLOBAL_START
;

2100 
bbi
->
bb
->
ö_abs_ªg_vÆue
[28]->
°ride
 = 0;

2103 
bbi
->
bb
->
ö_abs_ªg_vÆue
[29] = (
ric_p
)
	`mÆloc
((
ric_s
));

2104 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[29]);

2105 
bbi
->
bb
->
ö_abs_ªg_vÆue
[29]->
lowî_bound
 = 
STACK_START
;

2106 
bbi
->
bb
->
ö_abs_ªg_vÆue
[29]->
uµî_bound
 = 
STACK_START
;

2107 
bbi
->
bb
->
ö_abs_ªg_vÆue
[29]->
°ride
 = 0;

2110 
bbi
->
bb
->
ö_abs_ªg_vÆue
[31] = (
ric_p
)
	`mÆloc
((
ric_s
));

2111 
	`CHECK_MEM
(
bbi
->
bb
->
ö_abs_ªg_vÆue
[31]);

2112 
bbi
->
bb
->
ö_abs_ªg_vÆue
[31]->
lowî_bound
 = 
RETURN_ADDRESS
;

2113 
bbi
->
bb
->
ö_abs_ªg_vÆue
[31]->
uµî_bound
 = 
RETURN_ADDRESS
;

2114 
bbi
->
bb
->
ö_abs_ªg_vÆue
[31]->
°ride
 = 0;

2117 
	`¸óã_Æoc
();

2120 
	`™Æyze_t›
();

2122 #ifde‡
_DEBUG


2123 
	`¥ötf
("A«lysi†cou¡ = %d\¿f‹ %d BBÇodes\n", 
cou¡
, 
num_tcfg_nodes
);

2124 
	`dump_d©a_addªss
();

2139 
	}
}

	@address.h

1 #i‚de‡
__ADDRESS_H_


2 
	#__ADDRESS_H_


	)

4 
	taddr_t
;

6 
	#MAX_NO_REGISTERS
 34

	)

7 
	#HI
 32

	)

8 
	#LO
 33

	)

9 
	#STACK_START
 0x7fffc000

	)

10 
	#GLOBAL_START
 0x10000000

	)

11 
	#RETURN_ADDRESS
 0

	)

13 
	#SIZE_OF_BYTE
 1

	)

14 
	#SIZE_OF_WORD
 4

	)

15 
	#SIZE_OF_HALF_WORD
 (
SIZE_OF_WORD
)/2

	)

16 
	#SIZE_OF_BLOCK
 
B


	)

17 
	#INFINITY
 0x7fffc000

	)

18 
	#WIDENING_POINT
 5

	)

19 
	#GET_MEM
(
x
Ë((xË/ 
SIZE_OF_BLOCK
)

	)

21 
	s¶i°


23 * 
	md°
;

24 
¶i°
* 
	m√xt
;

27 
¶i°
* 
	t¶i°_p
;

28 
¶i°
 
	t¶i°_s
;

31 
	sric
 {

32 
addr_t
 
	mlowî_bound
;

33 
addr_t
 
	muµî_bound
;

34 
addr_t
 
	m°ride
;

36 
ric
 
	tric_s
;

37 
ric
* 
	tric_p
;

39 
	sabs_mem
 {

40 
	mvÆid
;

41 
	mö°_addr
;

42 
ric_p
 
	maddr
;

43 
ric_p
 
	mvÆue
;

44 
abs_mem
* 
	m√xt
;

46 
abs_mem
 
	tabs_mem_s
;

47 
abs_mem
* 
	tabs_mem_p
;

49 
	sw‹kli°
 {

50 * 
	md©a
;

51 
w‹kli°
* 
	m√xt
;

53 
w‹kli°
 
	tw‹kli°_s
;

54 
w‹kli°
* 
	tw‹kli°_p
;

56 
isEm±y
(
w‹kli°_p
 
Wli°
);

57 
addToW‹kLi°
(
w‹kli°_p
* 
Wli°
, * 
d©a
);

58 * 
ªmoveO√FromW‹kLi°
(
w‹kli°_p
* 
Wli°
);

60 
™Æyze_addªss
();

61 
gcd
(
a
, 
b
);

	@bpred.c

25 
	~<°dlib.h
>

26 
	~<°rög.h
>

27 
	~"b¥ed.h
"

31 
num_tcfg_nodes
;

32 
num_tcfg_edges
;

33 
tcfg_node_t
 **
tcfg
;

34 
tcfg_edge_t
 **
tcfg_edges
;

35 
b¥ed_scheme
;

36 
pùe_ibuf_size
, 
pùe_iwö_size
;

38 *
	gpi_èbÀ
;

39 
bfg_node_t
 
	groŸ_bbb
, 
	gíd_bbb
;

40 
	groŸ_bbb_id
, 
	gíd_bbb_id
;

41 
bfg_node_t
 ***
	gbfg
;

42 
	gnum_bfg_nodes
;

43 
	gBHR
, 
	gBHR_PWR
, 
	gBHR_MSK
;

44 
	gBHT_SIZE
, 
	gBHT
, 
	gBHT_MSK
;

45 
bfg_node_t
 **
	gvbbb
;

53 
de_ö°_t
 ***
	gmp_ö°s
;

55 *
	gnum_mp_ö°s
;

65 
	$cﬁÀ˘_mp_ö°s
()

67 
num
 = 0, 
i
 = 0, 
j
, 
limô
;

68 
de_ö°_t
 **
tmp_ö°s
;

69 
tcfg_node_t
 *
bbi
;

70 
tcfg_edge_t
 *
e
;

72 
limô
 = 
pùe_ibuf_size
 + 
pùe_iwö_size
 - 1;

73 
mp_ö°s
 = (
de_ö°_t
 ***Ë
	`ˇŒoc
(
num_tcfg_edges
, (de_inst_t**));

74 
	`CHECK_MEM
(
mp_ö°s
);

75 
num_mp_ö°s
 = (*Ë
	`ˇŒoc
(
num_tcfg_edges
, ());

76 
	`CHECK_MEM
(
num_mp_ö°s
);

78 
tmp_ö°s
 = (
de_ö°_t
 **Ë
	`ˇŒoc
(
limô
, (de_inst_t*));

79 
	`CHECK_MEM
(
tmp_ö°s
);

80 
i
 = 0; i < 
num_tcfg_edges
; i++) {

81 
e
 = 
tcfg_edges
[
i
];

82 i‡(!
	`c⁄d_bbi
(
e
->
§c
))

85 i‡(
e
 =e->
§c
->
out
)

86 
bbi
 = 
e
->
√xt_out
->
d°
;

88 
bbi
 = 
e
->
§c
->
out
->
d°
;

89 
num
 = 0;

90 
num
 < 
limô
) {

91 
j
 = 0; (j < 
bbi
->
bb
->
num_ö°
Ë&& (
num
 < 
limô
); j++)

92 
tmp_ö°s
[
num
++] = &
bbi
->
bb
->
code
[
j
];

93 i‡((
bbi
->
out
 =
NULL
Ë|| (
	`c⁄d_bbi
(bbi)))

95 
bbi
 = bbi->
out
->
d°
;

97 
mp_ö°s
[
i
] = (
de_ö°_t
 **Ë
	`ˇŒoc
(
num
, (de_inst_t*));

98 
	`CHECK_MEM
(
mp_ö°s
[
i
]);

99 
	`memmove
(
mp_ö°s
[
i
], 
tmp_ö°s
, 
num
 * (
de_ö°_t
*));

100 
num_mp_ö°s
[
i
] = 
num
;

103 
	`‰ì
(
tmp_ö°s
);

104 
	}
}

118 
	$öô_roŸ_bbb
()

120 
roŸ_bbb
.
bbi
 = 
NULL
;

121 
roŸ_bbb
.
bhr
 = 0;

122 
roŸ_bbb
.
pi
 = 0;

123 
roŸ_bbb
.
out
 = 
NULL
;

124 
roŸ_bbb
.
ö
 = 
NULL
;

125 
roŸ_bbb
.
Êags
 = 0;

126 
	}
}

131 
	$öô_íd_bbb
()

133 
íd_bbb
.
bbi
 = 
NULL
;

134 
íd_bbb
.
pi
 = 
BHT_SIZE
 + 1;

135 
íd_bbb
.
out
 = 
NULL
;

136 
íd_bbb
.
ö
 = 
NULL
;

137 
íd_bbb
.
Êags
 = 0;

138 
	}
}

144 
	$bhr_upd©e
(
bhr
, 
bønch
)

146 i‡(
bønch
 =
TAKEN
)

147  ((
BHR_MSK
 & ((
bhr
) << 1)) | 1);

148 i‡(
bønch
 =
NOT_TAKEN
)

149  ((
BHR_MSK
 & ((
bhr
) << 1)) | 0);

151  
bhr
;

152 
	}
}

159 
	$öô_bfg
()

161 
i
;

163 
	`öô_roŸ_bbb
();

164 
	`öô_íd_bbb
();

166 
bfg
 = (
bfg_node_t
 ***Ë
	`mÆloc
(
num_tcfg_nodes
 * (bfg_node_t **));

167 
	`CHECK_MEM
(
bfg
);

168 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

169 
bfg
[
i
] = (
bfg_node_t
 **Ë
	`ˇŒoc
(
BHT_SIZE
, (bfg_node_t *));

170 
	`CHECK_MEM
(
bfg
[
i
]);

173 
pi_èbÀ
 = (*Ë
	`ˇŒoc
(
BHT_SIZE
, ());

174 
	}
}

179 
	$bhr_to_pi
(
tcfg_node_t
 *
bbi
, 
bhr
)

181 
cfg_node_t
 *
bb
 = 
bbi
->bb;

182 
addr_t
 
addr
;

184 i‡(
b¥ed_scheme
 =
GSHARE
) {

185 
addr
 = 
bb
->
code
[bb->
num_ö°
-1].addr;

186  (((
bhr
 << (
BHT
 - 
BHR
)Ë^ (
addr
 >> 3)Ë& 
BHT_MSK
);

187 } i‡(
b¥ed_scheme
 =
GAG
) {

188  
bhr
;

190 
addr
 = 
bb
->
code
[bb->
num_ö°
-1].addr;

191  ((
addr
 >> 3Ë& 
BHT_MSK
);

193 
	}
}

198 
bfg_node_t
 *

199 
	$√w_bbb
(
bbi_id
, 
bhr
)

201 
bfg_node_t
 *
x
;

203 
x
 = (
bfg_node_t
 *Ë
	`ˇŒoc
(1, (bfg_node_t));

204 
	`CHECK_MEM
(
x
);

205 
x
->
bbi
 = 
tcfg
[
bbi_id
];

206 
x
->
bhr
 = bhr;

207 
x
->
pi
 = 
	`bhr_to_pi
(x->
bbi
, 
bhr
);

209 
pi_èbÀ
[
x
->
pi
] = 1;

211  
x
;

212 
	}
}

218 
tcfg_node_t
 *

219 
	$√xt_c⁄d_bbi
(
tcfg_edge_t
 *
e
)

221 !
	`c⁄d_bbi
(
e
->
d°
)) {

222 
e
 =É->
d°
->
out
;

223 i‡(
e
 =
NULL
)

224  
NULL
;

226  
e
->
d°
;

227 
	}
}

231 
bfg_edge_t
 *

232 
	$√w_bfg_edge
(
bfg_node_t
 *
x
, bfg_node_à*
y
, 
bønch
)

234 
bfg_edge_t
 *
p
;

236 
p
 = (
bfg_edge_t
 *Ë
	`ˇŒoc
(1, (bfg_edge_t));

237 
	`CHECK_MEM
(
p
);

238 
p
->
§c
 = 
x
;Ö->
d°
 = 
y
;

239 
p
->
bønch
 = branch;

241 
p
->
¥ev_out
 = 
NULL
;Ö->
√xt_out
 = 
x
->
out
;

242 i‡(
x
->
out
 !
NULL
)

243 
x
->
out
->
¥ev_out
 = 
p
;

244 
x
->
out
 = 
p
;

246 
p
->
¥ev_ö
 = 
NULL
;Ö->
√xt_ö
 = 
y
->
ö
;

247 i‡(
y
->
ö
 !
NULL
)

248 
y
->
ö
->
¥ev_ö
 = 
p
;

249 
y
->
ö
 = 
p
;

250 
	}
}

256 
	$åav_tcfg
()

258 
bhr
, 
pi
;

259 
tcfg_node_t
 *
bbi
;

260 
Queue
 
w‹kli°
;

261 
bfg_node_t
 *
x
;

262 
tcfg_edge_t
 *
e
;

263 
bønch
;

265 
bbi
 = 
tcfg
[0];

267 
num_bfg_nodes
 = 0;

268 
	`öô_queue
(&
w‹kli°
, (
bfg_node_t
 *));

269 
bbi
 = 
tcfg
[0];

271 !
	`c⁄d_bbi
(
bbi
Ë&& (bbi->
out
 !
NULL
))

272 
bbi
 = bbi->
out
->
d°
;

273 if(
bbi
->
out
 =
NULL
)

276 
bfg
[
bbi
->
id
][0] = 
	`√w_bbb
(bbi->id, 0);

277 
bfg
[
bbi
->
id
][0]->id = 
num_bfg_nodes
++;

278 
	`√w_bfg_edge
(&
roŸ_bbb
, 
bfg
[
bbi
->
id
][0], 
NOT_TAKEN
);

279 
	`íqueue
(&
w‹kli°
, &
bfg
[
bbi
->
id
][0]);

281 !
	`queue_em±y
(&
w‹kli°
)) {

282 
x
 = *((
bfg_node_t
 **Ë
	`dequeue
(&
w‹kli°
));

283 
e
 = 
x
->
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

284 
bønch
 = 
e
->branch;

285 
bbi
 = 
	`√xt_c⁄d_bbi
(
e
);

286 i‡(
bbi
 =
NULL
) {

287 
	`√w_bfg_edge
(
x
, &
íd_bbb
, 
bønch
);

291 i‡(
bønch
 =
TAKEN
)

292 
bhr
 = 
	`bhr_upd©e
(
x
->bhr, 1);

293 i‡(
bønch
 =
NOT_TAKEN
)

294 
bhr
 = 
	`bhr_upd©e
(
x
->bhr, 0);

296 
bhr
 = 
x
->bhr;

297 
pi
 = 
	`bhr_to_pi
(
bbi
, 
bhr
);

298 i‡(
bfg
[
bbi
->
id
][
pi
] =
NULL
) {

299 
bfg
[
bbi
->
id
][
pi
] = 
	`√w_bbb
(bbi->id, 
bhr
);

300 
bfg
[
bbi
->
id
][
pi
]->id = 
num_bfg_nodes
++;

301 
	`íqueue
(&
w‹kli°
, &
bfg
[
bbi
->
id
][
pi
]);

303 
	`√w_bfg_edge
(
x
, 
bfg
[
bbi
->
id
][
pi
], 
bønch
);

307 i‡(
num_bfg_nodes
 < 77777) {

308 
roŸ_bbb_id
 = 77777;

309 
íd_bbb_id
 = 88888;

311 
	`Ârötf
(
°dîr
, "Program complexity is overánalysisÜimit!\n");

312 
	`exô
(1);

314 
roŸ_bbb
.
id
 = 
roŸ_bbb_id
;

315 
íd_bbb
.
id
 = 
íd_bbb_id
;

316 
	}
}

322 
	$cﬁÀ˘_bfg_nodes
()

324 
i
, 
j
, 
id
;

325 
tcfg_node_t
 *
p
;

327 
vbbb
 = (
bfg_node_t
 **Ë
	`mÆloc
(
num_bfg_nodes
 * (bfg_node_t *));

328 
	`CHECK_MEM
(
vbbb
);

329 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

330 
j
 = 0; j < 
BHT_SIZE
; j++) {

331 i‡(
bfg
[
i
][
j
] !
NULL
) {

332 
vbbb
[
bfg
[
i
][
j
]->
id
] = bfg[i][j];

336 
	}
}

341 
	$dump_bfg
()

343 
i
, 
j
;

344 
bfg_edge_t
 *
e
;

345 
bnum
 = 0;

347 
	`¥ötf
("\ndump bfg\n");

348 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

349 
j
 = 0; j < 
BHT_SIZE
; j++) {

350 i‡(
bfg
[
i
][
j
] =
NULL
)

352 
	`¥ötf
("%d(%d_%xË[ ", 
bfg
[
i
][
j
]->
id
, bfg[i][j]->
bbi
->id, bfg[i][j]->
pi
);

353 
e
 = 
bfg
[
i
][
j
]->
out
;É !
NULL
;É =É->
√xt_out
) {

354 i‡(
e
->
d°
->
id
 >
num_bfg_nodes
)

355 
	`¥ötf
("%d(%d_%xË", 
e
->
d°
->
id
,É->d°->id,É->d°->
pi
);

357 
	`¥ötf
("%d(%d_%xË", 
e
->
d°
->
id
,É->d°->
bbi
->id,É->d°->
pi
);

359 
	`¥ötf
(" ]\n");

360 i‡(
	`bbi_ty≥
(
bfg
[
i
][
j
]->
bbi
Ë=
CTRL_COND
)

361 
bnum
++;

364 
	}
}

369 
	$buûd_bfg
()

371 
	`öô_bfg
();

372 
	`åav_tcfg
();

373 
	`cﬁÀ˘_bfg_nodes
();

375 
	}
}

385 
btg_edge_t
 **
	gbtg_ö
, **
	gbtg_out
;

386 
btg_edge_t
 **
	gíd_bbb_ö
, **
	groŸ_bbb_out
;

391 
	$ªach
(
bfg_node_t
 *
x
, bfg_node_à*
y
, 
bønch
)

393 
btg_edge_t
 *
p
;

395 
p
 = (
btg_edge_t
 *Ë
	`mÆloc
((btg_edge_t));

396 
	`CHECK_MEM
(
p
);

398 
p
->
§c
 = 
x
;Ö->
d°
 = 
y
;

399 
p
->
bønch
 = branch;

400 
p
->
√xt_out
 = 
btg_out
[
x
->
id
];

401 
btg_out
[
x
->
id
] = 
p
;

402 
p
->
√xt_ö
 = 
btg_ö
[
y
->
id
];

403 
btg_ö
[
y
->
id
] = 
p
;

404 
	}
}

410 
	$ªach_íd
(
bfg_node_t
 *
x
, 
bønch
)

412 
btg_edge_t
 *
p
;

414 
p
 = (
btg_edge_t
 *Ë
	`mÆloc
((btg_edge_t));

415 
	`CHECK_MEM
(
p
);

417 
p
->
§c
 = 
x
;Ö->
d°
 = &
íd_bbb
;

418 
p
->
bønch
 = branch;

419 
p
->
√xt_out
 = 
btg_out
[
x
->
id
];

420 
btg_out
[
x
->
id
] = 
p
;

421 
p
->
√xt_ö
 = 
íd_bbb_ö
[
x
->
pi
];

422 
íd_bbb_ö
[
x
->
pi
] = 
p
;

423 
	}
}

428 
	$cﬁÀ˘_ªachabÀs
(
bfg_node_t
 *
bbb
, 
bønch
)

430 
ªached
, 
íd_ªached
;

431 
Queue
 
w‹kli°
;

432 
bfg_node_t
 *
x
, *
y
;

433 
bfg_edge_t
 *
e
;

435 i‡(
bbb
->
out
->
bønch
 == branch) {

436 
x
 = 
bbb
->
out
->
d°
;

437 
ªached
 = (Ë
bbb
->
out
;

439 
x
 = 
bbb
->
out
->
√xt_out
->
d°
;

440 
ªached
 = (Ë
bbb
->
out
->
√xt_out
;

443 
	`öô_queue
(&
w‹kli°
, (
bfg_node_t
 *));

444 
	`íqueue
(&
w‹kli°
, &
x
);

445 
x
->
Êags
 = 
ªached
;

446 
íd_ªached
 = 0;

448 !
	`queue_em±y
(&
w‹kli°
)) {

449 
x
 = *((
bfg_node_t
 **Ë
	`dequeue
(&
w‹kli°
));

450 i‡(
x
->
pi
 =
bbb
->pi) {

451 
	`ªach
(
bbb
, 
x
, 
bønch
);

452 } i‡(
x
->
out
 =
NULL
) {

453 i‡(!
íd_ªached
) {

454 
	`ªach_íd
(
bbb
, 
bønch
);

455 
íd_ªached
 = 1;

458 
y
 = 
x
->
out
->
d°
;

459 i‡(
y
->
Êags
 !
ªached
) {

460 
	`íqueue
(&
w‹kli°
, &
y
);

461 
y
->
Êags
 = 
ªached
;

463 
y
 = 
x
->
out
->
√xt_out
->
d°
;

464 i‡(
y
->
Êags
 !
ªached
) {

465 
	`íqueue
(&
w‹kli°
, &
y
);

466 
y
->
Êags
 = 
ªached
;

470 
	`‰ì_queue
(&
w‹kli°
);

471 
	}
}

478 
	$roŸ_ªach
(
bfg_node_t
 *
èrgë
)

480 
btg_edge_t
 *
p
;

482 
p
 = (
btg_edge_t
 *Ë
	`mÆloc
((btg_edge_t));

483 
	`CHECK_MEM
(
p
);

485 
p
->
§c
 = &
roŸ_bbb
;Ö->
d°
 = 
èrgë
;

486 
p
->
bønch
 = 
NOT_TAKEN
;

487 
p
->
√xt_out
 = 
roŸ_bbb_out
[
èrgë
->
pi
];

488 
roŸ_bbb_out
[
èrgë
->
pi
] = 
p
;

489 
p
->
√xt_ö
 = 
btg_ö
[
èrgë
->
id
];

490 
btg_ö
[
èrgë
->
id
] = 
p
;

491 
	}
}

497 
	$roŸ_ªach_íd
(
pi
)

499 
btg_edge_t
 *
p
;

501 
p
 = (
btg_edge_t
 *Ë
	`mÆloc
((btg_edge_t));

502 
	`CHECK_MEM
(
p
);

504 
p
->
§c
 = &
roŸ_bbb
;Ö->
d°
 = &
íd_bbb
;

505 
p
->
bønch
 = 
NOT_TAKEN
;

506 
p
->
√xt_out
 = 
roŸ_bbb_out
[
pi
];

507 
roŸ_bbb_out
[
pi
] = 
p
;

508 
p
->
√xt_ö
 = 
íd_bbb_ö
[
pi
];

509 
íd_bbb_ö
[
pi
] = 
p
;

510 
	}
}

517 
	$cﬁÀ˘_roŸ_ªachabÀ
(
pi
)

519 
íd_ªached
;

520 
Queue
 
w‹kli°
;

521 
bfg_node_t
 *
x
, *
y
;

522 
bfg_edge_t
 *
e
;

524 i‡(
vbbb
[0]->
pi
 ==Öi) {

525 
	`roŸ_ªach
(
vbbb
[0]);

529 
	`öô_queue
(&
w‹kli°
, (
bfg_node_t
 *));

530 
	`íqueue
(&
w‹kli°
, &
vbbb
[0]);

531 
vbbb
[0]->
Êags
 =
pi
;

532 
íd_ªached
 = 0;

534 !
	`queue_em±y
(&
w‹kli°
)) {

535 
x
 = *((
bfg_node_t
 **Ë
	`dequeue
(&
w‹kli°
));

536 i‡(
x
->
pi
 ==Öi) {

537 
	`roŸ_ªach
(
x
);

538 } i‡(
x
->
out
 =
NULL
) {

539 i‡(!
íd_ªached
) {

540 
	`roŸ_ªach_íd
(
pi
);

541 
íd_ªached
 = 1;

544 
y
 = 
x
->
out
->
d°
;

545 i‡(
y
->
Êags
 !
pi
) {

546 
	`íqueue
(&
w‹kli°
, &
y
);

547 
y
->
Êags
 = 
pi
;

549 
y
 = 
x
->
out
->
√xt_out
->
d°
;

550 i‡(
y
->
Êags
 !
pi
) {

551 
	`íqueue
(&
w‹kli°
, &
y
);

552 
y
->
Êags
 = 
pi
;

556 
	`‰ì_queue
(&
w‹kli°
);

557 
	}
}

562 
	$dump_btg
()

564 
i
, 
id
;

565 
btg_edge_t
 *
p
;

567 
	`¥ötf
("\ndump branchÅransition graph\n");

569 
i
 = 0; i < 
BHT_SIZE
; i++) {

570 i‡(
roŸ_bbb_out
[
i
] =
NULL
)

572 
	`¥ötf
("roŸ[%d]: ", 
i
);

573 
p
 = 
roŸ_bbb_out
[
i
];Ö !
NULL
;Ö =Ö->
√xt_out
)

574 
	`¥ötf
("%d ", 
p
->
d°
->
id
);

575 
	`¥ötf
("\n");

578 
i
 = 0; i < 
num_bfg_nodes
; i++) {

579 i‡(!(
	`bbi_ty≥
(
vbbb
[
i
]->
bbi
Ë=
CTRL_COND
))

581 
	`¥ötf
("OUT[%d]: ", 
i
);

583 
p
 = 
btg_out
[
i
];Ö !
NULL
;Ö =Ö->
√xt_out
)

584 
	`¥ötf
("%d(%cË", 
p
->
d°
->
id
, (p->
bønch
 =
TAKEN
) ? 'T' : 'N');

585 
	`¥ötf
("\n");

587 
	`¥ötf
("IN[%d]: ", 
i
);

588 
p
 = 
btg_ö
[
i
];Ö !
NULL
;Ö =Ö->
√xt_ö
)

589 
	`¥ötf
("%d(%cË", 
p
->
§c
->
id
, (p->
bønch
 =
TAKEN
) ? 'T' : 'N');

590 
	`¥ötf
("\n");

593 
i
 = 0; i < 
BHT_SIZE
; i++) {

594 i‡(
íd_bbb_ö
[
i
] =
NULL
)

596 
	`¥ötf
("íd[%d]: ", 
i
);

597 
p
 = 
íd_bbb_ö
[
i
];Ö !
NULL
;Ö =Ö->
√xt_ö
)

598 i‡(
p
->
§c
->
id
 =
roŸ_bbb_id
)

599 
	`¥ötf
("%d ", 
p
->
§c
->
id
);

601 
	`¥ötf
("%d(%cË", 
p
->
§c
->
id
, (p->
bønch
 =
TAKEN
) ? 'T' : 'N');

602 
	`¥ötf
("\n");

604 
	}
}

609 
	$buûd_btg
()

611 
i
;

613 
btg_ö
 = (
btg_edge_t
 **Ë
	`ˇŒoc
(
num_bfg_nodes
, (btg_edge_t *));

614 
btg_out
 = (
btg_edge_t
 **Ë
	`ˇŒoc
(
num_bfg_nodes
, (btg_edge_t *));

615 
	`CHECK_MEM
(
btg_ö
);

616 
	`CHECK_MEM
(
btg_out
);

617 
roŸ_bbb_out
 = (
btg_edge_t
**Ë
	`ˇŒoc
(
BHT_SIZE
, (btg_edge_t *));

618 
íd_bbb_ö
 = (
btg_edge_t
**Ë
	`ˇŒoc
(
BHT_SIZE
, (btg_edge_t *));

620 
i
 = 0; i < 
num_bfg_nodes
; i++) {

621 
	`cﬁÀ˘_ªachabÀs
(
vbbb
[
i
], 
TAKEN
);

622 
	`cﬁÀ˘_ªachabÀs
(
vbbb
[
i
], 
NOT_TAKEN
);

627 
i
 = 0; i< 
num_bfg_nodes
; i++)

628 
vbbb
[
i
]->
Êags
 = 
BHT_SIZE
;

629 
íd_bbb
.
Êags
 = 
BHT_SIZE
;

630 
i
=0; i < 
BHT_SIZE
; i++) {

631 i‡(
pi_èbÀ
[
i
])

632 
	`cﬁÀ˘_roŸ_ªachabÀ
(
i
);

634 
i
=0; i < 
num_bfg_nodes
; i++)

635 
vbbb
[
i
]->
Êags
 = 0;

638 
	}
}

643 
	$b¥ed_™Æysis
()

646 
	`cﬁÀ˘_mp_ö°s
();

647 
	`buûd_bfg
();

648 
	`buûd_btg
();

649 
	}
}

	@bpred.h

26 #i‚de‡
BPRED_H


27 
	#BPRED_H


	)

29 
	~"comm⁄.h
"

30 
	~"tcfg.h
"

32 
	#BP_NONE
 0

	)

33 
	#BP_CPRED
 1

	)

34 
	#BP_MPRED
 2

	)

35 
	#BP_UNCLEAR
 3

	)

37 
	#ROOT_BBB_ID
 77777

	)

38 
	#END_BBB_ID
 99999

	)

41 
	eb¥ed_scheme_t
 { 
	mNO_BPRED
, 
	mGAG
, 
	mGSHARE
, 
	mLOCAL
 };

44 
bfg_edge_t
 
	tbfg_edge_t
;

48 
tcfg_node_t
 *
	mbbi
;

49 
	mid
;

50 
	mbhr
;

51 
	mpi
;

52 
bfg_edge_t
 *
	mout
;

53 
bfg_edge_t
 *
	mö
;

55 
	mÊags
;

56 } 
	tbfg_node_t
;

61 
	sbfg_edge_t
 {

62 
	mbønch
;

63 
bfg_node_t
 *
	m§c
, *
	md°
;

64 
bfg_edge_t
 *
	m¥ev_out
, *
	m√xt_out
, *
	m¥ev_ö
, *
	m√xt_ö
;

69 
btg_edge_t
 
	tbtg_edge_t
;

71 
	sbtg_edge_t
 {

72 
bfg_node_t
 *
	m§c
, *
	md°
;

73 
	mbønch
;

74 
btg_edge_t
 *
	m√xt_ö
, *
	m√xt_out
;

80 
bbb_ö°_num
(
bfg_node_t
 *
bbb
);

83 
b¥ed_™Æys
();

86 
dump_bfg
();

	@bs.c

46 
	sDATA
 {

47 
	mkey
;

48 
	mvÆue
;

51 #ifde‡
DEBUG


52 
	g˙t1
;

55 
DATA
 
	gd©a
[30] = {

87 
	$maö
()

89 
	`bö¨y_£¨ch
(5);

90 
	}
}

92 
	$bö¨y_£¨ch
(
x
)

94 
fvÆue
, 
mid
, 
up
, 
low
 ;

96 
low
 = 0;

97 
up
 = 29;

98 
fvÆue
 = -1 ;

99 
low
 <
up
) {

100 
mid
 = (
low
 + 
up
) >> 1;

101 i‡–
d©a
[
mid
].
key
 =
x
 ) {

102 
up
 = 
low
 - 1;

103 
fvÆue
 = 
d©a
[
mid
].
vÆue
;

104 #ifde‡
DEBUG


105 
	`¥ötf
("FOUND!!\n");

109 i‡–
d©a
[
mid
].
key
 > 
x
 ) {

110 
up
 = 
mid
 - 1;

111 #ifde‡
DEBUG


112 
	`¥ötf
("MID-1\n");

116 
low
 = 
mid
 + 1;

117 #ifde‡
DEBUG


118 
	`¥ötf
("MID+1\n");

121 
	`¥ötf
("LoopÉxecuted\n");

122 #ifde‡
DEBUG


123 
˙t1
++;

126 #ifde‡
DEBUG


127 
	`¥ötf
("Lo› Cou¡ : %d\n", 
˙t1
);

129  
fvÆue
;

130 
	}
}

	@cache.c

23 
	~<°dlib.h
>

24 
	~<°rög.h
>

25 
	~"comm⁄.h
"

26 
	~"tcfg.h
"

27 
	~"ˇche.h
"

28 
	~"b¥ed.h
"

29 
	~"lo›s.h
"

32 
¥og_t
 
¥og
;

33 
num_tcfg_nodes
;

34 
tcfg_node_t
 **
tcfg
;

35 
num_tcfg_edges
;

36 
tcfg_edge_t
 **
tcfg_edges
;

37 
pùe_ibuf_size
;

38 
pùe_iwö_size
;

39 
b¥ed_scheme
;

40 *
num_mp_ö°s
;

41 
de_ö°_t
 ***
mp_ö°s
;

42 
num_tcfg_lo›s
;

43 
lo›_t
 **
lo›_m≠
;

44 
lo›_t
 **
lo›s
;

45 
lo›_t
 ***
lo›_comm_™˚s
;

48 *
	gnum_hô_miss
;

49 
ˇche_t
 
	gˇche
;

51 *
	gnum_mblks
;

56 
mem_blk_t
 **
	ggí
;

61 
mem_blk_t
 **
	gmp_gí
;

63 
èg_lök_t
 
	tèg_lök_t
;

64 
	sèg_lök_t
 {

65 
	mèg
;

66 
èg_lök_t
 *
	m√xt
;

69 
èg_lök_t
 ***
	glo›_ˇche_ègs
;

70 **
	gnum_mblk_c⁄Êi˘s
;

71 
lo›_t
 ***
	gmblk_hô_lo›
;

72 
lo›_t
 ***
	gbbi_hm_li°
;

73 *
num_hô_miss
;

78 
dump_gí
();

81 
dump_lo›_ègs
();

84 
dump_mblk_hôlo›
();

87 
dump_hm_li°
();

93 
	$£t_ˇche_basic
(
n£ts
, 
assoc
, 
bsize
, 
miss_≥«…y
)

95 
ˇche
.
ns
 = 
n£ts
;

96 
ˇche
.
«
 = 
assoc
;

97 
ˇche
.
ls
 = 
bsize
;

98 
ˇche
.
cmp
 = 
miss_≥«…y
;

99 
	}
}

104 
	$£t_ˇche
()

106 
i
, 
n
;

108 
ˇche
.
nsb
 = 
	`log_ba£2
(ˇche.
ns
);

109 
ˇche
.
lsb
 = 
	`log_ba£2
(ˇche.
ls
);

111 
ˇche
.
¡b
 = 
MAX_TAG_BITS
;

112 
ˇche
.
¡
 = 1 << cache.
¡b
;

114 
ˇche
.
t_sb
 = cache.
¡b
 + cache.
nsb
;

115 
ˇche
.
s_lb
 = cache.
nsb
 + cache.
lsb
;

116 
ˇche
.
¡_s
 = 1 << cache.
t_sb
;

118 
ˇche
.
l_msk
 = (1 << cache.
lsb
) - 1;

120 
ˇche
.
s_msk
 = 0;

121 
i
 = 1; i < 
ˇche
.
ns
; i <<= 1)

122 
ˇche
.
s_msk
 |
i
;

123 
ˇche
.
s_msk
 <<ˇche.
lsb
;

125 
ˇche
.
t_msk
 = 0;

126 
i
 = 1; i < 
ˇche
.
¡
; i <<= 1)

127 
ˇche
.
t_msk
 |
i
;

128 
ˇche
.
t_msk
 <<ˇche.
lsb
 + cache.
nsb
;

130 
ˇche
.
t_s_msk
 = cache.
t_msk
 | cache.
s_msk
;

131 
	}
}

139 
	$tcfg_node_gí
(
tcfg_node_t
 *
bbi
)

141 
addr_t
 
addr
, 
ó
;

142 
mem_blk_t
 
mblk
, *
p
;

143 
i
, 
£t
, 
èg
, 
num_upd©es
 = 0;

144 
Queue
 
w‹kli°
;

146 
	`öô_queue
(&
w‹kli°
, (
mem_blk_t
));

148 
addr
 = 
	`CLEAR_LSB
(
bbi
->
bb
->
ß
);

149 
ó
 = 
bbi
->
bb
->
ß
 + bbi->bb->
size
;

150 
addr
 < 
ó
) {

151 
mblk
.
£t
 = 
	`SET
(
addr
);

152 
mblk
.
èg
 = 
	`TAG
(
addr
);

153 
	`íqueue
(&
w‹kli°
, &
mblk
);

154 
addr
 +
ˇche
.
ls
;

155 
num_upd©es
++;

158 
gí
[
bbi
->
id
] = (
mem_blk_t
 *Ë
	`ˇŒoc
(
num_upd©es
+1, (mem_blk_t));

159 
	`CHECK_MEM
(
gí
[
bbi
->
id
]);

160 
i
 = 0; i < 
num_upd©es
; i++) {

161 
p
 = (
mem_blk_t
 *Ë
	`dequeue
(&
w‹kli°
);

162 
	`memmove
(&
gí
[
bbi
->
id
][
i
], 
p
, (
mem_blk_t
));

164 
gí
[
bbi
->
id
][
i
].
£t
 = 
MAX_CACHE_SETS
;

166 
	`‰ì_queue
(&
w‹kli°
);

167 
	}
}

173 
	$tcfg_edge_mp_gí
(
tcfg_edge_t
 *
e
)

175 
i
, 
£t
, 
èg
, 
num_upd©es
 = 0;

176 
addr_t
 
addr
, 
ó
;

177 
mem_blk_t
 
mblk
, *
p
;

178 
Queue
 
w‹kli°
;

180 
	`öô_queue
(&
w‹kli°
, (
mem_blk_t
));

182 
mblk
.
£t
 = 
MAX_CACHE_SETS
;

183 
i
 = 0; i < 
num_mp_ö°s
[
e
->
id
]; i++) {

184 
addr
 = 
	`CLEAR_LSB
(
mp_ö°s
[
e
->
id
][
i
]->addr);

185 
ó
 = 
mp_ö°s
[
e
->
id
][
i
]->
addr
 + mp_ö°s[e->id][i]->
size
;

186 
addr
 < 
ó
) {

187 
£t
 = 
	`SET
(
addr
);

188 
èg
 = 
	`TAG
(
addr
);

189 i‡((
£t
 !
mblk
.£tË|| (
èg
 != mblk.tag)) {

190 
mblk
.
£t
 = set;

191 
mblk
.
èg
 =Åag;

192 
	`íqueue
(&
w‹kli°
, &
mblk
);

193 
num_upd©es
++;

195 
addr
 +
ˇche
.
ls
;

198 
mp_gí
[
e
->
id
] = (
mem_blk_t
 *Ë
	`ˇŒoc
(
num_upd©es
+1, (mem_blk_t));

199 
	`CHECK_MEM
(
mp_gí
[
e
->
id
]);

200 
i
 = 0; i < 
num_upd©es
; i++) {

201 
p
 = (
mem_blk_t
 *Ë
	`dequeue
(&
w‹kli°
);

202 
	`memmove
(&
mp_gí
[
e
->
id
][
i
], 
p
, (
mem_blk_t
));

204 
mp_gí
[
e
->
id
][
i
].
£t
 = 
MAX_CACHE_SETS
;

206 
	`‰ì_queue
(&
w‹kli°
);

207 
	}
}

213 
	$ˇlc_gí
()

215 
i
;

218 
gí
 = (
mem_blk_t
 **Ë
	`ˇŒoc
(
num_tcfg_nodes
, (mem_blk_t *));

219 
	`CHECK_MEM
(
gí
);

220 
mp_gí
 = (
mem_blk_t
 **Ë
	`ˇŒoc
(
num_tcfg_edges
, (mem_blk_t *));

221 
	`CHECK_MEM
(
mp_gí
);

223 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

224 
	`tcfg_node_gí
(
tcfg
[
i
]);

227 i‡(
b¥ed_scheme
 =
NO_BPRED
)

230 
i
 = 0; i < 
num_tcfg_edges
; i++) {

231 i‡(
num_mp_ö°s
[
i
] > 0)

232 
	`tcfg_edge_mp_gí
(
tcfg_edges
[
i
]);

234 
	}
}

240 
	$ˇlc_num_mblks
()

242 
i
;

243 
addr_t
 
ß
, 
ó
;

245 
num_mblks
 = (*Ë
	`ˇŒoc
(
num_tcfg_nodes
, ());

246 
	`CHECK_MEM
(
num_mblks
);

248 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

249 
ß
 = 
	`LSB_OFF
(
tcfg
[
i
]->
bb
->sa);

250 
ó
 = 
tcfg
[
i
]->
bb
->
ß
 +Åcfg[i]->bb->
size
;

251 
ó
 = 
	`LSB_OFF
(ea - 1);

252 
num_mblks
[
i
] = 
ó
 - 
ß
 + 1;

254 
	}
}

259 
	$gë_mblks
()

261 
	`ˇlc_num_mblks
();

262 
	`ˇlc_gí
();

263 
	}
}

266 
èg_lök_t
 *

267 
	$£¨ch_èg
(
Õ_id
, 
£t
, 
èg
)

269 
èg_lök_t
 *
èg_li°
, *
p
;

271 
èg_li°
 = 
lo›_ˇche_ègs
[
Õ_id
][
£t
];

272 
p
 = 
èg_li°
;Ö !
NULL
;Ö =Ö->
√xt
) {

273 i‡(
p
->
èg
 ==Åag)

274  
p
;

276  
NULL
;

277 
	}
}

282 
	$add_èg
(
Õ_id
, 
£t
, 
èg
)

284 
èg_lök_t
 *
x
;

286 
x
 = (
èg_lök_t
 *Ë
	`ˇŒoc
(1, (tag_link_t));

287 
x
->
èg
 =Åag;

288 
x
->
√xt
 = 
lo›_ˇche_ègs
[
Õ_id
][
£t
];

289 
lo›_ˇche_ègs
[
Õ_id
][
£t
] = 
x
;

290 
	}
}

297 
	$gë_lo›_ègs
()

299 
i
, 
j
;

300 
£t
, 
èg
;

301 
mem_blk_t
 *
mblk
;

302 
lo›_t
 *
Õ
;

303 
èg_lök_t
 *
p
;

304 
addr_t
 
addr
;

306 
lo›_ˇche_ègs
 = (
èg_lök_t
 ***Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (tag_link_t **));

307 
i
 = 0; i < 
num_tcfg_lo›s
; i++)

308 
lo›_ˇche_ègs
[
i
] = (
èg_lök_t
 **Ë
	`ˇŒoc
(
ˇche
.
ns
, (tag_link_t *));

309 
num_mblk_c⁄Êi˘s
 = (**Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (*));

310 
i
 = 0; i < 
num_tcfg_lo›s
; i++)

311 
num_mblk_c⁄Êi˘s
[
i
] = (*Ë
	`ˇŒoc
(
ˇche
.
ns
, ());

313 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

314 
Õ
 = 
lo›_m≠
[
i
];

315 i‡(
Õ
 =
NULL
)

317 
j
 = 0; j < 
num_mblks
[
i
]; j++) {

318 
£t
 = 
gí
[
i
][
j
].set;

319 
èg
 = 
gí
[
i
][
j
].tag;

320 i‡(
	`£¨ch_èg
(
Õ
->
id
, 
£t
, 
èg
Ë=
NULL
)

321 
	`add_èg
(
Õ
->
id
, 
£t
, 
èg
);

324 
addr
 = 
tcfg
[
i
]->
bb
->
ß
 +Åcfg[i]->bb->
size
;

325 
j
 = 0; j < 
pùe_ibuf_size
 - 1; j++) {

326 
£t
 = 
	`SET
(
addr
);

327 
èg
 = 
	`TAG
(
addr
);

328 i‡(
	`£¨ch_èg
(
Õ
->
id
, 
£t
, 
èg
Ë=
NULL
)

329 
	`add_èg
(
Õ
->
id
, 
£t
, 
èg
);

330 
addr
 +
tcfg
[
i
]->
bb
->
code
[0].
size
;

336 
i
 = 0; i < 
num_tcfg_lo›s
; i++) {

337 
Õ
 = 
lo›s
[
i
];

338 
j
 = 0; j < 
num_tcfg_lo›s
; j++) {

339 i‡(
i
 =
j
)

341 i‡(
lo›_comm_™˚s
[
i
][
j
] !
Õ
)

343 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

344 
p
 = 
lo›_ˇche_ègs
[
j
][
£t
];Ö !
NULL
;Ö =Ö->
√xt
) {

345 i‡(
	`£¨ch_èg
(
Õ
->
id
, 
£t
, 
p
->
èg
Ë=
NULL
)

346 
	`add_èg
(
Õ
->
id
, 
£t
, 
p
->
èg
);

353 
i
 = 0; i < 
num_tcfg_lo›s
; i++) {

354 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

355 
p
 = 
lo›_ˇche_ègs
[
i
][
£t
];Ö !
NULL
;Ö =Ö->
√xt
) {

356 
num_mblk_c⁄Êi˘s
[
i
][
£t
]++;

361 
	}
}

368 
	$gë_mp_c⁄Êi˘s
(
tcfg_node_t
 *
bbi
)

370 
tcfg_node_t
 *
§c
;

371 
tcfg_edge_t
 *
e
, *
mp_e
;

372 
mem_blk_t
 *
mblks
;

373 
èg0
, 
£t0
, 
c⁄Êi˘_ègs
[32];

374 
num_c⁄Êi˘s
, 
tmp
, 
i
, 
j
, 
max_c⁄Êi˘s
 = 0;

376 
èg0
 = 
	`TAG
(
bbi
->
bb
->
ß
);

377 
£t0
 = 
	`SET
(
bbi
->
bb
->
ß
);

378 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

379 
§c
 = 
e
->src;

380 i‡(
	`bbi_ty≥
(
§c
Ë!
CTRL_COND
)

382 
mp_e
 = 
§c
->
out
;

383 i‡(
mp_e
->
d°
 =
bbi
)

384 
mp_e
 = mp_e->
√xt_out
;

385 
mblks
 = 
mp_gí
[
mp_e
->
id
];

386 
num_c⁄Êi˘s
 = 0; 
i
 = 0;

387 
mblks
[
i
].
£t
 !
MAX_CACHE_SETS
) {

388 i‡((
mblks
[
i
].
£t
 =
£t0
Ë&& (mblks[i].
èg
 !
èg0
)) {

389 
j
 = 0; j < 
num_c⁄Êi˘s
; j++) {

390 i‡(
c⁄Êi˘_ègs
[
j
] =
mblks
[
i
].
èg
)

393 i‡(
j
 =
num_c⁄Êi˘s
) {

394 
c⁄Êi˘_ègs
[
num_c⁄Êi˘s
] = 
mblks
[
i
].
èg
;

395 
num_c⁄Êi˘s
++;

396 i‡(
num_c⁄Êi˘s
 == 32)

400 
i
++;

402 i‡(
num_c⁄Êi˘s
 > 
max_c⁄Êi˘s
)

403 
max_c⁄Êi˘s
 = 
num_c⁄Êi˘s
;

405  
max_c⁄Êi˘s
;

406 
	}
}

411 
	$h™dÀ_fú°_mblk
(
bbi_id
)

413 
ts1
, 
ts2
, 
num_c⁄Êi˘s
;

414 
tcfg_edge_t
 *
e
;

415 
cfg_node_t
 *
bb
;

417 i‡(
bbi_id
 == 0)

420 
bb
 = 
tcfg
[
bbi_id
]->bb;

421 
ts1
 = 
	`TAGSET
(
bb
->
ß
);

422 
e
 = 
tcfg
[
bbi_id
]->
ö
;É !
NULL
;É =É->
√xt_ö
) {

423 
bb
 = 
e
->
§c
->bb;

424 
ts2
 = 
	`TAGSET
(
bb
->
ß
 + bb->
size
 - 1);

425 i‡(
ts1
 !
ts2
)

428 i‡(
e
 !
NULL
)

431 i‡(
b¥ed_scheme
 =
NO_BPRED
) {

432 
mblk_hô_lo›
[
bbi_id
][0] = 
lo›s
[0];

434 
num_c⁄Êi˘s
 = 
	`gë_mp_c⁄Êi˘s
(
tcfg
[
bbi_id
]);

435 i‡(
num_c⁄Êi˘s
 < 
ˇche
.
«
)

436 
mblk_hô_lo›
[
bbi_id
][0] = 
lo›s
[0];

438 
mblk_hô_lo›
[
bbi_id
][0] = 
NULL
;

441 
	}
}

446 
	$h™dÀ_Ÿhî_mblk
(
bbi_id
, 
°¨t_mb
)

448 
mb_id
, 
£t
;

449 
lo›_t
 *
Õ
;

451 
mb_id
 = 
°¨t_mb
; mb_id < 
num_mblks
[
bbi_id
]; mb_id++) {

452 
£t
 = 
gí
[
bbi_id
][
mb_id
].set;

453 
Õ
 = 
lo›_m≠
[
bbi_id
];Ü∞!
NULL
;Ü∞Õ->
∑ª¡
) {

454 i‡(
num_mblk_c⁄Êi˘s
[
Õ
->
id
][
£t
] > 
ˇche
.
«
)

456 
mblk_hô_lo›
[
bbi_id
][
mb_id
] = 
Õ
;

459 
	}
}

468 
	$föd_hôlo›
()

470 
i
, 
°¨t_mb
;

471 
lo›_t
 *
Õ
;

472 
tcfg_edge_t
 *
e
;

474 
	`gë_lo›_ègs
();

476 
mblk_hô_lo›
 = (
lo›_t
 ***Ë
	`ˇŒoc
(
num_tcfg_nodes
, (loop_t **));

477 
i
 = 0; i < 
num_tcfg_nodes
; i++)

478 
mblk_hô_lo›
[
i
] = (
lo›_t
 **Ë
	`ˇŒoc
(
num_mblks
[i], (loop_t *));

479 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

480 
°¨t_mb
 = 
	`h™dÀ_fú°_mblk
(
i
);

481 
	`h™dÀ_Ÿhî_mblk
(
i
, 
°¨t_mb
);

484 
	}
}

489 
	$bbi_ˇãg‹ize
(
tcfg_node_t
 *
bbi
, 
lo›_t
 **
bbi_hô_lo›s
, 
Àn
)

491 
i
;

493 i‡(
Àn
 == 0) {

494 
bbi_hm_li°
[
bbi
->
id
] = (
lo›_t
 **Ë
	`ˇŒoc
(1, (loop_t *));

495 
bbi_hm_li°
[
bbi
->
id
][0] = 
NULL
;

496 
num_hô_miss
[
bbi
->
id
] = 1;

499 
bbi_hm_li°
[
bbi
->
id
] = (
lo›_t
 **Ë
	`ˇŒoc
(
Àn
+1, (loop_t *));

500 
	`memmove
(
bbi_hm_li°
[
bbi
->
id
], 
bbi_hô_lo›s
, 
Àn
 * (
lo›_t
 *));

501 
bbi_hm_li°
[
bbi
->
id
][
Àn
] = bbi_hm_li°[bbi->id][Àn-1]->
∑ª¡
;

502 
num_hô_miss
[
bbi
->
id
] = 
Àn
+1;

503 
	}
}

512 
	$ˇãg‹ize
()

514 
i
, 
j
, 
Æl_miss
 = 0, 
Àn
;

515 
lo›_t
 *
queue
[
MAX_LOOP_NEST
], *
Õ
;

517 
bbi_hm_li°
 = (
lo›_t
 ***Ë
	`ˇŒoc
(
num_tcfg_nodes
, (loop_t **));

518 
num_hô_miss
 = (*Ë
	`ˇŒoc
(
num_tcfg_nodes
, ());

520 
	`£t_lo›_Êags
(0);

521 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

522 
Àn
 = 0;

523 
Õ
 = 
lo›_m≠
[
i
];Ü∞!
NULL
;Ü∞Õ->
∑ª¡
) {

524 
j
 = 0; j < 
num_mblks
[
i
]; j++) {

525 i‡(
Õ
 =
mblk_hô_lo›
[
i
][
j
]) {

526 
queue
[
Àn
++] = 
Õ
;

531 
	`bbi_ˇãg‹ize
(
tcfg
[
i
], 
queue
, 
Àn
);

533 
	`£t_lo›_Êags
(0);

535 
	}
}

540 
	$ˇche_™Æysis
()

543 
	`£t_ˇche
();

544 
	`gë_mblks
();

545 
	`föd_hôlo›
();

546 
	`ˇãg‹ize
();

547 
	}
}

552 
	$gë_mblk_hômiss
(
tcfg_node_t
 *
bbi
, 
mblk_id
, 
lo›_t
 *
Õ
)

554 
lo›_t
 *
Õ1
, *
Õ2
;

556 
Õ1
 = 
mblk_hô_lo›
[
bbi
->
id
][
mblk_id
];

557 i‡((
Õ
 =
NULL
Ë|| (
Õ1
 == NULL))

558  
IC_MISS
;

559 i‡(
Õ
 =
Õ1
)

560  
IC_HIT
;

562 
Õ2
 = 
lo›_comm_™˚s
[
Õ
->
id
][
Õ1
->id];

563 i‡(
Õ2
 =
Õ1
)

564  
IC_HIT
;

566  
IC_MISS
;

568 
	}
}

576 
	$dump_gí
()

578 
tcfg_node_t
 *
§c
, *
d°
;

579 
mem_blk_t
 *
mblk
;

580 
i
;

582 
i
 = 0; i < 
num_tcfg_edges
; i++) {

583 
§c
 = 
tcfg_edges
[
i
]->src;

584 
d°
 = 
tcfg_edges
[
i
]->dst;

585 
	`¥ötf
("tcfg_edge: %d.%d -> %d.%d\n", 
	`bbi_pid
(
§c
), 
	`bbi_bid
(src),

586 
	`bbi_pid
(
d°
), 
	`bbi_bid
(dst));

587 
mblk
 = 
gí
[
§c
->
id
]; mblk->
£t
 !
MAX_CACHE_SETS
; mblk++)

588 
	`¥ötf
("\t£t=%x: %x\n", 
mblk
->
£t
, mblk->
èg
);

589 i‡(
mp_gí
[
i
] =
NULL
)

591 
	`¥ötf
("\t---------------\n");

592 
mblk
 = 
mp_gí
[
i
]; mblk->
£t
 !
MAX_CACHE_SETS
; mblk++)

593 
	`¥ötf
("\t£t=%x: %x\n", 
mblk
->
£t
, mblk->
èg
);

596 
	}
}

601 
	$dump_lo›_ègs
()

603 
i
;

604 
£t
, 
èg
;

605 
èg_lök_t
 *
p
;

607 
	`¥ötf
("dumpÜoopÅags...\n");

608 
i
 = 0; i < 
num_tcfg_lo›s
; i++) {

609 
	`¥ötf
("lo›[%d]\n", 
i
);

610 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

611 
	`¥ötf
("\t%d: ", 
£t
);

612 
p
 = 
lo›_ˇche_ègs
[
i
][
£t
];Ö !
NULL
;Ö =Ö->
√xt
)

613 
	`¥ötf
("%x ", 
p
->
èg
);

614 
	`¥ötf
("\n");

617 
	}
}

622 
	$dump_mblk_hôlo›
()

624 
i
, 
j
;

625 
	`¥ötf
("\ndump_mblk_hit_loop...\n");

626 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

627 
	`¥ötf
("bbi[%d]/%d:\n", 
i
, 
num_mblks
[i]);

628 
j
 = 0; j < 
num_mblks
[
i
]; j++) {

629 i‡(
mblk_hô_lo›
[
i
][
j
] =
NULL
)

630 
	`¥ötf
("\t%d:Üo›[ ]\n", 
j
);

632 
	`¥ötf
("\t%d:Üo›[%d]\n", 
j
, 
mblk_hô_lo›
[
i
][j]->
id
);

635 
	}
}

640 
	$dump_hm_li°
()

642 
i
, 
j
;

644 
	`¥ötf
("dump bbi_hm_list...\n");

645 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

646 
	`¥ötf
("bbi[%d]: ", 
i
);

647 
j
 = 0; j < 
num_hô_miss
[
i
]; j++) {

648 i‡(
bbi_hm_li°
[
i
][
j
] =
NULL
)

649 
	`¥ötf
("\tloop[ ] ");

651 
	`¥ötf
("\éo›[%d] ", 
bbi_hm_li°
[
i
][
j
]->
id
);

653 
	`¥ötf
("\n");

655 
	}
}

	@cache.h

22 #i‚de‡
CACHE_H


23 
	#CACHE_H


	)

24 
	~"addªss.h
"

25 
	#MAX_CACHE_SETS
 1024

	)

31 
	#MAX_TAG_BITS
 14

	)

34 
	#CACHE_LINE
(
addr
Ë(◊ddrË& 
ˇche
.
l_msk
)

	)

35 
	#SET
(
addr
Ë((◊ddrË& 
ˇche
.
s_msk
Ë>> cache.
lsb
)

	)

36 
	#TAG
(
addr
Ë((◊ddrË& 
ˇche
.
t_msk
Ë>> cache.
s_lb
)

	)

37 
	#TAGSET
(
addr
Ë((◊ddrË& 
ˇche
.
t_s_msk
Ë>> cache.
lsb
)

	)

38 
	#TAGSET2
(
èg
, 
£t
Ë((—agË<< 
ˇche
.
nsb
Ë| (£t))

	)

39 
	#LSB_OFF
(
addr
Ë(◊ddrË>> 
ˇche
.
lsb
)

	)

40 
	#LSB_ON
(
addr
Ë(◊ddrË<< 
ˇche
.
lsb
)

	)

42 
	#CLEAR_LSB
(
addr
Ë((◊ddrË>> 
ˇche
.
lsb
Ë<< cache.lsb)

	)

43 
	#MBLK_ID
(
ß
, 
addr
Ë(
	`TAGSET
◊ddrË- TAGSET(ß))

	)

45 
	#IC_HIT
 0

	)

46 
	#IC_MISS
 1

	)

47 
	#IC_UNCLEAR
 2

	)

48 
	#MC_INC_SIZE
 8

	)

50 íum { 
	mIC_ILP
, 
	mIC_CATEGORIZE
 };

57 
	mns
;

58 
	mls
;

59 
	mnsb
;

60 
	mlsb
;

61 
	mcmp
;

62 
	m«
;

65 
	m¡
;

66 
	m¡b
;

69 
	ms_lb
;

70 
	mt_sb
;

71 
	m¡_s
;

74 
	ml_msk
;

75 
	ms_msk
;

76 
	mt_msk
;

77 
	mt_s_msk
;

78 } 
	tˇche_t
;

84 
	m£t
;

85 
	mèg
;

86 } 
	tmem_blk_t
;

93 
	mvÆid
;

94 
	mèg
;

95 } 
	tmblk_èg_t
;

98 
	smem_blk_£t


100 
	mblock
;

101 
mem_blk_£t
* 
	m√xt
;

104 
mem_blk_£t
 
	tmem_blk_£t_t
;

107 
	sˇche_block
 {

108 
mem_blk_£t_t
* 
	mmem_blk_h
;

111 
	sovr_m≠pög
 {

112 
	mﬁd
;

113 
	m√wb
;

114 
ovr_m≠pög
* 
	m√xt
;

117 
ovr_m≠pög
* 
	tovr_m≠_p
;

118 
ovr_m≠pög
 
	tovr_m≠_s
;

120 
	#CACHE_SET_SIZE
 
X


	)

121 
	#MAX_CACHE_SET
 
Y


	)

122 
	#PSEUDO
 
CACHE_SET_SIZE


	)

123 
	#DATA_MISS_PENALTY
 6

	)

124 
	#L1_MISS_PENALTY
 
l1


	)

125 
	#L2_MISS_PENALTY
 
l2


	)

126 
	#GET_SET
(
x
Ë((xË% 
MAX_CACHE_SET
)

	)

127 
	#PENALTY
 119400

	)

129 
	eACCESS
 {

130 
	mALL_HIT
 = 0,

131 
	mALL_MISS
,

132 
	mPS
,

133 
	mALL_X
,

134 
	mNOT_CLASSIFIED


137 
	eANALYSIS
 {

138 
	mMUST
 = 0,

139 
	mMAY
,

140 
	mPERSISTENCE


143 
ACCESS
 
	tACCESS_T
;

144 
ANALYSIS
 
	tANALYSIS_T
;

145 
ˇche_block
* 
	tacs_p
;

146 
ˇche_block
 
	tacs_s
;

149 
£t_ˇche_basic
(
n£ts
, 
assoc
, 
bsize
, 
miss_≥«…y
);

151 
™Æyze_d©a_ˇche
();

152 
™Æyze_abs_ö°r_ˇche
();

153 
™Æyze_unifõd_ˇche
();

	@cfg.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~"comm⁄.h
"

26 
	~"cfg.h
"

29 
iß_t
 *
iß
;

30 
¥og_t
 
¥og
;

37 
	$lookup_addr
(
de_ö°_t
 *
code
, 
num
, 
addr_t
 
addr
)

39 
hi
 = 
num
 - 1, 
lo
 = 0, 
i
;

41 
hi
 >
lo
) {

42 
i
 = (
hi
 + 
lo
) / 2;

43 i‡(
code
[
i
].
addr
 ==áddr)

44  
i
;

45 i‡(
code
[
i
].
addr
 >áddr)

46 
hi
 = 
i
 - 1;

48 
lo
 = 
i
 + 1;

51 
	}
}

58 
	$sˇn_¥ocs
(*
¥oc_ít
)

60 
maö_id
, 
i
, 
tid
;

62 
¥og
.
num_¥ocs
 = 0;

63 
i
 = 0; i < 
¥og
.
num_ö°
; i++) {

65 i‡(
¥og
.
code
[
i
].
addr
 =¥og.
maö_addr
) {

66 i‡(
¥oc_ít
[
i
] == 0) {

67 
¥oc_ít
[
i
] = 1;

68 
¥og
.
num_¥ocs
++;

69 
maö_id
 = 
i
;

71 } i‡(
	`ö°_ty≥
(&
¥og
.
code
[
i
]Ë=
INST_CALL
) {

74 
tid
 = 
	`lookup_addr
(
¥og
.
code
,Örog.
num_ö°
,Örog.code[
i
].
èrgë
);

75 i‡(
tid
 == -1) {

79 i‡(
¥oc_ít
[
tid
] == 0) {

80 
¥oc_ít
[
tid
] = 1;

81 
¥og
.
num_¥ocs
++;

85  
maö_id
;

86 
	}
}

89 
bj±b
;

93 
	$sˇn_blocks
(*
bb_ít
, 
¥oc_t
 *
¥oc
)

95 
i
, 
ty≥
, 
tid
;

96 
de_ö°_t
 *
ö°
;

98 
bb_ít
[0] = 1;

99 
¥oc
->
num_bb
 = 1;

101 
addr_t
 
adr
;

102 
bföd
;

103 
num
;

105 
i
 = 0; i < 
¥oc
->
num_ö°
; i++) {

106 
ö°
 = &
¥oc
->
code
[
i
];

107 
ty≥
 = 
	`ö°_ty≥
(
ö°
);

108 i‡((
ty≥
 =
INST_COND
Ë|| (ty≥ =
INST_UNCOND
)) {

110 
tid
 = 
	`lookup_addr
(
¥oc
->
code
,Öroc->
num_ö°
, 
ö°
->
èrgë
);

111 i‡(
tid
 == -1) {

112 
	`Ârötf
(
°dîr
, "nÿm©ch f‹ bønchÅ¨gë: %x\n", 
ö°
->
èrgë
);

113 
	`exô
(1);

115 i‡(
bb_ít
[
tid
] == 0) {

116 
bb_ít
[
tid
] = 1;

117 
¥oc
->
num_bb
++;

121 i‡(
bb_ít
[
i
+1] == 0) {

122 
bb_ít
[
i
+1] = 1;

123 
¥oc
->
num_bb
++;

125 } i‡(
ty≥
 =
INST_CALL
) {

127 i‡(
bb_ít
[
i
+1] == 0) {

128 
bb_ít
[
i
+1] = 1;

129 
¥oc
->
num_bb
++;

131 } i‡(
ty≥
 =
INST_RET
) {

134 i‡((
i
 < 
¥oc
->
num_ö°
 - 1Ë&& (
bb_ít
[i+1] == 0)) {

135 
bb_ít
[
i
+1] = 1;

136 
¥oc
->
num_bb
++;

140 if(
bj±b
 && 
i
 < 
¥oc
->
num_ö°
 - 1){

141 
bföd
 = 
	`lookup_j±abÀ
(
ö°
->
addr
);

143 if(
bföd
 > 0){

145 
num
 = 0;

147 
bb_ít
[
i
 + 1] +(
bföd
 - 1);

148 
¥oc
->
num_bb
 +(
bföd
 - 1);

150  
num
 < 
bföd
 ){

151 
	`gë_j±abÀ
(
ö°
->
addr
, 
num
, &
adr
);

152 
tid
 = 
	`lookup_addr
(
¥oc
->
code
,Öroc->
num_ö°
, 
adr
);

153 i‡(
tid
 == -1) {

154 
	`¥ötf
("nÿid f‹ jum∞èrgë: %x\n", 
adr
);

157 i‡(
bb_ít
[
tid
] == 0) {

158 
bb_ít
[
tid
] = 1;

159 
¥oc
->
num_bb
++;

161 
num
++;

167 
	}
}

171 
cfg_node_t
 *

172 
	$lookup_bb
(
cfg_node_t
 *
cfg
, 
num
, 
addr_t
 
addr
)

174 
hi
 = 
num
 - 1, 
lo
 = 0, 
i
;

176 
hi
 >
lo
) {

177 
i
 = (
hi
 + 
lo
) / 2;

178 i‡(
cfg
[
i
].
ß
 =
addr
)

179  &
cfg
[
i
];

180 i‡(
cfg
[
i
].
ß
 > 
addr
)

181 
hi
 = 
i
 - 1;

183 
lo
 = 
i
 + 1;

185  
NULL
;

186 
	}
}

195 
	$√w_edge
(
cfg_node_t
 *
§c
, cfg_node_à*
d°
, 
èkí
)

197 
cfg_edge_t
 *
e
 = (cfg_edge_à*Ë
	`mÆloc
((cfg_edge_t));

198 
	`CHECK_MEM
(
e
);

199 
e
->
§c
 = src;É->
d°
 = dst;

200 i‡(
èkí
 =
NOT_TAKEN
)

201 
§c
->
out_n
 = 
e
;

203 
§c
->
out_t
 = 
e
;

204 
d°
->
num_ö
++;

205 
d°
->
ö
 = (
cfg_edge_t
 **Ë
	`ªÆloc
(d°->ö, d°->
num_ö
 * (cfg_edge_t *));

206 
	`CHECK_MEM
(
d°
->
ö
);

207 
d°
->
ö
[d°->
num_ö
 - 1] = 
e
;

208 
	}
}

211 
bj±b
;

217 
	$¸óã_cfg_edges
(
¥oc_t
 *
¥oc
)

219 
i
, 
ty≥
;

220 
cfg_node_t
 *
bb
, *
bb1
;

222 
addr_t
 
adr
;

223 
bföd
;

225 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

226 
bb
 = &
¥oc
->
cfg
[
i
];

227 
ty≥
 = 
	`ö°_ty≥
(&
bb
->
code
[bb->
num_ö°
-1]);

228 i‡(
ty≥
 =
INST_COND
) {

230 
bb1
 = &
¥oc
->
cfg
[
i
+1];

231 
	`√w_edge
(
bb
, 
bb1
, 
NOT_TAKEN
);

233 
bb1
 = 
	`lookup_bb
(
¥oc
->
cfg
,Öroc->
num_bb
, 
bb
->
code
[bb->
num_ö°
-1].
èrgë
);

234 i‡(
bb1
 =
NULL
) {

235 
	`Ârötf
(
°dîr
, "cannot find block start witháddr: %x\n",

236 
bb
->
code
[bb->
num_ö°
-1].
èrgë
);

237 
	`exô
(1);

239 
	`√w_edge
(
bb
, 
bb1
, 
TAKEN
);

240 
bb
->
ty≥
 = 
CTRL_COND
;

241 } i‡(
ty≥
 =
INST_UNCOND
) {

243 
bb1
 = 
	`lookup_bb
(
¥oc
->
cfg
,Öroc->
num_bb
, 
bb
->
code
[bb->
num_ö°
-1].
èrgë
);

244 i‡(
bb1
 =
NULL
) {

245 
	`Ârötf
(
°dîr
, "cannot find block start witháddr: %x\n",

246 
bb
->
code
[bb->
num_ö°
-1].
èrgë
);

247 
	`exô
(1);

249 
	`√w_edge
(
bb
, 
bb1
, 
TAKEN
);

250 
bb
->
ty≥
 = 
CTRL_UNCOND
;

251 } i‡(
ty≥
 =
INST_RET
) {

253 
bb
->
ty≥
 = 
CTRL_RET
;

257 if(
bj±b
 && 
i
 !
¥oc
->
num_bb
 - 1 ){

276 
bföd
 = 
	`gë_j±abÀ_°©ic
(
bb
->
code
[bb->
num_ö°
 - 1].
addr
, &
adr
);

277 if(
bföd
 >= 0){

279 
bb1
 = 
	`lookup_bb
(
¥oc
->
cfg
,¥oc->
num_bb
,
adr
);

280 i‡(
bb1
 =
NULL
){

281 
	`¥ötf
("ˇ¬Ÿ föd block sèπ wôháddr: %x\n",
adr
);

283 
	`√w_edge
(
bb
,
bb1
,
TAKEN
);

285 if(
bföd
){

286 
bb1
 = &
¥oc
->
cfg
[
i
+1];

287 
	`√w_edge
(
bb
, 
bb1
, 
NOT_TAKEN
);

290 
bb
->
ty≥
 = 
CTRL_UNCOND
;

296 i‡(
i
 < 
¥oc
->
num_bb
 - 1) {

297 
bb1
 = &
¥oc
->
cfg
[
i
+1];

298 
	`√w_edge
(
bb
, 
bb1
, 
NOT_TAKEN
);

300 i‡(
ty≥
 =
INST_CALL
)

301 
bb
->
ty≥
 = 
CTRL_CALL
;

303 
bb
->
ty≥
 = 
CTRL_SEQ
;

306 
	}
}

311 
¥oc_t
 *

312 
	$lookup_¥oc
(
addr_t
 
addr
)

314 
hi
 = 
¥og
.
num_¥ocs
 - 1, 
lo
 = 0, 
i
;

316 
hi
 >
lo
) {

317 
i
 = (
hi
 + 
lo
) / 2;

318 i‡(
¥og
.
¥ocs
[
i
].
ß
 =
addr
)

319  &
¥og
.
¥ocs
[
i
];

320 i‡(
¥og
.
¥ocs
[
i
].
ß
 > 
addr
)

321 
hi
 = 
i
 - 1;

323 
lo
 = 
i
 + 1;

325  
NULL
;

326 
	}
}

330 
ölöe
 

331 
	$bb_is_lo›_hód
(
cfg_node_t
 *
bb
)

333  (
bb
->
lo›_rﬁe
 & 
LOOP_HEAD
);

334 
	}
}

338 
ölöe
 

339 
	$bb_is_lo›_èû
(
cfg_node_t
 *
bb
)

341  (
bb
->
lo›_rﬁe
 & 
LOOP_TAIL
);

342 
	}
}

347 
	$lo›_check
(
¥oc_t
 *
¥oc
, 
°¨t
, 
íd
)

349 
is_lo›
;

350 
bb_id
;

351 
cfg_node_t
 *
bb
;

352 
cfg_edge_t
 *
e
;

353 
Queue
 
w‹kli°
;

355 
bb
 = &
¥oc
->
cfg
[
°¨t
];

356 i‡(
	`bb_is_lo›_hód
(
bb
))

358 i‡(
°¨t
 =
íd
) {

359 
¥oc
->
cfg
[
°¨t
].
lo›_rﬁe
 = 
LOOP_HEAD
 | 
LOOP_TAIL
;

363 
	`öô_queue
(&
w‹kli°
, (
cfg_node_t
 *));

364 
	`íqueue
(&
w‹kli°
, &
bb
);

365 
bb
->
Êags
 = 
íd
;

366 !
	`queue_em±y
(&
w‹kli°
)) {

367 
bb
 = *((
cfg_node_t
 **Ë
	`dequeue
(&
w‹kli°
));

368 i‡(
bb
->
id
 =
íd
) {

369 
¥oc
->
cfg
[
°¨t
].
lo›_rﬁe
 = 
LOOP_HEAD
;

370 
¥oc
->
cfg
[
íd
].
lo›_rﬁe
 = 
LOOP_TAIL
;

373 i‡((
bb
->
out_n
 !
NULL
Ë&& (bb->out_n->
d°
->
Êags
 !
íd
)) {

374 
	`íqueue
(&
w‹kli°
, &
bb
->
out_n
->
d°
);

375 
bb
->
out_n
->
d°
->
Êags
 = 
íd
;

377 i‡((
bb
->
out_t
 !
NULL
Ë&& (bb->out_t->
d°
->
Êags
 !
íd
)) {

378 
	`íqueue
(&
w‹kli°
, &
bb
->
out_t
->
d°
);

379 
bb
->
out_t
->
d°
->
Êags
 = 
íd
;

382 
	`‰ì_queue
(&
w‹kli°
);

383 
	}
}

388 
	$idítify_lo›s
(
¥oc_t
 *
¥oc
)

390 
i
;

391 
cfg_node_t
 *
bb
;

392 
cfg_edge_t
 *
e
;

394 
i
 = 
¥oc
->
num_bb
 - 1; i >= 0; i--) {

395 
bb
 = &
¥oc
->
cfg
[
i
];

396 i‡(
bb
->
out_t
 =
NULL
)

398 i‡(
bb
->
out_t
->
d°
->
id
 <
i
)

399 
	`lo›_check
(
¥oc
, 
bb
->
out_t
->
d°
->
id
, 
i
);

401 
i
 = 0; i < 
¥oc
->
num_bb
; i++)

402 
¥oc
->
cfg
[
i
].
Êags
 = 0;

403 
	}
}

412 
	$¸óã_cfg
(
¥oc_t
 *
¥oc
)

414 *
bb_ít
, 
i
, 
bb_id
 = 0;

415 
num
;

417 
cfg_node_t
 *
bb
;

418 
addr_t
 
addr
;

419 
¥oc_t
 *
ˇŒì
;

423 
bb_ít
 = (*Ë
	`ˇŒoc
(
¥oc
->
num_ö°
, ());

424 
	`CHECK_MEM
(
bb_ít
);

427 
	`sˇn_blocks
(
bb_ít
, 
¥oc
);

428 
¥oc
->
cfg
 = (
cfg_node_t
 *Ë
	`ˇŒoc
’roc->
num_bb
, (cfg_node_t));

429 
	`CHECK_MEM
(
¥oc
->
cfg
);

432 
i
 = 0; i < 
¥oc
->
num_ö°
; i++) {

433 i‡(
bb_ít
[
i
]) {

435 
num
 = 
bb_ít
[
i
];

436 
num
 > 1){

438 
bb
 = &
¥oc
->
cfg
[
bb_id
];

439 
bb
->
id
 = 
bb_id
;

440 
bb
->
¥oc
 =Öroc;

441 
bb
->
ß
 = 
¥oc
->
code
[
i
 - 1].
addr
;

442 
bb
->
size
 = 
¥oc
->
code
[
i
 - 1].size;

443 
bb
->
num_ö°
 = 1;

444 
bb
->
code
 = &
¥oc
->code[
i
 - 1];

445 
bb_id
++;

446 
num
--;

448 
bb
 = &
¥oc
->
cfg
[
bb_id
];

449 
bb
->
id
 = 
bb_id
;

450 
bb
->
¥oc
 =Öroc;

451 
bb
->
ß
 = 
¥oc
->
code
[
i
].
addr
;

452 
bb
->
size
 = 
¥oc
->
code
[
i
].size;

453 
bb
->
num_ö°
 = 1;

454 
bb
->
code
 = &
¥oc
->code[
i
];

455 
bb_id
++;

458 
bb
->
size
 +
¥oc
->
code
[
i
].size;

459 
bb
->
num_ö°
++;

462 
	`‰ì
(
bb_ít
);

465 
	`¸óã_cfg_edges
(
¥oc
);

468 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

469 
bb
 = &
¥oc
->
cfg
[
i
];

470 i‡(
bb
->
ty≥
 =
CTRL_CALL
) {

471 
addr
 = 
bb
->
code
[bb->
num_ö°
-1].
èrgë
;

472 
ˇŒì
 = 
	`lookup_¥oc
(
addr
);

473 i‡(
ˇŒì
 =
NULL
) {

476 
bb
->
ty≥
 = 
CTRL_SEQ
;

478 
bb
->
ˇŒì
 = callee;

483 
	`idítify_lo›s
(
¥oc
);

484 
	}
}

490 
	$buûd_cfgs
()

492 *
¥oc_ít
, 
i
, 
¥oc_id
 = 0, 
maö_id
;

493 
¥oc_t
 *
¥oc
;

495 
¥oc_ít
 = (*Ë
	`ˇŒoc
(
¥og
.
num_ö°
, ());

496 
	`CHECK_MEM
(
¥oc_ít
);

499 
maö_id
 = 
	`sˇn_¥ocs
(
¥oc_ít
);

500 
¥og
.
¥ocs
 = (
¥oc_t
 *Ë
	`ˇŒoc
’rog.
num_¥ocs
, (proc_t));

501 
	`CHECK_MEM
(
¥og
.
¥ocs
);

504 
i
 = 0; i < 
¥og
.
num_ö°
; i++) {

505 i‡(
¥oc_ít
[
i
]) {

507 
¥oc
 = &
¥og
.
¥ocs
[
¥oc_id
];

508 
¥oc
->
id
 = 
¥oc_id
;

509 
¥oc
->
ß
 = 
¥og
.
code
[
i
].
addr
;

510 
¥oc
->
size
 = 
¥og
.
code
[
i
].size;

511 
¥oc
->
num_ö°
 = 1;

512 
¥oc
->
code
 = &
¥og
.code[
i
];

513 i‡(
i
 =
maö_id
)

514 
¥og
.
maö_¥oc
 = 
¥oc_id
;

515 
¥oc_id
++;

518 
¥oc
->
size
 +
¥og
.
code
[
i
].size;

519 
¥oc
->
num_ö°
++;

522 
	`‰ì
(
¥oc_ít
);

525 
i
 = 0; i < 
¥og
.
num_¥ocs
; i++) {

526 
	`¸óã_cfg
(&
¥og
.
¥ocs
[
i
]);

529 
	}
}

541 
	$dump_cfg
(
FILE
 *
Â
, 
¥oc_t
 *
¥oc
)

543 
cfg_node_t
 *
bb
;

544 
i
;

546 
	`Ârötf
(
Â
, "\≈roc[%d] cfg:\n", 
¥oc
->
id
);

547 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

548 
bb
 = &
¥oc
->
cfg
[
i
];

549 
	`Ârötf
(
Â
, " %d : %08x : [ ", 
bb
->
id
, bb->
ß
);

550 i‡(
bb
->
out_n
 !
NULL
)

551 
	`Ârötf
(
Â
, " %d", 
bb
->
out_n
->
d°
->
id
);

553 
	`Ârötf
(
Â
, " ");

554 
	`Ârötf
(
Â
, " , ");

555 i‡(
bb
->
out_t
 !
NULL
)

556 
	`Ârötf
(
Â
, " %d ", 
bb
->
out_t
->
d°
->
id
);

558 
	`Ârötf
(
Â
, " ");

559 
	`Ârötf
(
Â
, " ] ");

560 i‡(
bb
->
ˇŒì
 !
NULL
) {

561 
	`Ârötf
(
Â
, " P%d", 
bb
->
ˇŒì
->
id
);

564 i‡(
	`bb_is_lo›_hód
(
bb
))

565 
	`Ârötf
(
Â
, "/");

566 i‡(
	`bb_is_lo›_èû
(
bb
))

567 
	`Ârötf
(
Â
, "\\");

569 
	`Ârötf
(
Â
, "\n");

571 
	}
}

	@cfg.h

22 #i‚de‡
CFG_H


23 
	#CFG_H


	)

26 
	~<°dio.h
>

27 
	~"iß.h
"

30 
	#NOT_TAKEN
 0

	)

31 
	#TAKEN
 1

	)

32 
	#BOTH_BRANCHES
 2

	)

33 
	#LOOP_HEAD
 1

	)

34 
	#LOOP_TAIL
 2

	)

37 íum {
	mCTRL_SEQ
, 
	mCTRL_COND
, 
	mCTRL_UNCOND
, 
	mCTRL_CALL
, 
	mCTRL_RET
} 
	tbb_ty≥_t
;

40 
cfg_edge_t
 
	tcfg_edge_t
;

41 
¥oc_t
 
	t¥oc_t
;

45 
	mid
;

46 
¥oc_t
 *
	m¥oc
;

47 
addr_t
 
	mß
;

48 
	msize
;

49 
	mnum_ö°
;

50 
de_ö°_t
 *
	mcode
;

52 
bb_ty≥_t
 
	mty≥
;

53 
cfg_edge_t
 *
	mout_n
, *
	mout_t
;

54 
	mnum_ö
;

55 
cfg_edge_t
 **
	mö
;

57 
¥oc_t
 *
	mˇŒì
;

59 
	mlo›_rﬁe
;

61 
	mÊags
;

64 
ric_p
* 
	mö_abs_ªg_vÆue
;

65 
ric_p
* 
	mout_abs_ªg_vÆue
;

67 
abs_mem_p
 
	mö_abs_mem_vÆue
;

68 
abs_mem_p
 
	mout_abs_mem_vÆue
;

70 } 
	tcfg_node_t
;

75 
	scfg_edge_t
 {

76 
cfg_node_t
 *
	m§c
, *
	md°
;

82 
	s¥oc_t
 {

83 
	mid
;

84 
addr_t
 
	mß
;

85 
	msize
;

86 
	mnum_ö°
;

87 
de_ö°_t
 *
	mcode
;

89 
	mnum_bb
;

90 
cfg_node_t
 *
	mcfg
;

92 
	mÊags
;

99 
de_ö°_t
 *
	mcode
;

100 
	mcode_size
;

101 
	mnum_ö°
;

102 
addr_t
 
	m°¨t_addr
, 
	míd_addr
, 
	mmaö_addr
;

103 
¥oc_t
 *
	m¥ocs
;

104 
	mnum_¥ocs
;

105 
	mmaö_¥oc
;

106 } 
	t¥og_t
;

108 
	#MAX_OVRL_NODES
 1024

	)

109 
	#OPT
 1

	)

111 
	scﬁ_d©a


114 
¥oc_t
* 
	m¥oc
;

115 
de_ö°_t
* 
	mö°
;

116 }
	mu
;

117 
	mty≥
;

118 
cﬁ_d©a
* 
	m√xt
;

121 
cﬁ_d©a
* 
	tcﬁ_d©a_p
;

122 
cﬁ_d©a
 
	tcﬁ_d©a_s
;

125 
	sovæ_gøph
 {

127 
¥oc_t
* 
	m¥oc
;

128 
de_ö°_t
* 
	mö°
;

129 
cﬁ_d©a_p
 
	m¥ef
;

130 }
	mu
;

131 
	mty≥
;

132 
	mövÆid
;

134 
	m‰eq
;

135 
ovæ_gøph
* 
	m√xt
;

137 
ovæ_gøph
* 
	tovæ_gøph_p
;

138 
ovæ_gøph
 
	tovæ_gøph_s
;

142 
dump_cfg
(
FILE
 *
Â
, 
¥oc_t
 *
¥oc
);

	@common.c

23 
	~"comm⁄.h
"

24 
	~<as£π.h
>

25 
	~<°rög.h
>

26 
	~<°dlib.h
>

33 
my_b£¨ch
(c⁄° *
key
, c⁄° *
ba£
, 
size_t
 
n
, size_à
size
,

34 (*
cmp
)(c⁄° *
k
, c⁄° *
d©um
))

36 
low
, 
high
, 
mid
;

37 
c
;

39 i‡(
n
 == 0)

40  
ba£
;

42 
low
 = 0; 
high
 = 
n
 - 1;

43 
low
 <
high
) {

44 
mid
 = (
low
 + 
high
) / 2;

45 i‡(
cmp
 =
NULL
)

46 
c
 = (*((*Ë
key
Ë- *((*Ë(
ba£
 + 
mid
 * 
size
)));

48 
c
 = 
	`cmp
(
key
, (c⁄° *)(
ba£
 + 
mid
 * 
size
));

49 i‡(
c
 < 0)

50 
high
 = 
mid
 - 1;

51 i‡(
c
 > 0)

52 
low
 = 
mid
 + 1;

54  (c⁄° *)(
ba£
 + 
mid
 * 
size
);

57  (c⁄° *)(
ba£
 + 
low
 * 
size
);

58 
	}
}

65 
	$my_ö£π
(c⁄° *
x
, *
ba£
, *
y
, *
√Àm
, 
size
)

67 
nbyãs
;

68 *
p
;

70 
nbyãs
 = (*
√Àm
Ë* 
size
 - (()
y
 - ()
ba£
);

71 
	`as£π
(
nbyãs
 >= 0);

72 
	`memmove
(
y
+
size
, y, 
nbyãs
);

73 
	`mem˝y
(
y
, 
x
, 
size
);

74 (*
√Àm
)++;

75 
	}
}

82 
	$öô_°ack
(
Sèck
 *
°ack
, 
ñem_size
)

84 
°ack
->
ba£
 = (*Ë
	`mÆloc
(
STACK_ELEMS
 * 
ñem_size
);

85 i‡(
°ack
->
ba£
 =
NULL
) {

86 
	`Ârötf
(
°dîr
, "out of memory (__FILE__:__LINE__)\n");

87 
	`exô
(1);

89 
°ack
->
esize
 = 
ñem_size
;

90 
°ack
->
ˇ±
 = 
STACK_ELEMS
 * 
ñem_size
;

91 
°ack
->
t›
 = sèck->
ba£
;

92 
	}
}

97 
	$‰ì_°ack
(
Sèck
 *
°ack
)

99 i‡(
°ack
->
ba£
 !
NULL
) {

100 
	`‰ì
(
°ack
->
ba£
);

101 
°ack
->
ba£
 = 
NULL
;

103 
°ack
->
ˇ±
 = sèck->
esize
 = 0;

104 
°ack
->
t›
 = 
NULL
;

105 
	}
}

110 
	$°ack_push
(
Sèck
 *
°ack
, *
x
)

112 i‡((
°ack
->
t›
 + sèck->
esize
Ë> (°ack->
ba£
 + sèck->
ˇ±
)) {

113 
°ack
->
ˇ±
 *= 2;

114 
°ack
->
ba£
 = (*Ë
	`ªÆloc
(°ack->ba£, sèck->
ˇ±
);

115 i‡(
°ack
->
ba£
 =
NULL
) {

116 
	`Ârötf
(
°dîr
, "out of memory (__FILE__:__LINE__)\n");

117 
	`exô
(1);

120 
	`mem˝y
(
°ack
->
t›
, 
x
, sèck->
esize
);

121 
°ack
->
t›
 +°ack->
esize
;

122 
	}
}

127 
	$°ack_em±y
(
Sèck
 *
°ack
)

129 
	`as£π
(
°ack
->
t›
 >°ack->
ba£
);

130  (
°ack
->
t›
 =°ack->
ba£
) ? 1 : 0;

131 
	}
}

136 
	$°ack_p›
(
Sèck
 *
°ack
)

138 i‡(
	`°ack_em±y
(
°ack
))

139  
NULL
;

140 
°ack
->
t›
 -°ack->
esize
;

141  
°ack
->
t›
;

142 
	}
}

148 
	$˛ór_°ack
(
Sèck
 *
°ack
)

150 
°ack
->
t›
 = sèck->
ba£
;

151 
	}
}

157 
	$c›y_°ack
(
Sèck
 *
y
, Sèck *
x
)

160 
	`‰ì_°ack
(
y
);

162 
y
->
ba£
 = (*Ë
	`mÆloc
(
x
->
ˇ±
);

163 i‡(
y
->
ba£
 =
NULL
) {

164 
	`Ârötf
(
°dîr
, "out of memory (__FILE__:__LINE__)\n");

165 
	`exô
(1);

167 
	`mem˝y
(
y
->
ba£
, 
x
->ba£, (x->
t›
 - x->base));

168 
y
->
esize
 = 
x
->esize;

169 
y
->
ˇ±
 = 
x
->capt;

170 
y
->
t›
 = y->
ba£
 + (
x
->top - x->base);

171 
	}
}

177 
	$öô_queue
(
Queue
 *
queue
, 
ñem_size
)

179 
queue
->
ba£
 = (*Ë
	`mÆloc
(
QUEUE_ELEMS
 * 
ñem_size
);

180 i‡(
queue
->
ba£
 =
NULL
) {

181 
	`Ârötf
(
°dîr
, "out of memory (__FILE__:__LINE__)\n");

182 
	`exô
(1);

184 
queue
->
esize
 = 
ñem_size
;

185 
queue
->
ˇ±
 = 
QUEUE_ELEMS
 * 
ñem_size
;

186 
queue
->
hód
 = queue->
èû
 = queue->
ba£
;

187 
	}
}

192 
	$‰ì_queue
(
Queue
 *
queue
)

194 i‡(
queue
->
ba£
 !
NULL
) {

195 
	`‰ì
(
queue
->
ba£
);

196 
queue
->
ba£
 = 
NULL
;

198 
queue
->
ˇ±
 = queue->
esize
 = 0;

199 
queue
->
hód
 = queue->
èû
 = 
NULL
;

200 
	}
}

205 
	$íqueue
(
Queue
 *
queue
, *
x
)

207 *
√wba£
;

208 
n
;

210 
	`mem˝y
(
queue
->
èû
, 
x
, queue->
esize
);

211 
queue
->
èû
 +queue->
esize
;

212 i‡(
queue
->
èû
 =(queue->
ba£
 + queue->
ˇ±
))

213 
queue
->
èû
 = queue->
ba£
;

214 i‡(
queue
->
èû
 !queue->
hód
)

218 
√wba£
 = (*Ë
	`mÆloc
(
queue
->
ˇ±
 * 2);

219 i‡(
√wba£
 =
NULL
) {

220 
	`Ârötf
(
°dîr
, "out of memory (__FILE__:__LINE__)\n");

221 
	`exô
(1);

223 
n
 = 
queue
->
ba£
 + queue->
ˇ±
 - queue->
hód
;

224 
	`mem˝y
(
√wba£
, 
queue
->
hód
, 
n
);

225 i‡(
queue
->
èû
 > queue->
ba£
)

226 
	`mem˝y
(
√wba£
 + 
n
, 
queue
->
ba£
, queue->
èû
 - queue->base);

227 
	`‰ì
(
queue
->
ba£
);

228 
queue
->
ba£
 = 
√wba£
;

229 
queue
->
hód
 = queue->
ba£
;

230 
queue
->
èû
 = queue->
ba£
 + queue->
ˇ±
;

231 
queue
->
ˇ±
 *= 2;

232 
	}
}

237 
	$queue_em±y
(
Queue
 *
queue
)

239  (
queue
->
hód
 =queue->
èû
) ? 1 : 0;

240 
	}
}

245 
	$dequeue
(
Queue
 *
queue
)

247 *
p
;

248 i‡(
	`queue_em±y
(
queue
))

249  
NULL
;

250 
p
 = 
queue
->
hód
;

251 
queue
->
hód
 +queue->
esize
;

252 i‡(
queue
->
hód
 =(queue->
ba£
 + queue->
ˇ±
))

253 
queue
->
hód
 = queue->
ba£
;

254  
p
;

255 
	}
}

261 
	$˛ór_queue
(
Queue
 *
queue
)

263 
queue
->
hód
 = queue->
èû
 = queue->
ba£
;

264 
	}
}

269 
	$bôs
(
x
)

271 
i
 = 0;

273 i‡(
x
 == 0)

275 
x
 > 0) {

276 
i
++;

277 
x
 >>= 1;

279  
i
;

280 
	}
}

285 
	$ønge_i£˘
(
ønge_t
 *
x
,Ñ™ge_à*
y
)

287 i‡(
x
->
lo
 < 
y
->lo)

288 
x
->
lo
 = 
y
->lo;

289 i‡(
x
->
hi
 > 
y
->hi)

290 
x
->
hi
 = 
y
->hi;

291 i‡(
x
->
lo
 > x->
hi
)

292  
BAD_RANGE
;

294  
GOOD_RANGE
;

295 
	}
}

301 
	$ønge_uni⁄
(
ønge_t
 *
x
,Ñ™ge_à*
y
)

303 i‡(
x
->
lo
 > 
y
->lo)

304 
x
->
lo
 = 
y
->lo;

305 i‡(
x
->
hi
 < 
y
->hi)

306 
x
->
hi
 = 
y
->hi;

307 
	}
}

	@common.h

22 #i‚de‡
COMMON_H


23 
	#COMMON_H


	)

25 
	~<°dio.h
>

26 
	~<as£π.h
>

28 
	#TARGET_SS


29 

	)

30 
	#SHOW_PROGRESS
 0

	)

32 
	#BAD_RANGE
 0

	)

33 
	#GOOD_RANGE
 1

	)

34 
	#MAX_INST
 5120

	)

35 
	#MAX_BB
 1024

	)

36 
	#STACK_ELEMS
 1024

	)

37 
	#QUEUE_ELEMS
 1024

	)

38 
	#HEAP_ELEMS
 16

	)

39 
	#INFTY
 99999

	)

41 
	#CHECK_MEM
(
p
Ë\

	)

42 i‡((
	gp
Ë=
NULL
) { \

43 
Ârötf
(
°dîr
, "ouào‡mem‹y\n", 
__FILE__
, 
__LINE__
); \

44 
exô
(1); \

47 
	#ö°_num
(
code
, 
size
Ë((sizeË/ 
SS_INST_SIZE
)

	)

48 
	#ö°_size
(
code
, 
n
Ë(“Ë* 
SS_INST_SIZE
)

	)

49 
	#BETWEEN
(
x
, 
a
, 
b
Ë(((xË>◊)Ë&& ((xË<(b)))

	)

50 
	#INSIDE
(
x
, 
a
, 
b
Ë( (((xË> (a)Ë&& ((xË< (b))))

	)

51 
	#max
(
x
, 
y
Ë((xË> (yË? (xË: (y))

	)

52 
	#mö
(
x
, 
y
Ë((xË< (yË? (xË: (y))

	)

53 
	#SET_FLAG
(
x
, 
Êag_msk
Ë((xË|(Êag_msk))

	)

54 
	#RESET_FLAG
(
x
, 
Êag_msk
Ë((xË&(~(Êag_msk)))

	)

55 
	#TEST_FLAG
(
x
, 
Êag_msk
Ë((xË& (Êag_msk))

	)

57 
	#mem_‰ì
(
p
Ë(’Ë? 
	`‰ì
’Ë: 0)

	)

61 
	mlo
, 
	mhi
;

62 } 
	tønge_t
;

66 
	mlo
, 
	mhi
;

67 } 
	tønge16_t
;

70 
	mlo
, 
	mhi
;

71 } 
	tønge8_t
;

75 
cmp_gíîÆ
(
ønge_t
 *
x
,Ñ™ge_à*
y
);

79 
ønge_i£˘
(
ønge_t
 *
x
,Ñ™ge_à*
y
);

83 
ønge_uni⁄
(
ønge_t
 *
x
,Ñ™ge_à*
y
);

87 
	s°ack_t
 {

88 *
	mba£
;

89 *
	mt›
;

90 
	mesize
;

91 
	mˇ±
;

92 } 
	tSèck
;

96 #i‚de‡
QUEUE


97 
	#QUEUE


	)

98 
	squeue_t
 {

99 *
	mba£
;

100 *
	mhód
, *
	mèû
;

101 
	mesize
;

102 
	mˇ±
;

103 } 
	tQueue
;

109 
my_b£¨ch
(c⁄° *
key
, c⁄° *
ba£
, 
size_t
 
n
, size_à
size
,

110 (*
cmp
)(c⁄° *
k
, c⁄° *
d©um
));

113 
	`my_ö£π
(c⁄° *
x
, *
ba£
, *
y
, *
√Àm
, 
size
);

118 
	`bôs
(
x
);

	@conflicts.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~"iß.h
"

26 
	~"cfg.h
"

27 
	~"tcfg.h
"

28 
	~"lo›s.h
"

29 
	~"ö„asibÀ.h
"

31 
¥og_t
 
¥og
;

32 
iß_t
 *
iß
;

34 
tcfg_∆ök_t
 ***
bbi_m≠
;

35 
lo›_t
 **
lo›_m≠
;

38 
	$√g
–
a
 ) {

40 if–
a
 =
GT
 )  
LE
;

41 if–
a
 =
GE
 )  
LT
;

42 if–
a
 =
LE
 )  
GT
;

43 if–
a
 =
LT
 )  
GE
;

44 if–
a
 =
EQ
 )  
NE
;

45 if–
a
 =
NE
 )  
EQ
;

46  
NA
;

47 
	}
}

53 
	$ã°C⁄Êi˘
–
a
, 
rhs_a
, 
b
, 
rhs_b
 ) {

55 if–
a
 =
GT
 ) {

56 if–
b
 =
LT
 || b =
LE
 || b =
EQ
 ) {

57 if–
rhs_a
 < 
rhs_b
 )  0;

62 if–
a
 =
LT
 ) {

63 if–
b
 =
GT
 || b =
GE
 || b =
EQ
 ) {

64 if–
rhs_a
 > 
rhs_b
 )  0;

69 if–
a
 =
GE
 ) {

70 if–
b
 =
LT
 ) {

71 if–
rhs_a
 < 
rhs_b
 )  0;

74 if–
b
 =
LE
 || b =
EQ
 ) {

75 if–
rhs_a
 <
rhs_b
 )  0;

80 if–
a
 =
LE
 ) {

81 if–
b
 =
GT
 ) {

82 if–
rhs_a
 > 
rhs_b
 )  0;

85 if–
b
 =
GE
 || b =
EQ
 ) {

86 if–
rhs_a
 >
rhs_b
 )  0;

91 if–
a
 =
EQ
 ) {

92 if–
b
 =
NE
 ) {

93 if–
rhs_a
 !
rhs_b
 )  0;

96 if–
b
 =
EQ
 ) {

97 if–
rhs_a
 =
rhs_b
 )  0;

100 if–
b
 =
LT
 ) {

101 if–
rhs_a
 < 
rhs_b
 )  0;

104 if–
b
 =
GT
 ) {

105 if–
rhs_a
 > 
rhs_b
 )  0;

108 if–
b
 =
LE
 ) {

109 if–
rhs_a
 <
rhs_b
 )  0;

112 if–
b
 =
GE
 ) {

113 if–
rhs_a
 >
rhs_b
 )  0;

117 if–
a
 =
NE
 ) {

118 if–
b
 =
EQ
 && ( 
rhs_a
 =
rhs_b
 ))

123 
	}
}

131 
	$isBBC⁄Êi˘
–
bønch_t
 *
A
, bønch_à*
B
, 
r1
, 
r2
 ) {

132  
	`ã°C⁄Êi˘
–
r1
, 
A
->
rhs
, 
r2
, 
B
->rhs );

133 
	}
}

135 
	$isBAC⁄Êi˘
–
assign_t
 *
A
, 
bønch_t
 *
B
, 
r
 ) {

136 if–
A
->
rhs_v¨
 )  0;

137  
	`ã°C⁄Êi˘
–
EQ
, 
A
->
rhs
, 
r
, 
B
->rhs );

138 
	}
}

141 
	$addNuŒifõr
–
assign_t
 *
as
,ássign_à***
nuŒifõr_li°
, *
num_nuŒifõrs
 ) {

143 
i
, 
Àn
;

146  
i
 = 0; i < *
num_nuŒifõrs
; i++ )

147 if–(*
nuŒifõr_li°
)[
i
] =
as
 )

150 (*
num_nuŒifõrs
)++;

151 
Àn
 = *
num_nuŒifõrs
;

152 (*
nuŒifõr_li°
Ë(
assign_t
**Ë
	`ªÆloc
–*nuŒifõr_li°, 
Àn
 * (assign_t*) );

153 (*
nuŒifõr_li°
)[
Àn
-1] = 
as
;

156 
	}
}

162 
	$ªachabÀNoC™˚l
–*
ªs
, 
assign_t
 ***
nuŒifõr_li°
, *
num_nuŒifõrs
,

163 
pid
, 
§cid
, 
de°id
, *
dîôªe
,

164 
assign_t
 *
assg
, 
cfg_node_t
 *
bbli°
, 
num_bb
, **
visôed
 ) {

165 
i
, 
id
;

166 
cfg_node_t
 *
bb
;

167 
öf_node_t
 *
ib
;

170 if–
§cid
 =
de°id
 ) {

171 *
ªs
 |= 1;

176 
bb
 = &(
bbli°
[
§cid
]);

177 
ib
 = &(
öf_¥ocs
[
pid
].
öf_cfg
[
bb
->
id
]);

178 (*
visôed
)[
bb
->
id
] = 1;

181 if–
assg
 =
NULL
 || 
bb
->
id
 !=ássg->bb->id ) {

182  
i
 = 0; i < 
ib
->
num_assign
; i++ ) {

186 if–
	`°rcmp
–
dîôªe
, 
ib
->
assig∆i°
[
i
]->deritree ) == 0 ) {

187 
k
;

188 *
ªs
 |= 0;

189 
	`addNuŒifõr
–
ib
->
assig∆i°
[
i
], 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

207 if–
bb
->
out_n
 !
NULL
 ) {

208 
id
 = 
bb
->
out_n
->
d°
->id;

210 if–!(*
visôed
)[
id
] )

211 
	`ªachabÀNoC™˚l
–
ªs
, 
nuŒifõr_li°
, 
num_nuŒifõrs
, 
pid
, 
id
, 
de°id
, 
dîôªe
, 
assg
, 
bbli°
, 
num_bb
, 
visôed
 );

213 if–
bb
->
out_t
 !
NULL
 ) {

214 
id
 = 
bb
->
out_t
->
d°
->id;

216 if–!(*
visôed
)[
id
] )

217 
	`ªachabÀNoC™˚l
–
ªs
, 
nuŒifõr_li°
, 
num_nuŒifõrs
, 
pid
, 
id
, 
de°id
, 
dîôªe
, 
assg
, 
bbli°
, 
num_bb
, 
visôed
 );

220 
	}
}

230 
	$ã°RóchabÀNoC™˚l
–*
ªs
, 
assign_t
 ***
nuŒifõr_li°
, *
num_nuŒifõrs
,

231 
pid
, 
§cid
, 
de°id
, *
dîôªe
,

232 
assign_t
 *
assg
, 
cfg_node_t
 *
bbli°
, 
num_bb
 ) {

234 *
visôed
;

238 if–
§cid
 =
de°id
 )

239 *
ªs
 = 1;

241 
visôed
 = (*Ë
	`ˇŒoc
–
¥og
.
¥ocs
[
pid
].
num_bb
, () );

242 
	`ªachabÀNoC™˚l
–
ªs
, 
nuŒifõr_li°
, 
num_nuŒifõrs
, 
pid
, 
§cid
, 
de°id
, 
dîôªe
, 
assg
, 
bbli°
, 
num_bb
, &
visôed
 );

244 
	`‰ì
–
visôed
 );

246 
	}
}

252 
	$£tBAC⁄Êi˘
–
assign_t
 *
assg
, 
bønch_t
 *
br
, 
dú
,ássign_à**
nuŒifõr_li°
, 
num_nuŒifõrs
 ) {

254 
i
, 
n
;

256 
br
->
num_BA_c⁄Êi˘s
++;

257 
n
 = 
br
->
num_BA_c⁄Êi˘s
;

258 
br
->
BA_c⁄Êi˘_li°
 = (
BA_c⁄Êi˘_t
*Ë
	`ªÆloc
–br->BA_c⁄Êi˘_li°, 
n
 * (BA_conflict_t) );

259 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
c⁄Êi˘_§c
 = 
assg
;

260 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
c⁄Êi˘_dú
 = 
dú
;

261 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
num_nuŒifõrs
 =Çum_nullifiers;

262 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
 = 
NULL
;

264 if–
num_nuŒifõrs
 > 0 ) {

265 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
 = (
assign_t
**Ë
	`mÆloc
–
num_nuŒifõrs
 * (assign_t*) );

266  
i
 = 0; i < 
num_nuŒifõrs
; i++ )

267 
br
->
BA_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
[
i
] =Çullifier_list[i];

270 
	}
}

276 
	$£tBBC⁄Êi˘
–
bønch_t
 *
br1
, bønch_à*
br2
, 
dú
, 
assign_t
 **
nuŒifõr_li°
, 
num_nuŒifõrs
 ) {

278 
i
, 
n
;

280 
br2
->
num_BB_c⁄Êi˘s
++;

281 
n
 = 
br2
->
num_BB_c⁄Êi˘s
;

282 
br2
->
BB_c⁄Êi˘_li°
 = (
BB_c⁄Êi˘_t
*Ë
	`ªÆloc
–br2->BB_c⁄Êi˘_li°, 
n
 * (BB_conflict_t) );

283 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
c⁄Êi˘_§c
 = 
br1
;

284 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
c⁄Êi˘_dú
 = 
dú
;

285 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
num_nuŒifõrs
 =Çum_nullifiers;

286 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
 = 
NULL
;

288 if–
num_nuŒifõrs
 > 0 ) {

289 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
 = (
assign_t
**Ë
	`mÆloc
–
num_nuŒifõrs
 * (assign_t*) );

290  
i
 = 0; i < 
num_nuŒifõrs
; i++ )

291 
br2
->
BB_c⁄Êi˘_li°
[
n
-1].
nuŒifõr_li°
[
i
] =Çullifier_list[i];

294 
	}
}

297 
	$isLo›Bønch
–
cfg_node_t
 *
bb
 ) {

299 
tcfg_ñök_t
 *
ñök
;

300 
tcfg_node_t
 *
node
 = 
bbi_m≠
[
bb
->
¥oc
->
id
][bb->id]->
bbi
;

302  
ñök
 = 
lo›_m≠
[
node
->
id
]->
exôs
;Élök !
NULL
;Élök =Élök->
√xt
 ) {

303 if–
node
 =
ñök
->
edge
->
§c
 )

307 
	}
}

315 
	$lo›EquÆ
–
cfg_node_t
 *
b1
, cfg_node_à*
b2
 ) {

317 
nd1
 = 
bbi_m≠
[
b1
->
¥oc
->
id
][b1->id]->
bbi
->id;

318 
nd2
 = 
bbi_m≠
[
b2
->
¥oc
->
id
][b2->id]->
bbi
->id;

319  (
lo›_m≠
[
nd1
] =lo›_m≠[
nd2
]);

320 
	}
}

326 
	$dëe˘C⁄Êi˘s
() {

328 
i
, 
j
, 
k
, 
n
;

331 
num_BA
 = 0;

332 
num_BB
 = 0;

335  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

336 
¥oc_t
 *
p
 = &(
¥og
.
¥ocs
[
i
]);

337 
öf_¥oc_t
 *
ù
 = &(
öf_¥ocs
[
i
]);

339 if–!
ö˛ude_¥oc
[
i
] )

342  
j
 = 0; j < 
ù
->
num_bb
; j++ ) {

343 
öf_node_t
 *
ib
 = &(
ù
->
öf_cfg
[
j
]);

344 
bønch_t
 *
br
 = 
ib
->
bønch
;

346 if–
br
 =
NULL
 )

351 if–
	`isLo›Bønch
–
ib
->
bb
 ))

355  
k
 = 0; k < 
ib
->
num_assign
; k++ ) {

356 
assign_t
 *
as
 = 
ib
->
assig∆i°
[
k
];

360 if–
	`°ªq
–
br
->
dîôªe
, 
as
->deritree )) {

362 if–
	`isBAC⁄Êi˘
–
as
, 
br
, br->
jump_c⁄d
 )) {

363 
	`£tBAC⁄Êi˘
–
as
, 
br
, 
JUMP
, 
NULL
, 0 );

365 
num_BA
++;

367 if–
	`isBAC⁄Êi˘
–
as
, 
br
, 
	`√g
–br->
jump_c⁄d
 ))) {

368 
	`£tBAC⁄Êi˘
–
as
, 
br
, 
FALL
, 
NULL
, 0 );

370 
num_BA
++;

379  
k
 = 0; k < 
j
; k++ ) {

380 
öf_node_t
 *
ibk
 = &(
ù
->
öf_cfg
[
k
]);

381 
bønch_t
 *
brk
 = 
ibk
->
bønch
;

383 if–
j
 =
k
 )

387 if–!
	`lo›EquÆ
–
ib
->
bb
, 
ibk
->bb ))

391  
n
 = 0;Ç < 
ibk
->
num_assign
;Ç++ ) {

392 
assign_t
 *
as
 = 
ibk
->
assig∆i°
[
n
];

395 if–
	`°ªq
–
as
->
dîôªe
, 
br
->deritree )) {

396 
ªs
 = 0;

397 
num_nuŒifõrs
 = 0;

398 
assign_t
 **
nuŒifõr_li°
 = 
NULL
;

401 
	`ã°RóchabÀNoC™˚l
–&
ªs
, &
nuŒifõr_li°
, &
num_nuŒifõrs
, 
p
->
id
, 
k
, 
j
, 
br
->
dîôªe
, 
as
,Ö->
cfg
,Ö->
num_bb
 );

403 if–
ªs
 ) {

404 if–
	`isBAC⁄Êi˘
–
as
, 
br
, br->
jump_c⁄d
 )) {

405 
	`£tBAC⁄Êi˘
–
as
, 
br
, 
JUMP
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

407 
num_BA
++;

409 if–
	`isBAC⁄Êi˘
–
as
, 
br
, 
	`√g
–br->
jump_c⁄d
 ))) {

410 
	`£tBAC⁄Êi˘
–
as
, 
br
, 
FALL
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

412 
num_BA
++;

415 
	`‰ì
–
nuŒifõr_li°
 );

422 if–
brk
 =
NULL
 )

426 if–
	`°ªq
–
brk
->
dîôªe
, 
br
->deritree )) {

428 
jump
 = 
p
->
cfg
[
k
].
out_t
->
d°
->
id
;

429 
ÁŒ
 = 
p
->
cfg
[
k
].
out_n
->
d°
->
id
;

432 
ªs
 = 0;

433 
num_nuŒifõrs
 = 0;

434 
assign_t
 **
nuŒifõr_li°
 = 
NULL
;

437 
	`ã°RóchabÀNoC™˚l
–&
ªs
, &
nuŒifõr_li°
, &
num_nuŒifõrs
, 
p
->
id
, 
jump
, 
j
, 
br
->
dîôªe
, 
NULL
,Ö->
cfg
,Ö->
num_bb
 );

439 if–
ªs
 ) {

440 if–
	`isBBC⁄Êi˘
–
brk
, 
br
, brk->
jump_c⁄d
, br->jump_cond )) {

441 
	`£tBBC⁄Êi˘
–
brk
, 
br
, 
JJ
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

443 
num_BB
++;

445 if–
	`isBBC⁄Êi˘
–
brk
, 
br
, brk->
jump_c⁄d
, 
	`√g
( br->jump_cond ))) {

446 
	`£tBBC⁄Êi˘
–
brk
, 
br
, 
JF
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

448 
num_BB
++;

451 
	`‰ì
–
nuŒifõr_li°
 );

453 
ªs
 = 0;

454 
num_nuŒifõrs
 = 0;

455 
nuŒifõr_li°
 = 
NULL
;

458 
	`ã°RóchabÀNoC™˚l
–&
ªs
, &
nuŒifõr_li°
, &
num_nuŒifõrs
, 
p
->
id
, 
ÁŒ
, 
j
, 
br
->
dîôªe
, 
NULL
,Ö->
cfg
,Ö->
num_bb
 );

460 if–
ªs
 ) {

461 if–
	`isBBC⁄Êi˘
–
brk
, 
br
, 
	`√g
–brk->
jump_c⁄d
 ), br->jump_cond )) {

462 
	`£tBBC⁄Êi˘
–
brk
, 
br
, 
FJ
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

464 
num_BB
++;

466 if–
	`isBBC⁄Êi˘
–
brk
, 
br
, 
	`√g
–brk->
jump_c⁄d
 ),Çeg( br->jump_cond ))) {

467 
	`£tBBC⁄Êi˘
–
brk
, 
br
, 
FF
, 
nuŒifõr_li°
, 
num_nuŒifõrs
 );

469 
num_BB
++;

472 
	`‰ì
–
nuŒifõr_li°
 );

481 
	}
}

	@estimate.c

22 
	~"comm⁄.h
"

23 
	~"b¥ed.h
"

24 
	~"pùñöe.h
"

25 
	~"exegøph.h
"

26 
	~"ss/machöe.h
"

27 
	~"ss/ss_machöe.h
"

29 
	#LATE
 0

	)

30 
	#EARLY
 1

	)

31 
	#STEP_SEP
 0

	)

32 
	#STEP_EST
 1

	)

33 
	#MAX_ITERS
 16

	)

34 
	#SHADED
 1

	)

37 
pùe_°ages
;

38 
egøph_node_t
 **
egøph
;

39 
eg_Àn
, 
∂og_Àn
, 
ñog_Àn
, 
body_Àn
;

40 
ønge16_t
 *
c€xi°
;

41 *
eg_ö°_succ
;

42 
eg_chaö_t
 *
eg_chaö
;

43 
mas_ö°_t
 **
eg_ö°s
;

44 
ruu_issue_width
;

45 
ruu_commô_width
;

46 
pùe_iwö_size
;

47 
b¥ed_ty≥
;

50 
	g°ï
 = 
STEP_SEP
;

51 
	gch™ged
;

54 
	gœ°_p
, 
	gœ°_≈
, 
	gfú°_b
, 
	gœ°_b
, 
	gfú°_e
;

58 
dump_egøph_times
(
°¨t
, 
íd
);

61 
check_„tch_times
();

67 
	$öô_shaded_≤ode
(
egøph_edge_t
 *
e
)

69 
hi
, 
°r
, 
fö
;

70 
egøph_node_t
 *
§c
, *
d°
;

72 
§c
 = 
e
->§c; 
d°
 =É->dst;

73 
°r
 = 
d°
->
rdy
.
hi
 - 
e
->
œt
.
lo
;

75 i‡((
§c
->
Êag
 !
SHADED
Ë|| (§c->
°r
.
hi
 > str)) {

76 
§c
->
rdy
.
hi
 = src->
°r
.hi = str;

77 i‡(
§c
->
œt
.
lo
 =
e
->lat.lo)

78 
§c
->
fö
.
hi
 = 
d°
->
rdy
.hi;

79 i‡(
§c
->
Êag
 !
SHADED
)

80 
§c
->
fö
.
hi
 = 
°r
 + src->
œt
.hi;

82 
§c
->
fö
.
hi
 = 
	`mö
(§c->fö.hi, 
°r
 + src->
œt
.hi);

83 i‡(
§c
->
Êag
 !
SHADED
) {

84 
§c
->
Êag
 = 
SHADED
;

85 
§c
->
rdy
.
lo
 = src->
°r
.lÿ§c->
fö
.lÿ-
INFTY
;

87 
e
 = 
§c
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

88 i‡(
e
->
n‹mÆ
 =
EG_NORM_EDGE
)

89 
	`öô_shaded_≤ode
(
e
);

92 
	}
}

97 
	$ª£t_nodes_Êags
(
fú°
, 
œ°
)

99 
ö°
, 
°age
, 
evít
;

101 
ö°
 = 
fú°
; in° <
œ°
; inst++) {

102 
°age
 = 0; sègê< 
pùe_°ages
; stage++)

103 
egøph
[
ö°
][
°age
].
Êag
 = 0;

105 
	}
}

112 
	$öô_£p
()

114 
ö°
, 
°age
;

115 
egøph_node_t
 *
vb
, *
v
;

116 
egøph_edge_t
 *
e
;

119 
vb
 = &
egøph
[
fú°_b
][0];

120 
vb
->
rdy
.
lo
 = vb->rdy.
hi
 = 0;

121 
vb
->
°r
.
lo
 = vb->
fö
.lo = 0;

122 
vb
->
°r
.
hi
 = vb->
fö
.hò
INFTY
;

123 
e
 = 
vb
->
ö
;É !
NULL
;É =É->
√xt_ö
)

124 
	`öô_shaded_≤ode
(
e
);

126 
ö°
 = 0; in° < 
eg_Àn
; inst++) {

127 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

128 
v
 = &
egøph
[
ö°
][
°age
];

129 i‡((
v
->
Êag
 =
SHADED
Ë|| (v =
vb
))

131 i‡(
v
->
ö°
 >
fú°_b
) {

132 
v
->
rdy
.
lo
 = v->
°r
.lo = 0;

133 
v
->
fö
.
lo
 = v->
œt
.lo;

135 
v
->
rdy
.
lo
 = v->
°r
.lÿv->
fö
.lÿ-
INFTY
;

137 
v
->
rdy
.
hi
 = v->
°r
.hòv->
fö
.hò
INFTY
;

140 
	}
}

145 
	$lc⁄td_dñay
(
egøph_node_t
 *
v
)

147 
√w_hi
, 
tmp
;

148 
egøph_node_t
 *
u
;

149 
egøph_edge_t
 *
e
;

151 i‡(
v
->
l_c⁄td
 =
NULL
)

152  
v
->
rdy
.
hi
;

154 i‡(
v
->
ö°
 >
fú°_e
) {

155 i‡(
v
->
œt
.
hi
 > 1)

156  
v
->
rdy
.
hi
 + v->
œt
.hi - 1;

159 
√w_hi
 = 
v
->
rdy
.
hi
;

160 
e
 = 
v
->
l_c⁄td
;É !
NULL
;É =É->
√xt_out
) {

161 i‡(
e
->
c⁄td_ty≥
 !
BI_DELAY
)

163 
u
 = 
e
->
d°
;

164 
tmp
 = 
	`mö
(
u
->
fö
.
hi
, 
v
->
rdy
.hò+ u->
œt
.hi - 1);

165 
√w_hi
 = 
	`max
“ew_hi, 
tmp
);

167  
√w_hi
;

168 
	}
}

173 
	$ec⁄td_dñay
(
egøph_node_t
 *
v
, 
√w_hi
)

175 
egøph_node_t
 *
u
;

176 
egøph_edge_t
 *
e
;

177 
max_u
 = 
√w_hi
, 
sum_d
 = 0;

179 i‡(
v
->
e_c⁄td
 =
NULL
)

180  
√w_hi
;

182 
e
 = 
v
->
e_c⁄td
;É !
NULL
;É =É->
√xt_ö
) {

183 i‡(
e
->
c⁄td_ty≥
 =
NO_DELAY
)

185 
u
 = 
e
->
§c
;

186 i‡(
u
->
fö
.
hi
 <
√w_hi
)

188 
sum_d
 +
	`mö
(
u
->
fö
.
hi
 - 
√w_hi
, u->
œt
.hi);

189 
max_u
 = 
	`max
(max_u, 
u
->
fö
.
hi
);

191 
√w_hi
 = 
	`mö
(
max_u
,Çew_hò+ 
sum_d
 / 
v
->
num_fu
);

192  
√w_hi
;

193 
	}
}

198 
	$sˇœr_dñay
(
egøph_node_t
 *
v
, 
√w_hi
)

202 
	#PEERS_WIN
 6

	)

203 
ö°
, 
i
, 
d
, 
ª°_≥îs
, 
mª°
, 
tmp
;

211 
≥îs
[
PEERS_WIN
], 
m≥îs
[PEERS_WIN];

212 
egøph_node_t
 *
u
, *
um
;

214 
i
 = 0; i < 
PEERS_WIN
; i++)

215 
≥îs
[
i
] = 
m≥îs
[i] = 0;

218 
ö°
 = 
v
->inst;

219 
i
 = 1; i < 
pùe_iwö_size
 - 1; i++) {

220 
ö°
 = 
eg_chaö
[ö°].
¥ed
;

221 i‡(
ö°
 < 0)

223 
u
 = &
egøph
[
ö°
][
v
->
°age
];

224 
d
 = 
u
->
°r
.
hi
 - 
√w_hi
;

225 i‡(
d
 < 0) {

226 i‡((
u
->
fu
 =
RdP‹t
Ë|| (u->fu =
WrP‹t
)) {

227 
um
 = &
egøph
[
ö°
][
u
->
°age
+1];

228 
d
 = 
um
->
°r
.
hi
 - 
√w_hi
;

229 i‡(
d
 >= 0) {

230 
d
 = 
	`mö
(d, 
PEERS_WIN
-1);

231 
≥îs
[
d
]++;

235 
d
 = 
	`mö
(d, 
PEERS_WIN
-1);

236 i‡((
u
->
fu
 =
RdP‹t
Ë|| (u->fu =
WrP‹t
))

237 
m≥îs
[
d
]++;

239 
≥îs
[
d
]++;

242 
d
 = 
PEERS_WIN
-1; d > 0; d--) {

243 
≥îs
[
d
-1] +=Öeers[d];

244 
m≥îs
[
d
-1] += mpeers[d];

246 
ª°_≥îs
 = 
≥îs
[0] + 
m≥îs
[0];

247 
mª°
 = 0;

248 
d
 = 0; d < 
PEERS_WIN
-1; d++) {

249 i‡((
ª°_≥îs
 + 
mª°
Ë< 
ruu_issue_width
)

250  
√w_hi
 + 
d
;

251 
tmp
 = 
ª°_≥îs
;

252 
ª°_≥îs
 =Ñe°_≥î†- 
	`max
(
ruu_issue_width
 - 
mª°
, 0);

253 
ª°_≥îs
 = 
	`mö
‘e°_≥îs, 
≥îs
[
d
+1] + 
m≥îs
[d+1]);

254 
mª°
 = 
	`mö
(
m≥îs
[
d
], 
tmp
Ë- mö(m≥îs[d+1], 
ª°_≥îs
);

256 
√w_hi
 +
d
 + (
ª°_≥îs
 + 
	`mö
(
m≥îs
[d],Ñe°_≥îsË+ 
mª°
Ë/ 
ruu_issue_width
;

257  
√w_hi
;

258 
	}
}

263 
	$„tch_dï
(
egøph_edge_t
 *
e
)

265  
	`mö
(
e
->
§c
->
°r
.
hi
 +É->
œt
.hi,É->§c->
fö
.hi);

266 
	}
}

271 
	$œã°_time
(
egøph_node_t
 *
v
)

273 
√w_hi
;

274 
egøph_node_t
 *
u
;

275 
egøph_edge_t
 *
e
;

277 i‡(
v
->
ö
 =
NULL
) {

278 i‡((
v
->
l_c⁄td
 =
NULL
Ë&& v->
°r
.
hi
 !v->
rdy
.hi) {

279 
v
->
°r
.
hi
 = v->
rdy
.hi;

280 
v
->
fö
.
hi
 = v->
°r
.hò+ v->
œt
.hi;

285 
√w_hi
 = -
INFTY
;

286 
e
 = 
v
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

288 i‡(
v
->
°age
 =0 && 
e
->
§c
->stage == 0)

289 
√w_hi
 = 
	`max
“ew_hi, 
	`„tch_dï
(
e
));

291 
√w_hi
 = 
	`max
“ew_hi, 
e
->
§c
->
°r
.
hi
 +É->
œt
.hi);

293 
u
 = &
egøph
[0][
pùe_°ages
-1];

294 i‡((
∂og_Àn
 > 0Ë&& (
v
->
ö°
 > 0Ë&& 
c€xi°
[v->ö°].
lo
 == 0)

295 
v
->
rdy
.
hi
 = 
	`max
(v->rdy.hi, 
u
->rdy.hi - 1);

297 
v
->
rdy
.
hi
 = 
√w_hi
;

298 i‡(
v
->
fu
 != 0) {

299 i‡(
v
->
œt
.
hi
 > 1) {

300 i‡(
v
->
ö°
 >
fú°_e
)

301 
√w_hi
 +
v
->
œt
.
hi
 - 1;

303 
√w_hi
 = 
	`lc⁄td_dñay
(
v
);

305 
√w_hi
 = 
	`ec⁄td_dñay
(
v
,Çew_hi);

308 i‡(
v
->
°age
 =
STAGE_EX
)

309 
√w_hi
 = 
	`sˇœr_dñay
(
v
,Çew_hi);

310 i‡(
√w_hi
 < 
v
->
°r
.
hi
) {

311 
v
->
°r
.
hi
 = 
√w_hi
;

312 
v
->
fö
.
hi
 = 
√w_hi
 + v->
œt
.hi;

313 
ch™ged
 = 1;

314 i‡((
v
->
e_c⁄td
 !
NULL
Ë|| (v->
l_c⁄td
 != NULL))

318 
	}
}

323 
	$óæõ°_time
(
egøph_node_t
 *
v
)

325 
√w_lo
;

326 
egøph_edge_t
 *
e
;

328 i‡(
v
->
ö
 =
NULL
)

331 
√w_lo
 = -
INFTY
;

332 
e
 = 
v
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

333 i‡(
e
->
n‹mÆ
 !
EG_NORM_EDGE
)

335 
√w_lo
 = 
	`max
“ew_lo, 
e
->
§c
->
°r
.
lo
 +É->
œt
.lo);

337 i‡(
√w_lo
 > 
v
->
rdy
.
lo
) {

338 
v
->
rdy
.
lo
 = v->
°r
.lÿ
√w_lo
;

339 
v
->
fö
.
lo
 = 
√w_lo
 + v->
œt
.lo;

340 
ch™ged
 = 1;

344 
	}
}

354 
	$upd©e_c⁄td
(
egøph_node_t
 *
v
)

356 
egøph_node_t
 *
u
;

357 
egøph_edge_t
 *
e
;

359 
e
 = 
v
->
e_c⁄td
;É !
NULL
;É =É->
√xt_ö
) {

360 i‡(
e
->
c⁄td_ty≥
 =
NO_DELAY
)

362 
u
 = 
e
->
§c
;

363 i‡((
v
->
rdy
.
lo
 >
u
->
fö
.
hi
) || (u->rdy.lo >= v->fin.hi))

364 
e
->
c⁄td_ty≥
 = 
NO_DELAY
;

365 i‡(
v
->
°r
.
lo
 >
u
->
rdy
.
hi
)

366 
e
->
c⁄td_ty≥
 = 
UNI_DELAY
;

368 
e
 = 
v
->
l_c⁄td
;É !
NULL
;É =É->
√xt_out
) {

369 i‡(
e
->
c⁄td_ty≥
 =
NO_DELAY
)

371 
u
 = 
e
->
d°
;

372 i‡((
v
->
rdy
.
lo
 >
u
->
fö
.
hi
) || (u->rdy.lo >= v->fin.hi))

373 
e
->
c⁄td_ty≥
 = 
NO_DELAY
;

374 i‡(
u
->
°r
.
lo
 >
v
->
rdy
.
hi
)

375 
e
->
c⁄td_ty≥
 = 
UNI_DELAY
;

377 
	}
}

382 
	$föd_£p
()

384 
ö°
, 
°age
, 
ech™ged
, 
lch™ged
;

385 
egøph_node_t
 *
v
;

387 
	`öô_£p
();

389 
ch™ged
 = 0;

390 
ö°
 = 0; in° < 
eg_Àn
; inst++) {

391 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

392 
v
 = &
egøph
[
ö°
][
°age
];

393 i‡(
ö°
 >
fú°_b
)

394 
ech™ged
 = 
	`óæõ°_time
(
v
);

395 
lch™ged
 = 
	`œã°_time
(
v
);

396 i‡(
ech™ged
 || 
lch™ged
)

397 
	`upd©e_c⁄td
(
v
);

400 } 
ch™ged
);

401 
	}
}

406 
	$∂og_backåack
(
egøph_edge_t
 *
e
)

408 
°r
, 
fö
, 
ö°
, 
°age
;

409 
egøph_node_t
 *
§c
, *
d°
, *
v
;

410 
egøph_edge_t
 *
e1
;

412 i‡(
e
->
n‹mÆ
 =
EG_COND_EDGE
)

415 
§c
 = 
e
->§c; 
d°
 =É->dst;

416 
§c
->
rdy
.
lo
 = src->
°r
.lÿ§c->
fö
.lÿ-
INFTY
;

419 
°r
 = 
d°
->
rdy
.
hi
 - 
e
->
œt
.
lo
;

421 i‡(
§c
->
°r
.
hi
 > str) {

422 
§c
->
rdy
.
hi
 = src->
°r
.hi = str;

423 i‡(
§c
->
œt
.
lo
 =
e
->lat.lo)

424 
§c
->
fö
.
hi
 = 
d°
->
rdy
.hi;

426 
§c
->
fö
.
hi
 = 
	`mö
(§c->fö.hi, 
°r
 + src->
œt
.hi);

429 i‡((
eg_chaö
[
§c
->
ö°
].
succ
 > src->ö° + 1Ë&& src->
°age
 == 3) {

430 
ö°
 = 
§c
->ö°+1; in° < 
eg_chaö
[§c->ö°].
succ
; inst++) {

431 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

432 
v
 = &
egøph
[
ö°
][
°age
];

433 
v
->
rdy
.
hi
 = v->
°r
.hòv->
fö
.hò
§c
->fin.hi;

437 
e
 = 
§c
->
ö
;É !
NULL
;É =É->
√xt_ö
)

438 
	`∂og_backåack
(
e
);

440 
	}
}

447 
	$öô_e°_∂og
()

449 
ö°
, 
°age
, 
i
;

450 
egøph_node_t
 *
v
;

451 
egøph_edge_t
 *
e
;

454 
ö°
 = 0; in° <
œ°_p
; inst++) {

455 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

456 
v
 = &
egøph
[
ö°
][
°age
];

457 
v
->
rdy
.
lo
 = v->
°r
.lÿ-
INFTY
;

458 
v
->
rdy
.
hi
 = v->
°r
.hi = 0;

461 
v
 = &
egøph
[
œ°_≈
][
pùe_°ages
-1];

462 
v
->
fö
.
hi
 = v->fö.
lo
 = 0;

463 
v
->
rdy
.
lo
 = -
INFTY
;

464 
v
->
°r
.
lo
 = 0 - v->
œt
.
hi
;

465 
v
->
rdy
.
hi
 = v->
°r
.hò0 - v->
œt
.
lo
;

466 
e
 = 
v
->
ö
;É !
NULL
;É =É->
√xt_ö
)

467 
	`∂og_backåack
(
e
);

469 i‡(
b¥ed_ty≥
 =
BP_CPRED
)

472 
ö°
 = 
œ°_≈
 + 1; in° <
œ°_p
; inst++) {

473 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

474 
v
 = &
egøph
[
ö°
][
°age
];

475 
v
->
rdy
.
hi
 = v->
°r
.hòv->
fö
.hò
egøph
[
œ°_≈
][3].fin.hi;

478 
	}
}

483 
	$öô_e°_body
()

485 
ö°
, 
°age
;

486 
egøph_node_t
 *
v
;

489 
ö°
 = 
fú°_b
; in° < 
eg_Àn
; inst++) {

490 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

491 
v
 = &
egøph
[
ö°
][
°age
];

492 
v
->
rdy
.
lo
 = v->
°r
.lo = 0;

493 
v
->
rdy
.
hi
 = v->
°r
.hò
INFTY
;

496 
	}
}

503 
	$di°™˚
(
egøph_node_t
 *
v
,Égøph_node_à*
u
)

505 
Àn
 = 0, 
tmp
;

506 
egøph_edge_t
 *
e
;

508 i‡(
v
 =
u
)

511 
e
 = 
v
->
out
;É !
NULL
;É =É->
√xt_out
) {

512 i‡(
e
->
d°
->
ö°
 > 
u
->inst)

514 
tmp
 = 
e
->
œt
.
lo
 + 
	`di°™˚
”->
d°
, 
u
);

515 i‡(
tmp
 > 
Àn
)

516 
Àn
 = 
tmp
;

518  
Àn
;

519 
	}
}

526 
	$mö_ovîœp
(
egøph_node_t
 *
v
,Égøph_node_à*
u
)

528 
d
, 
mo
 = 
INFTY
;

529 
egøph_edge_t
 *
e
;

531 
e
 = 
v
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

532 
d
 = 
	`di°™˚
(
e
->
§c
, 
u
Ë-É->
œt
.
hi
;

533 i‡(
d
 < 
mo
)

534 
mo
 = 
d
;

536  
mo
;

537 
	}
}

542 
	$öô_e°
()

544 
	`öô_e°_∂og
();

545 
	`öô_e°_body
();

546 
	}
}

552 
	$make_e°
()

554 
ö°
, 
°age
;

555 
egøph_node_t
 *
v
;

557 
	`öô_e°
();

559 
ch™ged
 = 0;

560 
ö°
 = 
fú°_b
; in° < 
eg_Àn
; inst++) {

561 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

562 
v
 = &
egøph
[
ö°
][
°age
];

563 
	`óæõ°_time
(
v
);

564 
	`œã°_time
(
v
);

567 } 
ch™ged
);

568 
	}
}

573 
	$e°_egøph
()

575 
tm
, 
mö_ov
;

576 
egøph_node_t
 *
v
, *
u
, *
w
;

578 
fú°_b
 = 
∂og_Àn
;

579 
œ°_p
 = 
fú°_b
 - 1;

580 
œ°_≈
 = 
eg_chaö
[
fú°_b
].
¥ed
;

581 
fú°_e
 = 
∂og_Àn
 + 
body_Àn
;

582 
œ°_b
 = 
fú°_e
 - 1;

584 
	`föd_£p
();

589 
v
 = &
egøph
[
œ°_b
][
pùe_°ages
-1];

590 
tm
 = 
v
->
°r
.
hi
 + v->
œt
.hi;

592 i‡(
∂og_Àn
 == 0)

593  
tm
;

595 
u
 = &
egøph
[
fú°_b
][0];

596 
w
 = &
egøph
[
œ°_≈
][
pùe_°ages
-1];

597 
mö_ov
 = 
	`mö_ovîœp
(
w
, 
u
);

598 
tm
 -
mö_ov
;

599 
	`make_e°
();

600 
tm
 = 
	`mö
—m, 
v
->
°r
.
hi
 + v->
œt
.hi);

601  
tm
;

602 
	}
}

607 
	$check_„tch_times
()

609 
ö°
, 
t1
, 
t2
;

611 
ö°
 = 1; in° < 
eg_Àn
; inst++) {

612 
t1

egøph
[
ö°
-1][0].
°r
.
hi
 +Égøph[ö°-1][0].
œt
.hi;

613 
t2

egøph
[
ö°
][0].
°r
.
hi
 +Égøph[ö°][0].
œt
.hi;

614 i‡(
t1
 > 
t2
)

615 
	`¥ötf
("IF[%d]: %d %d\n", 
ö°
-1, 
t1
, 
t2
);

617 
	}
}

622 
	$dump_egøph_times
(
°¨t
, 
íd
)

624 
ö°
, 
°age
;

625 
egøph_node_t
 *
v
;

627 i‡((
°¨t
 =0Ë&& (
íd
 == 0))

628 
íd
 = 
∂og_Àn
 + 
body_Àn
 + 
ñog_Àn
;

629 
	`¥ötf
("dumpÉxecution graphÅimes [%d %d]: %d, %d, %d\n",

630 
°¨t
, 
íd
, 
∂og_Àn
, 
body_Àn
, 
ñog_Àn
);

631 
ö°
 = 
°¨t
; in° < 
íd
; inst++) {

632 i‡((
ö°
 =
fú°_b
Ë|| (ö° =
fú°_e
))

633 
	`¥ötf
("----------------------------------------------------------\n");

634 
	`¥ötf
("%3d[%x]", 
ö°
, 
eg_ö°s
[ö°]->ö°->
addr
 & 0xffff);

635 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
)

636 
	`¥ötf
("c");

637 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_MPRED
)

638 
	`¥ötf
("m");

640 
	`¥ötf
("u");

641 i‡((
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_HIT
Ë|| (
egøph
[ö°][0].
œt
.
hi
 == 1))

642 
	`¥ötf
("/H");

643 i‡(
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_MISS
)

644 
	`¥ötf
("/M");

646 
	`¥ötf
("/U");

647 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

648 
v
 = &
egøph
[
ö°
][
°age
];

649 
	`¥ötf
(" * %3d %3d %3d", 
v
->
rdy
.
hi
, v->
°r
.hi, v->
fö
.hi);

651 
	`¥ötf
("\n");

653 
	`¥ötf
("\n");

654 
	}
}

659 
	$dump_egøph_óæõ°
(
°¨t
, 
íd
)

661 
ö°
, 
°age
, 
evít
;

662 
egøph_node_t
 *
v
;

664 i‡((
°¨t
 =0Ë&& (
íd
 == 0))

665 
íd
 = 
∂og_Àn
 + 
body_Àn
 + 
ñog_Àn
;

666 
	`¥ötf
("dum∞executi⁄ gøph EARLIEST [%d %d]: %d, %d, %d\n", 
°¨t
, 
íd
,

667 
∂og_Àn
, 
body_Àn
, 
ñog_Àn
);

668 
ö°
 = 
°¨t
; in° < 
íd
; inst++) {

669 i‡((
ö°
 =
fú°_b
Ë|| (ö° =
fú°_e
))

670 
	`¥ötf
("------------------------------------------------------------------------\n");

671 
	`¥ötf
("%3d[%x]", 
ö°
, 
eg_ö°s
[ö°]->ö°->
addr
 & 0xffff);

672 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
)

673 
	`¥ötf
("c");

674 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_MPRED
)

675 
	`¥ötf
("m");

677 
	`¥ötf
("u");

678 i‡((
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_HIT
Ë|| (
egøph
[ö°][0].
œt
.
hi
 == 1))

679 
	`¥ötf
("/H");

680 i‡(
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_MISS
)

681 
	`¥ötf
("/M");

683 
	`¥ötf
("/U");

684 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

685 
v
 = &
egøph
[
ö°
][
°age
];

686 
	`¥ötf
(" * %3d %3d %3d", 
v
->
rdy
.
lo
, v->
°r
.lo, v->°r.lÿ+ v->
œt
.lo);

688 
	`¥ötf
("\n");

690 
	`¥ötf
("\n");

691 
	}
}

695 
	$dump_ec⁄td
(
egøph_node_t
 *
v
)

697 
egøph_edge_t
 *
e
;

699 
	`¥ötf
("ec⁄td[%d]\n", 
v
->
ö°
);

700 
e
 = 
v
->
e_c⁄td
;É !
NULL
;É =É->
√xt_ö
) {

701 
	`¥ötf
("<-[%d]: %d\n", 
e
->
§c
->
ö°
,É->
c⁄td_ty≥
);

703 
	}
}

	@exegraph.c

23 
	~<°dlib.h
>

24 
	~"comm⁄.h
"

25 
	~"lo›s.h
"

26 
	~"b¥ed.h
"

27 
	~"ˇche.h
"

28 
	~"pùñöe.h
"

29 
	~"exegøph.h
"

32 *
num_mp_ö°s
;

33 
pùe_°ages
;

35 
mas_ö°_t
 **
	geg_ö°s
;

36 
egøph_node_t
 **
	gegøph
;

37 
	geg_Àn
 = 0, 
	g∂og_Àn
 = 0, 
	gñog_Àn
 = 0, 
	gbody_Àn
 = 0;

39 
egøph_edge_t
 *
	gegøph_edges
 = 
NULL
;

40 
	gnum_eg_edges
 = 0;

44 
ønge16_t
 *
	gc€xi°
;

50 
eg_chaö_t
 *
	geg_chaö
;

52 
	gb¥ed_ty≥
;

53 
lo›_t
 *
	gbody_lo›
;

58 
dump_egøph
();

63 
	$Æloc_mem
()

65 
i
;

67 
egøph_edges
 = (
egøph_edge_t
 *Ë
	`ˇŒoc
(
MAX_EG_EDGES
, (egraph_edge_t));

68 
eg_ö°s
 = (
mas_ö°_t
 **Ë
	`ˇŒoc
(
MAX_EG_LEN
, (mas_inst_t *));

69 
egøph
 = (
egøph_node_t
 **Ë
	`ˇŒoc
(
MAX_EG_LEN
, (egraph_node_t *));

70 
i
 = 0; i < 
MAX_EG_LEN
; i++)

71 
egøph
[
i
] = (
egøph_node_t
 *Ë
	`ˇŒoc
(
pùe_°ages
, (egraph_node_t));

72 
c€xi°
 = (
ønge16_t
 *Ë
	`ˇŒoc
(
MAX_EG_LEN
, (range16_t));

73 
eg_chaö
 = (
eg_chaö_t
 *Ë
	`ˇŒoc
(
MAX_EG_LEN
, (eg_chain_t));

74 
	}
}

103 
	$¸óã_egøph
(
mas_ö°_t
 *
∂og
, 
≈
, mas_ö°_à*
ñog
, 
√
,

104 
mas_ö°_t
 *
body
, 
nb
, 
bp
, 
lo›_t
 *
Õ
)

106 
i
, 
n
;

107 
fú°
 = 1;

109 
∂og_Àn
 = 
≈
;

110 
ñog_Àn
 = 
√
;

111 
body_Àn
 = 
nb
;

112 
eg_Àn
 = 
≈
 + 
√
 + 
nb
;

113 
b¥ed_ty≥
 = 
bp
;

114 
body_lo›
 = 
Õ
;

116 i‡(
fú°
) {

117 
	`Æloc_mem
();

118 
fú°
 = 0;

122 
i
 = 0; i < 
∂og_Àn
; i++)

123 
eg_ö°s
[
i
] = &
∂og
[i];

124 
n
 = 
∂og_Àn
;

125 
i
 = 0; i < 
body_Àn
; i++)

126 
eg_ö°s
[
i
+
n
] = &
body
[i];

127 
n
 +
body_Àn
;

128 
i
 = 0; i < 
ñog_Àn
; i++)

129 
eg_ö°s
[
i
+
n
] = &
ñog
[i];

131 
	`¸óã_egøph_ss
();

134 
	}
}

139 
	$dump_egøph_dïíds
(
ö°
)

141 
egøph_node_t
 *
n1
, *
n2
;

142 
egøph_edge_t
 *
e
;

143 
°age
;

145 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

146 
	`¥ötf
(" sège[%d]: in:", 
°age
);

147 
n1
 = &
egøph
[
ö°
][
°age
];

148 
e
 = 
n1
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

149 i‡(
e
->
n‹mÆ
 =
EG_COND_EDGE
)

150 
	`¥ötf
("*");

151 
n2
 = 
e
->
§c
;

152 
	`¥ötf
(" %d.%d(%d)", 
n2
->
ö°
,Ç2->
°age
, 
e
->
œt
.
hi
);

154 
	`¥ötf
("; out:");

155 
e
 = 
n1
->
out
;É !
NULL
;É =É->
√xt_out
) {

156 i‡(
e
->
n‹mÆ
 =
EG_COND_EDGE
)

157 
	`¥ötf
("*");

158 
n2
 = 
e
->
d°
;

159 
	`¥ötf
(" %d.%d", 
n2
->
ö°
,Ç2->
°age
, 
e
->
œt
.
hi
);

161 
	`¥ötf
("\n");

163 
	}
}

168 
	$dump_egøph_c⁄ãnds
(
ö°
)

170 
egøph_node_t
 *
n1
, *
n2
;

171 
egøph_edge_t
 *
e
;

172 
°age
;

174 
	`¥ötf
(" E_CONTEND:");

175 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

176 
n1
 = &
egøph
[
ö°
][
°age
];

177 
e
 = 
n1
->
e_c⁄td
;É !
NULL
;É =É->
√xt_ö
) {

178 
n2
 = 
e
->
§c
;

179 
	`¥ötf
(" %d.%d", 
n2
->
ö°
,Ç2->
°age
);

180 i‡(
e
->
n‹mÆ
 =
EG_COND_EDGE
)

181 
	`¥ötf
("*");

184 
	`¥ötf
("\n L_CONTEND:");

185 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

186 
n1
 = &
egøph
[
ö°
][
°age
];

187 
e
 = 
n1
->
l_c⁄td
;É !
NULL
;É =É->
√xt_out
) {

188 
n2
 = 
e
->
d°
;

189 
	`¥ötf
(" %d.%d", 
n2
->
ö°
,Ç2->
°age
);

190 i‡(
e
->
n‹mÆ
 =
EG_COND_EDGE
)

191 
	`¥ötf
("*");

194 
	`¥ötf
("\n");

195 
	}
}

200 
	$dump_egøph
()

202 
ö°
;

204 
	`¥ötf
("\√xe¯gøph: [P=%d; B=%d; E=%d]\n", 
∂og_Àn
, 
body_Àn
, 
ñog_Àn
);

205 
	`¥ötf
("#edges: %d;ávg: %d\n", 
num_eg_edges
,Çum_eg_edges/
eg_Àn
);

206 
ö°
 = 0; in° < 
eg_Àn
; inst++) {

207 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_MPRED
)

208 
	`¥ötf
("ö°[%d]:%x(m)\n", 
ö°
, 
eg_ö°s
[ö°]->ö°->
addr
);

209 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_UNCLEAR
)

210 
	`¥ötf
("ö°[%d]:%x(u)\n", 
ö°
, 
eg_ö°s
[ö°]->ö°->
addr
);

212 
	`¥ötf
("ö°[%d]:%x \n", 
ö°
, 
eg_ö°s
[ö°]->ö°->
addr
);

214 
	`dump_egøph_dïíds
(
ö°
);

215 
	`dump_egøph_c⁄ãnds
(
ö°
);

217 
	}
}

	@exegraph.h

22 #i‚de‡
EXE_GRAPH_H


23 
	#EXE_GRAPH_H


	)

26 
	~"comm⁄.h
"

27 
	~"b¥ed.h
"

28 
	~"ˇche.h
"

29 
	~"pùñöe.h
"

31 
	#MAX_EG_LEN
 1000

	)

32 
	#MAX_EG_EDGES
 20000

	)

35 íum { 
	mEG_NORM_EDGE
, 
	mEG_COND_EDGE
 };

40 íum { 
	mBI_DELAY
, 
	mUNI_DELAY
, 
	mNO_DELAY
 };

46 íum { 
	mEG_DEP_NONE
, 
	mEG_DEP_NORM
, 
	mEG_DEP_COND
 };

50 
egøph_edge_t
 
	tegøph_edge_t
;

53 
	mö°
, 
	m°age
;

54 
	mfu
, 
	mnum_fu
;

55 
ønge16_t
 
	mœt
;

56 
ønge_t
 
	mrdy
, 
	m°r
, 
	mfö
;

57 
	mbp_ty≥
;

58 
	mÊag
;

59 
egøph_edge_t
 *
	mö
, *
	mout
;

60 
egøph_edge_t
 *
	me_c⁄td
, *
	ml_c⁄td
;

61 } 
	tegøph_node_t
;

64 
	segøph_edge_t
 {

65 
egøph_node_t
 *
	m§c
, *
	md°
;

66 
ønge16_t
 
	mœt
;

68 
	mn‹mÆ
;

73 
	mc⁄td_ty≥
;

74 
egøph_edge_t
 *
	m√xt_ö
, *
	m√xt_out
;

80 
	m¥ed
;

81 
	msucc
;

82 } 
	teg_chaö_t
;

	@fir.c

14 
	#LOOPS
 1

	)

20 
	gfú_öt
[36]={

26 
	gö_d©a
[701]={

99 
	gout_d©a
[720]={

173 
	#OUTSIZE
 720

	)

182 
fú_fûãr_öt
(* 
ö
,* 
out
,
ö_Àn
,

183 * 
c€f
,
c€f_Àn
,

184 
sˇÀ
);

190 
	$maö
()

192 
ouçut
[
OUTSIZE
];

194 
	`fú_fûãr_öt
(
ö_d©a
,
ouçut
,700,
fú_öt
,35,285);

204 
	}
}

228 
	$fú_fûãr_öt
(* 
ö
,* 
out
,
ö_Àn
,

229 * 
c€f
,
c€f_Àn
,

230 
sˇÀ
)

232 
i
,
j
,
c€f_Àn2
,
acc_Àngth
;

233 
acc
;

234 *
ö_±r
,*
d©a_±r
,*
c€f_°¨t
,*
c€f_±r
,*
ö_íd
;

237 
c€f_°¨t
 = 
c€f
;

238 
c€f_Àn2
 = (
c€f_Àn
 + 1) >> 1;

241 
ö_íd
 = 
ö
 + 
ö_Àn
 - 1;

242 
ö_±r
 = 
ö
 + 
c€f_Àn2
 - 1;

245 
acc_Àngth
 = 
c€f_Àn2
;

247 
i
 = 0 ; i < 
ö_Àn
 ; i++) {

250 
d©a_±r
 = 
ö_±r
;

251 
c€f_±r
 = 
c€f_°¨t
;

255 
acc
 = ()(*
c€f_±r
++Ë* (*
d©a_±r
--);

256 
j
 = 1 ; j < 
acc_Àngth
 ; j++)

258 
acc
 +()(*
c€f_±r
++Ë* (*
d©a_±r
--);

259 
	`¥ötf
("ThisÜoopÉncountered\n");

261 *
out
++ = ()(
acc
/
sˇÀ
);

265 if(
ö_±r
 =
ö_íd
) {

266 
acc_Àngth
--;

267 
c€f_°¨t
++;

273 if(
acc_Àngth
 < 
c€f_Àn
)ácc_length++;

274 
ö_±r
++;

277 
	}
}

	@ilp.c

67 
	~<°rög.h
>

68 
	~<°dlib.h
>

69 
	~"tcfg.h
"

70 
	~"lo›s.h
"

71 
	~"b¥ed.h
"

72 
	~"ˇche.h
"

73 
	~"pùñöe.h
"

76 
PROGRESS_STEP
;

78 
	#NOSIGN
 0

	)

79 
	#PLUS
 1

	)

80 
	#MINUS
 2

	)

81 
	#NO_PREFIX
 ""

	)

82 
	#NO_SUFFIX
 ""

	)

83 
	#BMP
 5

	)

85 
	#IC_NONE
 
IC_UNCLEAR


	)

88 
tcfg_∆ök_t
 ***
bbi_m≠
;

89 **
˝ªd_times
, **
m¥ed_times
, 
°¨t_time
;

90 *
num_hô_miss
;

91 
tcfg_edge_t
 **
tcfg_edges
;

92 
íabÀ_iˇche
;

94 
íabÀ_dˇche
;

96 
íabÀ_abs_ö°_ˇche
;

97 
b¥ed_scheme
;

98 
num_tcfg_edges
;

99 
num_tcfg_nodes
;

100 
tcfg_node_t
 **
tcfg
;

101 
bfg_node_t
 
°¨t_bbb
, 
íd_bbb
;

102 
num_bbi_bbb
;

103 
bfg_node_t
 ***
bfg
, **
vbbb
;

104 
roŸ_bbb_id
, 
íd_bbb_id
;

105 
num_bfg_nodes
;

106 
btg_edge_t
 **
btg_out
, **
btg_ö
;

107 
num_tcfg_lo›s
;

108 
BHT_SIZE
;

109 
ˇche_t
 
ˇche
;

110 ***
hô_miss
;

111 
iˇche_™Æy_mëhod
;

112 
lo›_t
 **
lo›_m≠
;

113 
lo›_t
 **
lo›s
;

114 
lo›_t
 ***
mblk_hô_lo›
;

115 
lo›_t
 ***
bbi_hm_li°
;

116 *
num_mblks
;

117 
lo›_t
 ***
lo›_comm_™˚s
;

118 
mem_blk_t
 **
gí
;

121 
FILE
 *
	gfûp
, *
	gfu§
;

122 
	gtŸÆ_c⁄s
 = 0, 
	gtŸÆ_v¨s
 = 0;

123 
	g°¨t_°r
[] = "Sè", 
	gíd_°r
[] = "End";

125 
	#NUM_VAR_GRP
 256

	)

126 
	#VAR_GRP_SIZE
 1024

	)

127 **
	gv¨_gΩs
[256];

128 
	gcuº_gΩ
 = 0, 
	gcuº_idx
 = 0;

129 
	g°r
[32], 
	gãrm
[32];

132 
¥og_t
 
¥og
;

136 
	$öô_v¨_gΩs
()

138 
v¨_gΩs
[0] = (**Ë
	`ˇŒoc
(
VAR_GRP_SIZE
, (*));

139 
	}
}

144 
	$add_v¨
(*
v¨
)

146 
Àn
 = 
	`°æí
(
v¨
) + 1;

148 i‡(
cuº_idx
 =
VAR_GRP_SIZE
) {

149 
v¨_gΩs
[++
cuº_gΩ
] = (**Ë
	`ˇŒoc
(
VAR_GRP_SIZE
, (*));

150 
cuº_idx
 = 0;

152 
v¨_gΩs
[
cuº_gΩ
][
cuº_idx
] = (*Ë
	`mÆloc
(
Àn
);

153 
	`°r˝y
(
v¨_gΩs
[
cuº_gΩ
][
cuº_idx
], 
v¨
);

154 
cuº_idx
++;

155 
	}
}

160 
	$√w_ãrm
(
FILE
 *
Â
)

162 i‡(
Â
 =
NULL
)

163 
	`add_v¨
(
ãrm
);

165 
	`Ârötf
(
Â
, "%s", 
ãrm
);

166 
	}
}

170 
	$tcfg_node_°r
(
tcfg_node_t
 *
bbi
)

172 
	`•rötf
(
°r
, "%d", 
bbi
->
id
);

173 
	}
}

179 
	$tcfg_node_ãrm
(
FILE
 *
Â
, 
tcfg_node_t
 *
bbi
, *
¥efix
, *
suffix
)

181 
	`tcfg_node_°r
(
bbi
);

182 
	`•rötf
(
ãrm
, "%sb%s%s", 
¥efix
, 
°r
, 
suffix
);

183 
	`√w_ãrm
(
Â
);

184 
	}
}

190 
	$tcfg_node_hm_ãrm
(
FILE
 *
Â
, 
tcfg_node_t
 *
bbi
, 
hm
, *
¥efix
, *
suffix
)

192 
	`tcfg_node_°r
(
bbi
);

193 
	`•rötf
(
ãrm
, "%sb%s.%d%s", 
¥efix
, 
°r
, 
hm
, 
suffix
);

194 
	`√w_ãrm
(
Â
);

195 
	}
}

200 
	$tcfg_edge_°r
(
tcfg_edge_t
 *
e
, 
b¥ed
)

202 
°r1
[32], 
°r2
[32];

204 
	`tcfg_node_°r
(
e
->
§c
);

205 
	`°r˝y
(
°r1
, 
°r
);

206 
	`tcfg_node_°r
(
e
->
d°
);

207 
	`°r˝y
(
°r2
, 
°r
);

208 i‡(
b¥ed
 =
BP_NONE
)

209 
	`•rötf
(
°r
, "%s_%s", 
°r1
, 
°r2
);

210 i‡(
b¥ed
 =
BP_CPRED
)

211 
	`•rötf
(
°r
, "c%s_%s", 
°r1
, 
°r2
);

212 i‡(
b¥ed
 =
BP_MPRED
)

213 
	`•rötf
(
°r
, "m%s_%s", 
°r1
, 
°r2
);

214 
	}
}

220 
	$tcfg_edge_ãrm
(
FILE
 *
Â
, 
tcfg_edge_t
 *
e
, 
b¥ed
, *
¥efix
, *
suffix
)

222 
	`tcfg_edge_°r
(
e
, 
b¥ed
);

223 
	`•rötf
(
ãrm
, "%sd%s%s", 
¥efix
, 
°r
, 
suffix
);

224 
	`√w_ãrm
(
Â
);

225 
	}
}

232 
	$e°_unô_ãrm
(
FILE
 *
Â
, 
tcfg_edge_t
 *
e
, 
b¥ed
, 
hm
, *
¥efix
, *
suffix
)

234 
	`tcfg_edge_°r
(
e
, 
b¥ed
);

235 i‡(
íabÀ_iˇche
 || 
íabÀ_abs_ö°_ˇche
)

236 
	`•rötf
(
ãrm
, "%sd%s.%d%s", 
¥efix
, 
°r
, 
hm
, 
suffix
);

238 
	`•rötf
(
ãrm
, "%sd%s%s", 
¥efix
, 
°r
, 
suffix
);

239 
	`√w_ãrm
(
Â
);

240 
	}
}

247 
	$bfg_node_°r
(
bfg_node_t
 *
bbb
)

249 i‡(
bbb
->
id
 =
roŸ_bbb_id
)

250 
	`•rötf
(
°r
, "%s", 
°¨t_°r
);

251 i‡(
bbb
->
id
 =
íd_bbb_id
)

252 
	`•rötf
(
°r
, "%s", 
íd_°r
);

254 
	`•rötf
(
°r
, "%d", 
bbb
->
id
);

255 
	}
}

261 
	$bfg_node_ãrm
(
FILE
 *
Â
, 
bfg_node_t
 *
bbb
, *
¥efix
, *
suffix
)

263 
	`bfg_node_°r
(
bbb
);

264 
	`•rötf
(
ãrm
, "%sc%s%s", 
¥efix
, 
°r
, 
suffix
);

265 
	`√w_ãrm
(
Â
);

266 
	}
}

271 
	$bfg_edge_°r
(
bfg_edge_t
 *
e
, 
b¥ed
)

273 
°r1
[32], 
°r2
[32], 
br
;

275 
	`bfg_node_°r
(
e
->
§c
);

276 
	`°r˝y
(
°r1
, 
°r
);

277 
	`bfg_node_°r
(
e
->
d°
);

278 
	`°r˝y
(
°r2
, 
°r
);

279 i‡(
e
->
bønch
 =
TAKEN
)

280 
br
 = 'T';

282 
br
 = 'N';

283 i‡(
b¥ed
 =
BP_NONE
)

284 
	`•rötf
(
°r
, "%s_%s%c", 
°r1
, 
°r2
, 
br
);

285 i‡(
b¥ed
 =
BP_CPRED
)

286 
	`•rötf
(
°r
, "c%s_%s%c", 
°r1
, 
°r2
, 
br
);

287 i‡(
b¥ed
 =
BP_MPRED
)

288 
	`•rötf
(
°r
, "m%s_%s%c", 
°r1
, 
°r2
, 
br
);

289 
	}
}

295 
	$bfg_edge_ãrm
(
FILE
 *
Â
, 
bfg_edge_t
 *
e
, 
b¥ed
, *
¥efix
, *
suffix
)

297 
	`bfg_edge_°r
(
e
, 
b¥ed
);

298 
	`•rötf
(
ãrm
, "%sf%s%s", 
¥efix
, 
°r
, 
suffix
);

299 
	`√w_ãrm
(
Â
);

300 
	}
}

305 
	$btg_edge_°r
(
btg_edge_t
 *
e
)

307 
°r1
[32], 
°r2
[32];

309 
	`bfg_node_°r
(
e
->
§c
);

310 
	`°r˝y
(
°r1
, 
°r
);

311 
	`bfg_node_°r
(
e
->
d°
);

312 
	`°r˝y
(
°r2
, 
°r
);

314 i‡(
e
->
bønch
 =
BOTH_BRANCHES
)

315 
	`•rötf
(
°r
, "%s_%s", 
°r1
, 
°r2
);

316 i‡(
e
->
bønch
 =
NOT_TAKEN
)

317 
	`•rötf
(
°r
, "%s_%sN", 
°r1
, 
°r2
);

318 i‡(
e
->
bønch
 =
TAKEN
)

319 
	`•rötf
(
°r
, "%s_%sT", 
°r1
, 
°r2
);

320 
	}
}

326 
	$btg_edge_ãrm
(
FILE
 *
Â
, 
btg_edge_t
 *
e
, *
¥efix
, *
suffix
)

328 
	`btg_edge_°r
(
e
);

329 
	`•rötf
(
ãrm
, "%•%s%s", 
¥efix
, 
°r
, 
suffix
);

330 
	`√w_ãrm
(
Â
);

331 
	}
}

336 
	$hm_°r
(
edge_id
, 
hm
)

338 
	`•rötf
(
°r
, "%d.%d", 
edge_id
, 
hm
);

339 
	}
}

345 
	$hm_ãrm
(
FILE
 *
Â
, 
edge_id
, 
hm
, *
¥efix
, *
suffix
)

347 
	`hm_°r
(
edge_id
, 
hm
);

348 
	`•rötf
(
ãrm
, "%shm%s%s", 
¥efix
, 
°r
, 
suffix
);

349 
	`√w_ãrm
(
Â
);

350 
	}
}

355 
	$mp£t_°r
(
tcfg_edge_t
 *
edge
, 
Õ_id
, 
£t
)

357 
tmp_°r
[32];

359 
	`tcfg_edge_°r
(
edge
, 
BP_NONE
);

360 
	`•rötf
(
tmp_°r
, "%s.%d.%d", 
°r
, 
Õ_id
, 
£t
);

361 
	`°r˝y
(
°r
, 
tmp_°r
);

362 
	}
}

368 
	$mp£t_ãrm
(
FILE
 *
Â
, 
tcfg_edge_t
 *
edge
, 
Õ_id
, 
£t
, *
¥efix
, *
suffix
)

370 
	`mp£t_°r
(
edge
, 
Õ_id
, 
£t
);

371 
	`•rötf
(
ãrm
, "%smp%s%s", 
¥efix
, 
°r
, 
suffix
);

372 
	`√w_ãrm
(
Â
);

373 
	}
}

378 
	$mpunô_°r
(
tcfg_edge_t
 *
edge
, 
hm
, 
£t
)

380 
tmp_°r
[32];

382 
	`tcfg_edge_°r
(
edge
, 
BP_NONE
);

383 
	`•rötf
(
tmp_°r
, "%s.%d.%d", 
°r
, 
hm
, 
£t
);

384 
	`°r˝y
(
°r
, 
tmp_°r
);

385 
	}
}

391 
	$mpunô_ãrm
(
FILE
 *
Â
, 
tcfg_edge_t
 *
edge
, 
hm
, 
£t
, *
¥efix
, *
suffix
)

393 
	`mpunô_°r
(
edge
, 
hm
, 
£t
);

394 
	`•rötf
(
ãrm
, "%sd%s%s", 
¥efix
, 
°r
, 
suffix
);

395 
	`√w_ãrm
(
Â
);

396 
	}
}

403 
	$m≠_bb_bbi
(
¥oc
, 
bb
, 
fú°
, 
sign
, 
c€ff
)

405 
i
, 
j
;

406 
tcfg_∆ök_t
 *
∆
;

407 
tcfg_node_t
 *
bbi
;

408 
sign_s
[3] = "", 
tmp
[3], 
c€ff_s
[8] = "", 
¥efix_°r
[32];

410 if–
bbi_m≠
[
¥oc
][
bb
] =
NULL
 )

415 i‡(
sign
 =
PLUS
)

416 
	`°r˝y
(
tmp
, "+ ");

418 
	`°r˝y
(
tmp
, "- ");

419 i‡(!
fú°
)

420 
	`°r˝y
(
sign_s
, 
tmp
);

422 i‡(
c€ff
 != 1)

423 
	`•rötf
(
c€ff_s
, "%d ", 
c€ff
);

427 
∆
 = 
bbi_m≠
[
¥oc
][
bb
];Ç»!
NULL
;Ç»∆->
√xt
) {

428 
bbi
 = 
∆
->bbi;

430 
	`•rötf
(
¥efix_°r
, "%s%s", 
sign_s
, 
c€ff_s
);

431 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
¥efix_°r
, 
NO_SUFFIX
);

432 i‡(
fú°
) {

433 
fú°
 = 0;

434 
	`°r˝y
(
sign_s
, 
tmp
);

438 
	}
}

444 
	$m≠_bb_bbi_c⁄ãxt
(
¥oc
, 
bb
, 
fú°
, 
sign
, 
c€ff
, 
k
)

446 
tcfg_∆ök_t
 *
∆
;

447 
tcfg_node_t
 *
bbi
;

448 
sign_s
[3] = "", 
tmp
[3], 
c€ff_s
[8] = "", 
¥efix_°r
[32];

449 
cou¡
;

451 if–
bbi_m≠
[
¥oc
][
bb
] =
NULL
 )

456 i‡(
sign
 =
PLUS
)

457 
	`°r˝y
(
tmp
, "+ ");

459 
	`°r˝y
(
tmp
, "- ");

460 i‡(!
fú°
)

461 
	`°r˝y
(
sign_s
, 
tmp
);

463 i‡(
c€ff
 != 1)

464 
	`•rötf
(
c€ff_s
, "%d ", 
c€ff
);

467 
cou¡
 = 0, 
∆
 = 
bbi_m≠
[
¥oc
][
bb
]; cou¡ < 
k
 &&Ç»!
NULL
; cou¡++,Ç»∆->
√xt
);

469 
bbi
 = 
∆
->bbi;

471 
	`•rötf
(
¥efix_°r
, "%s%s", 
sign_s
, 
c€ff_s
);

472 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
¥efix_°r
, 
NO_SUFFIX
);

473 i‡(
fú°
) {

474 
fú°
 = 0;

475 
	`°r˝y
(
sign_s
, 
tmp
);

478 
	}
}

483 
	$u£r_c⁄s
()

485 
löe
[128], *
rhs
, *
p
, 
tmp
[128];

486 
¥oc
, 
bb
, 
i
, 
övÆid
 = 0;

487 
sign
, 
fú°
, 
c€ff
;

488 
nom©ch
 = 0;

490 
	`fgës
(
löe
, 128, 
fu§
Ë!
NULL
) {

491 i‡((
rhs
 = 
	`°rchr
(
löe
, '<')Ë=
NULL
) {

492 i‡((
rhs
 = 
	`°rchr
(
löe
, '>')Ë=
NULL
)

493 i‡((
rhs
 = 
	`°rchr
(
löe
, '=')Ë=
NULL
) {

494 
	`Ârötf
(
°dîr
, "1. invÆid c⁄°øöt:\n%s", 
löe
);

495 
	`exô
(1);

498 
fú°
 = 1;

499 
c€ff
 = 1;

500 
sign
 = 
PLUS
;

501 
p
 = 
löe
;Ö !
rhs
;Ö++) {

502 i‡(*
p
 == 'c') {

503 
i
 = 
	`ssˇnf
(
p
+1, "%d.%d", &
¥oc
, &
bb
);

504 i‡(
i
 != 2) {

505 
övÆid
 = 1;

509 
nom©ch
 = 
	`m≠_bb_bbi
(
¥oc
, 
bb
, 
fú°
, 
sign
, 
c€ff
);

510 if–
nom©ch
 )

513 
	`•rötf
(
tmp
, "%d.%d", 
¥oc
, 
bb
);

514 
p
 +
	`°æí
(
tmp
);

515 
fú°
 = 0;

516 
c€ff
 = 1;

517 } i‡(*
p
 == '+') {

518 
sign
 = 
PLUS
;

519 } i‡(*
p
 == '-') {

520 
sign
 = 
MINUS
;

521 } i‡((*
p
 >= '1') && (*p <= '9')) {

522 
	`ssˇnf
(
p
, "%d", &
c€ff
);

523 
	`•rötf
(
tmp
, "%d", 
c€ff
);

524 
p
 +
	`°æí
(
tmp
) - 1;

525 } i‡(*
p
 == ' ' || *p == '\t') {

528 
övÆid
 = 1;

532 i‡(
övÆid
) {

533 
	`Ârötf
(
°dîr
, "2. invÆid c⁄°øöts:\n%s", 
löe
);

536 if–
nom©ch
 )

539 
	`Ârötf
(
fûp
, " %s", 
rhs
);

540 
tŸÆ_c⁄s
++;

542 
	}
}

550 
	$u£r_c⁄s_c⁄ãxt
()

552 
löe
[128], *
rhs
, *
p
, 
tmp
[128];

553 
¥oc
, 
bb
, 
i
, 
k
, 
övÆid
 = 0;

554 
sign
, 
fú°
, 
c€ff
;

556 
nom©ch
 = 0;

558 
num_c⁄ãxts
;

559 
tcfg_∆ök_t
 *
∆
;

560 
cou¡
 = 0;

562 
	`fgës
(
löe
, 128, 
fu§
Ë!
NULL
) {

564 i‡((
rhs
 = 
	`°rchr
(
löe
, '<')Ë=
NULL
) {

565 i‡((
rhs
 = 
	`°rchr
(
löe
, '>')Ë=
NULL
) {

566 i‡((
rhs
 = 
	`°rchr
(
löe
, '=')Ë=
NULL
) {

567 
	`Ârötf
(
°dîr
, "1. invÆid c⁄°øöt:\n%s", 
löe
);

568 
	`exô
(1);

574 if–
	`°rchr
(
löe
, '<'Ë=
NULL
 && strchr(line, '>') == NULL ) {

575 
fú°
 = 1;

576 
c€ff
 = 1;

577 
sign
 = 
PLUS
;

578 
p
 = 
löe
;Ö !
rhs
;Ö++) {

580 i‡(*
p
 == 'c') {

581 
i
 = 
	`ssˇnf
(
p
+1, "%d.%d", &
¥oc
, &
bb
);

582 i‡(
i
 != 2) {

583 
övÆid
 = 1;

587 
nom©ch
 = 
	`m≠_bb_bbi
(
¥oc
, 
bb
, 
fú°
, 
sign
, 
c€ff
);

588 if–
nom©ch
 )

591 
	`•rötf
(
tmp
, "%d.%d", 
¥oc
, 
bb
);

592 
p
 +
	`°æí
(
tmp
);

593 
fú°
 = 0;

594 
c€ff
 = 1;

595 } i‡(*
p
 == '+') {

596 
sign
 = 
PLUS
;

597 } i‡(*
p
 == '-') {

598 
sign
 = 
MINUS
;

599 } i‡((*
p
 >= '1') && (*p <= '9')) {

600 
	`ssˇnf
(
p
, "%d", &
c€ff
);

601 
	`•rötf
(
tmp
, "%d", 
c€ff
);

602 
p
 +
	`°æí
(
tmp
) - 1;

603 } i‡(*
p
 == ' ' || *p == '\t') {

606 
övÆid
 = 1;

610 i‡(
övÆid
) {

611 
	`Ârötf
(
°dîr
, "2. invÆid c⁄°øöts:\n%s", 
löe
);

614 if–
nom©ch
 )

617 
	`Ârötf
(
fûp
, " %s", 
rhs
);

618 
tŸÆ_c⁄s
++;

625 
p
 = 
löe
;Ö !
rhs
;Ö++) {

626 i‡(*
p
 == 'c') {

627 
i
 = 
	`ssˇnf
(
p
+1, "%d.%d", &
¥oc
, &
bb
);

628 i‡(
i
 != 2) {

629 
övÆid
 = 1;

632 
num_c⁄ãxts
 = 0;

633 
∆
 = 
bbi_m≠
[
¥oc
][
bb
];Ç»!
NULL
;Ç»∆->
√xt
)

634 
num_c⁄ãxts
++;

639 i‡(
övÆid
) {

640 
	`Ârötf
(
°dîr
, "2a. invÆid c⁄°øöts:\n%s", 
löe
);

645  
k
 = 0; k < 
num_c⁄ãxts
; k++ ) {

646 
fú°
 = 1;

647 
c€ff
 = 1;

648 
sign
 = 
PLUS
;

649 
p
 = 
löe
;Ö !
rhs
;Ö++) {

650 i‡(*
p
 == 'c') {

651 
i
 = 
	`ssˇnf
(
p
+1, "%d.%d", &
¥oc
, &
bb
);

652 i‡(
i
 != 2) {

653 
övÆid
 = 1;

657 
nom©ch
 = 
	`m≠_bb_bbi_c⁄ãxt
(
¥oc
, 
bb
, 
fú°
, 
sign
, 
c€ff
, 
k
);

658 if–
nom©ch
 )

661 
	`•rötf
(
tmp
, "%d.%d", 
¥oc
, 
bb
);

662 
p
 +
	`°æí
(
tmp
);

663 
fú°
 = 0;

664 
c€ff
 = 1;

665 } i‡(*
p
 == '+') {

666 
sign
 = 
PLUS
;

667 } i‡(*
p
 == '-') {

668 
sign
 = 
MINUS
;

669 } i‡((*
p
 >= '1') && (*p <= '9')) {

670 
	`ssˇnf
(
p
, "%d", &
c€ff
);

671 
	`•rötf
(
tmp
, "%d", 
c€ff
);

672 
p
 +
	`°æí
(
tmp
) - 1;

673 } i‡(*
p
 == ' ' || *p == '\t') {

676 
övÆid
 = 1;

680 i‡(
övÆid
) {

681 
	`Ârötf
(
°dîr
, "2b. invÆid c⁄°øöts:\n%s", 
löe
);

684 if–
nom©ch
 )

687 
	`Ârötf
(
fûp
, " %s", 
rhs
);

688 
tŸÆ_c⁄s
++;

691 
	`¥ötf
("\n");

692 
	}
}

696 
	$v°¨t_co°_ãrm
()

698 
	`Ârötf
(
fûp
, "%d d%s_0", 
°¨t_time
, 
°¨t_°r
);

699 
	}
}

704 
	$co°_ãrm
(
edge_id
, 
b¥ed
)

706 
i
, 
tm
, 
num_hm
;

707 
tcfg_edge_t
 *
e
;

708 
l1
,
l2
;

710 
e
 = 
tcfg_edges
[
edge_id
];

711 
	`tcfg_edge_°r
(
e
, 
b¥ed
);

713 i‡(
íabÀ_iˇche
)

714 
num_hm
 = 
num_hô_miss
[
tcfg_edges
[
edge_id
]->
d°
->
id
];

716 
num_hm
 = 1;

717 
i
 = 0; i < 
num_hm
; i++) {

718 i‡(
b¥ed
 =
BP_MPRED
)

719 
tm
 = 
m¥ed_times
[
edge_id
][
i
];

721 
tm
 = 
˝ªd_times
[
edge_id
][
i
];

722 i‡(
íabÀ_iˇche
) {

723 
	`Ârötf
(
fûp
, " + %d d%s.%d", 
tm
, 
°r
, 
i
);

725 
	`Ârötf
(
fûp
, " + %d d%s", 
tm
, 
°r
);

730 if(
íabÀ_dˇche
)

732 
tcfg_node_t
* 
bbi
 = 
tcfg_edges
[
edge_id
]->
§c
;

733 
	`Ârötf
(
fûp
, " + %d d%s", 
bbi
->
dˇche_dñay
, 
°r
);

734 
	`Ârötf
(
fûp
, " + %d d%s.0", 
L1_MISS_PENALTY
 * 
bbi
->
n_d©a_≥rsi°í˚
,

735 
°r
);

736 
	`Ârötf
(
fûp
, " + %d d%s.0", 
L2_MISS_PENALTY
 * 
bbi
->
n_u1_d©a_≥rsi°í˚
,

737 
°r
);

740 if(
íabÀ_abs_ö°_ˇche
)

742 
tcfg_node_t
* 
bbi
 = 
tcfg_edges
[
edge_id
]->
§c
;

743 
	`Ârötf
(
fûp
, " + %d d%s", 
bbi
->
ö°_ˇche_dñay
, 
°r
);

745 
	`Ârötf
(
fûp
, " + %d d%s.0", 
L1_MISS_PENALTY
 * 
bbi
->
n_≥rsi°í˚
, 
°r
);

746 
	`Ârötf
(
fûp
, " + %d d%s.0", 
L2_MISS_PENALTY
 * 
bbi
->
n_l2_≥rsi°í˚
, 
°r
);

747 
	`Ârötf
(
fûp
, " + %d d%s.0", 
L2_MISS_PENALTY
 * 
bbi
->
n_u1_≥rsi°í˚
, 
°r
);

749 
	}
}

756 
	$tcfg_node_c⁄s
(
tcfg_node_t
 *
bbi
)

758 
tcfg_edge_t
 *
e
;

760 
	`tcfg_node_ãrm
(
NULL
, 
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
);

762 i‡(
bbi
->
out
 !
NULL
) {

763 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
);

764 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

765 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

766 
	`tcfg_edge_ãrm
(
NULL
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

768 
	`Ârötf
(
fûp
, " = 0\n");

769 
tŸÆ_c⁄s
++;

773 i‡(
bbi
->
ö
 !
NULL
) {

774 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
);

775 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
)

776 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

778 i‡(
bbi
->
id
 == 0)

779 
	`Ârötf
(
fûp
, " - d%s_0", 
°¨t_°r
);

780 
	`Ârötf
(
fûp
, " = 0\n");

781 
tŸÆ_c⁄s
++;

782 } i‡(
bbi
->
id
 == 0) {

783 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
);

784 
	`Ârötf
(
fûp
, " - d%s_0 = 0\n", 
°¨t_°r
);

785 
tŸÆ_c⁄s
++;

787 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, 
NO_PREFIX
, " = 0\n");

788 
tŸÆ_c⁄s
++;

790 
	}
}

796 
	$tcfg_c⁄s
()

798 
i
;

800 
	`Ârötf
(
fûp
, "\\ ===Åcfg constraints ===\n");

802 if(
íabÀ_abs_ö°_ˇche
)

804 
edge_id
;

805 
tcfg_edge_t
* 
e
;

818 
	`Ârötf
(
fûp
, "d%s_0 = 1\n", 
°¨t_°r
);

819 
tŸÆ_c⁄s
++;

820 
	`•rötf
(
°r
, "d%s_0", 
°¨t_°r
);

821 
	`add_v¨
(
°¨t_°r
);

824 
i
 = 0; i < 
num_tcfg_nodes
; i++)

825 
	`tcfg_node_c⁄s
(
tcfg
[
i
]);

826 
	`Ârötf
(
fûp
, "\n");

827 
	}
}

834 
	$bfg_c⁄s
()

836 
i
, 
has_roŸ
, 
has_íd
;

837 
bfg_node_t
 *
bbb
;

838 
bfg_edge_t
 *
e
;

839 
tcfg_node_t
 *
bbi
;

840 
tcfg_edge_t
 *
tcfg_e
;

842 
i
=0; i<
num_bfg_nodes
; i++) {

843 
bbb
 = 
vbbb
[
i
];

844 
	`bfg_node_ãrm
(
NULL
, 
bbb
, 
NO_PREFIX
, 
NO_SUFFIX
);

846 
	`bfg_node_ãrm
(
fûp
, 
bbb
, 
NO_PREFIX
, 
NO_SUFFIX
);

847 
has_íd
 = 0;

848 
e
 = 
bbb
->
out
;É !
NULL
;É =É->
√xt_out
) {

849 i‡(
e
->
d°
->
id
 =
íd_bbb_id
) {

850 
has_íd
 = 1;

853 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

854 
	`bfg_edge_ãrm
(
NULL
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

856 
	`Ârötf
(
fûp
, " <%d\n", 
has_íd
);

857 
tŸÆ_c⁄s
++;

858 
	`bfg_node_ãrm
(
fûp
, 
bbb
, 
NO_PREFIX
, 
NO_SUFFIX
);

859 
has_íd
 = 0;

860 
e
 = 
bbb
->
out
;É !
NULL
;É =É->
√xt_out
) {

861 i‡(
e
->
d°
->
id
 =
íd_bbb_id
) {

864 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

865 
	`bfg_edge_ãrm
(
NULL
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

867 
	`Ârötf
(
fûp
, " >= 0\n");

868 
tŸÆ_c⁄s
++;

871 
	`bfg_node_ãrm
(
fûp
, 
bbb
, 
NO_PREFIX
, 
NO_SUFFIX
);

872 
has_roŸ
 = 0;

873 
e
 = 
bbb
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

874 i‡(
e
->
§c
->
id
 =
roŸ_bbb_id
) {

875 
has_roŸ
 = 1;

878 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

880 
	`Ârötf
(
fûp
, " <%d\n", 
has_roŸ
);

881 
tŸÆ_c⁄s
++;

882 
	`bfg_node_ãrm
(
fûp
, 
bbb
, 
NO_PREFIX
, 
NO_SUFFIX
);

883 
has_roŸ
 = 0;

884 
e
 = 
bbb
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

885 i‡(
e
->
§c
->
id
 =
roŸ_bbb_id
) {

888 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

890 
	`Ârötf
(
fûp
, " >= 0\n");

891 
tŸÆ_c⁄s
++;

893 
	`Ârötf
(
fûp
, "\n");

894 
	}
}

905 
	$btg_c⁄s
()

907 
i
, 
pi
, 
has_roŸ
, 
has_íd
;

908 
bfg_node_t
 *
x
, *
y
;

909 
bfg_edge_t
 *
e
;

910 
btg_edge_t
 *
p
;

913 
	`Ârötf
(
fûp
, "\n");

914 
i
 = 0; i < 
num_bfg_nodes
; i++) {

915 
x
 = 
vbbb
[
i
];

916 
e
 = 
x
->
out
;É !
NULL
;É =É->
√xt_out
) {

917 i‡(
e
->
d°
->
id
 =
íd_bbb_id
)

919 
	`bfg_edge_ãrm
(
NULL
, 
e
, 
BP_CPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

920 
	`bfg_edge_ãrm
(
NULL
, 
e
, 
BP_MPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

921 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

922 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_CPRED
, " - ", 
NO_SUFFIX
);

923 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, " - ", " = 0\n");

924 
tŸÆ_c⁄s
++;

929 
	`Ârötf
(
fûp
, "\n");

932 
i
 = 0; i < 
num_bfg_nodes
; i++) {

933 
x
 = 
vbbb
[
i
];

935 
	`bfg_node_ãrm
(
fûp
, 
x
, 
NO_PREFIX
, 
NO_SUFFIX
);

936 
has_roŸ
 = 0;

937 
p
 = 
btg_ö
[
i
];Ö !
NULL
;Ö =Ö->
√xt_ö
) {

938 i‡(
p
->
§c
->
id
 =
roŸ_bbb_id
) {

939 
has_roŸ
 = 1;

942 
	`btg_edge_ãrm
(
fûp
, 
p
, " - ", 
NO_SUFFIX
);

944 
	`Ârötf
(
fûp
, " <%d\n", 
has_roŸ
);

945 
tŸÆ_c⁄s
++;

946 
	`bfg_node_ãrm
(
fûp
, 
x
, 
NO_PREFIX
, 
NO_SUFFIX
);

947 
p
 = 
btg_ö
[
i
];Ö !
NULL
;Ö =Ö->
√xt_ö
) {

948 i‡(
p
->
§c
->
id
 =
roŸ_bbb_id
) {

951 
	`btg_edge_ãrm
(
fûp
, 
p
, " - ", 
NO_SUFFIX
);

953 
	`Ârötf
(
fûp
, " >= 0\n");

954 
tŸÆ_c⁄s
++;

959 
	`Ârötf
(
fûp
, "\n");

960 
i
 = 0; i < 
num_bfg_nodes
; i++) {

961 
x
 = 
vbbb
[
i
];

962 
e
 = 
x
->
out
;É !
NULL
;É =É->
√xt_out
) {

963 i‡(
e
->
d°
->
id
 =
íd_bbb_id
)

965 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

966 
has_íd
 = 0;

967 
p
 = 
btg_out
[
i
];Ö !
NULL
;Ö =Ö->
√xt_out
) {

968 i‡(
e
->
bønch
 !
p
->branch)

970 i‡(
p
->
d°
->
id
 =
íd_bbb_id
) {

971 
has_íd
 = 1;

974 
	`btg_edge_ãrm
(
fûp
, 
p
, " - ", 
NO_SUFFIX
);

976 
	`Ârötf
(
fûp
, " <%d\n", 
has_íd
);

977 
tŸÆ_c⁄s
++;

978 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

979 
p
 = 
btg_out
[
i
];Ö !
NULL
;Ö =Ö->
√xt_out
) {

980 i‡(
e
->
bønch
 !
p
->branch)

982 i‡(
p
->
d°
->
id
 =
íd_bbb_id
) {

985 
	`btg_edge_ãrm
(
fûp
, 
p
, " - ", 
NO_SUFFIX
);

987 
	`Ârötf
(
fûp
, " >= 0\n");

988 
tŸÆ_c⁄s
++;

993 
	`Ârötf
(
fûp
, "\n");

994 
i
 = 0; i < 
num_bfg_nodes
; i++) {

995 
x
 = 
vbbb
[
i
];

996 
e
 = 
x
->
out
;É !
NULL
;É =É->
√xt_out
) {

998 i‡(
e
->
d°
->
id
 =
íd_bbb_id
)

1000 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1001 
has_roŸ
 == 0;

1002 
p
 = 
btg_ö
[
i
];Ö !
NULL
;Ö =Ö->
√xt_ö
) {

1003 i‡(
e
->
bønch
 =
p
->branch)

1005 i‡(
p
->
§c
->
id
 =
roŸ_bbb_id
) {

1006 
has_roŸ
 = 1;

1009 
	`btg_edge_ãrm
(
fûp
, 
p
, " - ", 
NO_SUFFIX
);

1011 
	`Ârötf
(
fûp
, " <%d\n", 
has_roŸ
);

1012 
tŸÆ_c⁄s
++;

1015 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1016 
	`bfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", " <= 0\n");

1017 
tŸÆ_c⁄s
++;

1021 
	`Ârötf
(
fûp
, "\n");

1022 
	}
}

1031 
	$tcfg_bfg_c⁄s
()

1033 
i
, 
j
, 
pi
, 
bønch
, 
bp
[2] = {
BP_NONE
, 
BP_MPRED
};

1034 
tcfg_node_t
 *
bbi
;

1035 
tcfg_edge_t
 *
e
;

1036 
bfg_node_t
 *
x
, *
y
;

1037 
bfg_edge_t
 *
bbb_e
;

1040 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1041 i‡(
	`bbi_ty≥
(
tcfg
[
i
]Ë!
CTRL_COND
)

1043 
	`tcfg_node_ãrm
(
fûp
, 
tcfg
[
i
], 
NO_PREFIX
, 
NO_SUFFIX
);

1044 
pi
 = 0;Öò< 
BHT_SIZE
;Öi++) {

1045 i‡(
bfg
[
i
][
pi
] !
NULL
)

1046 
	`bfg_node_ãrm
(
fûp
, 
bfg
[
i
][
pi
], " - ", 
NO_SUFFIX
);

1048 
	`Ârötf
(
fûp
, " = 0\n");

1049 
tŸÆ_c⁄s
++;

1054 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1055 
bbi
 = 
tcfg
[
i
];

1056 i‡(
	`bbi_ty≥
(
bbi
Ë!
CTRL_COND
)

1058 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

1059 
j
 = 
e
->
d°
->
id
;

1060 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

1061 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_CPRED
, " - ", 
NO_SUFFIX
);

1062 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, " - ", " = 0\n");

1063 
tŸÆ_c⁄s
++;

1064 
	`tcfg_edge_ãrm
(
NULL
, 
e
, 
BP_CPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1065 
	`tcfg_edge_ãrm
(
NULL
, 
e
, 
BP_MPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1069 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1070 
bbi
 = 
tcfg
[
i
];

1071 i‡(
	`bbi_ty≥
(
bbi
Ë!
CTRL_COND
)

1074 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

1075 
j
 = 0; j < 2; j++) {

1076 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
bp
[
j
], 
NO_PREFIX
, 
NO_SUFFIX
);

1077 
bønch
 = 
e
->branch;

1078 
pi
 = 0;Öò< 
BHT_SIZE
;Öi++) {

1079 i‡((
x
 = 
bfg
[
i
][
pi
]Ë=
NULL
)

1081 i‡(
x
->
out
->
bønch
 == branch)

1082 
bbb_e
 = 
x
->
out
;

1084 
bbb_e
 = 
x
->
out
->
√xt_out
;

1085 i‡(
bbb_e
->
d°
->
id
 =
íd_bbb_id
) {

1088 
	`bfg_edge_ãrm
(
fûp
, 
bbb_e
, 
bp
[
j
], " - ", 
NO_SUFFIX
);

1090 i‡(
pi
 < 
BHT_SIZE
)

1091 
	`Ârötf
(
fûp
, " <= 1\n");

1093 
	`Ârötf
(
fûp
, " = 0\n");

1094 
tŸÆ_c⁄s
++;

1098 
	`Ârötf
(
fûp
, "\n");

1099 
	}
}

1101 
	$tcfg_e°unô_c⁄s_ps
()

1103 
edge_id
, 
hm
, 
num
;

1104 
tcfg_edge_t
* 
e
;

1106 
	`Ârötf
(
fûp
, "\n\\ ===Åcfg_estunit_cons_ps ===\n");

1108 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

1109 
e
 = 
tcfg_edges
[
edge_id
];

1110 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

1111 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 0, " - ", 
NO_SUFFIX
);

1112 
	`Ârötf
(
fûp
, " >= 0\n");

1113 
tŸÆ_c⁄s
++;

1114 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 0, 
NO_PREFIX
 , 
NO_SUFFIX
);

1115 
	`Ârötf
(
fûp
, " <= 1\n");

1116 
tŸÆ_c⁄s
++;

1118 
	}
}

1121 
	$tcfg_e°unô_c⁄s
()

1123 
edge_id
, 
hm
, 
num
;

1124 
tcfg_edge_t
 *
e
;

1126 
	`Ârötf
(
fûp
, "\n\\ ===Åcfg_estunit_cons ===\n");

1127 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

1128 
e
 = 
tcfg_edges
[
edge_id
];

1129 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
);

1130 
num
 = 
num_hô_miss
[
tcfg_edges
[
edge_id
]->
d°
->
id
];

1131 
hm
 = 0; hm < 
num
; hm++)

1132 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, " - ", 
NO_SUFFIX
);

1133 
	`Ârötf
(
fûp
, " = 0\n");

1134 
tŸÆ_c⁄s
++;

1135 i‡((
b¥ed_scheme
 =
NO_BPRED
Ë|| !
	`c⁄d_bbi
(
e
->
§c
))

1138 
hm
 = 0; hm < 
num
; hm++) {

1139 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1140 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_CPRED
, 
hm
, " - ", 
NO_SUFFIX
);

1141 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_MPRED
, 
hm
, " - ", " = 0\n");

1142 
tŸÆ_c⁄s
++;

1146 
e
 = 
tcfg_edges
[
edge_id
];

1147 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_CPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1148 
hm
 = 0; hm < 
num
; hm++)

1149 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_CPRED
, 
hm
, " - ", 
NO_SUFFIX
);

1150 
	`Ârötf
(
fûp
, " = 0\n");

1151 
tŸÆ_c⁄s
++;

1153 
e
 = 
tcfg_edges
[
edge_id
];

1154 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, 
NO_PREFIX
, 
NO_SUFFIX
);

1155 
hm
 = 0; hm < 
num
; hm++)

1156 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_MPRED
, 
hm
, " - ", 
NO_SUFFIX
);

1157 
	`Ârötf
(
fûp
, " = 0\n");

1158 
tŸÆ_c⁄s
++;

1160 
	}
}

1165 
	$b¥ed_mis£s
()

1167 
i
;

1168 
tcfg_node_t
 *
bbi
;

1169 
tcfg_edge_t
 *
e
;

1171 
	`Ârötf
(
fûp
, "bm");

1172 
	`add_v¨
("bm");

1173 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1174 
bbi
 = 
tcfg
[
i
];

1175 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

1176 i‡(
	`c⁄d_bbi
(
e
->
§c
))

1177 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_MPRED
, " - ", 
NO_SUFFIX
);

1180 
	`Ârötf
(
fûp
, " = 0\n");

1181 
tŸÆ_c⁄s
++;

1182 
	}
}

1187 
mpˇche_mis£s
();

1191 
	$ˇche_mis£s
()

1193 
i
, 
j
, 
hm
, 
num
, 
cﬁd_mis£s
 = 0, 
ts0
, 
ts1
;

1194 
¥efix_°r
[32];

1195 
lo›_t
 *
Õ1
, *
Õ2
, *
Õ3
;

1196 
tcfg_node_t
 *
Õ_hód
;

1197 
tcfg_edge_t
 *
e
;

1199 
	`Ârötf
(
fûp
, "cm");

1200 
	`add_v¨
("cm");

1202 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1203 
ts0
 = 
	`TAGSET
(
tcfg
[
i
]->
bb
->
ß
);

1204 
hm
 = 0; hm < 
num_hô_miss
[
i
]; hm++) {

1205 
Õ1
 = 
bbi_hm_li°
[
i
][
hm
];

1206 
e
 = 
tcfg
[
i
]->
ö
;É !
NULL
;É =É->
√xt_ö
) {

1207 
num
 = 0;

1208 
j
 = 0; j < 
num_mblks
[
i
]; j++) {

1209 
Õ2
 = 
mblk_hô_lo›
[
i
][
j
];

1210 i‡((
Õ1
 =
NULL
Ë|| (
Õ2
 == NULL))

1211 
num
++;

1212 i‡(
Õ1
 !
Õ2
) {

1213 
Õ3
 = 
lo›_comm_™˚s
[
Õ1
->
id
][
Õ2
->id];

1214 i‡(
Õ3
 =
Õ1
)

1215 
num
++;

1218 i‡(
num
 > 1) {

1219 
	`•rötf
(
¥efix_°r
, " - %d ", 
num
);

1220 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, 
¥efix_°r
, 
NO_SUFFIX
);

1221 } i‡(
num
 == 1) {

1222 
	`•rötf
(
¥efix_°r
, " - ", 
num
);

1223 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, 
¥efix_°r
, 
NO_SUFFIX
);

1228 i‡(
b¥ed_scheme
 !
BP_NONE
)

1229 
	`mpˇche_mis£s
();

1230 
	`Ârötf
(
fûp
, " = %d\n", 
num_mblks
[0]);

1231 
tŸÆ_c⁄s
++;

1232 
	}
}

1242 
	$ˇche_c⁄s
()

1244 
i
, 
j
, 
hm
, 
hm1
;

1245 
tcfg_node_t
 *
bbi
, *
Õ_hód
;

1246 
tcfg_edge_t
 *
e
;

1247 
lo›_t
 *
Õ
;

1249 
	`Ârötf
(
fûp
, "\n\\ === cache_cons ===\n");

1251 
	`tcfg_node_hm_ãrm
(
fûp
, 
tcfg
[0], 0, 
NO_PREFIX
, " <= 1\n");

1252 
	`tcfg_node_hm_ãrm
(
NULL
, 
tcfg
[0], 0, 
NO_PREFIX
, 
NO_SUFFIX
);

1253 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

1254 
	`tcfg_node_ãrm
(
fûp
, 
tcfg
[
i
], 
NO_PREFIX
, 
NO_SUFFIX
);

1255 
hm
 = 0; hm < 
num_hô_miss
[
i
]; hm++) {

1256 
	`tcfg_node_hm_ãrm
(
fûp
, 
tcfg
[
i
], 
hm
, " - ", 
NO_SUFFIX
);

1257 
	`tcfg_node_hm_ãrm
(
NULL
, 
tcfg
[
i
], 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1259 
	`Ârötf
(
fûp
, " = 0\n");

1260 
tŸÆ_c⁄s
++;

1262 
	`Ârötf
(
fûp
, "\n");

1264 
	`tcfg_node_hm_ãrm
(
fûp
, 
tcfg
[0], 0, 
NO_PREFIX
, " <= 1\n");

1265 
tŸÆ_c⁄s
++;

1266 
	`tcfg_node_hm_ãrm
(
NULL
, 
tcfg
[0], 0, 
NO_PREFIX
, 
NO_SUFFIX
);

1267 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

1268 
bbi
 = 
tcfg
[
i
];

1269 i‡(
bbi
->
ö
 =
NULL
)

1271 
hm
 = 0; hm < 
num_hô_miss
[
i
]; hm++) {

1272 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1273 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
)

1274 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, " - ", 
NO_SUFFIX
);

1275 
	`Ârötf
(
fûp
, " = 0\n");

1276 
tŸÆ_c⁄s
++;

1277 
	`tcfg_node_hm_ãrm
(
NULL
, 
bbi
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1280 
	`Ârötf
(
fûp
, "\n");

1282 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1283 
bbi
 = 
tcfg
[
i
];

1285 
hm
 = 
num_hô_miss
[
i
] - 1;

1286 i‡(
hm
 == 0) {

1287 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1288 
	`tcfg_node_ãrm
(
fûp
, 
bbi
, " - ", " = 0\n");

1289 
tŸÆ_c⁄s
++;

1292 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm
];

1293 i‡((
Õ
 =
NULL
Ë|| (Õ->
hód
 == NULL)) {

1294 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm
, 
NO_PREFIX
, " <= 1\n");

1295 
tŸÆ_c⁄s
++;

1297 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1298 
	`tcfg_node_ãrm
(
fûp
, 
Õ
->
hód
, " - ", " <= 0\n");

1299 
tŸÆ_c⁄s
++;

1302 
hm
--; hm > 0 ; hm--) {

1303 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm
, 
NO_PREFIX
, 
NO_SUFFIX
);

1304 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm
-1];

1305 
Õ_hód
 = 
Õ
->
hód
;

1306 
e
 = 
Õ_hód
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

1307 i‡(
lo›_m≠
[
e
->
§c
->
id
] =
Õ
->
∑ª¡
)

1308 
	`tcfg_edge_ãrm
(
fûp
, 
e
, 
BP_NONE
, " - ", 
NO_SUFFIX
);

1310 
hm1
 = 
hm
+1; hm1 < 
num_hô_miss
[
i
]; hm1++) {

1311 
	`tcfg_node_hm_ãrm
(
fûp
, 
bbi
, 
hm1
, " + ", 
NO_SUFFIX
);

1313 
	`Ârötf
(
fûp
, " <= 0\n");

1314 
tŸÆ_c⁄s
++;

1319 
	`Ârötf
(
fûp
, "\n");

1320 
i
 = 1; i < 
num_tcfg_lo›s
; i++) {

1321 
Õ_hód
 = 
lo›s
[
i
]->
hód
;

1322 
e
 = 
Õ_hód
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

1323 i‡(
lo›_m≠
[
e
->
§c
->
id
] !
lo›s
[
i
])

1325 
hm
 = 1; hm < 
num_hô_miss
[
Õ_hód
->
id
]; hm++) {

1326 
	`e°_unô_ãrm
(
fûp
, 
e
, 
BP_NONE
, 
hm
, 
NO_PREFIX
, " = 0\n");

1327 
tŸÆ_c⁄s
++;

1331 
	}
}

1335 
tcfg_ñök_t
 ***
mp_af„˘ed_£ts
;

1336 ***
mp_times
;

1339 
	$edge_mp£t_c⁄s
(
Õ_id
, 
tcfg_edge_t
 *
edge
)

1341 
£t
, 
af„˘ed
 = 0;

1342 
tcfg_ñök_t
 **
mp_afs
, *
ñök
;

1344 
mp_afs
 = 
mp_af„˘ed_£ts
[
Õ_id
];

1345 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1346 
ñök
 = 
mp_afs
[
£t
];Élök !
NULL
;Élök =Élök->
√xt
) {

1347 i‡(
ñök
->
edge
 ==Édge)

1350 i‡(
ñök
 !
NULL
) {

1351 i‡(
af„˘ed
 == 0) {

1352 
af„˘ed
 = 1;

1353 
	`mp£t_ãrm
(
fûp
, 
edge
, 
Õ_id
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1355 
	`mp£t_ãrm
(
fûp
, 
edge
, 
Õ_id
, 
£t
, " + ", 
NO_SUFFIX
);

1357 
	`mp£t_ãrm
(
NULL
, 
edge
, 
Õ_id
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1360 i‡(
af„˘ed
) {

1361 
	`tcfg_edge_ãrm
(
fûp
, 
edge
, 
BP_MPRED
, " - ", " <= 0\n");

1362 
tŸÆ_c⁄s
++;

1364 
	}
}

1369 
	$föd_c⁄d_exô
(
Õ_id
, 
tcfg_edge_t
 *
edge
)

1371 
tcfg_ñök_t
 *
ñök
;

1373 i‡(
	`c⁄d_bbi
(
edge
->
§c
)) {

1374 i‡(
edge
->
§c
->
out
 ==Édge)

1375 
	`edge_mp£t_c⁄s
(
Õ_id
, 
edge
->
√xt_out
);

1377 
	`edge_mp£t_c⁄s
(
Õ_id
, 
edge
->
§c
->
out
);

1379 
edge
 =Édge->
§c
->
ö
;Édgê!
NULL
;Édgêedge->
√xt_ö
)

1380 
	`föd_c⁄d_exô
(
Õ_id
, 
edge
);

1382 
	}
}

1390 
	$mp£t_c⁄s
()

1392 
Õ_id
;

1393 
tcfg_ñök_t
 *
ñök
;

1395 
	`Ârötf
(
fûp
, "\n\\ === mpset_cons ===\n");

1396 
Õ_id
 = 1;Üp_id < 
num_tcfg_lo›s
;Üp_id++) {

1397 
ñök
 = 
lo›s
[
Õ_id
]->
exôs
;Élök !
NULL
;Élök =Élök->
√xt
) {

1398 
	`föd_c⁄d_exô
(
Õ_id
, 
ñök
->
edge
);

1401 
	}
}

1406 
	$£t_mpunô_c⁄s
(
bbi_id
, 
hm
, 
Õ_id
)

1408 
£t
;

1409 
tcfg_ñök_t
 *
ñök
;

1410 
tcfg_edge_t
 *
edge
;

1412 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1413 
ñök
 = 
mp_af„˘ed_£ts
[
Õ_id
][
£t
];

1414 i‡(
ñök
 =
NULL
)

1416 
edge
 = 
tcfg
[
bbi_id
]->
ö
;

1417 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1418 
	`mpunô_ãrm
(
NULL
, 
edge
, 
hm
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1419 
edge
 =Édge->
√xt_ö
;Édgê!
NULL
;Édge =Édge->next_in) {

1420 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, " + ", 
NO_SUFFIX
);

1421 
	`mpunô_ãrm
(
NULL
, 
edge
, 
hm
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1423 ; 
ñök
 !
NULL
;Élök =Élök->
√xt
) {

1424 
	`mp£t_ãrm
(
fûp
, 
ñök
->
edge
, 
Õ_id
, 
£t
, " - ", " <= 0\n");

1425 
tŸÆ_c⁄s
++;

1428 
	}
}

1433 
	$e°unô_mpunô_c⁄s
(
bbi_id
, 
hm
, 
Õ_id
)

1435 
£t
, 
fú°
;

1436 
tcfg_ñök_t
 *
ñök
;

1437 
tcfg_edge_t
 *
edge
;

1439 
edge
 = 
tcfg
[
bbi_id
]->
ö
;Édgê!
NULL
;Édgêedge->
√xt_ö
) {

1440 
fú°
 = 1;

1441 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1442 
ñök
 = 
mp_af„˘ed_£ts
[
Õ_id
][
£t
];

1443 i‡(
ñök
 =
NULL
)

1445 i‡(
fú°
) {

1446 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, 
NO_PREFIX
, 
NO_SUFFIX
);

1447 
fú°
 = 0;

1449 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, " + ", 
NO_SUFFIX
);

1452 i‡(
fú°
 == 0) {

1453 
	`e°_unô_ãrm
(
fûp
, 
edge
, 
BP_NONE
, 
hm
, " - ", " <= 0\n");

1454 
tŸÆ_c⁄s
++;

1457 
	}
}

1462 
	$mpunô_c⁄s
()

1464 
£t
, 
i
, 
num_hm
, 
hm
, 
fú°
;

1465 
tcfg_edge_t
 *
edge
;

1466 
lo›_t
 *
hm_Õ
;

1468 
	`Ârötf
(
fûp
, "\n\\ === mpunit_cons ===\n");

1469 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

1470 i‡–
lo›_m≠
[
i
] == 0)

1472 
num_hm
 = 
num_hô_miss
[
i
];

1473 
hm
 = 0; hm < 
num_hm
; hm++) {

1474 
hm_Õ
 = 
bbi_hm_li°
[
i
][
hm
];

1475 i‡((
hm_Õ
 =
NULL
Ë|| (hm_Õ->
id
 == 0))

1477 
	`£t_mpunô_c⁄s
(
i
, 
hm
, 
hm_Õ
->
id
);

1478 
	`e°unô_mpunô_c⁄s
(
i
, 
hm
, 
hm_Õ
->
id
);

1481 
	}
}

1487 
	$mp_ˇche_c⁄s
()

1489 
	`mp£t_c⁄s
();

1490 
	`mpunô_c⁄s
();

1491 
	}
}

1496 
	$e°unô_mpco°_func
(
bbi_id
, 
hm
, 
Õ_id
)

1498 
£t
, 
≥«…y
;

1499 
¥efix_°r
[16];

1500 
tcfg_edge_t
 *
edge
;

1501 
tcfg_ñök_t
 *
ñök
;

1503 
edge
 = 
tcfg
[
bbi_id
]->
ö
;Édgê!
NULL
;Édgêedge->
√xt_ö
) {

1504 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1505 
ñök
 = 
mp_af„˘ed_£ts
[
Õ_id
][
£t
];

1506 i‡(
ñök
 =
NULL
)

1508 
≥«…y
 = 
mp_times
[
edge
->
id
][
hm
][
£t
] -

1509 
˝ªd_times
[
edge
->
id
][
hm
];

1510 
	`•rötf
(
¥efix_°r
, " + %d ", 
≥«…y
);

1511 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, 
¥efix_°r
, 
NO_SUFFIX
);

1514 
	}
}

1519 
	$mpco°_func
()

1521 
£t
, 
i
, 
num_hm
, 
hm
, 
≥«…y
;

1522 
tcfg_edge_t
 *
edge
;

1523 
lo›_t
 *
hm_Õ
;

1525 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

1526 i‡(
lo›_m≠
[
i
] == 0)

1528 
num_hm
 = 
num_hô_miss
[
i
];

1529 
hm
 = 0; hm < 
num_hm
; hm++) {

1530 
hm_Õ
 = 
bbi_hm_li°
[
i
][
hm
];

1531 i‡((
hm_Õ
 =
NULL
Ë|| (hm_Õ->
id
 == 0))

1533 
	`e°unô_mpco°_func
(
i
, 
hm
, 
hm_Õ
->
id
);

1536 
	}
}

1541 
	$mpunô_ˇche_mis£s
(
bbi_id
, 
hm
, 
Õ_id
)

1543 
£t
, 
i
, 
num_ègs
;

1544 
tcfg_ñök_t
 *
ñök
;

1545 
tcfg_edge_t
 *
edge
;

1546 
¥efix_°r
[8];

1548 
edge
 = 
tcfg
[
bbi_id
]->
ö
;Édgê!
NULL
;Édgêedge->
√xt_ö
) {

1549 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1550 
ñök
 = 
mp_af„˘ed_£ts
[
Õ_id
][
£t
];

1551 i‡(
ñök
 =
NULL
)

1553 
num_ègs
 = 0;

1554 
i
 = 0; i < 
num_mblks
[
bbi_id
]; i++) {

1555 i‡(
gí
[
bbi_id
][
i
].
£t
 == set)

1556 
num_ègs
++;

1558 i‡(
num_ègs
 == 1)

1559 
	`•rötf
(
¥efix_°r
, " - ");

1561 
	`•rötf
(
¥efix_°r
, " - %d ", 
num_ègs
);

1562 
	`mpunô_ãrm
(
fûp
, 
edge
, 
hm
, 
£t
, 
¥efix_°r
, 
NO_SUFFIX
);

1565 
	}
}

1570 
	$mpˇche_mis£s
()

1572 
£t
, 
i
, 
num_hm
, 
hm
;

1573 
tcfg_edge_t
 *
edge
;

1574 
lo›_t
 *
hm_Õ
;

1576 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

1577 i‡(
lo›_m≠
[
i
] == 0)

1579 
num_hm
 = 
num_hô_miss
[
i
];

1580 
hm
 = 0; hm < 
num_hm
; hm++) {

1581 
hm_Õ
 = 
bbi_hm_li°
[
i
][
hm
];

1582 i‡((
hm_Õ
 =
NULL
Ë|| (hm_Õ->
id
 == 0))

1584 
	`mpunô_ˇche_mis£s
(
i
, 
hm
, 
hm_Õ
->
id
);

1587 
	}
}

1592 
	$co°_func
()

1594 
i
;

1596 
	`Ârötf
(
fûp
, "%d b%d", 
tcfg
[0]->
bb
->
num_ö°
, 0);

1597 
i
 = 1; i < 
num_tcfg_nodes
; i++)

1598 
	`Ârötf
(
fûp
, " + %d b%d", 
tcfg
[
i
]->
bb
->
num_ö°
, i);

1599 
	}
}

1606 
	$co°_func
()

1608 
edge_id
 = 0;

1610 
	`v°¨t_co°_ãrm
();

1611 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

1612 i‡((
b¥ed_scheme
 =
NO_BPRED
Ë|| !
	`c⁄d_bbi
(
tcfg_edges
[
edge_id
]->
§c
))

1613 
	`co°_ãrm
(
edge_id
, 
BP_NONE
);

1615 
	`co°_ãrm
(
edge_id
, 
BP_CPRED
);

1616 
	`co°_ãrm
(
edge_id
, 
BP_MPRED
);

1619 i‡((
b¥ed_scheme
 !
NO_BPRED
Ë&& 
íabÀ_iˇche
)

1620 
	`mpco°_func
();

1621 
	`Ârötf
(
fûp
, "\n");

1622 
	}
}

1627 
	$wrôe_v¨s
()

1629 
gid
, 
i
;

1631 
	`Ârötf
(
fûp
, "\nGenerals\n\n");

1633 
gid
 = 0; gid < 
cuº_gΩ
; gid++) {

1634 
i
 = 0; i < 
VAR_GRP_SIZE
; i++)

1635 
	`Ârötf
(
fûp
, "%s\n", 
v¨_gΩs
[
gid
][
i
]);

1637 
i
 = 0; i < 
cuº_idx
; i++)

1638 
	`Ârötf
(
fûp
, "%s\n", 
v¨_gΩs
[
cuº_gΩ
][
i
]);

1640 
tŸÆ_v¨s
 = 
cuº_gΩ
 * 
VAR_GRP_SIZE
 + 
cuº_idx
;

1642 
	`Ârötf
(
fûp
, "\nEnd\n");

1643 
	`Ârötf
(
fûp
, "\\ÅŸÆ_c⁄s: %d \âŸÆ_v¨s: %d\n", 
tŸÆ_c⁄s
, 
tŸÆ_v¨s
);

1644 
	}
}

1648 
	~"ö„asibÀ.h
"

1650 
íabÀ_ö„as
;

1660 
	$ö„as_nuŒifõrs
–
assign_t
 **
nuŒifõr_li°
, 
num_nuŒifõrs
, 
pid
, 
˘xt
 ) {

1662 
i
, 
cou¡
;

1664  
i
 = 0; i < 
num_nuŒifõrs
; i++ ) {

1665 
tcfg_∆ök_t
 *
ndlök
 = 
bbi_m≠
[
pid
][
nuŒifõr_li°
[
i
]->
bb
->
id
];

1668 
cou¡
 = 0;

1669  
cou¡
 < 
˘xt
 && 
ndlök
 !
NULL
 ) {

1670 
ndlök
 =Çdlök->
√xt
;

1671 
cou¡
++;

1673 if–
ndlök
 =
NULL
 )

1674 
	`¥ötf
( "Unbalanced context:Ñequired %d; found %d forÇullifier(%d::%d)\n",

1675 
˘xt
, 
cou¡
-1, 
pid
, 
nuŒifõr_li°
[
i
]->
bb
->
id
 ), 
	`exô
(1);

1677 
	`Ârötf
–
fûp
, " - " );

1678 
	`tcfg_node_ãrm
–
fûp
, 
ndlök
->
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1681 
	}
}

1690 
	$ö„as_blockcou¡
–
tcfg_node_t
 *
ib
, 
˘xt
 ) {

1692 
cou¡
;

1693 
tcfg_∆ök_t
 *
ndlök
;

1695 
Õid
 = 
ib
->
lo›_id
;

1696 
öf_lo›_t
 *
Õ
;

1698 if–
Õid
 == -1 ) {

1700 if–
ib
->
exec_cou¡
 > -1 )

1701 
	`Ârötf
–
fûp
, " <%d\n", 
ib
->
exec_cou¡
 );

1703 
	`Ârötf
–
fûp
, " <= 1\n" );

1708 
Õ
 = &(
öf_lo›s
[
Õid
]);

1711 
ndlök
 = 
bbi_m≠
[
Õ
->
pid
][Õ->
íåy
];

1714 
cou¡
 = 0;

1715  
cou¡
 < 
˘xt
 && 
ndlök
 !
NULL
 ) {

1716 
ndlök
 =Çdlök->
√xt
;

1717 
cou¡
++;

1719 if–
ndlök
 =
NULL
 )

1720 
	`¥ötf
( "Unbalanced context:Ñequired %d forÇode(%d::%d); found %d forÉntry(%d::%d)\n",

1721 
˘xt
, 
ib
->
bb
->
¥oc
->
id
, ib->bb->id, 
cou¡
-1, 
Õ
->
pid
,Üp->
íåy
 ), 
	`exô
(1);

1723 
	`Ârötf
–
fûp
, " - %d ", 
Õ
->
bound
 );

1724 
	`tcfg_node_ãrm
–
fûp
, 
ndlök
->
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1725 
	`Ârötf
–
fûp
, " <= 0\n" );

1728 
	}
}

1734 
	$ö„as_c⁄s
() {

1736 
i
, 
j
, 
k
;

1738 
öf_¥oc_t
 *
ù
;

1739 
pid
;

1741 
	`Ârötf
–
fûp
, "\n\\ === infeasibleÖath constraints ===\n" );

1743  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

1745 if–!
ö˛ude_¥oc
[
i
] )

1748 
ù
 = &(
öf_¥ocs
[
i
]);

1749 
pid
 = 
ù
->
¥oc
->
id
;

1751  
j
 = 0; j < 
ù
->
num_bb
; j++ ) {

1752 
öf_node_t
 *
ib
 = &(
ù
->
öf_cfg
[
j
]);

1753 
bønch_t
 *
br
 = 
ib
->
bønch
;

1755 if–
br
 =
NULL
 )

1759  
k
 = 0; k < 
br
->
num_BA_c⁄Êi˘s
; k++ ) {

1760 
BA_c⁄Êi˘_t
 *
cf
 = &(
br
->
BA_c⁄Êi˘_li°
[
k
]);

1762 
cf_§c
 = 
cf
->
c⁄Êi˘_§c
->
bb
->
id
;

1763 
br_d°
 = (
cf
->
c⁄Êi˘_dú
 =
JUMP
Ë? 
br
->
bb
->
out_t
->
d°
->
id
 : br->bb->
out_n
->dst->id;

1766 
tcfg_∆ök_t
 *
cÊök
 = 
bbi_m≠
[
pid
][
cf_§c
];

1767 
tcfg_∆ök_t
 *
bæök
 = 
bbi_m≠
[
pid
][
br
->
bb
->
id
];

1768 
˘xt
 = 0;

1770  
cÊök
 !
NULL
 && 
bæök
 != NULL ) {

1773 
tcfg_edge_t
 *
br_out
 = 
bæök
->
bbi
->
out
;

1774  
br_out
 !
NULL
 && 
	`bbi_bid
(br_out->
d°
Ë!
br_d°
 )

1775 
br_out
 = br_out->
√xt_out
;

1776 if–
br_out
 =
NULL
 )

1777 
	`¥ötf
–"EdgênŸ found.\n" ), 
	`exô
(1);

1780 
	`tcfg_node_ãrm
–
fûp
, 
cÊök
->
bbi
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1781 
	`Ârötf
–
fûp
, " + " );

1782 
	`tcfg_edge_ãrm
–
fûp
, 
br_out
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1783 
	`ö„as_nuŒifõrs
–
cf
->
nuŒifõr_li°
, cf->
num_nuŒifõrs
, 
pid
, 
˘xt
 );

1785 
	`ö„as_blockcou¡
–
cÊök
->
bbi
, 
˘xt
 );

1788 
cÊök
 = cÊök->
√xt
;

1789 
bæök
 = bæök->
√xt
;

1790 
˘xt
++;

1795  
k
 = 0; k < 
br
->
num_BB_c⁄Êi˘s
; k++ ) {

1796 
BB_c⁄Êi˘_t
 *
cf
 = &(
br
->
BB_c⁄Êi˘_li°
[
k
]);

1797 
cfg_node_t
 *
cfbb
 = 
cf
->
c⁄Êi˘_§c
->
bb
;

1799 
cf_§c
 = 
cfbb
->
id
;

1800 
cf_d°
 = (
cf
->
c⁄Êi˘_dú
 =
JJ
 || cf->c⁄Êi˘_dú =
JF
Ë? 
cfbb
->
out_t
->
d°
->
id
 : cfbb->
out_n
->dst->id;

1801 
br_d°
 = (
cf
->
c⁄Êi˘_dú
 =
JJ
 || cf->c⁄Êi˘_dú =
FJ
Ë? 
br
->
bb
->
out_t
->
d°
->
id
 : br->bb->
out_n
->dst->id;

1804 
tcfg_∆ök_t
 *
cÊök
 = 
bbi_m≠
[
pid
][
cf_§c
];

1805 
tcfg_∆ök_t
 *
bæök
 = 
bbi_m≠
[
pid
][
br
->
bb
->
id
];

1806 
˘xt
 = 0;

1808  
cÊök
 !
NULL
 && 
bæök
 != NULL ) {

1811 
tcfg_edge_t
 *
cf_out
 = 
cÊök
->
bbi
->
out
;

1812  
cf_out
 !
NULL
 && 
	`bbi_bid
(cf_out->
d°
Ë!
cf_d°
 )

1813 
cf_out
 = cf_out->
√xt_out
;

1814 if–
cf_out
 =
NULL
 )

1815 
	`¥ötf
–"EdgênŸ found.\n" ), 
	`exô
(1);

1818 
tcfg_edge_t
 *
br_out
 = 
bæök
->
bbi
->
out
;

1819  
br_out
 !
NULL
 && 
	`bbi_bid
(br_out->
d°
Ë!
br_d°
 )

1820 
br_out
 = br_out->
√xt_out
;

1821 if–
br_out
 =
NULL
 )

1822 
	`¥ötf
–"EdgênŸ found.\n" ), 
	`exô
(1);

1825 
	`tcfg_edge_ãrm
–
fûp
, 
cf_out
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1826 
	`Ârötf
–
fûp
, " + " );

1827 
	`tcfg_edge_ãrm
–
fûp
, 
br_out
, 
BP_NONE
, 
NO_PREFIX
, 
NO_SUFFIX
 );

1828 
	`ö„as_nuŒifõrs
–
cf
->
nuŒifõr_li°
, cf->
num_nuŒifõrs
, 
pid
, 
˘xt
 );

1830 
	`ö„as_blockcou¡
–
cÊök
->
bbi
, 
˘xt
 );

1833 
cÊök
 = cÊök->
√xt
;

1834 
bæök
 = bæök->
√xt
;

1835 
˘xt
++;

1840 
	`Ârötf
–
fûp
, "\n" );

1843 
	}
}

1847 
	$c⁄°øöts
()

1849 
	`öô_v¨_gΩs
();

1851 
	`Ârötf
(
fûp
, "Maximize\n\n");

1852 
	`co°_func
();

1853 
	`Ârötf
(
fûp
, "\n\nSubjectÅo\n\n");

1855 i‡(
b¥ed_scheme
 !
NO_BPRED
)

1856 
	`b¥ed_mis£s
();

1857 i‡(
íabÀ_iˇche
)

1858 
	`ˇche_mis£s
();

1859 
	`Ârötf
(
fûp
, "\n");

1862 
	`tcfg_c⁄s
();

1864 i‡(
b¥ed_scheme
 !
NO_BPRED
) {

1865 
	`bfg_c⁄s
();

1866 
	`btg_c⁄s
();

1867 
	`tcfg_bfg_c⁄s
();

1870 i‡(
íabÀ_iˇche
) {

1871 
	`ˇche_c⁄s
();

1872 i‡(
b¥ed_scheme
 !
NO_BPRED
)

1873 
	`mp_ˇche_c⁄s
();

1874 
	`tcfg_e°unô_c⁄s
();

1877 if(
íabÀ_dˇche
)

1879 
	`tcfg_e°unô_c⁄s_ps
();

1883 if–
íabÀ_ö„as
 )

1884 
	`ö„as_c⁄s
();

1888 
	`u£r_c⁄s_c⁄ãxt
();

1890 
	`wrôe_v¨s
();

1891 
	}
}

1895 #unde‡
PLUS


1896 #unde‡
MINUS


	@infdump.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~"iß.h
"

26 
	~"cfg.h
"

27 
	~"ö„asibÀ.h
"

30 
¥og_t
 
¥og
;

33 
	$¥ötReg
–
ªgpos
 ) {

35 if–
ªgLi°
[
ªgpos
].
vÆid
 )

36 
	`¥ötf
–"ªg[%2d]: %s(%d)\n", 
ªgpos
, 
ªgLi°
[ªgpos].
dîôªe
,ÑegLi°[ªgpos].
vÆue
 );

38 
	`¥ötf
–"ªg[%2d]: %s(-)\n", 
ªgpos
, 
ªgLi°
[ªgpos].
dîôªe
 );

39 
	`fÊush
–
°dout
 );

40 
	}
}

43 
	$¥ötIn°r
–
ö¢_t
 *
is
 ) {

45 
	`¥ötf
–"0x%†%†%†%†%s\n", 
is
->
addr
, is->
›
, is->
r1
, is->
r2
, is->
r3
 );

46 
	`fÊush
–
°dout
 );

47 
	}
}

50 
	$¥ötIn°ru˘i⁄s
() {

52 
i
, 
j
, 
k
;

53 
öf_¥oc_t
 *
ù
;

54 
öf_node_t
 *
ib
;

55 
ö¢_t
 *
is
;

57  
i
 = 0; i < 
num_ö¢_°
; i++ ) {

58 
is
 = &(
ö¢li°_°
[
i
]);

59 
	`¥ötf
–"[°,--,%2d] 0x%†%†%†%†%s\n", 
i
, 
is
->
addr
, is->
›
, is->
r1
, is->
r2
, is->
r3
 );

62  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

63 
ù
 = &(
öf_¥ocs
[
i
]);

64  
j
 = 0; j < 
ù
->
num_bb
; j++ ) {

65 
ib
 = &(
ù
->
öf_cfg
[
j
]);

66  
k
 = 0; k < 
ib
->
num_ö¢
; k++ ) {

67 
is
 = &(
ib
->
ö¢li°
[
k
]);

68 
	`¥ötf
–"[%2d,%2d,%2d] 0x%†%†%†%†%s\n", 
i
, 
j
, 
k
, 
is
->
addr
, is->
›
, is->
r1
, is->
r2
, is->
r3
 );

73 
	}
}

76 *
	$gëDúName
–
dú
 ) {

78  
dú
 ) {

79 
GT
:  "GT";

80 
GE
:  "GE";

81 
LT
:  "LT";

82 
LE
:  "LE";

83 
EQ
:  "EQ";

84 
NE
:  "NE";

85 
NA
:  "NA";

89 
	}
}

92 
	$¥ötBAC⁄Êi˘
–
BA_c⁄Êi˘_t
 *
cf
 ) {

94 
i
;

96 if–
cf
->
c⁄Êi˘_dú
 =
JUMP
 )

97 
	`¥ötf
–"-- <%d::%d> JUMP", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
, cf->c⁄Êi˘_§c->
löío
 );

98 if–
cf
->
c⁄Êi˘_dú
 =
FALL
 )

99 
	`¥ötf
–"-- <%d::%d> FALL", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
, cf->c⁄Êi˘_§c->
löío
 );

101  
i
 = 0; i < 
cf
->
num_nuŒifõrs
; i++ )

102 
	`¥ötf
–" _<%d::%d> ", 
cf
->
nuŒifõr_li°
[
i
]->
bb
->
id
, cf->nuŒifõr_li°[i]->
löío
 );

103 
	`¥ötf
( "\n" );

106 
	}
}

108 
	$¥ötBBC⁄Êi˘
–
BB_c⁄Êi˘_t
 *
cf
 ) {

110 
i
;

112 if–
cf
->
c⁄Êi˘_dú
 =
JJ
 )

113 
	`¥ötf
–"-- <%d> JUMP/JUMP", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
 );

114 if–
cf
->
c⁄Êi˘_dú
 =
JF
 )

115 
	`¥ötf
–"-- <%d> JUMP/FALL", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
 );

116 if–
cf
->
c⁄Êi˘_dú
 =
FJ
 )

117 
	`¥ötf
–"-- <%d> FALL/JUMP", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
 );

118 if–
cf
->
c⁄Êi˘_dú
 =
FF
 )

119 
	`¥ötf
–"-- <%d> FALL/FALL", 
cf
->
c⁄Êi˘_§c
->
bb
->
id
 );

121  
i
 = 0; i < 
cf
->
num_nuŒifõrs
; i++ )

122 
	`¥ötf
–" _<%d::%d>", 
cf
->
nuŒifõr_li°
[
i
]->
bb
->
id
, cf->nuŒifõr_li°[i]->
löío
 );

123 
	`¥ötf
( "\n" );

126 
	}
}

129 
	$¥ötBønch
–
bønch_t
 *
br
, 
¥ötcf
 ) {

131 
i
, 
k
;

133 if–
br
 =
NULL
 )

136 
	`¥ötf
–"B <%d,%3d>", 
br
->
bb
->
¥oc
->
id
, br->bb->id );

137 
	`¥ötf
( "Ñhs:" );

138 if–
br
->
rhs_v¨
 )

139 
	`¥ötf
( "var" );

141 
	`¥ötf
–"%3d", 
br
->
rhs
 );

143 
	`¥ötf
–" jump:%s", 
	`gëDúName
–
br
->
jump_c⁄d
 ));

144 
	`¥ötf
–" dîi:%s\n", 
br
->
dîôªe
 );

146 if–!
¥ötcf
 )

168 if–
br
->
num_BA_c⁄Êi˘s
 > 0 ) {

169 
	`¥ötf
( "- BA conflicts:\n" );

170  
i
 = 0; i < 
br
->
num_BA_c⁄Êi˘s
; i++ )

171 
	`¥ötBAC⁄Êi˘
–&(
br
->
BA_c⁄Êi˘_li°
[
i
]) );

173 if–
br
->
num_BB_c⁄Êi˘s
 > 0 ) {

174 
	`¥ötf
( "- BB conflicts:\n" );

175  
i
 = 0; i < 
br
->
num_BB_c⁄Êi˘s
; i++ )

176 
	`¥ötBBC⁄Êi˘
–&(
br
->
BB_c⁄Êi˘_li°
[
i
]) );

180 
	}
}

183 
	$¥ötAssign
–
assign_t
 *
assg
, 
¥ötcf
 ) {

185 
i
;

187 
	`¥ötf
–"A <%d,%3d,%3d> ", 
assg
->
bb
->
¥oc
->
id
,ássg->bb->id,ássg->
löío
 );

188 
	`¥ötf
( "rhs:" );

189 if–
assg
->
rhs_v¨
 )

190 
	`¥ötf
( "var " );

192 
	`¥ötf
–"%3d ", 
assg
->
rhs
 );

193 
	`¥ötf
–"dîi:%s\n", 
assg
->
dîôªe
 );

195 if–!
¥ötcf
 )

207 
	}
}

210 
	$¥ötEf„˘s
–
¥ötcf
 ) {

212 
i
, 
j
, 
k
;

213 
öf_node_t
 *
ib
;

215 
	`¥ötf
( "--------------------------------\n" );

216  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

217  
j
 = 0; j < 
öf_¥ocs
[
i
].
num_bb
; j++ ) {

218 
ib
 = &(
öf_¥ocs
[
i
].
öf_cfg
[
j
]);

219  
k
 = 0; k < 
ib
->
num_assign
; k++ )

220 
	`¥ötAssign
–
ib
->
assig∆i°
[
k
], 
¥ötcf
 );

221 
	`¥ötBønch
–
ib
->
bønch
, 
¥ötcf
 );

224 
	`¥ötf
( "--------------------------------\n" );

226 
	}
}

	@infeasible.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~"iß.h
"

26 
	~"cfg.h
"

27 
	~"tcfg.h
"

28 
	~"lo›s.h
"

29 
	~"ö„asibÀ.h
"

32 
¥og_t
 
¥og
;

33 
iß_t
 *
iß
;

35 
num_tcfg_nodes
;

36 
tcfg_node_t
 **
tcfg
;

38 
tcfg_∆ök_t
 ***
bbi_m≠
;

39 
lo›_t
 **
lo›_m≠
;

45 
	$t›o_ˇŒ
–**
ˇŒìs
, *
num_ˇŒì
 ) {

47 
i
, 
cuºp
;

49 *
come‰om
;

50 
come‰omsize
;

51 *
m¨kfö
;

52 
fö
;

54 
cou¡d⁄e
;

56 
come‰om
 = 
NULL
;

57 
come‰omsize
 = 0;

58 
m¨kfö
 = (*Ë
	`ˇŒoc
–
¥og
.
num_¥ocs
, () );

59 
ˇŒgøph
 = (*Ë
	`ˇŒoc
–
¥og
.
num_¥ocs
, () );

61 
cou¡d⁄e
 = 0;

64 
cuºp
 = 
¥og
.
maö_¥oc
;

66  
cou¡d⁄e
 < 
¥og
.
num_¥ocs
 ) {

68 
fö
 = 1;

69  
i
 = 0; 
fö
 && i < 
num_ˇŒì
[
cuºp
]; i++ )

70 if–
m¨kfö
[ 
ˇŒìs
[
cuºp
][
i
] ] != 2 )

71 
fö
 = 0;

73 if–
num_ˇŒì
[
cuºp
] <0 || 
fö
 ) {

74 
m¨kfö
[
cuºp
] = 2;

75 
ˇŒgøph
[
cou¡d⁄e
++] = 
cuºp
;

78 if–!
come‰omsize
 )

81 
cuºp
 = 
come‰om
[--
come‰omsize
];

85 
m¨kfö
[
cuºp
] = 1;

86 
come‰om
 = (*Ë
	`ªÆloc
–come‰om, (
come‰omsize
+1) * () );

87 
come‰om
[
come‰omsize
++] = 
cuºp
;

90 
fö
 = 1;

91  
i
 = 0; 
fö
 && i < 
num_ˇŒì
[
cuºp
]; i++ ) {

92 if–
m¨kfö
[
ˇŒìs
[
cuºp
][
i
]] != 2 ) {

93 
cuºp
 = 
ˇŒìs
[cuºp][
i
];

94 
fö
 = 0;

97 if–
fö
 )

98 
	`¥ötf
–"Unvisôed cÆÀdÖro˚duªÇŸ dëe˘ed.\n" ), 
	`exô
(1);

102 
	`‰ì
–
come‰om
 );

103 
	`‰ì
–
m¨kfö
 );

106 
	}
}

109 
	$ªadIn°r
–*
obj_fûe
 ) {

111 
i
, 
j
, 
k
;

113 
FILE
 *
f
;

114 
tmp
[120];

115 
addr
;

117 
¥oc_t
 *
p
;

118 
cfg_node_t
 *
b
;

119 
de_ö°_t
 *
d
;

121 
öf_¥oc_t
 *
ù
;

122 
öf_node_t
 *
ib
;

123 
ö¢_t
 *
is
;

126 
n
, 
Àn
;

127 *
num_ˇŒì
 = (*Ë
	`ˇŒoc
–
¥og
.
num_¥ocs
, () );

128 **
ˇŒìs
 = (**Ë
	`mÆloc
–
¥og
.
num_¥ocs
 * (*) );

129  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ )

130 
ˇŒìs
[
i
] = 
NULL
;

133 
öf_¥ocs
 = (
öf_¥oc_t
*Ë
	`mÆloc
–
¥og
.
num_¥ocs
 * (inf_proc_t) );

134  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

135 
p
 = &(
¥og
.
¥ocs
[
i
]);

136 
ù
 = &(
öf_¥ocs
[
i
]);

138 
ù
->
¥oc
 = 
p
;

139 
ù
->
num_bb
 = 
p
->num_bb;

140 
ù
->
öf_cfg
 = (
öf_node_t
*Ë
	`mÆloc
–ù->
num_bb
 * (inf_node_t) );

142  
j
 = 0; j < 
ù
->
num_bb
; j++ ) {

143 
b
 = &(
p
->
cfg
[
j
]);

144 
ib
 = &(
ù
->
öf_cfg
[
j
]);

146 
ib
->
bb
 = 
b
;

147 
ib
->
num_ö¢
 = 
b
->
num_ö°
;

148 
ib
->
ö¢li°
 = (
ö¢_t
*Ë
	`mÆloc
–ib->
num_ö¢
 * (insn_t) );

149 
ib
->
num_assign
 = 0;

150 
ib
->
assig∆i°
 = 
NULL
;

151 
ib
->
bønch
 = 
NULL
;

152 
ib
->
lo›_id
 = -1;

153 
ib
->
exec_cou¡
 = -1;

155  
k
 = 0; k < 
ib
->
num_ö¢
; k++ ) {

156 
d
 = &(
b
->
code
[
k
]);

157 
is
 = &(
ib
->
ö¢li°
[
k
]);

159 
	`•rötf
–
is
->
addr
, "%x", 
d
->addr );

160 
	`°r˝y
–
is
->
›
, 
iß
[
d
->
›_íum
].
«me
 );

161 
is
->
r1
[0] = '\0';

162 
is
->
r2
[0] = '\0';

163 
is
->
r3
[0] = '\0';

166 
	`•rötf
–
tmp
, "£d -¿'/^00%s/p' %s.di†|áwk '{¥öà$4}' >Ålöe", 
is
->
addr
, 
obj_fûe
 );

167 
	`sy°em
–
tmp
 );

168 
	`sy°em
( "catÅline |År ',' '\\ ' |År '(' '\\ ' |År ')' '\\ ' >Åopr" );

170 
f
 = 
	`f›í
( "topr", "r" );

171 
	`fsˇnf
–
f
, "%†%†%s", 
is
->
r1
, is->
r2
, is->
r3
 );

172 
	`f˛o£
–
f
 );

179 
	`•rötf
–
tmp
, "gª∞__°¨à%s.di†|áwk '{¥öà$1,$3,$4}' > st.dis", 
obj_fûe
 );

180 
	`sy°em
–
tmp
 );

181 
	`•rötf
–
tmp
, "ˇà°.di†|Å∏',' '\\ ' |Å∏'(' '\\ ' |Å∏')' '\\ ' >Öª", 
obj_fûe
 );

182 
	`sy°em
–
tmp
 );

184 
num_ö¢_°
 = 0;

185 
ö¢li°_°
 = 
NULL
;

187 
f
 = 
	`f›í
( "pre", "r" );

188  
	`fgës
–
tmp
, 
INSN_LEN
, 
f
 )) {

189 
num_ö¢_°
++;

190 
ö¢li°_°
 = (
ö¢_t
*Ë
	`ªÆloc
–ö¢li°_°, 
num_ö¢_°
 * (insn_t) );

192 
is
 = &(
ö¢li°_°
[
num_ö¢_°
-1]);

193 
is
->
r1
[0] = '\0';

194 
is
->
r2
[0] = '\0';

195 
is
->
r3
[0] = '\0';

196 
	`ssˇnf
–
tmp
, "%x %†%†%†%s\n", &
addr
, 
is
->
›
, is->
r1
, is->
r2
, is->
r3
 );

197 
	`•rötf
–
is
->
addr
, "%x",áddr );

199 
	`f˛o£
–
f
 );

201 
	`sy°em
( "rm -fÅlineÅoprÖre st.dis" );

203 
	`t›o_ˇŒ
–
ˇŒìs
, 
num_ˇŒì
 );

206 
n
 = 
¥og
.
num_¥ocs
 - 1;

207 
Àn
 = 
¥og
.
num_¥ocs
 / 2;

208  
i
 = 0; i < 
Àn
; i++ ) {

209 
tmp
 = 
ˇŒgøph
[
i
];

210 
ˇŒgøph
[
i
] = cÆlgøph[
n
-i];

211 
ˇŒgøph
[
n
-
i
] = 
tmp
;

214 
	`‰ì
–
num_ˇŒì
 );

215  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ )

216 
	`‰ì
–
ˇŒìs
[
i
] );

217 
	`‰ì
–
ˇŒìs
 );

218 
	}
}

225 
	$isDì≥r
–
∑·
, 
pbef
 ) {

227 
i
;

228  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

229 if–
ˇŒgøph
[
i
] =
∑·
 )

231 if–
ˇŒgøph
[
i
] =
pbef
 )

235 
	}
}

238 
	$£tCou¡Rec
–
tcfg_node_t
 *
bbi
, 
cou¡
, 
ªtu∫_pid
 ) {

240 
tcfg_edge_t
 *
e
;

242 if–
bbi
->
exec_cou¡
 >
cou¡
 ) {

243 
	`¥ötf
–"Exi°ög cou¡Åcfg %d(%d::%dË%d\n", 
bbi
->
id
, bbi->
bb
->
¥oc
->id, bbi->bb->id, bbi->
exec_cou¡
 );

246 
bbi
->
exec_cou¡
 = 
cou¡
;

249  
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
 ) {

250 if–
e
->
d°
->
bb
->
¥oc
->
id
 !
ªtu∫_pid
 )

251 
	`£tCou¡Rec
–
e
->
d°
, 
cou¡
, 
ªtu∫_pid
 );

254 
	}
}

257 
	$£tCou¡
–
tcfg_node_t
 *
bbi
, 
cou¡
 ) {

259 if–
bbi
->
exec_cou¡
 >
cou¡
 ) {

260 
	`¥ötf
–"Exi°ög cou¡Åcfg %d(%d::%dË%d\n", 
bbi
->
id
, bbi->
bb
->
¥oc
->id, bbi->bb->id, bbi->
exec_cou¡
 );

263 
bbi
->
exec_cou¡
 = 
cou¡
;

267 if–
bbi
->
bb
->
ˇŒì
 !
NULL
 && bbi->
out
 != NULL )

268 
	`£tCou¡Rec
–
bbi
->
out
->
d°
, 
cou¡
, bbi->
bb
->
¥oc
->
id
 );

271 
	}
}

274 
	$£tLo›IDRec
–
tcfg_node_t
 *
bbi
, 
Õid
, 
ªtu∫_pid
 ) {

276 
tcfg_edge_t
 *
e
;

277 
öf_lo›_t
 *
Õ
 = &(
öf_lo›s
[
Õid
]);

279 if–
bbi
->
lo›_id
 =
Õid
 || 
	`isDì≥r
–
öf_lo›s
[bbi->lo›_id].
pid
, 
Õ
->pid ))

282 
bbi
->
lo›_id
 = 
Õid
;

283 
	`¥ötf
( "SetÅcfg %d(%d::%d)Üoop:%dÉntry:(%d::%d) bound:%d\n",

284 
bbi
->
id
, bbi->
bb
->
¥oc
->id, bbi->bb->id, 
Õid
, 
Õ
->
pid
,Üp->
íåy
,Üp->
bound
 );

286  
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
 ) {

287 if–
e
->
d°
->
bb
->
¥oc
->
id
 !
ªtu∫_pid
 )

288 
	`£tLo›IDRec
–
e
->
d°
, 
Õid
, 
ªtu∫_pid
 );

291 
	}
}

294 
	$£tLo›ID
–
tcfg_node_t
 *
bbi
, 
Õid
 ) {

296 
öf_lo›_t
 *
Õ
 = &(
öf_lo›s
[
Õid
]);

298 if–
bbi
->
lo›_id
 =
Õid
 || 
	`isDì≥r
–
öf_lo›s
[bbi->lo›_id].
pid
, 
Õ
->pid ))

301 
bbi
->
lo›_id
 = 
Õid
;

302 
	`¥ötf
( "SetÅcfg %d(%d::%d)Üoop:%dÉntry:(%d::%d) bound:%d\n",

303 
bbi
->
id
, bbi->
bb
->
¥oc
->id, bbi->bb->id, 
Õid
, 
Õ
->
pid
,Üp->
íåy
,Üp->
bound
 );

306 if–
bbi
->
bb
->
ˇŒì
 !
NULL
 && bbi->
out
 != NULL )

307 
	`£tLo›IDRec
–
bbi
->
out
->
d°
, 
Õid
, bbi->
bb
->
¥oc
->
id
 );

310 
	}
}

316 
	$m¨kLo›
–
öf_¥oc_t
 *
ù
, 
öf_node_t
 *
hód
, inf_node_à*
ib
, 
Õid
, **
checked
 ) {

318 
i
;

319 
tcfg_∆ök_t
 *
ndlök
;

320 
öf_lo›_t
 *
Õ
 = &(
öf_lo›s
[
Õid
]);

324 if–
ib
->
lo›_id
 =-1 || 
öf_lo›s
[ib->lo›_id].
íåy
 < 
Õ
->entry ) {

325 
	`¥ötf
–"Së %d::%dÜo›:%dÉ¡ry:%d bound:%d\n", 
ù
->
¥oc
->
id
, 
ib
->
bb
->id, 
Õid
, 
Õ
->
íåy
,Üp->
bound
 );

326 
ib
->
lo›_id
 = 
Õid
;

329  
ndlök
 = 
bbi_m≠
[
ù
->
¥oc
->
id
][
ib
->
bb
->id];Çdlök !
NULL
;Çdlök =Çdlök->
√xt
 )

330 
	`£tLo›ID
–
ndlök
->
bbi
, 
Õid
 );

333 
	`¥ötf
–"Ne°ed %d::%dÜo›:%dÉ¡ry:%d (nŸ upd©ed)\n", 
ù
->
¥oc
->
id
, 
ib
->
bb
->id, ib->
lo›_id
, 
öf_lo›s
[ib->lo›_id].
íåy
 );

335 (*
checked
)[
ib
->
bb
->
id
] = 1;

337 if–
ib
 =
hód
 )

340  
i
 = 0; i < 
ib
->
bb
->
num_ö
; i++ ) {

341 
¥e
 = 
ib
->
bb
->
ö
[
i
]->
§c
->
id
;

342 if–!(*
checked
)[
¥e
] &&Öª > 
Õ
->
íåy
 )

343 
	`m¨kLo›
–
ù
, 
hód
, &(ù->
öf_cfg
[
¥e
]), 
Õid
, 
checked
 );

345 
	}
}

352 
	$ªadBlockCou¡s
–*
obj_fûe
 ) {

354 
FILE
 *
f
;

355 
tmp
[256];

356 
i
, 
pid
, 
bid
, 
pid2
, 
íåy
, 
cou¡
;

358 
öf_¥oc_t
 *
ù
;

359 
öf_node_t
 *
ib
;

361  
i
 = 0; i < 
num_tcfg_nodes
; i++ ) {

362 
tcfg
[
i
]->
lo›_id
 = -1;

363 
tcfg
[
i
]->
exec_cou¡
 = -1;

367 
	`•rötf
–
tmp
, "ˇà%s.c⁄†|Å∏'c' '\\ ' |áwk '$2 ~ \"=\" {¥öà$1,$NF}' |Å∏'.' '\\ ' > cou¡s", 
obj_fûe
 );

368 
	`sy°em
–
tmp
 );

369 
f
 = 
	`f›í
( "counts", "r" );

370  
	`fsˇnf
–
f
, "%d %d %d", &
pid
, &
bid
, &
cou¡
 ) !
EOF
 ) {

372 
tcfg_∆ök_t
 *
ndlök
;

375 if–!
ö˛ude_¥oc
[
pid
] ) {

376 
	`¥ötf
( "Ignoring count forÉxcluded function.\n" );

379 
öf_¥ocs
[
pid
].
öf_cfg
[
bid
].
exec_cou¡
 = 
cou¡
;

382  
ndlök
 = 
bbi_m≠
[
pid
][
bid
];Çdlök !
NULL
;Çdlök =Çdlök->
√xt
 )

383 
	`£tCou¡
–
ndlök
->
bbi
, 
cou¡
 );

385 
	`f˛o£
–
f
 );

388 
	`•rötf
–
tmp
, "gª∞\\< %s.c⁄†| sed '/+/d' |Å∏'-' '\\ ' |Å∏'=' '\\ ' |Å∏'\\<' '\\ ' >Åmp", 
obj_fûe
 );

389 
	`sy°em
–
tmp
 );

390 
	`sy°em
( "awk '{if(NF==4)Örint $1,$3,$2}'Åmp |År 'c' '\\ ' |År '.' '\\ ' > bounds" );

392 
num_öf_lo›s
 = 0;

393 
öf_lo›s
 = 
NULL
;

395  
pid
 = 0;Öid < 
¥og
.
num_¥ocs
;Öid++ ) {

396 if–
ö˛ude_¥oc
[
pid
] ) {

397 
ù
 = &(
öf_¥ocs
[
pid
]);

398  
bid
 = 0; bid < 
ù
->
num_bb
; bid++ )

399 
ù
->
öf_cfg
[
bid
].
lo›_id
 = -1;

403 
f
 = 
	`f›í
( "bounds", "r" );

404  
	`fsˇnf
–
f
, "%d %d %d %d %d", &
pid
, &
bid
, &
pid2
, &
íåy
, &
cou¡
 ) !
EOF
 ) {

406 
Õid
, 
hód
, 
èû
;

407 
lo›_t
 *
Õn
;

408 
öf_lo›_t
 *
Õ
;

409 
öf_node_t
 *
hd
, *
è
;

411 *
checked
;

415 if–!
ö˛ude_¥oc
[
pid
] || !ö˛ude_¥oc[
pid2
] ) {

416 
	`¥ötf
( "Ignoring bound forÉxcluded function.\n" );

420 
ù
 = &(
öf_¥ocs
[
pid
]);

421 
ib
 = &(
ù
->
öf_cfg
[
bid
]);

423 
Õid
 = 
num_öf_lo›s
++;

424 
öf_lo›s
 = (
öf_lo›_t
*Ë
	`ªÆloc
–öf_lo›s, 
num_öf_lo›s
 * (inf_loop_t) );

425 
Õ
 = &(
öf_lo›s
[
Õid
]);

426 
Õ
->
pid
 =Öid;

427 
Õ
->
íåy
 =Éntry;

428 
Õ
->
bound
 = 
cou¡
;

432 
Õn
 = 
lo›_m≠
[
bbi_m≠
[
pid
][
bid
]->
bbi
->
id
];

433 
hód
 = 
	`bbi_bid
–
Õn
->head );

434 
èû
 = 
	`bbi_bid
–
Õn
->tail );

435 
hd
 = &(
ù
->
öf_cfg
[
hód
]);

436 
è
 = &(
ù
->
öf_cfg
[
èû
]);

437 
checked
 = (*Ë
	`ˇŒoc
–
ù
->
num_bb
, () );

438 
	`m¨kLo›
–
ù
, 
hd
, 
è
, 
Õid
, &
checked
 );

439 
	`‰ì
–
checked
 );

441 
	`f˛o£
–
f
 );

443 
	`sy°em
( "rmÅmp counts bounds" );

445 
	}
}

448 
	$ö„as_™Æysis
–*
obj_fûe
 ) {

450 
	`ªadIn°r
–
obj_fûe
 );

451 
	`ªadBlockCou¡s
–
obj_fûe
 );

453 
	`˛órReg
();

454 
	`öôRegSë
();

457 
	`¥ötf
–"Sèπög symbﬁi¯executi⁄...\n" ); 
	`fÊush
(
°dout
);

458 
	`execuã
();

461 
	`¥ötf
–"Sèπög c⁄Êi˘ dëe˘i⁄...\n" ); 
	`fÊush
(
°dout
);

462 
	`dëe˘C⁄Êi˘s
();

463 
	`¥ötf
–"Dëe˘ed %d BBánd %d BA\n", 
num_BB
, 
num_BA
 ); 
	`fÊush
(
°dout
);

465 
	}
}

	@infeasible.h

23 
	~"cfg.h
"

25 
DEBUG_INFEAS
;

27 
¥og_t
 
¥og
;

28 
iß_t
 *
iß
;

30 *
ö˛ude_¥oc
;

33 
	#REG_RETURN
 
ªgLi°
[2].
«me


	)

36 
	#°ªq
(
a
, 
b
Ë◊[0] !'\0' && 
	`°rcmp
◊,bË=0)

	)

40 
	#INVALID
 0

	)

41 
	#VALID
 1

	)

42 
	#CONST
 0

	)

43 
	#VAR
 1

	)

44 
	#DEF_VAL
 0

	)

45 
	#DEF_DERI
 ""

	)

48 
	#OP_LEN
 9

49 
	#DERI_LEN
 800

50 
	#INSN_LEN
 50

51 
	#NO_REG
 68

	)

53 
	#NONE
 0

	)

54 
	#JUMP
 1

	)

55 
	#FALL
 2

	)

57 
	#JJ
 3

58 
	#JF
 4

59 
	#FJ
 5

60 
	#FF
 6

61 

	)

63 
	#GT
 1

64 
	#GE
 2

65 
	#LT
 3

66 
	#LE
 4

67 
	#EQ
 5

68 
	#NE
 6

69 
	#NA
 0

70 

	)

73 
	#KO
 -2

74 
	#NIL
 -1

	)

75 
	#SLTI
 1

	)

76 
	#SLT
 2

	)

80 
	m«me
[
OP_LEN
];

81 
	mdîôªe
[
DERI_LEN
];

82 
	mvÆue
;

83 
	mvÆid
;

84 
	mÊag
;

85 } 
	tªg_t
;

88 
	maddr
[
OP_LEN
];

89 
	m›
[
OP_LEN
];

90 
	mr1
[
OP_LEN
];

91 
	mr2
[
OP_LEN
];

92 
	mr3
[
OP_LEN
];

93 } 
	tö¢_t
;

96 
bønch_t
 
	tbønch_t
;

99 
cfg_node_t
 *
	mbb
;

100 
	mdîôªe
[
DERI_LEN
];

101 
	mrhs
;

102 
	mrhs_v¨
;

103 
	mlöío
;

104 } 
	tassign_t
;

107 
assign_t
 *
	mc⁄Êi˘_§c
;

108 
	mc⁄Êi˘_dú
;

109 
	mnum_nuŒifõrs
;

110 
assign_t
 **
	mnuŒifõr_li°
;

111 } 
	tBA_c⁄Êi˘_t
;

114 
bønch_t
 *
	mc⁄Êi˘_§c
;

115 
	mc⁄Êi˘_dú
;

116 
	mnum_nuŒifõrs
;

117 
assign_t
 **
	mnuŒifõr_li°
;

118 } 
	tBB_c⁄Êi˘_t
;

120 
	sbønch_t
 {

121 
cfg_node_t
 *
	mbb
;

122 
	mdîôªe
[
DERI_LEN
];

123 
	mrhs
;

124 
	mrhs_v¨
;

125 
	mjump_c⁄d
;

126 
	mnum_BA_c⁄Êi˘s
;

127 
BA_c⁄Êi˘_t
 *
	mBA_c⁄Êi˘_li°
;

128 
	mnum_BB_c⁄Êi˘s
;

129 
BB_c⁄Êi˘_t
 *
	mBB_c⁄Êi˘_li°
;

133 
cfg_node_t
 *
	mbb
;

134 
	mnum_ö¢
;

135 
ö¢_t
 *
	mö¢li°
;

136 
	mnum_assign
;

137 
assign_t
 **
	massig∆i°
;

138 
bønch_t
 *
	mbønch
;

139 
	mlo›_id
;

140 
	mexec_cou¡
;

141 } 
	töf_node_t
;

144 
¥oc_t
 *
	m¥oc
;

145 
	mnum_bb
;

146 
öf_node_t
 *
	möf_cfg
;

147 } 
	töf_¥oc_t
;

150 
	mpid
;

151 
	míåy
;

152 
	mbound
;

153 } 
	töf_lo›_t
;

155 
öf_¥oc_t
 *
	göf_¥ocs
;

157 *
	gˇŒgøph
;

159 
ªg_t
 
	gªgLi°
[
NO_REG
];

161 
	gnum_ö¢_°
;

162 
ö¢_t
 *
	gö¢li°_°
;

165 
	gnum_öf_lo›s
;

166 
öf_lo›_t
 *
	göf_lo›s
;

173 
	gnum_BA
;

174 
	gnum_BB
;

176 
ö„as_™Æysis
–*
obj_fûe
 );

	@isa.c

23 
	~<°dio.h
>

24 
	~"iß.h
"

28 
iß_t
 *
	giß
;

29 
	gnum_iß
;

35 
	$öô_iß
()

38 
	`öô_iß_ss
();

40 
	}
}

45 
ölöe
 

46 
	$ö°_ty≥
(
de_ö°_t
 *
ö°
)

48  
iß
[
ö°
->
›_íum
].
ty≥
;

49 
	}
}

54 
	$max_ö°_œt
(
de_ö°_t
 *
ö°
)

56 
fu
;

58  
	`ss_max_ö°_œt
(
ö°
);

59 
	}
}

73 
	$dump_iß
()

75 
i
;

77 
i
 = 0; i < 
num_iß
; i++)

78 
	`¥ötf
("%3d: %-10†ty≥ %x\n", 
i
, 
iß
[i].
«me
, iß[i].
ty≥
);

79 
	}
}

	@isa.h

22 #i‚de‡
ISA_H


23 
	#ISA_H


	)

24 
	~"addªss.h
"

25 
	~"ˇche.h
"

31 
	eö°_ty≥_t
 {

32 
	mINST_NOP
 = 0,

34 
	mINST_ICOMP
,

35 
	mINST_FCOMP
,

37 
	mINST_LOAD
,

38 
	mINST_STORE
,

40 
	mINST_COND
,

41 
	mINST_UNCOND
,

42 
	mINST_CALL
,

43 
	mINST_RET
,

45 
	mINST_TRAP


50 
	m›code
;

51 
	mty≥
;

52 *
	m«me
;

53 } 
	tiß_t
;

57 
addr_t
 
	maddr
;

58 
addr_t
 
	mr_addr
;

59 
	m›_íum
;

61 
	msize
;

63 
	mnum_ö
, 
	mnum_out
;

64 *
	mö
, *
	mout
;

65 
	mimm
;

68 
addr_t
 
	mèrgë
;

70 
acs_p
** 
	macs_ö
;

72 
acs_p
** 
	macs_out
;

74 
ric_p
* 
	mabs_ªg
;

76 
ACCESS_T
 
	md©a_ac˚ss
;

78 
ACCESS_T
 
	mö°_ac˚ss
;

79 
ACCESS_T
 
	ml2_ö°_ac˚ss
;

80 
ACCESS_T
 
	mu1_d©a_ac˚ss
;

81 
ric_p
 
	mmod_addr
;

82 } 
	tde_ö°_t
;

	@loops.c

25 
	~<°dlib.h
>

26 
	~"comm⁄.h
"

27 
	~"lo›s.h
"

31 
	#lo›_bbb_idx
(
id
Ë((idË- 
Õ_bbb_off£t
 - 
num_bfg_nodes
)

	)

33 
num_tcfg_nodes
;

34 
num_tcfg_edges
;

35 
tcfg_node_t
 **
tcfg
;

36 
tcfg_edge_t
 **
tcfg_edges
;

38 
lo›_t
 **
	glo›s
;

39 
	gnum_tcfg_lo›s
;

40 
lo›_t
 **
	glo›_m≠
;

41 
lo›_t
 ***
	glo›_comm_™˚s
;

46 
lo›_t
 *

47 
	$√w_lo›
(
tcfg_edge_t
 *
e
)

49 
i
;

50 
num
 = 0;

51 
lo›_t
 *
Õ
;

53 
Õ
 = (
lo›_t
 *Ë
	`ˇŒoc
(1, (loop_t));

54 
	`CHECK_MEM
(
Õ
);

55 
Õ
->
id
 = 
num_tcfg_lo›s
++;

56 
Õ
->
hód
 = 
e
->
d°
;Üp->
èû
 =É->
§c
;

58  
Õ
;

59 
	}
}

64 
	$£t_lo›_Êags
(
Êag
)

66 
i
;

68 
i
 = 0; i < 
num_tcfg_lo›s
; i++)

69 
lo›s
[
i
]->
Êags
 = 
Êag
;

70 
	}
}

75 
	$föd_lo›s
()

77 
i
;

78 
tcfg_edge_t
 *
e
;

80 
num_tcfg_lo›s
 = 1;

81 
lo›_m≠
 = (
lo›_t
 **Ë
	`ˇŒoc
(
num_tcfg_nodes
, (loop_t *));

82 
	`CHECK_MEM
(
lo›_m≠
);

84 
i
 = 0; i < 
num_tcfg_edges
; i++) {

85 
e
 = 
tcfg_edges
[
i
];

86 i‡(
	`bbi_backedge
(
e
)) {

87 i‡(
lo›_m≠
[
e
->
d°
->
id
] !
NULL
)

89 i‡(
	`bb_is_lo›_hód
(
e
->
d°
->
bb
Ë&& 
	`bb_is_lo›_èû
”->
§c
->bb))

90 
lo›_m≠
[
e
->
d°
->
id
] =Üo›_m≠[e->
§c
->id] = 
	`√w_lo›
(e);

94 
lo›s
 = (
lo›_t
 **Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (loop_t *));

95 
	`CHECK_MEM
(
lo›s
);

97 
lo›s
[0] = (
lo›_t
 *Ë
	`ˇŒoc
(1, (loop_t));

98 
lo›s
[0]->
hód
 = 
tcfg
[0];

99 
lo›_m≠
[0] = 
lo›s
[0];

100 
	`CHECK_MEM
(
lo›s
[0]);

101 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

102 i‡(
lo›_m≠
[
i
] !
NULL
)

103 
lo›s
[
lo›_m≠
[
i
]->
id
] =Üoop_map[i];

105 
	}
}

111 
	$exô_lo›
(
tcfg_edge_t
 *
e
)

113 
lo›_t
 *
Õ
;

114 
hód_bid
, 
èû_bid
, 
d°_bid
;

116 
Õ
 = 
lo›_m≠
[
e
->
§c
->
id
];

117 i‡(
Õ
 =
lo›s
[0])

119 i‡(
	`bbi_pid
(
e
->
d°
Ë!bbi_pid(
Õ
->
hód
))

122 
hód_bid
 = 
	`bbi_bid
(
Õ
->
hód
); 
èû_bid
 = bbi_bid÷p->
èû
);

123 
d°_bid
 = 
	`bbi_bid
(
e
->
d°
);

124 i‡((
d°_bid
 > 
èû_bid
Ë|| (d°_bid < 
hód_bid
))

128 
	}
}

133 
	$ªg_lo›_exô
(
tcfg_edge_t
 *
e
)

135 
lo›_t
 *
Õ
;

136 
tcfg_ñök_t
 *
ñök
;

138 
Õ
 = 
lo›_m≠
[
e
->
§c
->
id
];

139 
ñök
 = (
tcfg_ñök_t
 *Ë
	`ˇŒoc
(1, (tcfg_elink_t *));

140 
ñök
->
edge
 = 
e
;Élök->
√xt
 = 
Õ
->
exôs
;

141 
Õ
->
exôs
 = 
ñök
;

142 
	}
}

147 
	$dól_exô_edge
(
tcfg_edge_t
 *
e
)

149 
lo›_t
 *
Õ
;

150 
tcfg_node_t
 *
d°
;

151 
hód_bid
, 
èû_bid
, 
Õ_pid
, 
bid
, 
pid
;

153 
	`ªg_lo›_exô
(
e
);

154 
d°
 = 
e
->dst;

155 i‡(
lo›_m≠
[
d°
->
id
] !
NULL
) {

156 i‡(
d°
 !
lo›_m≠
[d°->
id
]->
hód
)

159 i‡(
lo›_m≠
[
d°
->
id
]->
∑ª¡
 !
NULL
)

161 
Õ
 = 
lo›_m≠
[
e
->
§c
->
id
]->
∑ª¡
;Ü∞!
lo›s
[0];Üp =Üp->parent) {

162 
hód_bid
 = 
	`bbi_bid
(
Õ
->
hód
); 
èû_bid
 = bbi_bid÷p->
èû
);

163 
Õ_pid
 = 
	`bbi_pid
(
Õ
->
hód
);

164 
bid
 = 
	`bbi_bid
(
d°
); 
pid
 = 
	`bbi_pid
(dst);

165 i‡((
pid
 !
Õ_pid
Ë|| ((
bid
 >
hód_bid
Ë&& (bid <
èû_bid
))) {

166 
lo›_m≠
[
d°
->
id
]->
∑ª¡
 = 
Õ
;

170 i‡(
lo›_m≠
[
d°
->
id
]->
∑ª¡
 =
NULL
)

171 
lo›_m≠
[
d°
->
id
]->
∑ª¡
 = 
lo›s
[0];

174 
Õ
 = 
lo›_m≠
[
e
->
§c
->
id
]->
∑ª¡
;Ü∞!
lo›s
[0];Üp =Üp->parent) {

175 
hód_bid
 = 
	`bbi_bid
(
Õ
->
hód
); 
èû_bid
 = bbi_bid÷p->
èû
);

176 
Õ_pid
 = 
	`bbi_pid
(
Õ
->
hód
);

177 
bid
 = 
	`bbi_bid
(
d°
); 
pid
 = 
	`bbi_pid
(dst);

178 i‡((
pid
 !
Õ_pid
Ë|| ((
bid
 >
hód_bid
Ë&& (bid <
èû_bid
))) {

179 
lo›_m≠
[
d°
->
id
] = 
Õ
;

183 i‡(
lo›_m≠
[
d°
->
id
] =
NULL
)

184 
lo›_m≠
[
d°
->
id
] = 
lo›s
[0];

185 
	}
}

190 
	$dól_Ÿhî_edge
(
tcfg_edge_t
 *
e
)

192 i‡(
lo›_m≠
[
e
->
d°
->
id
] =
NULL
) {

193 
lo›_m≠
[
e
->
d°
->
id
] =Üo›_m≠[e->
§c
->id];

194 } i‡(
lo›_m≠
[
e
->
d°
->
id
] !lo›_m≠[e->
§c
->id]) {

196 
lo›_m≠
[
e
->
d°
->
id
]->
∑ª¡
 =Üo›_m≠[e->
§c
->id];

198 
	}
}

203 
	$m≠_bbi_lo›
()

205 
Queue
 
w‹kli°
;

206 
tcfg_node_t
 *
§c
, *
d°
;

207 
tcfg_edge_t
 *
e
;

209 
	`öô_queue
(&
w‹kli°
, (
tcfg_node_t
 *));

210 
	`íqueue
(&
w‹kli°
, &
tcfg
[0]);

211 
tcfg
[0]->
Êags
 = 1;

212 !
	`queue_em±y
(&
w‹kli°
)) {

213 
§c
 = *((
tcfg_node_t
 **Ë
	`dequeue
(&
w‹kli°
));

214 
e
 = 
§c
->
out
;É !
NULL
;É =É->
√xt_out
) {

215 
d°
 = 
e
->dst;

216 i‡(
	`exô_lo›
(
e
))

217 
	`dól_exô_edge
(
e
);

218 i‡(
d°
->
Êags
 == 0)

219 
	`dól_Ÿhî_edge
(
e
);

221 i‡(
d°
->
Êags
 == 0) {

222 
	`íqueue
(&
w‹kli°
, &
d°
);

223 
d°
->
Êags
 = 1;

227 
	`˛ór_bbi_Êags
();

228 
	`‰ì_queue
(&
w‹kli°
);

229 
	}
}

234 
	$£¨ch_comm⁄_™˚°‹
(
lo›_t
 *
x
,Üo›_à*
y
)

236 
lo›_t
 *
Õ
;

237 
i
, 
Êag
 = (Ë
x
;

239 
Õ
 = 
x
;Ü∞!
NULL
;Ü∞Õ->
∑ª¡
) {

240 i‡(
Õ
 =
y
) {

241 
lo›_comm_™˚s
[
x
->
id
][
y
->id] = y;

242 
lo›_comm_™˚s
[
y
->
id
][
x
->id] = y;

245 
Õ
->
Êags
 = 
Êag
;

247 
Õ
 = 
y
;Ü∞!
NULL
;Ü∞Õ->
∑ª¡
) {

248 i‡(
Õ
->
Êags
 =
Êag
) {

249 
lo›_comm_™˚s
[
x
->
id
][
y
->id] = 
Õ
;

250 
lo›_comm_™˚s
[
y
->
id
][
x
->id] = 
Õ
;

260 
	}
}

266 
	$lo›_ªœti⁄s
()

268 
i
, 
j
;

271 
lo›_comm_™˚s
 = (
lo›_t
 ***Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (loop_t **));

272 
i
 = 0; i < 
num_tcfg_lo›s
; i++)

273 
lo›_comm_™˚s
[
i
] = (
lo›_t
 **Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (loop_t *));

275 
i
 = 0; i < 
num_tcfg_lo›s
; i++) {

276 
lo›_comm_™˚s
[
i
][i] = 
lo›s
[i];

277 
j
 = 
i
 + 1; j < 
num_tcfg_lo›s
; j++)

278 
	`£¨ch_comm⁄_™˚°‹
(
lo›s
[
i
],Üo›s[
j
]);

280 
	}
}

285 
	$dump_lo›s
()

287 
i
;

288 
tcfg_node_t
 *
x
, *
y
, *
z
;

290 
	`¥ötf
("\ndumpÜoops\n");

291 
	`¥ötf
("----------------\n");

292 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

293 
x
 = 
tcfg
[
i
];

294 i‡(
lo›_m≠
[
i
] =
NULL
)

296 
y
 = 
lo›_m≠
[
i
]->
hód
; 
z
 =Üo›_m≠[i]->
èû
;

297 i‡(
y
 =
tcfg
[0])

298 
	`¥ötf
("%d.%d: \t%d[start -Énd]\n",

299 
	`bbi_pid
(
x
), 
	`bbi_bid
(x), 
lo›_m≠
[
i
]->
id
);

301 
	`¥ötf
("%d.%d: \t%d[%d.%d - %d.%d] /Öarent:%d\n",

302 
	`bbi_pid
(
x
), 
	`bbi_bid
(x), 
lo›_m≠
[
i
]->
id
,

303 
	`bbi_pid
(
y
), 
	`bbi_bid
(y), bbi_pid(
z
), bbi_bid(z),

304 
lo›_m≠
[
i
]->
∑ª¡
->
id
);

306 
	}
}

311 
	$dump_lo›_comm_™˚s
()

313 
i
, 
j
;

315 
	`¥ötf
("\ndumpÜoop commonáncestors:\n");

316 
i
 = 0; i < 
num_tcfg_lo›s
; i++) {

317 
j
 = 0; j < 
num_tcfg_lo›s
; j++) {

318 
	`¥ötf
("%2d ", 
lo›_comm_™˚s
[
i
][
j
]->
id
);

320 
	`¥ötf
("\n");

322 
	}
}

327 
	$lo›_¥o˚ss
()

329 
	`föd_lo›s
();

330 
	`m≠_bbi_lo›
();

332 
	`lo›_ªœti⁄s
();

334 
	}
}

	@loops.h

24 #i‚de‡
LOOPS_H


25 
	#LOOPS_H


	)

28 
	~"tcfg.h
"

31 
	#MAX_LOOP_NEST
 32

	)

33 
	#LOOP_ENTRY
 0

	)

34 
	#LOOP_EXIT
 1

	)

38 
lo›_t
 
	tlo›_t
;

40 
	slo›_t
 {

41 
	mid
;

42 
tcfg_node_t
 *
	mhód
;

43 
tcfg_node_t
 *
	mèû
;

44 
lo›_t
 *
	m∑ª¡
;

45 
tcfg_ñök_t
 *
	mexôs
;

46 
	mÊags
;

	@main.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~"cfg.h
"

27 
	~"b¥ed.h
"

28 
	~"ˇche.h
"

29 
	~"addªss.h
"

31 
	gDEBUG_INFEAS
 = 0;

33 
	gPROGRESS_STEP
 = 10000;

34 
num_tcfg_edges
;

36 *
run_›t
;

37 
FILE
 *
fûp
, *
fu§
;

39 
	gb¥ed_scheme
;

40 
	gíabÀ_iˇche
;

41 
	gíabÀ_dˇche
 = 0;

42 
	gíabÀ_abs_ö°_ˇche
 = 0;

44 
¥og_t
 
	g¥og
;

48 
	~"ö„asibÀ.h
"

49 
	gíabÀ_ö„as
;

52 *
	gö˛ude_¥oc
;

55 
	tticks
;

56 
	#CPU_MHZ
 3000000000

	)

57 
__ölöe__
 
ticks
 
	$gëticks
()

59 
a
, 
d
;

60 
asm
 vﬁ©ûe("rdtsc" : "˜" (
a
), "=d" (
d
));

61  ((
ticks
)
a
Ë| ((—icks)
d
) << 32);

62 
	}
}

64 
	$föd¥oc
–
addr
 ) {

65 
i
;

66  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ )

67 if–
¥og
.
¥ocs
[
i
].
ß
 =
addr
 )

68  
i
;

70 
	}
}

74 
	$ªad_fun˘i⁄s
–*
obj_fûe
 ) {

76 
FILE
 *
Âå
;

77 
‚ame
[80];

79 
id
;

80 
addr
;

81 
«me
[80];

83 
ö˛ude_¥oc
 = (*Ë
	`ˇŒoc
–
¥og
.
num_¥ocs
, () );

85 
	`•rötf
–
‚ame
, "%s.‚li°", 
obj_fûe
 );

86 
Âå
 = 
	`f›í
–
‚ame
, "r" );

88 if–!
Âå
 ) {

89 if–
DEBUG_INFEAS
 )

90 
	`¥ötf
–"%s.‚li°ÇŸ found --áŒÖro˚duª†wû»bêö˛uded i¿e°im©i⁄.\n", 
obj_fûe
 );

91  
id
 = 0; id < 
¥og
.
num_¥ocs
; id++ )

92 
ö˛ude_¥oc
[
id
] = 1;

96  
	`fsˇnf
–
Âå
, "%x %s", &
addr
, 
«me
 ) !
EOF
 ) {

97 
id
 = 
	`föd¥oc
–
addr
 );

98 if–
id
 != -1 )

99 
ö˛ude_¥oc
[
id
] = 1;

101 
	`¥ötf
–"W¨nög:Öro˚duª [0x%x] %†nŸ found.\n", 
addr
, 
«me
 );

103 
	`f˛o£
–
Âå
 );

105 
	}
}

110 
	$∑th_™Æysis
(*
obj_fûe
)

113 
	`ªad_code
(
obj_fûe
);

116 
	`buûd_cfgs
();

120 
	`ªad_fun˘i⁄s
(
obj_fûe
);

123 
	`¥og_å™
();

126 
	`lo›_¥o˚ss
();

129 if–
íabÀ_ö„as
 )

130 
	`ö„as_™Æysis
(
obj_fûe
);

131 
	}
}

136 
	$mi¸ﬂrch_modñög
()

138 i‡(
b¥ed_scheme
 !
NO_BPRED
)

139 
	`b¥ed_™Æysis
();

140 i‡(
íabÀ_iˇche
)

141 
	`ˇche_™Æysis
();

142 
	`pùe_™Æysis
();

143 
	}
}

147 
	$do_ûp
(*
obj_fûe
)

149 
exô_vÆ
;

150 
s
[256];

153 
	`•rötf
(
s
, "%s.Õ", 
obj_fûe
);

154 
fûp
 = 
	`f›í
(
s
, "w");

155 
	`•rötf
(
s
, "%s.c⁄s", 
obj_fûe
);

156 
fu§
 = 
	`f›í
(
s
, "r");

157 i‡((
fûp
 =
NULL
Ë|| (
fu§
 == NULL)) {

158 
	`Ârötf
(
°dîr
, "failÅo open ILP/CONS files for writing/reading\n");

159 
	`exô
(1);

161 
	`c⁄°øöts
();

163 
	`f˛o£
(
fûp
);

164 
	`f˛o£
(
fu§
);

167 
	`•rötf
–
s
, "%s.ûp", 
obj_fûe
 );

168 
fûp
 = 
	`f›í
–
s
, "w" );

169 
	`Ârötf
–
fûp
, "enter Q\n" );

170 
	`f˛o£
–
fûp
 );

175 
	`•rötf
–
s
, "ˇà%s.Õ >> %s.ûp", 
obj_fûe
, obj_file );

176 
	`sy°em
–
s
 );

178 
	`•rötf
–
s
, "%s.ûp", 
obj_fûe
 );

179 
fûp
 = 
	`f›í
–
s
, "a" );

180 
	`Ârötf
–
fûp
, "optimize\n" );

181 
	`Ârötf
–
fûp
, "£àlogfûê%s.sﬁ\n", 
obj_fûe
 );

182 
	`Ârötf
–
fûp
, "display solution objective\n" );

183 
	`Ârötf
–
fûp
, "display solution variables -\n" );

184 
	`Ârötf
–
fûp
, "quit\n" );

185 
	`f˛o£
–
fûp
 );

190 
	}
}

195 
	$run_e°
(*
obj_fûe
)

197 
	`mi¸ﬂrch_modñög
();

198 
	`do_ûp
(
obj_fûe
);

199 
	}
}

204 
	$run_cfg
(*
obj_fûe
)

206 
i
;

207 
s
[128];

208 
FILE
 *
fcfg
;

210 
	`•rötf
(
s
, "%s.cfg", 
obj_fûe
);

212 
fcfg
 = 
	`f›í
(
s
, "w");

213 i‡(
fcfg
 =
NULL
) {

214 
	`Ârötf
(
°dîr
, "ÁûÅÿ¸óã fûe: %s.cfg\n", 
s
);

215 
	`exô
(1);

218 
i
=0; i<
¥og
.
num_¥ocs
; i++) {

219 
	`dump_cfg
(
fcfg
, &
¥og
.
¥ocs
[
i
]);

221 
	`f˛o£
(
fcfg
);

224 
	}
}

227 
„tch_width
;

232 
	sj±b
{

233 
addr_t
 
	madr
;

234 
	m¡¨gë
;

235 
addr_t
 *
	m±¨gë
;

236 
	mödex
;

237 }
	tj±b
;

239 
j±b
 * 
	gpj±b
;

240 
	gbj±b
 = 0;

241 
	gnjp
;

243 
	$lookup_j±abÀ
(
addr_t
 
adr
){

244 
i
;

245 
num
 = 0;

246 
i
 = 0; i < 
njp
; i++){

247 if(
pj±b
[
i
].
adr
 ==ádr ){

248 
num
 = 
pj±b
[
i
].
¡¨gë
;

251  
num
;

252 
	}
}

254 
	$gë_j±abÀ
(
addr_t
 
§c
,
ödex
,áddr_à* 
èrgë
){

255 
i
;

256 
i
 = 0; i < 
njp
; i++){

257 if(
pj±b
[
i
].
adr
 =
§c
){

258 *
èrgë
 = 
pj±b
[
i
].
±¨gë
[
ödex
];

262 
	`as£π
(
i
 < 
njp
);

263 
	}
}

265 
	$gë_j±abÀ_°©ic
(
addr_t
 
§c
,áddr_à* 
èrgë
){

266 
i
,
j
;

267 
èû
 = -1;

268 
i
 = 0; i < 
njp
; i++){

269 if(
pj±b
[
i
].
adr
 =
§c
){

270 
j
 = 
pj±b
[
i
].
ödex
;

271 *
èrgë
 = 
pj±b
[
i
].
±¨gë
[
j
];

272 
pj±b
[
i
].
ödex
++;

273 if(
pj±b
[
i
].
ödex
 =pj±b[i].
¡¨gë
)

274 
èû
 = 0;

276 
èû
 = 1;

281  
èû
;

282 
	}
}

285 
	$ªad_öjp
(* 
objfûe
){

286 
èbÀsize
,
i
,
j
;

287 
fûe
[100];

288 
FILE
 *
·abÀ
;

289 
	`•rötf
(
fûe
,"%s.jèbÀ",
objfûe
);

290 
·abÀ
 = 
	`f›í
(
fûe
,"r");

291 if(!
·abÀ
){

293 
bj±b
 = 0;

295 
bj±b
 = 1;

296 
	`fsˇnf
(
·abÀ
,"%d",&
èbÀsize
);

297 
njp
 = 
èbÀsize
;

298 
pj±b
 = (
j±b
 *)
	`ˇŒoc
(
èbÀsize
, (jptb));

299 
i
 = 0; i < 
èbÀsize
; i++){

300 
	`fsˇnf
(
·abÀ
,"%08x",&
pj±b
[
i
].
adr
);

301 
	`fsˇnf
(
·abÀ
,"%d",&
pj±b
[
i
].
¡¨gë
);

302 
pj±b
[
i
].
ödex
 = 0;

303 
pj±b
[
i
].
±¨gë
 = (
addr_t
 *)
	`ˇŒoc
’j±b[i].
¡¨gë
, (addr_t));

304 
j
 = 0; j < 
pj±b
[
i
].
¡¨gë
; j++)

305 
	`fsˇnf
(
·abÀ
,"%08x",&
pj±b
[
i
].
±¨gë
[
j
]);

307 
	`f˛o£
(
·abÀ
);

310 
	}
}

312 *
	gpdïth
;

313 
	gbdïth
 = 0;

315 
	$ã°_dïth
(
pid
, 
dïth
){

316 i‡(
dïth
 < 
pdïth
[
pid
])

320 
	}
}

321 
	$ªad_ªcursive
(* 
objfûe
){

322 
fûe
[100];

323 
FILE
 *
·abÀ
;

324 
size
,
i
;

325 
	`•rötf
(
fûe
,"%s.ªcursive",
objfûe
);

326 
·abÀ
 = 
	`f›í
(
fûe
,"r");

327 if(!
·abÀ
){

328 
bdïth
 = 0;

330 
bdïth
 = 1;

331 
	`fsˇnf
(
·abÀ
,"%d",&
size
);

332 
pdïth
 = (*)
	`ˇŒoc
(
size
,(pdepth));

333 
i
 = 0; i < 
size
; i++)

334 
	`fsˇnf
(
·abÀ
,"%d",&
pdïth
[
i
]);

335 
	`f˛o£
(
·abÀ
);

337 
	}
}

340 
	$maö
(
¨gc
, **
¨gv
)

342 
ticks
 
a
,
b
;

344 i‡(
¨gc
 <= 1) {

345 
	`Ârötf
(
°dîr
, "Usage:\n");

346 
	`Ârötf
(
°dîr
, "%†<›ti⁄s> <bíchm¨k>\n", 
¨gv
[0]);

347 
	`exô
(1);

350 
	`öô_iß
();

352 
	`ªad_›t
(
¨gc
, 
¨gv
);

355 
	`ªad_öjp
(
¨gv
[
¨gc
 - 1]);

358 
	`ªad_ªcursive
(
¨gv
[
¨gc
 - 1]);

361 i‡(
	`°rcmp
(
run_›t
, "CFG") == 0) {

363 
	`ªad_code
–
¨gv
[
¨gc
-1] );

364 
	`buûd_cfgs
();

365 
	`run_cfg
–
¨gv
[
¨gc
-1] );

369 
íabÀ_ö„as
 = 1;

372 
	`∑th_™Æysis
(
¨gv
[
¨gc
-1]);

381 
	`¥ötf
("===================================================\n");

382 
	`¥ötf
("Addªs†compuèti⁄Åimê%l‡£cs\n", (
b
 - 
a
)/((1.0Ë* 
CPU_MHZ
));

383 
	`¥ötf
("===================================================\n");

393 
	`¥ötf
("===================================================\n");

394 
	`¥ötf
("Layouàcompuèti⁄Åimê%l‡£cs\n", (
b
 - 
a
)/((1.0Ë* 
CPU_MHZ
));

395 
	`¥ötf
("===================================================\n");

397 
a
 = 
	`gëticks
();

405 
b
 = 
	`gëticks
();

407 
	`¥ötf
("===================================================\n");

408 
	`¥ötf
("Maximum cachê™Æysi†timê%l‡£cs\n", (
b
 - 
a
)/((1.0Ë* 
CPU_MHZ
));

409 
	`¥ötf
("===================================================\n");

411 
l1_i1_ps
, 
l1_d1_ps
, 
i1_u1_ps
, 
u1_d1_ps
;

413 
	`¥ötf
("=====================================================\n");

414 
	`¥ötf
("PS I1 i¿L1 = %d\n", 
l1_i1_ps
);

415 
	`¥ötf
("PS D1 i¿L1 = %d\n", 
l1_d1_ps
);

416 
	`¥ötf
("PS D1 i¿U1án†Æl-miss/n¯© D1 = %d\n", 
u1_d1_ps
);

417 
	`¥ötf
("PS I1 i¿U1án†Æl-miss/n¯© L1 = %d\n", 
i1_u1_ps
);

418 
	`¥ötf
("=====================================================\n");

424 
	`run_e°
(
¨gv
[
¨gc
 - 1]);

425 
	}
}

	@options.c

23 
	~"comm⁄.h
"

28 
	$ªad_›t
(
¨gc
, **
¨gv
)

30 #ifde‡
TARGET_SS


31 
	`ªad_›t_ss
(
¨gc
, 
¨gv
);

33 
	}
}

	@pipeline.c

26 
	~<°rög.h
>

27 
	~<°dlib.h
>

28 
	~"cfg.h
"

29 
	~"ˇche.h
"

30 
	~"b¥ed.h
"

31 
	~"lo›s.h
"

32 
	~"pùñöe.h
"

35 
tcfg_node_t
 **
tcfg
;

36 
num_tcfg_nodes
;

37 
tcfg_edge_t
 **
tcfg_edges
;

38 
num_tcfg_edges
;

39 
ˇche_t
 
ˇche
;

40 
b¥ed_scheme
;

41 
íabÀ_iˇche
;

42 ***
hô_miss
;

43 *
num_hô_miss
;

44 
lo›_t
 ***
bbi_hm_li°
;

45 *
num_bbi_hm_li°
;

46 
de_ö°_t
 ***
mp_ö°s
;

47 *
num_mp_ö°s
;

48 
num_eg_ö°s
;

49 **
num_mblk_c⁄Êi˘s
;

50 
lo›_t
 **
lo›s
;

51 
lo›_t
 **
lo›_m≠
;

52 
num_tcfg_lo›s
;

53 
mem_blk_t
 **
mp_gí
;

56 
	gpùe_°ages
 = 5;

57 
	gpùe_ibuf_size
;

58 
	gpùe_iwö_size
;

59 
	g¥ﬁog_size
, 
	gpùe_iwö_size
;

60 
code_lök_t
 **
	g¥ﬁogs
, **
	gïûogs
;

61 
mas_ö°_t
 **
	gbodõs
, *
	g°¨t_body
;

62 **
	g˝ªd_times
, **
	gm¥ed_times
, 
	g°¨t_time
;

68 *
	gmœt_bbi
;

71 *
	gmax_ñog_Àn
;

73 *
	gmœt_mpö°
;

76 *
	gnum_∂og_åunc
;

77 
mblk_èg_t
 *
	gtmp_cs
;

78 
	gnum_∂ogs
, 
	gnum_ñogs
;

83 
	$£t_mœt_bbi
()

85 
bbi_id
, 
i
;

86 
cfg_node_t
 *
bb
;

87 
de_ö°_t
 *
ö°
;

89 
mœt_bbi
 = (*Ë
	`ˇŒoc
(
num_tcfg_nodes
, ());

90 
bbi_id
 = 0; bbi_id < 
num_tcfg_nodes
; bbi_id++) {

91 
bb
 = 
tcfg
[
bbi_id
]->bb;

92 
i
 = 
bb
->
num_ö°
 - 1; i >= 0; i--) {

93 i‡(
	`max_ö°_œt
(&
bb
->
code
[
i
]) > 1)

96 
mœt_bbi
[
bbi_id
] = 
i
;

98 
	}
}

101 
	#MAX_REGS
 256

	)

102 
	gdï_ªgs
[
MAX_REGS
];

105 
	$lookup_mœt
(
‹ig
, 
di°
, 
tcfg_node_t
 *
bbi
, 
no_mœt
)

107 
i
, 
k
, 
tmp
, 
r
;

108 
de_ö°_t
 *
ö°
;

109 
tcfg_edge_t
 *
e
;

111 i‡(
no_mœt
 && (
mœt_bbi
[
bbi
->
id
] < 0)) {

112 
di°
 +
bbi
->
bb
->
num_ö°
;

113 i‡((
bbi
->
ö
 =
NULL
Ë|| (
di°
 >
pùe_iwö_size
))

115 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
)

116 
	`lookup_mœt
(
‹ig
, 
di°
, 
e
->
§c
, 1);

120 
i
 = 
bbi
->
bb
->
num_ö°
 - 1; i >= 0; i--) {

121 
ö°
 = &
bbi
->
bb
->
code
[
i
];

122 
k
 = 0; k < 
ö°
->
num_out
; k++) {

123 
r
 = 
ö°
->
out
[
k
];

124 i‡(
dï_ªgs
[
r
] =
‹ig
) {

125 
tmp
 = 
pùe_iwö_size
 - (
di°
 + (
bbi
->
bb
->
num_ö°
 - 
i
));

126 
max_ñog_Àn
[
‹ig
] = 
	`max
(
tmp
, max_elog_len[orig]);

130 i‡(
	`max_ö°_œt
(
ö°
) > 1) {

131 
k
 = 0; k < 
ö°
->
num_ö
; k++) {

132 
r
 = 
ö°
->
ö
[
k
];

133 
dï_ªgs
[
r
] = 
‹ig
;

138 
di°
 +
bbi
->
bb
->
num_ö°
;

139 i‡(
di°
 < 
pùe_iwö_size
) {

140 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
)

141 
	`lookup_mœt
(
‹ig
, 
di°
, 
e
->
§c
, 0);

143 
	}
}

148 
	$bound_ñog_Àn
()

150 
i
;

151 
tcfg_edge_t
 *
e
;

153 
max_ñog_Àn
 = (*Ë
	`mÆloc
(
num_tcfg_nodes
 * ());

154 
i
 = 0; i < 
MAX_REGS
; i++)

155 
dï_ªgs
[
i
] = -1;

157 
max_ñog_Àn
[0] = 0;

158 i‡(
mœt_bbi
[0] >= 0)

159 
max_ñog_Àn
[0] = 
pùe_iwö_size
 - (
tcfg
[0]->
bb
->
num_ö°
 - 
mœt_bbi
[0]);

161 
i
 = 1; i < 
num_tcfg_nodes
; i++) {

162 
max_ñog_Àn
[
i
] = 0;

163 
	`lookup_mœt
(
i
, 0, 
tcfg
[i], 1);

165 
	}
}

170 
	$föd_mœt_mpö°
()

172 
i
, 
k
;

173 
tcfg_edge_t
 *
e
;

175 
mœt_mpö°
 = (*Ë
	`ˇŒoc
(
num_tcfg_edges
, ());

176 
num_∂og_åunc
 = (*Ë
	`ˇŒoc
(
num_tcfg_edges
, ());

178 
i
 = 0; i < 
num_tcfg_edges
; i++) {

179 
k
 = 0; k < 
num_mp_ö°s
[
i
]; k++) {

180 i‡(
	`max_ö°_œt
(
mp_ö°s
[
i
][
k
]) > 1) {

181 
mœt_mpö°
[
i
] = 
k
 + 1;

186 
	}
}

193 
	$√w_¥ﬁog
(
log_£t
, 
tcfg_edge_t
 **
∑th
, 
∑th_Àn
, 
num_skù
)

195 
i
, 
k
, 
num
 = 0, 
num_mp
 = 0, 
èg
, 
£t
, 
edge_id
, 
max_num_mp
;

196 
tcfg_node_t
 *
bbi
, *
mbbi
;

197 
Queue
 
queue
;

198 
code_lök_t
 *
∂og
;

199 
mas_ö°_t
 
mas_ö°
;

200 
addr_t
 
ß
;

202 i‡(
num_skù
 < 0)

203 
num_skù
 = 0;

205 
	`mem£t
(
tmp_cs
, 0, 
ˇche
.
ns
 * (
mblk_èg_t
));

206 
	`öô_queue
(&
queue
, (
mas_ö°_t
));

207 
i
 = 
∑th_Àn
-1; i >= 0; i--) {

208 
bbi
 = 
∑th
[
i
]->
§c
;

209 
ß
 = 
bbi
->
bb
->sa;

211 
k
 = 
num_skù
; k < 
bbi
->
bb
->
num_ö°
; k++) {

213 
mas_ö°
.
ö°
 = &
bbi
->
bb
->
code
[
k
];

214 
mas_ö°
.
bbi_id
 = 
bbi
->
id
;

215 
mas_ö°
.
mblk_id
 = 
	`MBLK_ID
(
ß
, mas_ö°.
ö°
->
addr
);

216 
mas_ö°
.
bp_Êag
 = 
BP_CPRED
;

218 
èg
 = 
	`TAG
(
mas_ö°
.
ö°
->
addr
);

219 
£t
 = 
	`SET
(
mas_ö°
.
ö°
->
addr
);

220 i‡(
tmp_cs
[
£t
].
vÆid
 == 0)

221 
mas_ö°
.
ic_Êag
 = 
IC_UNCLEAR
;

222 i‡(
tmp_cs
[
£t
].
èg
 ==Åag)

223 
mas_ö°
.
ic_Êag
 = 
IC_HIT
;

225 
mas_ö°
.
ic_Êag
 = 
IC_MISS
;

226 
tmp_cs
[
£t
].
vÆid
 = 1;

227 
tmp_cs
[
£t
].
èg
 =Åag;

228 
	`íqueue
(&
queue
, &
mas_ö°
);

229 
num
++;

231 
num_skù
 = 0;

232 i‡((
b¥ed_scheme
 =
NO_BPRED
Ë|| !
	`c⁄d_bbi
(
bbi
))

236 
edge_id
 = 
∑th
[
i
]->
id
;

237 i‡(
mœt_mpö°
[
edge_id
] > 
max_ñog_Àn
[
bbi
->
id
])

240 
max_num_mp
 = 
	`mö
(
num_mp_ö°s
[
edge_id
], 
max_ñog_Àn
[
bbi
->
id
]);

241 i‡(
bbi
->
out
 =
∑th
[
i
])

242 
mbbi
 = 
bbi
->
out
->
√xt_out
->
d°
;

244 
mbbi
 = 
bbi
->
out
->
d°
;

245 
num_mp
 = 0;

246 
k
 = 0; k < 
max_num_mp
; k++) {

247 i‡(
num_mp
 >
mbbi
->
bb
->
num_ö°
) {

248 
mbbi
 = mbbi->
out
->
d°
;

249 
num_mp
 = 0;

251 
mas_ö°
.
ö°
 = 
mp_ö°s
[
edge_id
][
k
];

252 
mas_ö°
.
bbi_id
 = 
mbbi
->
id
;

253 
mas_ö°
.
mblk_id
 = 
	`MBLK_ID
(
mbbi
->
bb
->
ß
, mas_ö°.
ö°
->
addr
);

254 i‡(
i
 == 0)

255 
mas_ö°
.
bp_Êag
 = 
BP_MPRED
;

257 
mas_ö°
.
bp_Êag
 = 
BP_UNCLEAR
;

258 
èg
 = 
	`TAG
(
mas_ö°
.
ö°
->
addr
);

259 
£t
 = 
	`SET
(
mas_ö°
.
ö°
->
addr
);

260 i‡(
tmp_cs
[
£t
].
vÆid
 == 0)

261 
mas_ö°
.
ic_Êag
 = 
IC_UNCLEAR
;

262 i‡(
tmp_cs
[
£t
].
èg
 ==Åag)

263 
mas_ö°
.
ic_Êag
 = 
IC_HIT
;

265 
mas_ö°
.
ic_Êag
 = 
IC_MISS
;

266 
tmp_cs
[
£t
].
vÆid
 = 1;

268 
	`íqueue
(&
queue
, &
mas_ö°
);

269 
num
++;

270 
num_mp
++;

272 i‡(
i
 == 0)

273 
num_∂og_åunc
[
log_£t
] = 
max_num_mp
;

277 
∂og
 = (
code_lök_t
 *Ë
	`ˇŒoc
(1, (code_link_t));

278 
	`CHECK_MEM
(
∂og
);

279 
∂og
->
code
 = (
mas_ö°_t
 *Ë
	`ˇŒoc
(
num
, (mas_inst_t));

280 
	`CHECK_MEM
(
∂og
->
code
);

281 
k
 = 0; k < 
num
; k++)

282 
∂og
->
code
[
k
] = *((
mas_ö°_t
 *Ë
	`dequeue
(&
queue
));

283 
∂og
->
num_ö°
 = 
num
;

284 
∂og
->
√xt
 = 
¥ﬁogs
[
log_£t
];

285 
¥ﬁogs
[
log_£t
] = 
∂og
;

287 
	`‰ì_queue
(&
queue
);

288 
	}
}

293 
	$åav_backw¨d
(
log_£t
, 
tcfg_edge_t
 **
∑th
, 
∑th_Àn
, 
code_Àn
)

295 
tcfg_node_t
 *
bbi
;

296 
tcfg_edge_t
 *
e
;

297 
i
;

299 
bbi
 = 
∑th
[
∑th_Àn
-1]->
§c
;

300 
code_Àn
 +
bbi
->
bb
->
num_ö°
;

301 i‡((
code_Àn
 >
¥ﬁog_size
Ë|| (
bbi
->
ö
 =
NULL
))

302 
	`√w_¥ﬁog
(
log_£t
, 
∑th
, 
∑th_Àn
, 
code_Àn
 - 
¥ﬁog_size
);

304 
e
 = 
bbi
->
ö
;É !
NULL
;É =É->
√xt_ö
) {

305 
∑th
[
∑th_Àn
] = 
e
;

306 
	`åav_backw¨d
(
log_£t
, 
∑th
, 
∑th_Àn
+1, 
code_Àn
);

309 
	}
}

316 
	$cﬁÀ˘_¥ﬁogs
()

318 
tcfg_edge_t
 **
∑th
;

319 
i
;

321 
∑th
 = (
tcfg_edge_t
 **Ë
	`ˇŒoc
(
¥ﬁog_size
, (tcfg_edge_t *));

322 
	`CHECK_MEM
(
∑th
);

323 
¥ﬁogs
 = (
code_lök_t
 **Ë
	`ˇŒoc
(
num_tcfg_edges
, (code_link_t *));

324 
	`CHECK_MEM
(
¥ﬁogs
);

326 
i
 = 0; i < 
num_tcfg_edges
; i++) {

327 
∑th
[0] = 
tcfg_edges
[
i
];

328 
	`åav_backw¨d
(
i
, 
∑th
, 1, 0);

331 
	`‰ì
(
∑th
);

332 
	}
}

338 
	$√w_ïûog
(
log_£t
, 
tcfg_edge_t
 **
∑th
, 
∑th_Àn
)

340 
i
, 
k
, 
num
 = 0, 
num1
 = 0, 
m
 = 0, 
max_Àn
, 
hô_mœt
, 
£t
, 
èg
;

341 
tcfg_node_t
 *
bbi
;

342 
Queue
 
queue
;

343 
code_lök_t
 *
ñog
;

344 
mas_ö°_t
 
mas_ö°
;

345 
addr_t
 
ß
;

347 
max_Àn
 = 
max_ñog_Àn
[
tcfg_edges
[
log_£t
]->
§c
->
id
];

348 
	`mem£t
(
tmp_cs
, 0, 
ˇche
.
ns
 * (
mblk_èg_t
));

349 
	`öô_queue
(&
queue
, (
de_ö°_t
));

350 
i
 = 0; i < 
∑th_Àn
; i++) {

351 
hô_mœt
 = 0;

353 
bbi
 = 
∑th
[
i
]->
d°
;

354 
ß
 = 
bbi
->
bb
->sa;

355 
k
 = 0; (k < 
bbi
->
bb
->
num_ö°
Ë&& (
m
 < 
max_Àn
); k++, m++) {

356 
mas_ö°
.
ö°
 = &
bbi
->
bb
->
code
[
k
];

357 
mas_ö°
.
bbi_id
 = 
bbi
->
id
;

358 
mas_ö°
.
mblk_id
 = 
	`MBLK_ID
(
ß
, mas_ö°.
ö°
->
addr
);

360 
mas_ö°
.
bp_Êag
 = 
BP_CPRED
;

362 
èg
 = 
	`TAG
(
mas_ö°
.
ö°
->
addr
);

363 
£t
 = 
	`SET
(
mas_ö°
.
ö°
->
addr
);

364 i‡(
tmp_cs
[
£t
].
vÆid
 == 0)

365 
mas_ö°
.
ic_Êag
 = 
IC_UNCLEAR
;

366 i‡(
tmp_cs
[
£t
].
èg
 ==Åag)

367 
mas_ö°
.
ic_Êag
 = 
IC_HIT
;

369 
mas_ö°
.
ic_Êag
 = 
IC_MISS
;

370 
tmp_cs
[
£t
].
vÆid
 = 1;

371 
tmp_cs
[
£t
].
èg
 =Åag;

372 
	`íqueue
(&
queue
, &
mas_ö°
);

373 i‡(
	`max_ö°_œt
(
mas_ö°
.
ö°
) > 1) {

374 
num1
 = 
num
 + 
k
 + 1;

375 
hô_mœt
 = 1;

378 
num
 +
k
;

381 i‡((
num1
 =0Ë|| (
hô_mœt
 == 0)) {

382 
	`‰ì_queue
(&
queue
);

387 
ñog
 = (
code_lök_t
 *Ë
	`ˇŒoc
(1, (code_link_t));

388 
	`CHECK_MEM
(
ñog
);

389 
ñog
->
code
 = (
mas_ö°_t
 *Ë
	`ˇŒoc
(
num1
, (mas_inst_t));

390 
	`CHECK_MEM
(
ñog
->
code
);

391 
k
 = 0; k < 
num1
; k++) {

392 
ñog
->
code
[
k
] = *((
mas_ö°_t
 *Ë
	`dequeue
(&
queue
));

394 
ñog
->
num_ö°
 = 
num1
;

395 
ñog
->
√xt
 = 
ïûogs
[
log_£t
];

396 
ïûogs
[
log_£t
] = 
ñog
;

398 
	`‰ì_queue
(&
queue
);

400 
	}
}

405 
	$åav_f‹w¨d
(
log_£t
, 
tcfg_edge_t
 **
∑th
, 
∑th_Àn
, 
code_Àn
)

407 
tcfg_node_t
 *
bbi
;

408 
tcfg_edge_t
 *
e
;

409 
ñog_¸óãd
 = 0, 
tmp
;

411 
bbi
 = 
∑th
[
∑th_Àn
-1]->
d°
;

412 
code_Àn
 +
bbi
->
bb
->
num_ö°
;

413 i‡((
code_Àn
 >
max_ñog_Àn
[
∑th
[0]->
§c
->
id
]Ë|| (
bbi
->
out
 =
NULL
)) {

414 i‡(
mœt_bbi
[
bbi
->
id
] >= 0)

415 
ñog_¸óãd
 = 
	`√w_ïûog
(
log_£t
, 
∑th
, 
∑th_Àn
);

417 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

418 
∑th
[
∑th_Àn
] = 
e
;

419 
tmp
 = 
	`åav_f‹w¨d
(
log_£t
, 
∑th
, 
∑th_Àn
+1, 
code_Àn
);

420 
ñog_¸óãd
 |
tmp
;

422 i‡((
ñog_¸óãd
 =0Ë&& (
mœt_bbi
[
bbi
->
id
] >= 0))

423 
ñog_¸óãd
 = 
	`√w_ïûog
(
log_£t
, 
∑th
, 
∑th_Àn
);

425  
ñog_¸óãd
;

426 
	}
}

433 
	$cﬁÀ˘_ïûogs
()

435 
tcfg_edge_t
 **
∑th
;

436 
i
;

438 
∑th
 = (
tcfg_edge_t
 **Ë
	`ˇŒoc
(
pùe_iwö_size
, (tcfg_edge_t *));

439 
	`CHECK_MEM
(
∑th
);

440 
ïûogs
 = (
code_lök_t
 **Ë
	`ˇŒoc
(
num_tcfg_edges
, (code_link_t *));

441 
	`CHECK_MEM
(
ïûogs
);

443 
i
 = 0; i < 
num_tcfg_edges
; i++) {

444 i‡(
max_ñog_Àn
[
tcfg_edges
[
i
]->
§c
->
id
] == 0)

446 
∑th
[0] = 
tcfg_edges
[
i
];

447 
	`åav_f‹w¨d
(
i
, 
∑th
, 1, 0);

450 
	`‰ì
(
∑th
);

451 
	}
}

456 
	$cﬁÀ˘_bodõs
()

458 
i
, 
k
, 
num
;

459 
tcfg_node_t
 *
bbi
;

461 
num
 = 
tcfg
[0]->
bb
->
num_ö°
;

462 
°¨t_body
 = (
mas_ö°_t
 *Ë
	`ˇŒoc
(
num
, (mas_inst_t));

463 
	`CHECK_MEM
(
°¨t_body
);

464 
k
 = 0; k < 
num
; k++) {

465 
°¨t_body
[
k
].
ö°
 = &
tcfg
[0]->
bb
->
code
[k];

466 
°¨t_body
[
k
].
bp_Êag
 = 
BP_CPRED
;

468 
bodõs
 = (
mas_ö°_t
 **Ë
	`ˇŒoc
(
num_tcfg_edges
, (mas_inst_t *));

469 
	`CHECK_MEM
(
bodõs
);

470 
i
 = 0; i < 
num_tcfg_edges
; i++) {

471 
bbi
 = 
tcfg_edges
[
i
]->
d°
;

472 
num
 = 
bbi
->
bb
->
num_ö°
;

473 
bodõs
[
i
] = (
mas_ö°_t
 *Ë
	`ˇŒoc
(
num
, (mas_inst_t));

474 
	`CHECK_MEM
(
bodõs
[
i
]);

475 
k
 = 0; k < 
num
; k++) {

476 
bodõs
[
i
][
k
].
ö°
 = &
bbi
->
bb
->
code
[k];

477 
bodõs
[
i
][
k
].
bbi_id
 = 
bbi
->
id
;

478 
bodõs
[
i
][
k
].
bp_Êag
 = 
BP_CPRED
;

481 
	}
}

486 
	$£t_body_hômiss
(
edge_id
, 
hm_id
)

488 
i
, 
num
, 
ts0
, 
ts
, 
off£t
, 
mblk_id
 = 1;

489 
tcfg_node_t
 *
bbi
;

490 
lo›_t
 *
Õ
;

492 
bbi
 = 
tcfg_edges
[
edge_id
]->
d°
;

493 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm_id
];

494 
num
 = 
bbi
->
bb
->
num_ö°
;

495 
bodõs
[
edge_id
][0].
ic_Êag
 = 
	`gë_mblk_hômiss
(
bbi
, 0, 
Õ
);

496 
i
 = 1; i < 
num
; i++) {

497 
off£t
 = 
	`CACHE_LINE
(
bbi
->
bb
->
code
[
i
].
addr
);

498 i‡(
off£t
 == 0) {

499 
bodõs
[
edge_id
][
i
].
ic_Êag
 = 
	`gë_mblk_hômiss
(
bbi
, 
mblk_id
, 
Õ
);

500 
mblk_id
++;

503 
	}
}

508 
	$öô_∑
()

510 
¥ﬁog_size
 = 
pùe_ibuf_size
 + 
pùe_iwö_size
;

511 
	}
}

516 
	$Æloc_e°_unôs
()

518 
i
, 
n
, 
bbi_id
, 
num_hm
;

519 
tcfg_edge_t
 *
e
;

521 
˝ªd_times
 = (**Ë
	`ˇŒoc
(
num_tcfg_edges
, (*));

522 
m¥ed_times
 = (**Ë
	`ˇŒoc
(
num_tcfg_edges
, (*));

523 
	`CHECK_MEM
(
˝ªd_times
);

524 
	`CHECK_MEM
(
m¥ed_times
);

526 
°¨t_time
 = 0;

527 
i
 = 0; i < 
num_tcfg_edges
; i++) {

528 i‡(
íabÀ_iˇche
) {

529 
num_hm
 = 
num_hô_miss
[
tcfg_edges
[
i
]->
d°
->
id
];

531 
num_hm
 = 1;

532 
˝ªd_times
[
i
] = (*Ë
	`ˇŒoc
(
num_hm
, ());

533 
	`CHECK_MEM
(
˝ªd_times
);

534 i‡(
	`c⁄d_bbi
(
tcfg_edges
[
i
]->
§c
)) {

535 
m¥ed_times
[
i
] = (*Ë
	`ˇŒoc
(
num_hm
, ());

536 
	`CHECK_MEM
(
m¥ed_times
);

539 
	}
}

547 
	$˘x_unô_time
(
edge_id
, 
hm_id
, 
bp
)

549 
num_p
, 
num_e
, 
num_b
, 
t
, *
t_˝ªd
, *
t_m¥ed
;

550 
tcfg_node_t
 *
bbi
;

551 
tcfg_edge_t
 *
e
;

552 
code_lök_t
 *
∂og
, *
ñog
;

553 
unô_e°im©ed
;

554 
lo›_t
 *
Õ
;

556 
t_˝ªd
 = &
˝ªd_times
[
edge_id
][
hm_id
];

557 
t_m¥ed
 = &
m¥ed_times
[
edge_id
][
hm_id
];

558 i‡(
íabÀ_iˇche
)

559 
	`£t_body_hômiss
(
edge_id
, 
hm_id
);

560 
bbi
 = 
tcfg_edges
[
edge_id
]->
d°
;

561 
num_b
 = 
bbi
->
bb
->
num_ö°
;

563 i‡(
íabÀ_iˇche
)

564 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm_id
];

566 
Õ
 = 
NULL
;

567 
∂og
 = 
¥ﬁogs
[
edge_id
];Ölog !
NULL
;Ölog =Ölog->
√xt
) {

568 
num_p
 = 
∂og
->
num_ö°
;

569 i‡(
b¥ed_scheme
 !
NO_BPRED
 && 
bp
 =
BP_CPRED
)

570 
num_p
 -
num_∂og_åunc
[
edge_id
];

571 
unô_e°im©ed
 = 0;

572 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

573 
ñog
 = 
ïûogs
[
e
->
id
];Élog !
NULL
;Élog =Élog->
√xt
) {

574 
num_e
 = 
ñog
->
num_ö°
;

575 
	`¸óã_egøph
(
∂og
->
code
, 
num_p
, 
ñog
->code, 
num_e
,

576 
bodõs
[
edge_id
], 
num_b
, 
bp
, 
Õ
);

577 
t
 = 
	`e°_egøph
();

578 i‡((
bp
 =
BP_CPRED
Ë&& (
t
 > *
t_˝ªd
))

579 *
t_˝ªd
 = 
t
;

580 i‡((
bp
 =
BP_MPRED
Ë&& (
t
 > *
t_m¥ed
))

581 *
t_m¥ed
 = 
t
;

582 
unô_e°im©ed
 = 1;

585 i‡(
unô_e°im©ed
 == 1)

587 
	`¸óã_egøph
(
∂og
->
code
, 
num_p
, 
NULL
, 0, 
bodõs
[
edge_id
], 
num_b
, 
bp
, 
Õ
);

588 
t
 = 
	`e°_egøph
();

589 i‡((
bp
 =
BP_CPRED
Ë&& (
t
 > *
t_˝ªd
))

590 *
t_˝ªd
 = 
t
;

591 i‡((
bp
 =
BP_MPRED
Ë&& (
t
 > *
t_m¥ed
))

592 *
t_m¥ed
 = 
t
;

594 
	}
}

599 
	$e°_°¨t_unô
()

601 
num_b
, 
num_e
, 
off£t
, 
i
, 
t
, 
unô_e°im©ed
 = 0;

602 
tcfg_node_t
 *
bbi
 = 
tcfg
[0];

603 
tcfg_edge_t
 *
e
;

604 
code_lök_t
 *
ñog
;

606 
num_b
 = 
tcfg
[0]->
bb
->
num_ö°
;

607 
°¨t_body
[0].
ic_Êag
 = 
IC_MISS
;

608 
i
 = 1; i < 
num_b
; i++) {

609 
off£t
 = 
	`CACHE_LINE
(
bbi
->
bb
->
code
[
i
].
addr
);

610 i‡(
off£t
 == 0)

611 
°¨t_body
[
i
].
ic_Êag
 = 
IC_MISS
;

614 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

615 
ñog
 = 
ïûogs
[
e
->
id
];Élog !
NULL
;Élog =Élog->
√xt
) {

616 
num_e
 = 
ñog
->
num_ö°
;

617 
	`¸óã_egøph
(
NULL
, 0, 
ñog
->
code
, 
num_e
, 
°¨t_body
, 
num_b
,

618 
BP_CPRED
, 
lo›s
[0]);

619 
t
 = 
	`e°_egøph
();

620 i‡(
t
 > 
°¨t_time
)

621 
°¨t_time
 = 
t
;

622 
unô_e°im©ed
 = 1;

626 i‡(
unô_e°im©ed
 == 0) {

627 
	`¸óã_egøph
(
NULL
, 0, NULL, 0, 
°¨t_body
, 
num_b
, 
BP_CPRED
, 
lo›s
[0]);

628 
t
 = 
	`e°_egøph
();

629 i‡(
t
 > 
°¨t_time
)

630 
°¨t_time
 = 
t
;

632 
	}
}

637 
	$e°_unôs
()

639 
edge_id
, 
num_hm
, 
hm
, 
e°_mi•ªd
;

640 
tcfg_edge_t
 *
e
;

641 
code_lök_t
 *
∂og
, *
ñog
;

643 
	`Æloc_e°_unôs
();

644 
	`e°_°¨t_unô
();

646 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

647 i‡(
íabÀ_iˇche
) {

648 
num_hm
 = 
num_hô_miss
[
tcfg_edges
[
edge_id
]->
d°
->
id
];

650 
num_hm
 = 1;

651 
e
 = 
tcfg_edges
[
edge_id
];

652 i‡((
b¥ed_scheme
 !
NO_BPRED
Ë&& (
	`c⁄d_bbi
(
e
->
§c
)))

653 
e°_mi•ªd
 = 1;

655 
e°_mi•ªd
 = 0;

656 
hm
 = 0; hm < 
num_hm
; hm++) {

658 
	`˘x_unô_time
(
edge_id
, 
hm
, 
BP_CPRED
);

659 i‡(
e°_mi•ªd
)

660 
	`˘x_unô_time
(
edge_id
, 
hm
, 
BP_MPRED
);

663 
	}
}

671 
tcfg_ñök_t
 ***
	gmp_af„˘ed_£ts
;

672 ***
	gmp_times
;

675 **
	gmp_£t_ègs
;

676 *
	gnum_mp_£t_ègs
;

681 
	$gë_lo›_af„˘ed_£ts
(
Õ_id
, 
tcfg_edge_t
 *
mp_edge
, 
num_ö°
)

683 
tcfg_edge_t
 *
edge
;

684 
tcfg_node_t
 *
bbi
;

685 
tcfg_ñök_t
 *
ñök
;

686 
off£t
, 
i
, 
k
, 
£t
, 
èg
;

688 i‡(
mp_edge
 =mp_edge->
§c
->
out
)

689 
edge
 = 
mp_edge
->
√xt_out
;

691 
edge
 = 
mp_edge
->
§c
->
out
;

692 i‡(
edge
->
Êags
 == 1)

695 
i
 = 
num_ö°
; i < 
num_mp_ö°s
[
edge
->
id
]; i++) {

696 
off£t
 = 
	`CACHE_LINE
(
mp_ö°s
[
edge
->
id
][
i
]->
addr
);

697 i‡(
off£t
 == 0)

700 
	`mem£t
(
num_mp_£t_ègs
, 0, 
ˇche
.
ns
 * ());

701 ; 
i
 < 
num_mp_ö°s
[
edge
->
id
]; i++) {

702 
£t
 = 
	`SET
(
mp_ö°s
[
edge
->
id
][
i
]->
addr
);

703 i‡(
num_mp_£t_ègs
[
£t
] =
ˇche
.
«
)

705 
èg
 = 
	`TAG
(
mp_ö°s
[
edge
->
id
][
i
]->
addr
);

706 i‡(
num_mp_£t_ègs
[
£t
] == 0) {

707 
mp_£t_ègs
[
£t
][0] = 
èg
;

708 
num_mp_£t_ègs
[
£t
] = 1;

710 
k
 = 0; k < 
num_mp_£t_ègs
[
£t
]; k++) {

711 i‡(
èg
 =
mp_£t_ègs
[
£t
][
k
])

714 i‡(
k
 =
num_mp_£t_ègs
[
£t
]) {

715 
mp_£t_ègs
[
£t
][
k
] = 
èg
;

716 
num_mp_£t_ègs
[
£t
]++;

721 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

722 
i
 = 
num_mblk_c⁄Êi˘s
[
Õ_id
][
£t
];

723 i‡(
i
 > 
ˇche
.
«
)

725 i‡((
num_mp_£t_ègs
[
£t
] + 
i
Ë> 
ˇche
.
«
) {

726 
ñök
 = (
tcfg_ñök_t
 *Ë
	`ˇŒoc
(1, (tcfg_elink_t *));

727 
ñök
->
edge
 =Édge;

728 
ñök
->
√xt
 = 
mp_af„˘ed_£ts
[
Õ_id
][
£t
];

729 
mp_af„˘ed_£ts
[
Õ_id
][
£t
] = 
ñök
;

732 
	}
}

737 
	$föd_c⁄d_exô
(
Õ_id
, 
tcfg_edge_t
 *
edge
, 
num_ö°
)

739 
tcfg_ñök_t
 *
ñök
;

741 i‡(
	`c⁄d_bbi
(
edge
->
§c
)) {

742 
	`gë_lo›_af„˘ed_£ts
(
Õ_id
, 
edge
, 
num_ö°
);

744 
num_ö°
 +
edge
->
§c
->
bb
->num_inst;

745 i‡(
num_ö°
 >(
pùe_ibuf_size
 + 
pùe_iwö_size
 - 1))

747 
edge
 =Édge->
§c
->
ö
;Édgê!
NULL
;Édgêedge->
√xt_ö
)

748 
	`föd_c⁄d_exô
(
Õ_id
, 
edge
, 
num_ö°
);

750 
	}
}

757 
	$cﬁÀ˘_af„˘ed_£ts
()

759 
tcfg_node_t
 *
bbi
;

760 
tcfg_edge_t
 *
edge
;

761 
tcfg_ñök_t
 *
ñök
;

762 
lo›_t
 *
Õ
;

763 
Õ_id
, 
£t
, 
èg
;

765 
mp_af„˘ed_£ts
 = (
tcfg_ñök_t
 ***Ë
	`ˇŒoc
(
num_tcfg_lo›s
, (tcfg_elink_t **));

766 
Õ_id
 = 1;Üp_id < 
num_tcfg_lo›s
;Üp_id++)

767 
mp_af„˘ed_£ts
[
Õ_id
] = (
tcfg_ñök_t
 **Ë
	`ˇŒoc
(
ˇche
.
ns
, (tcfg_elink_t *));

769 
mp_£t_ègs
 = (**Ë
	`ˇŒoc
(
ˇche
.
ns
, (*));

770 
£t
 = 0; së < 
ˇche
.
ns
; set++)

771 
mp_£t_ègs
[
£t
] = (*Ë
	`ˇŒoc
(
ˇche
.
«
, ());

772 
num_mp_£t_ègs
 = (*Ë
	`ˇŒoc
(
ˇche
.
ns
, ());

774 
Õ_id
 = 1;Üp_id < 
num_tcfg_lo›s
;Üp_id++) {

775 
Õ
 = 
lo›s
[
Õ_id
];

776 
ñök
 = 
Õ
->
exôs
;Élök !
NULL
;Élök =Élök->
√xt
)

777 
	`föd_c⁄d_exô
(
Õ_id
, 
ñök
->
edge
, 0);

778 
	`˛ór_tcfg_edge_Êags
();

781 
£t
 = 0; së < 
ˇche
.
ns
; set++)

782 
	`‰ì
(
mp_£t_ègs
[
£t
]);

783 
	`‰ì
(
mp_£t_ègs
);

784 
	`‰ì
(
num_mp_£t_ègs
);

785 
	}
}

790 
	$mp_£t_body_hômiss
(
edge_id
, 
hm_id
, 
£t
)

792 
i
, 
num
, 
ts0
, 
ts
, 
off£t
, 
mblk_id
 = 1, 
£t1
;

793 
tcfg_node_t
 *
bbi
;

794 
lo›_t
 *
Õ
;

796 
bbi
 = 
tcfg_edges
[
edge_id
]->
d°
;

797 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm_id
];

798 
num
 = 
bbi
->
bb
->
num_ö°
;

799 
£t1
 = 
	`SET
(
bbi
->
bb
->
ß
);

800 i‡(
£t1
 =
£t
)

801 
bodõs
[
edge_id
][0].
ic_Êag
 = 
IC_UNCLEAR
;

803 
bodõs
[
edge_id
][0].
ic_Êag
 = 
	`gë_mblk_hômiss
(
bbi
, 0, 
Õ
);

804 
i
 = 1; i < 
num
; i++) {

805 
off£t
 = 
	`CACHE_LINE
(
bbi
->
bb
->
code
[
i
].
addr
);

806 i‡(
off£t
 == 0) {

807 
£t1
 = 
	`SET
(
bbi
->
bb
->
code
[
i
].
addr
);

808 i‡(
£t1
 =
£t
)

809 
bodõs
[
edge_id
][
i
].
ic_Êag
 = 
IC_UNCLEAR
;

811 
bodõs
[
edge_id
][
i
].
ic_Êag
 = 
	`gë_mblk_hômiss
(
bbi
, 
mblk_id
, 
Õ
);

812 
mblk_id
++;

815 
	}
}

820 
	$˘x_mpmiss_time
(
edge_id
, 
hm_id
, 
£t
, 
bp
)

822 
num_p
, 
num_e
, 
num_b
, 
t
, *
t_mp
, 
unô_e°im©ed
;

823 
tcfg_node_t
 *
bbi
;

824 
tcfg_edge_t
 *
e
;

825 
code_lök_t
 *
∂og
, *
ñog
;

826 
lo›_t
 *
Õ
;

828 
t_mp
 = &
mp_times
[
edge_id
][
hm_id
][
£t
];

829 i‡(
íabÀ_iˇche
)

830 
	`mp_£t_body_hômiss
(
edge_id
, 
hm_id
, 
£t
);

831 
bbi
 = 
tcfg_edges
[
edge_id
]->
d°
;

832 
num_b
 = 
bbi
->
bb
->
num_ö°
;

834 i‡(
íabÀ_iˇche
)

835 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm_id
];

837 
Õ
 = 
NULL
;

839 
∂og
 = 
¥ﬁogs
[
edge_id
];Ölog !
NULL
;Ölog =Ölog->
√xt
) {

840 
num_p
 = 
∂og
->
num_ö°
;

841 i‡(
b¥ed_scheme
 !
NO_BPRED
 && 
bp
 =
BP_CPRED
)

842 
num_p
 -
num_∂og_åunc
[
edge_id
];

843 
unô_e°im©ed
 = 0;

844 
e
 = 
bbi
->
out
;É !
NULL
;É =É->
√xt_out
) {

845 
ñog
 = 
ïûogs
[
e
->
id
];Élog !
NULL
;Élog =Élog->
√xt
) {

846 
num_e
 = 
ñog
->
num_ö°
;

847 
	`¸óã_egøph
(
∂og
->
code
, 
num_p
, 
ñog
->code, 
num_e
,

848 
bodõs
[
edge_id
], 
num_b
, 
bp
, 
Õ
);

849 
t
 = 
	`e°_egøph
();

850 i‡(
t
 > *
t_mp
)

851 *
t_mp
 = 
t
;

852 
unô_e°im©ed
 = 1;

855 i‡(
unô_e°im©ed
 == 1)

858 
	`¸óã_egøph
(
∂og
->
code
, 
num_p
, 
NULL
, 0, 
bodõs
[
edge_id
], 
num_b
, 
bp
, 
Õ
);

859 
t
 = 
	`e°_egøph
();

860 i‡(
t
 > *
t_mp
)

861 *
t_mp
 = 
t
;

863 
	}
}

868 
	$e°_mpmiss_times
()

870 
edge_id
, 
num_hm
, 
hm
, 
bp
, 
£t
;

871 
tcfg_node_t
 *
bbi
;

872 
tcfg_edge_t
 *
e
;

873 
lo›_t
 *
Õ
;

874 
code_lök_t
 *
∂og
, *
ñog
;

876 
mp_times
 = (***Ë
	`ˇŒoc
(
num_tcfg_edges
, (**));

878 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

879 
e
 = 
tcfg_edges
[
edge_id
];

880 
num_hm
 = 
num_hô_miss
[
e
->
d°
->
id
];

881 
mp_times
[
edge_id
] = (**Ë
	`ˇŒoc
(
num_hm
, (*));

882 
bbi
 = 
e
->
d°
;

883 i‡(
	`c⁄d_bbi
(
e
->
§c
))

884 
bp
 = 
BP_MPRED
;

886 
bp
 = 
BP_CPRED
;

887 
hm
 = 0; hm < 
num_hm
; hm++) {

888 
mp_times
[
edge_id
][
hm
] = (*Ë
	`ˇŒoc
(
ˇche
.
ns
, ());

889 
Õ
 = 
bbi_hm_li°
[
bbi
->
id
][
hm
];

890 i‡((
Õ
 =
NULL
Ë|| (Õ->
id
 == 0))

892 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

893 i‡(
mp_af„˘ed_£ts
[
Õ
->
id
][
£t
] !
NULL
) {

894 
	`˘x_mpmiss_time
(
edge_id
, 
hm
, 
£t
, 
bp
);

899 
	}
}

905 
	$h™dÀ_mpmiss
()

907 
	`cﬁÀ˘_af„˘ed_£ts
();

908 
	`e°_mpmiss_times
();

909 
	}
}

914 
	$pùe_™Æysis
()

916 
tmp_cs
 = (
mblk_èg_t
 *Ë
	`ˇŒoc
(
ˇche
.
ns
, (mblk_tag_t));

917 
	`CHECK_MEM
(
tmp_cs
);

919 
	`öô_∑
();

920 
	`£t_mœt_bbi
();

921 
	`bound_ñog_Àn
();

922 i‡(
b¥ed_scheme
 !
BP_NONE
)

923 
	`föd_mœt_mpö°
();

925 
	`cﬁÀ˘_bodõs
();

926 
	`cﬁÀ˘_¥ﬁogs
();

927 
	`cﬁÀ˘_ïûogs
();

928 
	`e°_unôs
();

930 i‡(
íabÀ_iˇche
 && (
b¥ed_scheme
 !
NO_BPRED
))

931 
	`h™dÀ_mpmiss
();

933 
	`‰ì
(
mœt_bbi
);

934 
	`‰ì
(
tmp_cs
);

935 
	}
}

943 
	$dump_xlogs
(
code_lök_t
 **
xlogs
)

945 
tcfg_node_t
 *
§c
, *
d°
;

946 
i
, 
k
;

947 
code_lök_t
 *
log
;

948 
mas_ö°_t
 *
mas_ö°
;

950 
i
 = 0; i < 
num_tcfg_edges
; i++) {

951 
§c
 = 
tcfg_edges
[
i
]->src;

952 
d°
 = 
tcfg_edges
[
i
]->dst;

953 
	`¥ötf
("\√dge: %d.%d -> %d.%d", 
	`bbi_pid
(
§c
), 
	`bbi_bid
(src),

954 
	`bbi_pid
(
d°
), 
	`bbi_bid
(dst));

955 
log
 = 
xlogs
[
i
];Üog !
NULL
;Üog =Üog->
√xt
) {

956 
k
 = 0; k < 
log
->
num_ö°
; k++) {

957 
mas_ö°
 = &
log
->
code
[
k
];

958 i‡((
k
 & 7) == 0)

959 
	`¥ötf
("\¿ %x", 
mas_ö°
->
ö°
->
addr
);

961 
	`¥ötf
(" %x", 
mas_ö°
->
ö°
->
addr
);

962 i‡(
mas_ö°
->
bp_Êag
 =
BP_MPRED
)

963 
	`¥ötf
("/M");

964 i‡(
mas_ö°
->
bp_Êag
 =
BP_UNCLEAR
)

965 
	`¥ötf
("/U");

967 
	`¥ötf
("/C");

968 i‡(
mas_ö°
->
ic_Êag
 =
IC_MISS
)

969 
	`¥ötf
("M");

970 i‡(
mas_ö°
->
ic_Êag
 =
IC_UNCLEAR
)

971 
	`¥ötf
("U");

973 
	`¥ötf
("H");

975 
	`¥ötf
("\n -------------------------------------------");

976 
	`¥ötf
("-------------------------------------------\n");

979 
	}
}

984 
	$dump_unôs_times
()

986 
tcfg_edge_t
 *
e
;

987 
edge_id
, 
hm
, 
num_hm
;

989 
	`¥ötf
("dumpÅimingÉstimates for basic blocks\n");

990 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

991 
e
 = 
tcfg_edges
[
edge_id
];

992 
	`¥ötf
("%d.%d -> %d.%d\n",

993 
	`bbi_pid
(
e
->
§c
), 
	`bbi_bid
”->§c), bbi_pid”->
d°
), bbi_bid(e->dst));

994 i‡(
íabÀ_iˇche
) {

995 
num_hm
 = 
num_hô_miss
[
tcfg_edges
[
edge_id
]->
d°
->
id
];

997 
num_hm
 = 1;

998 
hm
 = 0; hm < 
num_hm
; hm++) {

999 
	`¥ötf
(" hm[%d]: %d", 
hm
, 
˝ªd_times
[
edge_id
][hm]);

1000 i‡((
b¥ed_scheme
 !
NO_BPRED
Ë&& 
	`c⁄d_bbi
(
e
->
§c
))

1001 
	`¥ötf
(" %d(m)", 
m¥ed_times
[
edge_id
][
hm
]);

1002 
	`¥ötf
("\n");

1005 
	`¥ötf
("\n");

1006 
	}
}

1011 
	$dump_unô_time
(
edge_id
, 
hm
, 
bp
)

1013 
t
;

1014 
tcfg_edge_t
 *
e
 = 
tcfg_edges
[
edge_id
];

1016 i‡(
bp
 =
BP_CPRED
)

1017 
t
 = 
˝ªd_times
[
edge_id
][
hm
];

1019 
t
 = 
m¥ed_times
[
edge_id
][
hm
];

1020 
	`¥ötf
(" %d.%d -> %d.%d (hm:%d bp:%d): %d\n",

1021 
	`bbi_pid
(
e
->
§c
), 
	`bbi_bid
”->§c), bbi_pid”->
d°
), bbi_bid(e->dst),

1022 
hm
, 
bp
, 
t
);

1023 
	}
}

1028 
	$dump_edge_mp_times
(
edge_id
, 
hm
)

1030 *
t
, 
£t
;

1031 
tcfg_edge_t
 *
e
 = 
tcfg_edges
[
edge_id
];

1032 
tcfg_node_t
 *
bbi
 = 
e
->
d°
;

1033 
lo›_t
 *
Õ
;

1035 
t
 = 
mp_times
[
edge_id
][
hm
];

1036 
	`¥ötf
(" %d.%d -> %d.%d (hm:%d): ",

1037 
	`bbi_pid
(
e
->
§c
), 
	`bbi_bid
”->§c), bbi_pid”->
d°
), bbi_bid”->d°), 
hm
);

1038 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1039 i‡(
t
[
£t
] != 0)

1040 
	`¥ötf
(" s[%d]=%d", 
£t
, 
t
[set]);

1042 
	`¥ötf
("\n");

1043 
	}
}

1048 
	$dump_mp_times
()

1050 
tcfg_edge_t
 *
e
;

1051 
lo›_t
 *
Õ
;

1052 
edge_id
, 
hm
, 
num_hm
, 
£t
, *
t
;

1054 
	`¥ötf
("dump mispredÅimingÉstimates for basic blocks\n");

1055 
edge_id
 = 0;Édge_id < 
num_tcfg_edges
;Édge_id++) {

1056 
e
 = 
tcfg_edges
[
edge_id
];

1057 
	`¥ötf
("%d.%d -> %d.%d\n",

1058 
	`bbi_pid
(
e
->
§c
), 
	`bbi_bid
”->§c), bbi_pid”->
d°
), bbi_bid(e->dst));

1059 
num_hm
 = 
num_hô_miss
[
tcfg_edges
[
edge_id
]->
d°
->
id
];

1060 
hm
 = 0; hm < 
num_hm
; hm++) {

1061 
Õ
 = 
bbi_hm_li°
[
e
->
d°
->
id
][
hm
];

1062 i‡(
Õ
 =
NULL
)

1064 
	`¥ötf
(" hm[%d]:", 
hm
);

1065 
t
 = 
mp_times
[
edge_id
][
hm
];

1066 
£t
 = 0; së < 
ˇche
.
ns
; set++) {

1067 i‡(
t
[
£t
] != 0)

1068 
	`¥ötf
(" s[%x]=%d", 
£t
, 
t
[set]);

1070 
	`¥ötf
("\n");

1073 
	`¥ötf
("\n");

1074 
	}
}

1079 
	$dump_∂og_°©s
()

1081 
i
;

1082 
code_lök_t
 *
p
;

1083 
Àn_°©
[48];

1085 
	`¥ötf
("dumpÖrologÜen statistics\n");

1086 
i
 = 0; i < 48; i++)

1087 
Àn_°©
[
i
] = 0;

1089 
i
 = 0; i < 
num_tcfg_edges
; i++) {

1090 
p
 = 
¥ﬁogs
[
i
];Ö !
NULL
;Ö =Ö->
√xt
) {

1091 
Àn_°©
[
p
->
num_ö°
]++;

1095 
i
 = 0; i < 48; i++) {

1096 i‡(
Àn_°©
[
i
] > 0)

1097 
	`¥ötf
("Àn[%d]: %d\n", 
i
, 
Àn_°©
[i]);

1100 
	}
}

1105 
	$dump_ñog_°©s
()

1107 
i
;

1108 
code_lök_t
 *
p
;

1109 
Àn_°©
[32];

1111 
	`¥ötf
("dumpÉpilogÜen statistics\n");

1112 
i
 = 0; i < 32; i++)

1113 
Àn_°©
[
i
] = 0;

1115 
i
 = 0; i < 
num_tcfg_edges
; i++) {

1116 
p
 = 
ïûogs
[
i
];Ö !
NULL
;Ö =Ö->
√xt
) {

1117 
Àn_°©
[
p
->
num_ö°
]++;

1121 
i
 = 0; i < 32; i++) {

1122 i‡(
Àn_°©
[
i
] > 0)

1123 
	`¥ötf
("Àn[%d]: %d\n", 
i
, 
Àn_°©
[i]);

1126 
	}
}

1131 
	$dump_c⁄ãxt_°©s
()

1133 
code_lök_t
 *
p
;

1134 
tcfg_edge_t
 *
e
;

1135 
i
, *
num_∂ogs
, *
num_ñogs
, 
num_˘xs
, 
tŸÆ
 = 0;

1137 
	`dump_∂og_°©s
();

1138 
	`dump_ñog_°©s
();

1140 
num_∂ogs
 = (*Ë
	`ˇŒoc
(
num_tcfg_nodes
, ());

1141 
num_ñogs
 = (*Ë
	`ˇŒoc
(
num_tcfg_nodes
, ());

1143 
	`¥ötf
("dump context statistics\n");

1144 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1145 
e
 = 
tcfg
[
i
]->
ö
;É !
NULL
;É =É->
√xt_ö
) {

1146 
p
 = 
¥ﬁogs
[
e
->
id
];Ö !
NULL
;Ö =Ö->
√xt
)

1147 
num_∂ogs
[
i
]++;

1149 
e
 = 
tcfg
[
i
]->
out
;É !
NULL
;É =É->
√xt_out
) {

1150 
p
 = 
ïûogs
[
e
->
id
];Ö !
NULL
;Ö =Ö->
√xt
)

1151 
num_ñogs
[
i
]++;

1153 
num_˘xs
 = 
	`max
(
num_∂ogs
[
i
], 1Ë* max(
num_ñogs
[i], 1);

1154 
	`¥ötf
("%3d: (%3d, %3d/%2dË%6d\n", 
i
, 
num_∂ogs
[i], 
num_ñogs
[i], 
max_ñog_Àn
[i], 
num_˘xs
);

1155 
tŸÆ
 +
num_˘xs
;

1157 
	`¥ötf
("\n-----------------------\¡ŸÆ: %d\n", 
tŸÆ
);

1159 
	`‰ì
(
num_∂ogs
);

1160 
	`‰ì
(
num_ñogs
);

1161 
	}
}

1166 
	$dump_ñog_Àn
()

1168 
i
;

1170 
	`¥ötf
("dump max_elog_len\n");

1171 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

1172 
	`¥ötf
("bbi[%d]/%x: %d\n", 
i
, 
tcfg
[i]->
bb
->
ß
, 
max_ñog_Àn
[i]);

1174 
	}
}

1179 
	$dump_mœt_mpö°
()

1181 
i
;

1183 
	`¥ötf
("dump mlat_mpinst\n");

1184 
i
 = 0; i < 
num_tcfg_edges
; i++) {

1185 
	`¥ötf
("edge[%d->%d]/%x->%x: %d\n", 
tcfg_edges
[
i
]->
§c
->
id
,

1186 
tcfg_edges
[
i
]->
d°
->
id
,Åcfg_edges[i]->
§c
->
bb
->
ß
,

1187 
tcfg_edges
[
i
]->
d°
->
bb
->
ß
, 
mœt_mpö°
[i]);

1189 
	}
}

	@pipeline.h

22 #i‚de‡
PIPE_LINE_H


23 
	#PIPE_LINE_H


	)

25 
	~"comm⁄.h
"

28 
	#BODY_CODE
 0

	)

29 
	#PLOG_CODE
 1

	)

30 
	#ELOG_CODE
 2

	)

32 
	#MAX_SSCALAR
 4

	)

37 
de_ö°_t
 *
	mö°
;

38 
	mbbi_id
;

39 
	mmblk_id
;

40 
	mbp_Êag
;

41 
	mic_Êag
;

42 } 
	tmas_ö°_t
;

45 
code_lök_t
 
	tcode_lök_t
;

47 
	scode_lök_t
 {

48 
mas_ö°_t
 *
	mcode
;

49 
	mnum_ö°
;

50 
code_lök_t
 *
	m√xt
;

55 
dump_xlogs
();

57 
dump_unôs_times
();

59 
dump_mp_times
();

61 
dump_∂og_°©s
();

63 
dump_ñog_°©s
();

65 
dump_c⁄ãxt_°©s
();

67 
dump_ñog_Àn
();

69 
dump_mœt_mpö°
();

	@qurt.c

55 
	ga
[3], 
	gx1
[2], 
	gx2
[2];

56 
	gÊag
;

58 
quπ
();

61 
	$Ábs
(
n
)

63 
f
;

65 i‡(
n
 >0Ë
f
 =Ç;

66 
f
 = -
n
;

67  
f
;

68 
	}
}

70 
	$sqπ
(
vÆ
)

71 
vÆ
;

73 
x
 = 
vÆ
/10;

75 
dx
;

77 
diff
;

78 
mö_tﬁ
 = 0.00001;

80 
i
, 
Êag
;

82 
Êag
 = 0;

83 i‡(
vÆ
 =0 ) 
x
 = 0;

85 
i
=1;i<20;i++)

87 i‡(!
Êag
) {

89 
	`¥ötf
("EnteredÅheÜoop\n");

91 
dx
 = (
vÆ
 - (
x
*x)) / (2.0 * x);

92 
x
 = x + 
dx
;

93 
diff
 = 
vÆ
 - (
x
*x);

94 i‡(
	`Ábs
(
diff
Ë<
mö_tﬁ
Ë
Êag
 = 1;

97 
x
 =x;

100  (
x
);

101 
	}
}

104 
	$maö
()

107 
Êag
;

110 
a
[0] = 1.0;

111 
a
[1] = -3.0;

112 
a
[2] = 2.0;

114 
	`quπ
();

120 
a
[0] = 4.0;

121 
a
[1] = -7.0;

122 
a
[2] = 8.0;

124 
	`quπ
();

127 
a
[0] = 1.0;

128 
a
[1] = -4.0;

129 
a
[2] = 8.0;

131 
	`quπ
();

132 
	}
}

134 
	$quπ
()

136 
d
, 
w1
, 
w2
;

138 if(
a
[0] == 0.0) (999);

139 
d
 = 
a
[1]*a[1] - 4 *á[0] *á[2];

140 
w1
 = 2.0 * 
a
[0];

141 
w2
 = 
	`sqπ
(
	`Ábs
(
d
));

142 if(
d
 > 0.0)

144 
Êag
 = 1;

145 
x1
[0] = (-
a
[1] + 
w2
Ë/ 
w1
;

146 
x1
[1] = 0.0;

147 
x2
[0] = (-
a
[1] - 
w2
Ë/ 
w1
;

148 
x2
[1] = 0.0;

151 if(
d
 == 0.0)

153 
Êag
 = 0;

154 
x1
[0] = -
a
[1] / 
w1
;

155 
x1
[1] = 0.0;

156 
x2
[0] = 
x1
[0];

157 
x2
[1] = 0.0;

162 
Êag
 = -1;

163 
w2
 /
w1
;

164 
x1
[0] = -
a
[1] / 
w1
;

165 
x1
[1] = 
w2
;

166 
x2
[0] = 
x1
[0];

167 
x2
[1] = -
w2
;

170 
	}
}

	@readfile.c

23 
	~<°dio.h
>

24 
	~"cfg.h
"

25 
	~"iß.h
"

28 
¥og_t
 
¥og
;

29 
iß_t
 *
iß
;

35 
	$ªad_code
(*
‚ame
)

37 
	`ªad_code_ss
(
‚ame
);

39 
	}
}

49 
	$dump_code
()

51 
i
, 
j
;

52 
de_ö°_t
 *
ö°
;

54 
i
 = 0 ; i < 
¥og
.
num_ö°
; i++) {

55 
ö°
 = &
¥og
.
code
[
i
];

56 
	`¥ötf
("%8x %-10s", 
ö°
->
addr
, 
iß
[ö°->
›_íum
].
«me
);

57 
j
 = 0; j < 
ö°
->
num_out
; j++)

58 
	`¥ötf
(" O%d", 
ö°
->
out
[
j
]);

59 
j
 = 0; j < 
ö°
->
num_ö
; j++)

60 
	`¥ötf
(" I%d", 
ö°
->
ö
[
j
]);

61 i‡(
ö°
->
èrgë
 != 0)

62 
	`¥ötf
("Å¨gë: %x", 
ö°
->
èrgë
);

63 
	`¥ötf
("\n");

65 
	}
}

	@reg.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~"ö„asibÀ.h
"

29 
	$öôRegSë
() {

31 
	`°r˝y
–
ªgLi°
[0].
«me
 , "$0" ); strcpy(ÑegList[1].name , "$1" );

32 
	`°r˝y
–
ªgLi°
[2].
«me
 , "$2" ); strcpy(ÑegList[3].name , "$3" );

33 
	`°r˝y
–
ªgLi°
[4].
«me
 , "$4" ); strcpy(ÑegList[5].name , "$5" );

34 
	`°r˝y
–
ªgLi°
[6].
«me
 , "$6" ); strcpy(ÑegList[7].name , "$7" );

35 
	`°r˝y
–
ªgLi°
[8].
«me
 , "$8" ); strcpy(ÑegList[9].name , "$9" );

36 
	`°r˝y
–
ªgLi°
[10].
«me
, "$10" ); strcpy(ÑegList[11].name, "$11" );

37 
	`°r˝y
–
ªgLi°
[12].
«me
, "$12" ); strcpy(ÑegList[13].name, "$13" );

38 
	`°r˝y
–
ªgLi°
[14].
«me
, "$14" ); strcpy(ÑegList[15].name, "$15" );

39 
	`°r˝y
–
ªgLi°
[16].
«me
, "$16" ); strcpy(ÑegList[17].name, "$17" );

40 
	`°r˝y
–
ªgLi°
[18].
«me
, "$18" ); strcpy(ÑegList[19].name, "$19" );

41 
	`°r˝y
–
ªgLi°
[20].
«me
, "$20" ); strcpy(ÑegList[21].name, "$21" );

42 
	`°r˝y
–
ªgLi°
[22].
«me
, "$22" ); strcpy(ÑegList[23].name, "$23" );

43 
	`°r˝y
–
ªgLi°
[24].
«me
, "$24" ); strcpy(ÑegList[25].name, "$25" );

44 
	`°r˝y
–
ªgLi°
[26].
«me
, "$26" ); strcpy(ÑegList[27].name, "$27" );

45 
	`°r˝y
–
ªgLi°
[28].
«me
, "$28" ); strcpy(ÑegList[29].name, "$29" );

46 
	`°r˝y
–
ªgLi°
[30].
«me
, "$30" ); strcpy(ÑegList[31].name, "$31" );

48 
	`°r˝y
–
ªgLi°
[34].
«me
, "$f0" ); strcpy(ÑegList[35].name, "$f1" );

49 
	`°r˝y
–
ªgLi°
[36].
«me
, "$f2" ); strcpy(ÑegList[37].name, "$f3" );

50 
	`°r˝y
–
ªgLi°
[38].
«me
, "$f4" ); strcpy(ÑegList[39].name, "$f5" );

51 
	`°r˝y
–
ªgLi°
[40].
«me
, "$f6" ); strcpy(ÑegList[41].name, "$f7" );

52 
	`°r˝y
–
ªgLi°
[42].
«me
, "$f8" ); strcpy(ÑegList[43].name, "$f9" );

53 
	`°r˝y
–
ªgLi°
[44].
«me
, "$f10" ); strcpy(ÑegList[45].name, "$f11" );

54 
	`°r˝y
–
ªgLi°
[46].
«me
, "$f12" ); strcpy(ÑegList[47].name, "$f13" );

55 
	`°r˝y
–
ªgLi°
[48].
«me
, "$f14" ); strcpy(ÑegList[49].name, "$f15" );

56 
	`°r˝y
–
ªgLi°
[50].
«me
, "$f16" ); strcpy(ÑegList[51].name, "$f17" );

57 
	`°r˝y
–
ªgLi°
[52].
«me
, "$f18" ); strcpy(ÑegList[53].name, "$f19" );

58 
	`°r˝y
–
ªgLi°
[54].
«me
, "$f20" ); strcpy(ÑegList[55].name, "$f21" );

59 
	`°r˝y
–
ªgLi°
[56].
«me
, "$f22" ); strcpy(ÑegList[57].name, "$f23" );

60 
	`°r˝y
–
ªgLi°
[58].
«me
, "$f24" ); strcpy(ÑegList[59].name, "$f25" );

61 
	`°r˝y
–
ªgLi°
[60].
«me
, "$f26" ); strcpy(ÑegList[61].name, "$f27" );

62 
	`°r˝y
–
ªgLi°
[62].
«me
, "$f28" ); strcpy(ÑegList[63].name, "$f29" );

63 
	`°r˝y
–
ªgLi°
[64].
«me
, "$f30" ); strcpy(ÑegList[65].name, "$f31" );

65 
	`°r˝y
–
ªgLi°
[66].
«me
, "$fcc" );

67 
ªgLi°
[0].
dîôªe
[0] = '\0';

68 
ªgLi°
[0].
vÆue
 = 0;

69 
ªgLi°
[0].
vÆid
 = 1;

70 
ªgLi°
[0].
Êag
 = 
NIL
;

72 
	`°r˝y
–
ªgLi°
[28].
dîôªe
, "$28" );

73 
ªgLi°
[28].
vÆue
 = 0;

74 
ªgLi°
[28].
vÆid
 = 0;

75 
ªgLi°
[28].
Êag
 = 
NIL
;

77 
	`°r˝y
–
ªgLi°
[29].
dîôªe
, "$29" );

78 
ªgLi°
[28].
vÆue
 = 0;

79 
ªgLi°
[28].
vÆid
 = 0;

80 
ªgLi°
[28].
Êag
 = 
NIL
;

82 
	`°r˝y
–
ªgLi°
[30].
dîôªe
, "$30" );

83 
ªgLi°
[30].
vÆue
 = 0;

84 
ªgLi°
[30].
vÆid
 = 0;

85 
ªgLi°
[30].
Êag
 = 
NIL
;

88 
	}
}

91 
	$˛órReg
() {

93 
i
;

94  
i
 = 1; i < 
NO_REG
; i++ ) {

96 if–
i
 == 28 || i == 29 || i == 30 )

99 
ªgLi°
[
i
].
dîôªe
[0] = '\0';

100 
ªgLi°
[
i
].
vÆue
 = 0;

101 
ªgLi°
[
i
].
vÆid
 = 0;

102 
ªgLi°
[
i
].
Êag
 = 
NIL
;

105 
	}
}

108 
	$födReg
–
key
[] ) {

110 
i
;

111  
i
 = 0; i < 
NO_REG
; i++ ) {

112 if–
	`°ªq
–
key
, 
ªgLi°
[
i
].
«me
 ))

113  
i
;

116 
	}
}

119 
	$hexVÆue
–*
hexSå
 ) {

121 
vÆ
;

122 
	`ssˇnf
–
hexSå
, "%x", &
vÆ
 );

123  
vÆ
;

124 
	}
}

127 
	$£tReg
–
pos
, 
dîôªe
[], 
vÆue
, 
vÆid
, 
Êag
 ) {

130 
ªgLi°
[
pos
].
dîôªe
[0] = '\0';

131 
	`°r˝y
–
ªgLi°
[
pos
].
dîôªe
, deritree );

132 
ªgLi°
[
pos
].
vÆue
 = value;

133 
ªgLi°
[
pos
].
vÆid
 = valid;

134 
ªgLi°
[
pos
].
Êag
 = flag;

137 
	}
}

140 
	$ªgOp
–
ö¢_t
 *
ö¢
, *
vÆ
, *
dîi
 ) {

142 if–
	`°ªq
(
ö¢
->
›
, "addiu") ) {}

143 if–
	`°ªq
(
ö¢
->
›
, "addu" ) ) {}

144 if–
	`°ªq
(
ö¢
->
›
, "add.d") ) {}

145 if–
	`°ªq
(
ö¢
->
›
, "add.s") ) {}

146 if–
	`°ªq
(
ö¢
->
›
, "subu" ) ) {}

147 if–
	`°ªq
(
ö¢
->
›
, "sub.d") ) {}

148 if–
	`°ªq
(
ö¢
->
›
, "sub.s") ) {}

149 if–
	`°ªq
(
ö¢
->
›
, "div" ) ) {}

150 if–
	`°ªq
(
ö¢
->
›
, "divu" ) ) {}

151 if–
	`°ªq
(
ö¢
->
›
, "mult" ) ) {}

152 if–
	`°ªq
(
ö¢
->
›
, "mul.d") ) {}

154 if–
	`°ªq
(
ö¢
->
›
, "and" ) ) {}

155 if–
	`°ªq
(
ö¢
->
›
, "andi") ) {}

156 if–
	`°ªq
(
ö¢
->
›
, "nor" ) ) {}

157 if–
	`°ªq
(
ö¢
->
›
, "or" ) ) {}

158 if–
	`°ªq
(
ö¢
->
›
, "ori" ) ) {}

159 if–
	`°ªq
(
ö¢
->
›
, "xor" ) ) {}

160 if–
	`°ªq
(
ö¢
->
›
, "xori") ) {}

162 if–
	`°ªq
(
ö¢
->
›
, "beq" ) ) {}

163 if–
	`°ªq
(
ö¢
->
›
, "bne" ) ) {}

164 if–
	`°ªq
(
ö¢
->
›
, "bgez") ) {}

165 if–
	`°ªq
(
ö¢
->
›
, "bgtz") ) {}

166 if–
	`°ªq
(
ö¢
->
›
, "blez") ) {}

167 if–
	`°ªq
(
ö¢
->
›
, "bltz") ) {}

169 if–
	`°ªq
(
ö¢
->
›
, "mfhi") ) {}

170 if–
	`°ªq
(
ö¢
->
›
, "mflo") ) {}

172 if–
	`°ªq
(
ö¢
->
›
, "sll" ) ) {}

173 if–
	`°ªq
(
ö¢
->
›
, "sllv") ) {}

174 if–
	`°ªq
(
ö¢
->
›
, "sra" ) ) {}

175 if–
	`°ªq
(
ö¢
->
›
, "srav") ) {}

176 if–
	`°ªq
(
ö¢
->
›
, "srl" ) ) {}

177 if–
	`°ªq
(
ö¢
->
›
, "srlv") ) {}

179 if–
	`°ªq
(
ö¢
->
›
, "slt" ) ) {}

180 if–
	`°ªq
(
ö¢
->
›
, "slti" ) ) {}

181 if–
	`°ªq
(
ö¢
->
›
, "sltiu") ) {}

182 if–
	`°ªq
(
ö¢
->
›
, "sltu" ) ) {}

184 if–
	`°ªq
(
ö¢
->
›
, "lb" ) ) {}

185 if–
	`°ªq
(
ö¢
->
›
, "lbu") ) {}

186 if–
	`°ªq
(
ö¢
->
›
, "lhu") ) {}

187 if–
	`°ªq
(
ö¢
->
›
, "lui") ) {}

188 if–
	`°ªq
(
ö¢
->
›
, "lw" ) ) {}

189 if–
	`°ªq
(
ö¢
->
›
, "l.d") ) {}

190 if–
	`°ªq
(
ö¢
->
›
, "l.s") ) {}

192 if–
	`°ªq
(
ö¢
->
›
, "sw" ) ) {}

193 if–
	`°ªq
(
ö¢
->
›
, "sb" ) ) {}

194 if–
	`°ªq
(
ö¢
->
›
, "sh" ) ) {}

195 if–
	`°ªq
(
ö¢
->
›
, "s.s") ) {}

197 if–
	`°ªq
(
ö¢
->
›
, "cvt.d.s") ) {}

198 if–
	`°ªq
(
ö¢
->
›
, "cvt.s.d") ) {}

200 if–
	`°ªq
(
ö¢
->
›
, "mtc1" ) ) {}

201 if–
	`°ªq
(
ö¢
->
›
, "mov.d") ) {}

204 
	}
}

	@ss/decode_cfg.h

23 #i‚de‡
DECODE_CFG_H


24 
	#DECODE_CFG_H


	)

31 
	#DNA
 (0)

	)

33 #i‡
deföed
(
TARGET_PISA
)

36 
	#DGPR
(
N
Ë(N)

	)

37 
	#DGPR_D
(
N
Ë((NË&~1)

	)

40 
	#DFPR_L
(
N
Ë(((N)+32)&~1)

	)

41 
	#DFPR_F
(
N
Ë(((N)+32)&~1)

	)

42 
	#DFPR_D
(
N
Ë(((N)+32)&~1)

	)

45 
	#DHI
 (0+32+32)

	)

46 
	#DLO
 (1+32+32)

	)

47 
	#DFCC
 (2+32+32)

	)

48 
	#DTMP
 (3+32+32)

	)

50 #ñi‡
deföed
(
TARGET_ALPHA
)

53 
	#DGPR
(
N
Ë(31 - (N)Ë

	)

56 
	#DFPR
(
N
Ë(((NË=31Ë? 
DNA
 : ((N)+32))

	)

59 
	#DFPCR
 (0+32+32)

	)

60 
	#DUNIQ
 (1+32+32)

	)

61 
	#DTMP
 (2+32+32)

	)

64 #îr‹ 
No
 
ISA
 
èrgë
 
deföed
...

	@ss/ecoff.h

101 #i‚de‡
ECOFF_H


102 
	#ECOFF_H


	)

104 
	#ECOFF_EB_MAGIC
 0x0160

	)

105 
	#ECOFF_EL_MAGIC
 0x0162

	)

107 
	secoff_fûehdr
 {

108 
	mf_magic
;

109 
	mf_ns˙s
;

110 
	mf_timd©
;

111 
	mf_sym±r
;

112 
	mf_nsyms
;

113 
	mf_›thdr
;

114 
	mf_Êags
;

117 
	secoff_aouthdr
 {

118 
	mmagic
;

119 
	mv°amp
;

120 
	mtsize
;

121 
	mdsize
;

122 
	mbsize
;

123 
	míåy
;

124 
	mãxt_°¨t
;

125 
	md©a_°¨t
;

126 
	mbss_°¨t
;

127 
	mg¥mask
;

128 
	m˝rmask
[4];

129 
	mgp_vÆue
;

132 
	secoff_s˙hdr
 {

133 
	ms_«me
[8];

134 
	ms_∑ddr
;

135 
	ms_vaddr
;

136 
	ms_size
;

137 
	ms_s˙±r
;

138 
	ms_ªÕå
;

139 
	ms_ n›å
;

140 
	ms_ƒñoc
;

141 
	ms_∆¬o
;

142 
	ms_Êags
;

145 
	secoff_symhdr_t
 {

146 
	mmagic
;

147 
	mv°amp
;

148 
	mûöeMax
;

149 
	mcbLöe
;

150 
	mcbLöeOff£t
;

151 
	midnMax
;

152 
	mcbDnOff£t
;

153 
	mùdMax
;

154 
	mcbPdOff£t
;

155 
	misymMax
;

156 
	mcbSymOff£t
;

157 
	mi›tMax
;

158 
	mcbO±Off£t
;

159 
	müuxMax
;

160 
	mcbAuxOff£t
;

161 
	missMax
;

162 
	mcbSsOff£t
;

163 
	missExtMax
;

164 
	mcbSsExtOff£t
;

165 
	mifdMax
;

166 
	mcbFdOff£t
;

167 
	m¸fd
;

168 
	mcbRfdOff£t
;

169 
	mõxtMax
;

170 
	mcbExtOff£t
;

171 } 
	tecoff_HDRR
;

173 
	#ECOFF_magicSym
 0x7009

	)

175 
	secoff_fdr
 {

176 
	madr
;

177 
	mrss
;

178 
	missBa£
;

179 
	mcbSs
;

180 
	misymBa£
;

181 
	mcsym
;

182 
	mûöeBa£
;

183 
	m˛öe
;

184 
	mi›tBa£
;

185 
	mc›t
;

186 
	mùdFú°
;

187 
	m˝d
;

188 
	müuxBa£
;

189 
	mˇux
;

190 
	mrfdBa£
;

191 
	m¸fd
;

192 
	mœng
 :5;

193 
	mfMîge
 :1;

194 
	mfRódö
 :1;

195 
	mfBigídün
 :1;

196 
	mª£rved
 :24;

197 
	mcbLöeOff£t
;

198 
	mcbLöe
;

199 } 
	tecoff_FDR
;

201 
	secoff_pdr
 {

202 
	madr
;

203 
	misym
;

204 
	mûöe
;

205 
	mªgmask
;

206 
	mªgoff£t
;

207 
	mi›t
;

208 
	m‰egmask
;

209 
	m‰egoff£t
;

210 
	m‰ameoff£t
;

211 
	m‰amîeg
;

212 
	mp¸eg
;

213 
	m Low
;

214 
	m High
;

215 
	mcbLöeOff£t
;

216 } 
	tecoff_PDR
;

218 
	secoff_SYMR
 {

219 
	miss
;

220 
	mvÆue
;

221 
	m°
 :6;

222 
	msc
 :5;

223 
	mª£rved
 :1;

224 
	mödex
 :20;

225 } 
	tecoff_SYMR
;

227 
	secoff_EXTR
 {

228 
	mª£rved
;

229 
	mifd
;

230 
ecoff_SYMR
 
	masym
;

231 } 
	tecoff_EXTR
;

233 
	#ECOFF_R_SN_TEXT
 1

	)

234 
	#ECOFF_R_SN_RDATA
 2

	)

235 
	#ECOFF_R_SN_DATA
 3

	)

236 
	#ECOFF_R_SN_SDATA
 4

	)

237 
	#ECOFF_R_SN_SBSS
 5

	)

238 
	#ECOFF_R_SN_BSS
 6

	)

240 
	#ECOFF_STYP_TEXT
 0x0020

	)

241 
	#ECOFF_STYP_RDATA
 0x0100

	)

242 
	#ECOFF_STYP_DATA
 0x0040

	)

243 
	#ECOFF_STYP_SDATA
 0x0200

	)

244 
	#ECOFF_STYP_SBSS
 0x0400

	)

245 
	#ECOFF_STYP_BSS
 0x0080

	)

247 
	#ECOFF_°Nû
 0

	)

248 
	#ECOFF_°GlobÆ
 1

	)

249 
	#ECOFF_°Sètic
 2

	)

250 
	#ECOFF_°P¨am
 3

	)

251 
	#ECOFF_°Loˇl
 4

	)

252 
	#ECOFF_°Labñ
 5

	)

253 
	#ECOFF_°Proc
 6

	)

254 
	#ECOFF_°Block
 7

	)

255 
	#ECOFF_°End
 8

	)

256 
	#ECOFF_°Membî
 9

	)

257 
	#ECOFF_°Ty≥def
 10

	)

258 
	#ECOFF_°Fûe
 11

	)

259 
	#ECOFF_°RegRñoc
 12

	)

260 
	#ECOFF_°F‹w¨d
 13

	)

261 
	#ECOFF_°SèticProc
 14

	)

262 
	#ECOFF_°C⁄°™t
 15

	)

	@ss/eval.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

54 
	~<˘y≥.h
>

55 
	~<î∫o.h
>

57 
	~"ho°.h
"

58 
	~"misc.h
"

59 
	~"evÆ.h
"

61 #i‡
deföed
(
•¨c
Ë&& !deföed(
__svr4__
)

62 
	#°πoul
 
°πﬁ


	)

66 
evÆ_îr_t
 
	gevÆ_îr‹
 = 
ERR_NOERR
;

69 *
	gevÆ_îr_°r
[
ERR_NUM
] = {

81 
evÆ_tokí_t
 
	gtok_m≠
[256];

82 
	gtok_m≠_öôülized
 = 
FALSE
;

86 
	$öô_tok_m≠
()

88 
i
;

90 
i
=0; i<256; i++)

91 
tok_m≠
[
i
] = 
tok_övÆid
;

94 
i
='a'; i<='z'; i++)

95 
tok_m≠
[
i
] = 
tok_idít
;

96 
i
='A'; i<='Z'; i++)

97 
tok_m≠
[
i
] = 
tok_idít
;

98 
tok_m≠
[()'_'] = 
tok_idít
;

99 
tok_m≠
[()'$'] = 
tok_idít
;

102 
i
='0'; i<='9'; i++)

103 
tok_m≠
[
i
] = 
tok_c⁄°
;

104 
tok_m≠
[()'.'] = 
tok_c⁄°
;

107 
tok_m≠
[()'+'] = 
tok_∂us
;

108 
tok_m≠
[()'-'] = 
tok_möus
;

109 
tok_m≠
[()'*'] = 
tok_mu…
;

110 
tok_m≠
[()'/'] = 
tok_div
;

111 
tok_m≠
[()'('] = 
tok_›¨í
;

112 
tok_m≠
[()')'] = 
tok_˝¨í
;

115 
tok_m≠
[()' '] = 
tok_whôe•a˚
;

116 
tok_m≠
[()'\t'] = 
tok_whôe•a˚
;

117 
	}
}

120 
evÆ_tokí_t


121 
	$gë_√xt_tokí
(
evÆ_°©e_t
 *
es
)

123 
Ælow_hex
;

124 
evÆ_tokí_t
 
tok
;

125 *
±ok_buf
, 
œ°_ch¨
;

128 i‡(!
tok_m≠_öôülized
)

130 
	`öô_tok_m≠
();

131 
tok_m≠_öôülized
 = 
TRUE
;

135 i‡(
es
->
≥ek_tok
 !
tok_övÆid
)

137 
tok
 = 
es
->
≥ek_tok
;

138 
es
->
≥ek_tok
 = 
tok_övÆid
;

139  
tok
;

143 
±ok_buf
 = 
es
->
tok_buf
;

144 *
±ok_buf
 = '\0';

147 *
es
->
p
 && 
tok_m≠
[()*es->p] =
tok_whôe•a˚
)

148 
es
->
p
++;

151 i‡(*
es
->
p
 == '\0')

152  
tok_eof
;

154 *
±ok_buf
++ = *
es
->
p
;

155 
tok
 = 
tok_m≠
[()*
es
->
p
++];

156 
tok
)

158 
tok_idít
:

160 *
es
->
p


161 && (
tok_m≠
[()*
es
->
p
] =
tok_idít


162 || 
tok_m≠
[()*
es
->
p
] =
tok_c⁄°
))

164 *
±ok_buf
++ = *
es
->
p
++;

167 
tok_c⁄°
:

169 
œ°_ch¨
 = '\0';

170 
Ælow_hex
 = 
FALSE
;

171 *
es
->
p
 &&

172 (
tok_m≠
[()*
es
->
p
] =
tok_c⁄°


173 || (*
es
->
p
 ='-' && 
œ°_ch¨
 == 'e')

174 || (*
es
->
p
 ='+' && 
œ°_ch¨
 == 'e')

175 || 
	`tﬁowî
(*
es
->
p
) == 'e'

176 || 
	`tﬁowî
(*
es
->
p
) == 'x'

177 || (
	`tﬁowî
(*
es
->
p
Ë='a' && 
Ælow_hex
)

178 || (
	`tﬁowî
(*
es
->
p
Ë='b' && 
Ælow_hex
)

179 || (
	`tﬁowî
(*
es
->
p
Ë='c' && 
Ælow_hex
)

180 || (
	`tﬁowî
(*
es
->
p
Ë='d' && 
Ælow_hex
)

181 || (
	`tﬁowî
(*
es
->
p
Ë='e' && 
Ælow_hex
)

182 || (
	`tﬁowî
(*
es
->
p
Ë='f' && 
Ælow_hex
)))

184 
œ°_ch¨
 = 
	`tﬁowî
(*
es
->
p
);

185 i‡(*
es
->
p
 == 'x' || *es->p == 'X')

186 
Ælow_hex
 = 
TRUE
;

187 *
±ok_buf
++ = *
es
->
p
++;

190 
tok_∂us
:

191 
tok_möus
:

192 
tok_mu…
:

193 
tok_div
:

194 
tok_›¨í
:

195 
tok_˝¨í
:

199 
tok
 = 
tok_övÆid
;

204 *
±ok_buf
 = '\0';

206  
tok
;

207 
	}
}

211 
evÆ_tokí_t


212 
	$≥ek_√xt_tokí
(
evÆ_°©e_t
 *
es
)

215 i‡(
es
->
≥ek_tok
 =
tok_övÆid
)

217 
es
->
œ°p
 =És->
p
;

218 
es
->
≥ek_tok
 = 
	`gë_√xt_tokí
(es);

222  
es
->
≥ek_tok
;

223 
	}
}

226 
evÆ_vÆue_t
 
ex¥
(
evÆ_°©e_t
 *
es
);

229 
evÆ_vÆue_t
 
	gîr_vÆue
 = { 
ë_öt
, { 0 } };

232 *
	gevÆ_ty≥_°r
[
ë_NUM
] = {

236 #ifde‡
HOST_HAS_QWORD


246 
evÆ_ty≥_t


247 
	$ªsu…_ty≥
(
evÆ_ty≥_t
 
t1
,

248 
evÆ_ty≥_t
 
t2
)

251 i‡(
t1
 =
ë_symbﬁ
 || 
t2
 ==Ét_symbol)

252 
	`∑nic
("symbol used inÉxpression");

255 i‡(
t1
 =
ë_doubÀ
 || 
t2
 ==Ét_double)

256  
ë_doubÀ
;

257 i‡(
t1
 =
ë_Êﬂt
 || 
t2
 ==Ét_float)

258  
ë_Êﬂt
;

259 #ifde‡
HOST_HAS_QWORD


260 i‡(
t1
 =
ë_qw‹d
 || 
t2
 ==Ét_qword)

261  
ë_qw‹d
;

262 i‡(
t1
 =
ë_sqw‹d
 || 
t2
 ==Ét_sqword)

263  
ë_sqw‹d
;

265 i‡(
t1
 =
ë_addr
 || 
t2
 ==Ét_addr)

266  
ë_addr
;

267 i‡(
t1
 =
ë_uöt
 || 
t2
 ==Ét_uint)

268  
ë_uöt
;

270  
ë_öt
;

271 
	}
}

279 
	$evÆ_as_doubÀ
(
evÆ_vÆue_t
 
vÆ
)

281 
vÆ
.
ty≥
)

283 
ë_doubÀ
:

284  
vÆ
.
vÆue
.
as_doubÀ
;

285 
ë_Êﬂt
:

286  ()
vÆ
.
vÆue
.
as_Êﬂt
;

287 #ifde‡
HOST_HAS_QWORD


288 
ë_qw‹d
:

289 #ifde‡
_MSC_VER


290  ()(
sqw‹d_t
)
vÆ
.
vÆue
.
as_qw‹d
;

292  ()
vÆ
.
vÆue
.
as_qw‹d
;

294 
ë_sqw‹d
:

295  ()
vÆ
.
vÆue
.
as_sqw‹d
;

297 
ë_addr
:

298 #i‡
	`deföed
(
_MSC_VER
Ë&& deföed(
TARGET_ALPHA
)

300  ()(
sqw‹d_t
)
vÆ
.
vÆue
.
as_addr
;

302  ()
vÆ
.
vÆue
.
as_addr
;

304 
ë_uöt
:

305  ()
vÆ
.
vÆue
.
as_uöt
;

306 
ë_öt
:

307  ()
vÆ
.
vÆue
.
as_öt
;

308 
ë_symbﬁ
:

309 
	`∑nic
("symbol used inÉxpression");

311 
	`∑nic
("illegalárithmeticÉxpression conversion");

313 
	}
}

317 
	$evÆ_as_Êﬂt
(
evÆ_vÆue_t
 
vÆ
)

319 
vÆ
.
ty≥
)

321 
ë_doubÀ
:

322  ()
vÆ
.
vÆue
.
as_doubÀ
;

323 
ë_Êﬂt
:

324  
vÆ
.
vÆue
.
as_Êﬂt
;

325 #ifde‡
HOST_HAS_QWORD


326 
ë_qw‹d
:

327 #ifde‡
_MSC_VER


328  ()(
sqw‹d_t
)
vÆ
.
vÆue
.
as_qw‹d
;

330  ()
vÆ
.
vÆue
.
as_qw‹d
;

332 
ë_sqw‹d
:

333  ()
vÆ
.
vÆue
.
as_sqw‹d
;

335 
ë_addr
:

336 #i‡
	`deföed
(
_MSC_VER
Ë&& deföed(
TARGET_ALPHA
)

338  ()(
sqw‹d_t
)
vÆ
.
vÆue
.
as_addr
;

340  ()
vÆ
.
vÆue
.
as_addr
;

342 
ë_uöt
:

343  ()
vÆ
.
vÆue
.
as_uöt
;

344 
ë_öt
:

345  ()
vÆ
.
vÆue
.
as_öt
;

346 
ë_symbﬁ
:

347 
	`∑nic
("symbol used inÉxpression");

349 
	`∑nic
("illegalárithmeticÉxpression conversion");

351 
	}
}

353 #ifde‡
HOST_HAS_QWORD


355 
qw‹d_t


356 
	$evÆ_as_qw‹d
(
evÆ_vÆue_t
 
vÆ
)

358 
vÆ
.
ty≥
)

360 
ë_doubÀ
:

361  (
qw‹d_t
)
vÆ
.
vÆue
.
as_doubÀ
;

362 
ë_Êﬂt
:

363  (
qw‹d_t
)
vÆ
.
vÆue
.
as_Êﬂt
;

364 
ë_qw‹d
:

365  
vÆ
.
vÆue
.
as_qw‹d
;

366 
ë_sqw‹d
:

367  (
qw‹d_t
)
vÆ
.
vÆue
.
as_sqw‹d
;

368 
ë_addr
:

369  (
qw‹d_t
)
vÆ
.
vÆue
.
as_addr
;

370 
ë_uöt
:

371  (
qw‹d_t
)
vÆ
.
vÆue
.
as_uöt
;

372 
ë_öt
:

373  (
qw‹d_t
)
vÆ
.
vÆue
.
as_öt
;

374 
ë_symbﬁ
:

375 
	`∑nic
("symbol used inÉxpression");

377 
	`∑nic
("illegalárithmeticÉxpression conversion");

379 
	}
}

382 
sqw‹d_t


383 
	$evÆ_as_sqw‹d
(
evÆ_vÆue_t
 
vÆ
)

385 
vÆ
.
ty≥
)

387 
ë_doubÀ
:

388  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_doubÀ
;

389 
ë_Êﬂt
:

390  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_Êﬂt
;

391 
ë_qw‹d
:

392  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_qw‹d
;

393 
ë_sqw‹d
:

394  
vÆ
.
vÆue
.
as_sqw‹d
;

395 
ë_addr
:

396  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_addr
;

397 
ë_uöt
:

398  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_uöt
;

399 
ë_öt
:

400  (
sqw‹d_t
)
vÆ
.
vÆue
.
as_öt
;

401 
ë_symbﬁ
:

402 
	`∑nic
("symbol used inÉxpression");

404 
	`∑nic
("illegalárithmeticÉxpression conversion");

406 
	}
}

410 
md_addr_t


411 
	$evÆ_as_addr
(
evÆ_vÆue_t
 
vÆ
)

413 
vÆ
.
ty≥
)

415 
ë_doubÀ
:

416  (
md_addr_t
)
vÆ
.
vÆue
.
as_doubÀ
;

417 
ë_Êﬂt
:

418  (
md_addr_t
)
vÆ
.
vÆue
.
as_Êﬂt
;

419 #ifde‡
HOST_HAS_QWORD


420 
ë_qw‹d
:

421  (
md_addr_t
)
vÆ
.
vÆue
.
as_qw‹d
;

422 
ë_sqw‹d
:

423  (
md_addr_t
)
vÆ
.
vÆue
.
as_sqw‹d
;

425 
ë_addr
:

426  
vÆ
.
vÆue
.
as_addr
;

427 
ë_uöt
:

428  (
md_addr_t
)
vÆ
.
vÆue
.
as_uöt
;

429 
ë_öt
:

430  (
md_addr_t
)
vÆ
.
vÆue
.
as_öt
;

431 
ë_symbﬁ
:

432 
	`∑nic
("symbol used inÉxpression");

434 
	`∑nic
("illegalárithmeticÉxpression conversion");

436 
	}
}

440 
	$evÆ_as_uöt
(
evÆ_vÆue_t
 
vÆ
)

442 
vÆ
.
ty≥
)

444 
ë_doubÀ
:

445  ()
vÆ
.
vÆue
.
as_doubÀ
;

446 
ë_Êﬂt
:

447  ()
vÆ
.
vÆue
.
as_Êﬂt
;

448 #ifde‡
HOST_HAS_QWORD


449 
ë_qw‹d
:

450  ()
vÆ
.
vÆue
.
as_qw‹d
;

451 
ë_sqw‹d
:

452  ()
vÆ
.
vÆue
.
as_sqw‹d
;

454 
ë_addr
:

455  ()
vÆ
.
vÆue
.
as_addr
;

456 
ë_uöt
:

457  
vÆ
.
vÆue
.
as_uöt
;

458 
ë_öt
:

459  ()
vÆ
.
vÆue
.
as_öt
;

460 
ë_symbﬁ
:

461 
	`∑nic
("symbol used inÉxpression");

463 
	`∑nic
("illegalárithmeticÉxpression conversion");

465 
	}
}

469 
	$evÆ_as_öt
(
evÆ_vÆue_t
 
vÆ
)

471 
vÆ
.
ty≥
)

473 
ë_doubÀ
:

474  ()
vÆ
.
vÆue
.
as_doubÀ
;

475 
ë_Êﬂt
:

476  ()
vÆ
.
vÆue
.
as_Êﬂt
;

477 #ifde‡
HOST_HAS_QWORD


478 
ë_qw‹d
:

479  ()
vÆ
.
vÆue
.
as_qw‹d
;

480 
ë_sqw‹d
:

481  ()
vÆ
.
vÆue
.
as_sqw‹d
;

483 
ë_addr
:

484  ()
vÆ
.
vÆue
.
as_addr
;

485 
ë_uöt
:

486  ()
vÆ
.
vÆue
.
as_uöt
;

487 
ë_öt
:

488  
vÆ
.
vÆue
.
as_öt
;

489 
ë_symbﬁ
:

490 
	`∑nic
("symbol used inÉxpression");

492 
	`∑nic
("illegalárithmeticÉxpression conversion");

494 
	}
}

501 
evÆ_vÆue_t


502 
	$f_add
(
evÆ_vÆue_t
 
vÆ1
, evÆ_vÆue_à
vÆ2
)

504 
evÆ_ty≥_t
 
ë
;

505 
evÆ_vÆue_t
 
vÆ
;

508 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
 || 
vÆ2
.type ==Ét_symbol)

510 
evÆ_îr‹
 = 
ERR_BADEXPR
;

511  
îr_vÆue
;

515 
ë
 = 
	`ªsu…_ty≥
(
vÆ1
.
ty≥
, 
vÆ2
.type);

516 
ë
)

518 
ë_doubÀ
:

519 
vÆ
.
ty≥
 = 
ë_doubÀ
;

520 
vÆ
.
vÆue
.
as_doubÀ
 = 
	`evÆ_as_doubÀ
(
vÆ1
Ë+ÉvÆ_as_doubÀ(
vÆ2
);

522 
ë_Êﬂt
:

523 
vÆ
.
ty≥
 = 
ë_Êﬂt
;

524 
vÆ
.
vÆue
.
as_Êﬂt
 = 
	`evÆ_as_Êﬂt
(
vÆ1
Ë+ÉvÆ_as_Êﬂt(
vÆ2
);

526 #ifde‡
HOST_HAS_QWORD


527 
ë_qw‹d
:

528 
vÆ
.
ty≥
 = 
ë_qw‹d
;

529 
vÆ
.
vÆue
.
as_qw‹d
 = 
	`evÆ_as_qw‹d
(
vÆ1
Ë+ÉvÆ_as_qw‹d(
vÆ2
);

531 
ë_sqw‹d
:

532 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

533 
vÆ
.
vÆue
.
as_sqw‹d
 = 
	`evÆ_as_sqw‹d
(
vÆ1
Ë+ÉvÆ_as_sqw‹d(
vÆ2
);

536 
ë_addr
:

537 
vÆ
.
ty≥
 = 
ë_addr
;

538 
vÆ
.
vÆue
.
as_addr
 = 
	`evÆ_as_addr
(
vÆ1
Ë+ÉvÆ_as_addr(
vÆ2
);

540 
ë_uöt
:

541 
vÆ
.
ty≥
 = 
ë_uöt
;

542 
vÆ
.
vÆue
.
as_uöt
 = 
	`evÆ_as_uöt
(
vÆ1
Ë+ÉvÆ_as_uöt(
vÆ2
);

544 
ë_öt
:

545 
vÆ
.
ty≥
 = 
ë_öt
;

546 
vÆ
.
vÆue
.
as_öt
 = 
	`evÆ_as_öt
(
vÆ1
Ë+ÉvÆ_as_öt(
vÆ2
);

549 
	`∑nic
("bogusÉxpressionÅype");

552  
vÆ
;

553 
	}
}

556 
evÆ_vÆue_t


557 
	$f_sub
(
evÆ_vÆue_t
 
vÆ1
, evÆ_vÆue_à
vÆ2
)

559 
evÆ_ty≥_t
 
ë
;

560 
evÆ_vÆue_t
 
vÆ
;

563 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
 || 
vÆ2
.type ==Ét_symbol)

565 
evÆ_îr‹
 = 
ERR_BADEXPR
;

566  
îr_vÆue
;

570 
ë
 = 
	`ªsu…_ty≥
(
vÆ1
.
ty≥
, 
vÆ2
.type);

571 
ë
)

573 
ë_doubÀ
:

574 
vÆ
.
ty≥
 = 
ë_doubÀ
;

575 
vÆ
.
vÆue
.
as_doubÀ
 = 
	`evÆ_as_doubÀ
(
vÆ1
Ë-ÉvÆ_as_doubÀ(
vÆ2
);

577 
ë_Êﬂt
:

578 
vÆ
.
ty≥
 = 
ë_Êﬂt
;

579 
vÆ
.
vÆue
.
as_Êﬂt
 = 
	`evÆ_as_Êﬂt
(
vÆ1
Ë-ÉvÆ_as_Êﬂt(
vÆ2
);

581 #ifde‡
HOST_HAS_QWORD


582 
ë_qw‹d
:

583 
vÆ
.
ty≥
 = 
ë_qw‹d
;

584 
vÆ
.
vÆue
.
as_qw‹d
 = 
	`evÆ_as_qw‹d
(
vÆ1
Ë-ÉvÆ_as_qw‹d(
vÆ2
);

586 
ë_sqw‹d
:

587 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

588 
vÆ
.
vÆue
.
as_sqw‹d
 = 
	`evÆ_as_sqw‹d
(
vÆ1
Ë-ÉvÆ_as_sqw‹d(
vÆ2
);

591 
ë_addr
:

592 
vÆ
.
ty≥
 = 
ë_addr
;

593 
vÆ
.
vÆue
.
as_addr
 = 
	`evÆ_as_addr
(
vÆ1
Ë-ÉvÆ_as_addr(
vÆ2
);

595 
ë_uöt
:

596 
vÆ
.
ty≥
 = 
ë_uöt
;

597 
vÆ
.
vÆue
.
as_uöt
 = 
	`evÆ_as_uöt
(
vÆ1
Ë-ÉvÆ_as_uöt(
vÆ2
);

599 
ë_öt
:

600 
vÆ
.
ty≥
 = 
ë_öt
;

601 
vÆ
.
vÆue
.
as_öt
 = 
	`evÆ_as_öt
(
vÆ1
Ë-ÉvÆ_as_öt(
vÆ2
);

604 
	`∑nic
("bogusÉxpressionÅype");

607  
vÆ
;

608 
	}
}

611 
evÆ_vÆue_t


612 
	$f_mu…
(
evÆ_vÆue_t
 
vÆ1
, evÆ_vÆue_à
vÆ2
)

614 
evÆ_ty≥_t
 
ë
;

615 
evÆ_vÆue_t
 
vÆ
;

618 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
 || 
vÆ2
.type ==Ét_symbol)

620 
evÆ_îr‹
 = 
ERR_BADEXPR
;

621  
îr_vÆue
;

625 
ë
 = 
	`ªsu…_ty≥
(
vÆ1
.
ty≥
, 
vÆ2
.type);

626 
ë
)

628 
ë_doubÀ
:

629 
vÆ
.
ty≥
 = 
ë_doubÀ
;

630 
vÆ
.
vÆue
.
as_doubÀ
 = 
	`evÆ_as_doubÀ
(
vÆ1
Ë*ÉvÆ_as_doubÀ(
vÆ2
);

632 
ë_Êﬂt
:

633 
vÆ
.
ty≥
 = 
ë_Êﬂt
;

634 
vÆ
.
vÆue
.
as_Êﬂt
 = 
	`evÆ_as_Êﬂt
(
vÆ1
Ë*ÉvÆ_as_Êﬂt(
vÆ2
);

636 #ifde‡
HOST_HAS_QWORD


637 
ë_qw‹d
:

638 
vÆ
.
ty≥
 = 
ë_qw‹d
;

639 
vÆ
.
vÆue
.
as_qw‹d
 = 
	`evÆ_as_qw‹d
(
vÆ1
Ë*ÉvÆ_as_qw‹d(
vÆ2
);

641 
ë_sqw‹d
:

642 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

643 
vÆ
.
vÆue
.
as_sqw‹d
 = 
	`evÆ_as_sqw‹d
(
vÆ1
Ë*ÉvÆ_as_sqw‹d(
vÆ2
);

646 
ë_addr
:

647 
vÆ
.
ty≥
 = 
ë_addr
;

648 
vÆ
.
vÆue
.
as_addr
 = 
	`evÆ_as_addr
(
vÆ1
Ë*ÉvÆ_as_addr(
vÆ2
);

650 
ë_uöt
:

651 
vÆ
.
ty≥
 = 
ë_uöt
;

652 
vÆ
.
vÆue
.
as_uöt
 = 
	`evÆ_as_uöt
(
vÆ1
Ë*ÉvÆ_as_uöt(
vÆ2
);

654 
ë_öt
:

655 
vÆ
.
ty≥
 = 
ë_öt
;

656 
vÆ
.
vÆue
.
as_öt
 = 
	`evÆ_as_öt
(
vÆ1
Ë*ÉvÆ_as_öt(
vÆ2
);

659 
	`∑nic
("bogusÉxpressionÅype");

662  
vÆ
;

663 
	}
}

666 
evÆ_vÆue_t


667 
	$f_div
(
evÆ_vÆue_t
 
vÆ1
, evÆ_vÆue_à
vÆ2
)

669 
evÆ_ty≥_t
 
ë
;

670 
evÆ_vÆue_t
 
vÆ
;

673 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
 || 
vÆ2
.type ==Ét_symbol)

675 
evÆ_îr‹
 = 
ERR_BADEXPR
;

676  
îr_vÆue
;

680 
ë
 = 
	`ªsu…_ty≥
(
vÆ1
.
ty≥
, 
vÆ2
.type);

681 
ë
)

683 
ë_doubÀ
:

684 
vÆ
.
ty≥
 = 
ë_doubÀ
;

685 
vÆ
.
vÆue
.
as_doubÀ
 = 
	`evÆ_as_doubÀ
(
vÆ1
Ë/ÉvÆ_as_doubÀ(
vÆ2
);

687 
ë_Êﬂt
:

688 
vÆ
.
ty≥
 = 
ë_Êﬂt
;

689 
vÆ
.
vÆue
.
as_Êﬂt
 = 
	`evÆ_as_Êﬂt
(
vÆ1
Ë/ÉvÆ_as_Êﬂt(
vÆ2
);

691 #ifde‡
HOST_HAS_QWORD


692 
ë_qw‹d
:

693 
vÆ
.
ty≥
 = 
ë_qw‹d
;

694 
vÆ
.
vÆue
.
as_qw‹d
 = 
	`evÆ_as_qw‹d
(
vÆ1
Ë/ÉvÆ_as_qw‹d(
vÆ2
);

696 
ë_sqw‹d
:

697 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

698 
vÆ
.
vÆue
.
as_sqw‹d
 = 
	`evÆ_as_sqw‹d
(
vÆ1
Ë/ÉvÆ_as_sqw‹d(
vÆ2
);

701 
ë_addr
:

702 
vÆ
.
ty≥
 = 
ë_addr
;

703 
vÆ
.
vÆue
.
as_addr
 = 
	`evÆ_as_addr
(
vÆ1
Ë/ÉvÆ_as_addr(
vÆ2
);

705 
ë_uöt
:

706 
vÆ
.
ty≥
 = 
ë_uöt
;

707 
vÆ
.
vÆue
.
as_uöt
 = 
	`evÆ_as_uöt
(
vÆ1
Ë/ÉvÆ_as_uöt(
vÆ2
);

709 
ë_öt
:

710 
vÆ
.
ty≥
 = 
ë_öt
;

711 
vÆ
.
vÆue
.
as_öt
 = 
	`evÆ_as_öt
(
vÆ1
Ë/ÉvÆ_as_öt(
vÆ2
);

714 
	`∑nic
("bogusÉxpressionÅype");

717  
vÆ
;

718 
	}
}

721 
evÆ_vÆue_t


722 
	$f_√g
(
evÆ_vÆue_t
 
vÆ1
)

724 
evÆ_vÆue_t
 
vÆ
;

727 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
)

729 
evÆ_îr‹
 = 
ERR_BADEXPR
;

730  
îr_vÆue
;

734 
vÆ1
.
ty≥
)

736 
ë_doubÀ
:

737 
vÆ
.
ty≥
 = 
ë_doubÀ
;

738 
vÆ
.
vÆue
.
as_doubÀ
 = - 
vÆ1
.value.as_double;

740 
ë_Êﬂt
:

741 
vÆ
.
ty≥
 = 
ë_Êﬂt
;

742 
vÆ
.
vÆue
.
as_Êﬂt
 = - 
vÆ1
.value.as_float;

744 #ifde‡
HOST_HAS_QWORD


745 
ë_qw‹d
:

746 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

747 
vÆ
.
vÆue
.
as_qw‹d
 = - (
sqw‹d_t
)
vÆ1
.value.as_qword;

749 
ë_sqw‹d
:

750 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

751 
vÆ
.
vÆue
.
as_sqw‹d
 = - 
vÆ1
.value.as_sqword;

754 
ë_addr
:

755 
vÆ
.
ty≥
 = 
ë_addr
;

756 
vÆ
.
vÆue
.
as_addr
 = - 
vÆ1
.value.as_addr;

758 
ë_uöt
:

759 i‡(()
vÆ1
.
vÆue
.
as_uöt
 > 2147483648U)

762 #ifde‡
HOST_HAS_QWORD


763 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

764 
vÆ
.
vÆue
.
as_sqw‹d
 = - ((
sqw‹d_t
)
vÆ1
.vÆue.
as_uöt
);

766 
vÆ
.
ty≥
 = 
ë_doubÀ
;

767 
vÆ
.
vÆue
.
as_doubÀ
 = - (()
vÆ1
.vÆue.
as_uöt
);

773 
vÆ
.
ty≥
 = 
ë_öt
;

774 
vÆ
.
vÆue
.
as_öt
 = - (()
vÆ1
.vÆue.
as_uöt
);

777 
ë_öt
:

778 i‡(()
vÆ1
.
vÆue
.
as_öt
 == 0x80000000U)

781 
vÆ
.
ty≥
 = 
ë_uöt
;

782 
vÆ
.
vÆue
.
as_uöt
 = 2147483648U;

787 
vÆ
.
ty≥
 = 
ë_öt
;

788 
vÆ
.
vÆue
.
as_öt
 = - 
vÆ1
.value.as_int;

792 
	`∑nic
("bogusÉxpressionÅype");

795  
vÆ
;

796 
	}
}

800 
	$f_eq_zîo
(
evÆ_vÆue_t
 
vÆ1
)

802 
vÆ
;

805 i‡(
vÆ1
.
ty≥
 =
ë_symbﬁ
)

807 
evÆ_îr‹
 = 
ERR_BADEXPR
;

808  
FALSE
;

811 
vÆ1
.
ty≥
)

813 
ë_doubÀ
:

814 
vÆ
 = 
vÆ1
.
vÆue
.
as_doubÀ
 == 0.0;

816 
ë_Êﬂt
:

817 
vÆ
 = 
vÆ1
.
vÆue
.
as_Êﬂt
 == 0.0;

819 #ifde‡
HOST_HAS_QWORD


820 
ë_qw‹d
:

821 
vÆ
 = 
vÆ1
.
vÆue
.
as_qw‹d
 == 0;

823 
ë_sqw‹d
:

824 
vÆ
 = 
vÆ1
.
vÆue
.
as_sqw‹d
 == 0;

827 
ë_addr
:

828 
vÆ
 = 
vÆ1
.
vÆue
.
as_addr
 == 0;

830 
ë_uöt
:

831 
vÆ
 = 
vÆ1
.
vÆue
.
as_uöt
 == 0;

833 
ë_öt
:

834 
vÆ
 = 
vÆ1
.
vÆue
.
as_öt
 == 0;

837 
	`∑nic
("bogusÉxpressionÅype");

840  
vÆ
;

841 
	}
}

846 
evÆ_vÆue_t


847 
	$c⁄°™t
(
evÆ_°©e_t
 *
es
)

849 
evÆ_vÆue_t
 
vÆ
;

850 
öt_vÆ
;

851 
uöt_vÆ
;

852 
doubÀ_vÆ
;

853 *
ídp
;

854 #ifde‡
HOST_HAS_QWORD


855 
sqw‹d_t
 
sqw‹d_vÆ
;

856 
qw‹d_t
 
qw‹d_vÆ
;

860 #i‡
	`deföed
(
•¨c
Ë&& !deföed(
__svr4__
)

861 
	`°πﬁ
(*, **, );

862 
	`°πod
(*, **);

872 
î∫o
 = 0;

873 
öt_vÆ
 = 
	`°πﬁ
(
es
->
tok_buf
, &
ídp
, 0);

874 i‡(!
î∫o
 && !*
ídp
)

877 
vÆ
.
ty≥
 = 
ë_öt
;

878 
vÆ
.
vÆue
.
as_öt
 = 
öt_vÆ
;

879  
vÆ
;

883 
î∫o
 = 0;

884 
uöt_vÆ
 = 
	`°πoul
(
es
->
tok_buf
, &
ídp
, 0);

885 i‡(!
î∫o
 && !*
ídp
)

888 
vÆ
.
ty≥
 = 
ë_uöt
;

889 
vÆ
.
vÆue
.
as_uöt
 = 
uöt_vÆ
;

890  
vÆ
;

893 #ifde‡
HOST_HAS_QWORD


895 
î∫o
 = 0;

896 
sqw‹d_vÆ
 = 
	`my©osq
(
es
->
tok_buf
, &
ídp
, 0);

897 i‡(!
î∫o
 && !*
ídp
)

900 
vÆ
.
ty≥
 = 
ë_sqw‹d
;

901 
vÆ
.
vÆue
.
as_sqw‹d
 = 
sqw‹d_vÆ
;

902  
vÆ
;

906 
î∫o
 = 0;

907 
qw‹d_vÆ
 = 
	`my©oq
(
es
->
tok_buf
, &
ídp
, 0);

908 i‡(!
î∫o
 && !*
ídp
)

911 
vÆ
.
ty≥
 = 
ë_qw‹d
;

912 
vÆ
.
vÆue
.
as_qw‹d
 = 
qw‹d_vÆ
;

913  
vÆ
;

919 
î∫o
 = 0;

920 
doubÀ_vÆ
 = 
	`°πod
(
es
->
tok_buf
, &
ídp
);

921 i‡(!
î∫o
 && !*
ídp
)

924 
vÆ
.
ty≥
 = 
ë_doubÀ
;

925 
vÆ
.
vÆue
.
as_doubÀ
 = 
doubÀ_vÆ
;

926  
vÆ
;

931 
evÆ_îr‹
 = 
ERR_BADCONST
;

932  
îr_vÆue
;

933 
	}
}

937 
evÆ_vÆue_t


938 
	$Á˘‹
(
evÆ_°©e_t
 *
es
)

940 
evÆ_tokí_t
 
tok
;

941 
evÆ_vÆue_t
 
vÆ
;

943 
tok
 = 
	`≥ek_√xt_tokí
(
es
);

944 
tok
)

946 
tok_›¨í
:

947 ()
	`gë_√xt_tokí
(
es
);

948 
vÆ
 = 
	`ex¥
(
es
);

949 i‡(
evÆ_îr‹
)

950  
îr_vÆue
;

952 
tok
 = 
	`≥ek_√xt_tokí
(
es
);

953 i‡(
tok
 !
tok_˝¨í
)

955 
evÆ_îr‹
 = 
ERR_UPAREN
;

956  
îr_vÆue
;

958 ()
	`gë_√xt_tokí
(
es
);

961 
tok_möus
:

963 ()
	`gë_√xt_tokí
(
es
);

964 
vÆ
 = 
	`Á˘‹
(
es
);

965 i‡(
evÆ_îr‹
)

966  
îr_vÆue
;

967 
vÆ
 = 
	`f_√g
(val);

970 
tok_idít
:

971 ()
	`gë_√xt_tokí
(
es
);

973 
vÆ
 = 
es
->
	`f_evÆ_idít
(es);

974 i‡(
evÆ_îr‹
)

975  
îr_vÆue
;

978 
tok_c⁄°
:

979 ()
	`gë_√xt_tokí
(
es
);

980 
vÆ
 = 
	`c⁄°™t
(
es
);

981 i‡(
evÆ_îr‹
)

982  
îr_vÆue
;

986 
evÆ_îr‹
 = 
ERR_NOTERM
;

987  
îr_vÆue
;

990  
vÆ
;

991 
	}
}

995 
evÆ_vÆue_t


996 
	$ãrm
(
evÆ_°©e_t
 *
es
)

998 
evÆ_tokí_t
 
tok
;

999 
evÆ_vÆue_t
 
vÆ
, 
vÆ1
;

1001 
vÆ
 = 
	`Á˘‹
(
es
);

1002 i‡(
evÆ_îr‹
)

1003  
îr_vÆue
;

1005 
tok
 = 
	`≥ek_√xt_tokí
(
es
);

1006 
tok
)

1008 
tok_mu…
:

1009 ()
	`gë_√xt_tokí
(
es
);

1010 
vÆ
 = 
	`f_mu…
(vÆ, 
	`ãrm
(
es
));

1011 i‡(
evÆ_îr‹
)

1012  
îr_vÆue
;

1015 
tok_div
:

1016 ()
	`gë_√xt_tokí
(
es
);

1017 
vÆ1
 = 
	`ãrm
(
es
);

1018 i‡(
evÆ_îr‹
)

1019  
îr_vÆue
;

1020 i‡(
	`f_eq_zîo
(
vÆ1
))

1022 
evÆ_îr‹
 = 
ERR_DIV0
;

1023  
îr_vÆue
;

1025 
vÆ
 = 
	`f_div
(vÆ, 
vÆ1
);

1031  
vÆ
;

1032 
	}
}

1036 
evÆ_vÆue_t


1037 
	$ex¥
(
evÆ_°©e_t
 *
es
)

1039 
evÆ_tokí_t
 
tok
;

1040 
evÆ_vÆue_t
 
vÆ
;

1042 
vÆ
 = 
	`ãrm
(
es
);

1043 i‡(
evÆ_îr‹
)

1044  
îr_vÆue
;

1046 
tok
 = 
	`≥ek_√xt_tokí
(
es
);

1047 
tok
)

1049 
tok_∂us
:

1050 ()
	`gë_√xt_tokí
(
es
);

1051 
vÆ
 = 
	`f_add
(vÆ, 
	`ex¥
(
es
));

1052 i‡(
evÆ_îr‹
)

1053  
îr_vÆue
;

1056 
tok_möus
:

1057 ()
	`gë_√xt_tokí
(
es
);

1058 
vÆ
 = 
	`f_sub
(vÆ, 
	`ex¥
(
es
));

1059 i‡(
evÆ_îr‹
)

1060  
îr_vÆue
;

1066  
vÆ
;

1067 
	}
}

1070 
evÆ_°©e_t
 *

1071 
	$evÆ_√w
(
evÆ_idít_t
 
f_evÆ_idít
,

1072 *
u£r_±r
)

1074 
evÆ_°©e_t
 *
es
;

1076 
es
 = 
	`ˇŒoc
(1, (
evÆ_°©e_t
));

1077 i‡(!
es
)

1078 
	`Áèl
("out of virtual memory");

1080 
es
->
f_evÆ_idít
 = f_eval_ident;

1081 
es
->
u£r_±r
 = user_ptr;

1083  
es
;

1084 
	}
}

1088 
	$evÆ_dñëe
(
evÆ_°©e_t
 *
es
)

1090 
	`‰ì
(
es
);

1091 
	}
}

1095 
evÆ_vÆue_t


1096 
	$evÆ_ex¥
(
evÆ_°©e_t
 *
es
,

1097 *
p
,

1098 **
ídp
)

1100 
evÆ_vÆue_t
 
vÆ
;

1103 
evÆ_îr‹
 = 
ERR_NOERR
;

1104 
es
->
p
 =Ö;

1105 *
es
->
tok_buf
 = '\0';

1106 
es
->
≥ek_tok
 = 
tok_övÆid
;

1109 
vÆ
 = 
	`ex¥
(
es
);

1112 i‡(
ídp
)

1114 i‡(
es
->
≥ek_tok
 !
tok_övÆid
)

1117 *
ídp
 = 
es
->
œ°p
;

1120 *
ídp
 = 
es
->
p
;

1123  
vÆ
;

1124 
	}
}

1128 
	$evÆ_¥öt
(
FILE
 *
°ªam
,

1129 
evÆ_vÆue_t
 
vÆ
)

1131 
vÆ
.
ty≥
)

1133 
ë_doubÀ
:

1134 
	`Ârötf
(
°ªam
, "%‡[doubÀ]", 
vÆ
.
vÆue
.
as_doubÀ
);

1136 
ë_Êﬂt
:

1137 
	`Ârötf
(
°ªam
, "%‡[Êﬂt]", ()
vÆ
.
vÆue
.
as_Êﬂt
);

1139 #ifde‡
HOST_HAS_QWORD


1140 
ë_qw‹d
:

1141 
	`myÂrötf
(
°ªam
, "%lu [qw‹d_t]", 
vÆ
.
vÆue
.
as_qw‹d
);

1143 
ë_sqw‹d
:

1144 
	`myÂrötf
(
°ªam
, "%ld [sqw‹d_t]", 
vÆ
.
vÆue
.
as_sqw‹d
);

1147 
ë_addr
:

1148 
	`myÂrötf
(
°ªam
, "0x%∞[md_addr_t]", 
vÆ
.
vÆue
.
as_addr
);

1150 
ë_uöt
:

1151 
	`Ârötf
(
°ªam
, "%u [uöt]", 
vÆ
.
vÆue
.
as_uöt
);

1153 
ë_öt
:

1154 
	`Ârötf
(
°ªam
, "%d [öt]", 
vÆ
.
vÆue
.
as_öt
);

1156 
ë_symbﬁ
:

1157 
	`Ârötf
(
°ªam
, "\"%s\" [symbﬁ]", 
vÆ
.
vÆue
.
as_symbﬁ
);

1160 
	`∑nic
("bogusÉxpressionÅype");

1162 
	}
}

1165 #ifde‡
TEST


1167 
evÆ_vÆue_t
 
	g™_öt
;

1168 
evÆ_vÆue_t
 
	ga_uöt
;

1169 
evÆ_vÆue_t
 
	ga_Êﬂt
;

1170 
evÆ_vÆue_t
 
	ga_doubÀ
;

1171 
evÆ_vÆue_t
 
	ga_symbﬁ
;

1173 
	ssym_m≠_t
 {

1174 *
	msymbﬁ
;

1175 
evÆ_vÆue_t
 *
	mvÆue
;

1178 
sym_m≠_t
 
	gsym_m≠
[] = {

1179 { "™_öt", &
™_öt
 },

1180 { "a_uöt", &
a_uöt
 },

1181 { "a_Êﬂt", &
a_Êﬂt
 },

1182 { "a_doubÀ", &
a_doubÀ
 },

1183 { "a_symbﬁ", &
a_symbﬁ
 },

1184 { 
NULL
, NULL },

1187 
evÆ_vÆue_t


1188 
	$my_evÆ_idít
(
evÆ_°©e_t
 *
es
)

1190 
sym_m≠_t
 *
sym
;

1192 
sym
=
sym_m≠
; sym->
symbﬁ
 !
NULL
; sym++)

1194 i‡(!
	`°rcmp
(
sym
->
symbﬁ
, 
es
->
tok_buf
))

1195  *
sym
->
vÆue
;

1198 
evÆ_îr‹
 = 
ERR_UNDEFVAR
;

1199  
îr_vÆue
;

1200 
	}
}

1203 
	$maö
()

1205 
evÆ_°©e_t
 *
es
;

1208 
™_öt
.
ty≥
 = 
ë_öt
;án_öt.
vÆue
.
as_öt
 = 1;

1209 
a_uöt
.
ty≥
 = 
ë_uöt
;á_uöt.
vÆue
.
as_uöt
 = 2;

1210 
a_Êﬂt
.
ty≥
 = 
ë_Êﬂt
;á_Êﬂt.
vÆue
.
as_Êﬂt
 = 3.0f;

1211 
a_doubÀ
.
ty≥
 = 
ë_doubÀ
;á_doubÀ.
vÆue
.
as_doubÀ
 = 4.0;

1212 
a_symbﬁ
.
ty≥
 = 
ë_symbﬁ
;á_symbﬁ.
vÆue
.
as_symbﬁ
 = "testing 1 2 3...";

1215 
es
 = 
	`evÆ_√w
(
my_evÆ_idít
, 
NULL
);

1219 
evÆ_vÆue_t
 
vÆ
;

1220 
ex¥_buf
[1024];

1222 
	`fgës
(
ex¥_buf
, 1024, 
°dö
);

1225 i‡(
ex¥_buf
[
	`°æí
(expr_buf)-1] == '\n')

1226 
ex¥_buf
[
	`°æí
(expr_buf)-1] = '\0';

1228 i‡(
ex¥_buf
[0] == '\0')

1229 
	`exô
(0);

1231 
vÆ
 = 
	`evÆ_ex¥
(
es
, 
ex¥_buf
, 
NULL
);

1232 i‡(
evÆ_îr‹
)

1233 
	`Ârötf
(
°dout
, "evÆÉº‹: %s\n", 
evÆ_îr_°r
[
evÆ_îr‹
]);

1236 
	`Ârötf
(
°dout
, "%†=", 
ex¥_buf
);

1237 
	`evÆ_¥öt
(
°dout
, 
vÆ
);

1238 
	`Ârötf
(
°dout
, "\n");

1241 
	}
}

	@ss/eval.h

52 #i‚de‡
EVAL_H


53 
	#EVAL_H


	)

55 
	~<°dio.h
>

56 
	~"ho°.h
"

57 
	~"misc.h
"

58 
	~"machöe.h
"

61 
	gevÆ_°©e_t
;

62 
	gevÆ_vÆue_t
;

67 
	gevÆ_vÆue_t


68 (*
	tevÆ_idít_t
)(
	tevÆ_°©e_t
 *
	tes
);

71 
	eevÆ_tokí_t
 {

72 
	mtok_idít
,

73 
	mtok_c⁄°
,

74 
	mtok_∂us
,

75 
	mtok_möus
,

76 
	mtok_mu…
,

77 
	mtok_div
,

78 
	mtok_›¨í
,

79 
	mtok_˝¨í
,

80 
	mtok_eof
,

81 
	mtok_whôe•a˚
,

82 
	mtok_övÆid


86 
	sevÆ_°©e_t
 {

87 *
	mp
;

88 *
	mœ°p
;

89 
evÆ_idít_t
 
	mf_evÆ_idít
;

90 *
	mu£r_±r
;

91 
	mtok_buf
[512];

92 
evÆ_tokí_t
 
	m≥ek_tok
;

96 
	eevÆ_îr_t
 {

97 
	mERR_NOERR
,

98 
	mERR_UPAREN
,

99 
	mERR_NOTERM
,

100 
	mERR_DIV0
,

101 
	mERR_BADCONST
,

102 
	mERR_BADEXPR
,

103 
	mERR_UNDEFVAR
,

104 
	mERR_EXTRA
,

105 
	mERR_NUM


109 
evÆ_îr_t
 
evÆ_îr‹
 ;

112 *
evÆ_îr_°r
[
ERR_NUM
];

115 
	eevÆ_ty≥_t
 {

116 
	më_öt
,

117 
	më_uöt
,

118 
	më_addr
,

119 #ifde‡
HOST_HAS_QWORD


120 
	më_qw‹d
,

121 
	më_sqw‹d
,

123 
	më_Êﬂt
,

124 
	më_doubÀ
,

125 
	më_symbﬁ
,

126 
	më_NUM


130 #ifde‡
HOST_HAS_QWORD


131 
	#EVAL_INTEGRAL
(
TYPE
Ë\

	)

132 ((
	gTYPE
Ë=
ë_öt
 || (
TYPE
Ë=
ë_uöt
 || (TYPEË=
ë_addr
 \

133 || (
TYPE
Ë=
ë_qw‹d
 || (TYPEË=
ë_sqw‹d
)

135 
	#EVAL_INTEGRAL
(
TYPE
Ë\

	)

136 ((
TYPE
Ë=
ë_öt
 || (TYPEË=
ë_uöt
 || (TYPEË=
ë_addr
)

140 *
evÆ_ty≥_°r
[
ë_NUM
];

143 
	sevÆ_vÆue_t
 {

144 
evÆ_ty≥_t
 
	mty≥
;

146 
	mas_öt
;

147 
	mas_uöt
;

148 
md_addr_t
 
	mas_addr
;

149 #ifde‡
HOST_HAS_QWORD


150 
qw‹d_t
 
	mas_qw‹d
;

151 
sqw‹d_t
 
	mas_sqw‹d
;

153 
	mas_Êﬂt
;

154 
	mas_doubÀ
;

155 *
	mas_symbﬁ
;

156 } 
	mvÆue
;

164 
evÆ_as_doubÀ
(
evÆ_vÆue_t
 
vÆ
);

167 
evÆ_as_Êﬂt
(
evÆ_vÆue_t
 
vÆ
);

169 #ifde‡
HOST_HAS_QWORD


171 
qw‹d_t
 
evÆ_as_qw‹d
(
evÆ_vÆue_t
 
vÆ
);

174 
sqw‹d_t
 
evÆ_as_sqw‹d
(
evÆ_vÆue_t
 
vÆ
);

178 
md_addr_t
 
evÆ_as_addr
(
evÆ_vÆue_t
 
vÆ
);

181 
evÆ_as_uöt
(
evÆ_vÆue_t
 
vÆ
);

184 
evÆ_as_öt
(
evÆ_vÆue_t
 
vÆ
);

187 
evÆ_°©e_t
 *

188 
evÆ_√w
(
evÆ_idít_t
 
f_evÆ_idít
,

189 *
u£r_±r
);

193 
evÆ_dñëe
(
evÆ_°©e_t
 *
es
);

197 
evÆ_vÆue_t


198 
evÆ_ex¥
(
evÆ_°©e_t
 *
es
,

199 *
p
,

200 **
ídp
);

204 
evÆ_¥öt
(
FILE
 *
°ªam
,

205 
evÆ_vÆue_t
 
vÆ
);

	@ss/host.h

52 #i‚de‡
HOST_H


53 
	#HOST_H


	)

56 #i‚de‡
__STDC__


57 #îr‹ 
The
 
Sim∂eSˇœr
 
simuœt‹s
 
mu°
 
be
 
compûed
 
wôh
 
™
 
ANSI
 
C
 
compûî
.

61 #unde‡
INLINE


62 #i‡
deföed
(
__GNUC__
)

63 
	#INLINE
 
ölöe


	)

65 
	#INLINE


	)

69 #ifde‡
__GNUC__


71 
	#SYMCAT
(
X
,
Y
ËX##
	)
Y

72 
	#ANSI_SYMCAT


	)

74 #ifde‡
OLD_SYMCAT


75 
	#SYMCAT
(
X
,
Y
ËX 
	)
Y

77 
	#SYMCAT
(
X
,
Y
ËX##
	)
Y

78 
	#ANSI_SYMCAT


	)

83 
	tboﬁ_t
;

84 
	tbyã_t
;

85 sig√d 
	tsbyã_t
;

86 
	thÆf_t
;

87 sig√d 
	tshÆf_t
;

88 
	tw‹d_t
;

89 sig√d 
	tsw‹d_t
;

90 
	tsÊﬂt_t
;

91 
	tdÊﬂt_t
;

94 #i‡
deföed
(
__GNUC__
Ë|| deföed(
__SUNPRO_C
Ë|| deföed(
__CC_C89
Ë|| deföed(
__CC_XLC
)

95 
	#HOST_HAS_QWORD


	)

96 
	tqw‹d_t
;

97 sig√d 
	tsqw‹d_t
;

98 #ifde‡
ANSI_SYMCAT


99 
	#ULL
(
N
ËN##
ULL


	)

100 
	#LL
(
N
ËN##
LL


	)

102 
	#ULL
(
N
ËN 
ULL


	)

103 
	#LL
(
N
ËN 
LL


	)

105 #ñi‡
deföed
(
__Æpha
)

106 
	#HOST_HAS_QWORD


	)

107 
	tqw‹d_t
;

108 sig√d 
	tsqw‹d_t
;

109 #ifde‡
ANSI_SYMCAT


110 
	#ULL
(
N
ËN##
UL


	)

111 
	#LL
(
N
ËN##
L


	)

113 
	#ULL
(
N
ËN 
UL


	)

114 
	#LL
(
N
ËN 
L


	)

116 #ñi‡
deföed
(
_MSC_VER
)

117 
	#HOST_HAS_QWORD


	)

118 
	t__öt64
 
	tqw‹d_t
;

119 sig√d 
	t__öt64
 
	tsqw‹d_t
;

120 
	#ULL
(
N
Ë((
qw‹d_t
)(N))

	)

121 
	#LL
(
N
Ë((
sqw‹d_t
)(N))

	)

123 #unde‡
HOST_HAS_QWORD


127 #ifde‡
HOST_HAS_QWORD


128 
sqw‹d_t
 
	tcou¡î_t
;

129 
sqw‹d_t
 
	ttick_t
;

131 
dÊﬂt_t
 
	tcou¡î_t
;

132 
dÊﬂt_t
 
	ttick_t
;

135 #ifde‡
__svr4__


136 
	#£tjmp
 
_£tjmp


	)

137 
	#l⁄gjmp
 
_l⁄gjmp


	)

	@ss/loader.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

55 
	~"ho°.h
"

56 
	~"misc.h
"

57 
	~"machöe.h
"

58 
	~"lﬂdî.h
"

60 
	~"ecoff.h
"

63 
	#TEXT_TAIL_PADDING
 128

	)

66 
md_addr_t
 
ld_ãxt_ba£
;

69 
ld_ãxt_size
;

72 
md_addr_t
 
	gld_¥og_íåy
 = 0;

79 
	$ld_lﬂd_¥og
(*
‚ame
)

81 
i
;

82 
FILE
 *
fobj
;

83 
Êoc
;

84 
ecoff_fûehdr
 
fhdr
;

85 
ecoff_aouthdr
 
ahdr
;

86 
ecoff_s˙hdr
 
shdr
;

88 
fobj
 = 
	`f›í
(
‚ame
, "r");

89 i‡(!
fobj
)

90 
	`Áèl
("ˇ¬Ÿ o≥¿execuèbÀ `%s'", 
‚ame
);

92 i‡(
	`‰ód
(&
fhdr
, (
ecoff_fûehdr
), 1, 
fobj
) < 1)

93 
	`Áèl
("ˇ¬ŸÑód hódî fromÉxecuèbÀ `%s'", 
‚ame
);

95 i‡(
	`‰ód
(&
ahdr
, (
ecoff_aouthdr
), 1, 
fobj
) < 1)

96 
	`Áèl
("ˇ¬ŸÑód AOUT hódî fromÉxecuèbÀ `%s'", 
‚ame
);

101 
	`f£ek
(
fobj
, (
ecoff_fûehdr
Ë+ 
fhdr
.
f_›thdr
, 0);

103 
	`debug
("¥o˚ssög %d se˘i⁄†ö `%s'...", 
fhdr
.
f_ns˙s
, 
‚ame
);

106 
Êoc
 = 
	`·ñl
(
fobj
);

107 
i
 = 0; i < 
fhdr
.
f_ns˙s
; i++)

109 *
p
;

110 i‡(
	`f£ek
(
fobj
, 
Êoc
, 0) == -1)

111 
	`Áèl
("couldÇotÑesetÜocation inÉxecutable");

112 i‡(
	`‰ód
(&
shdr
, (
ecoff_s˙hdr
), 1, 
fobj
) < 1)

113 
	`Áèl
("couldÇŸÑód se˘i⁄ %d fromÉxecuèbÀ", 
i
);

114 
Êoc
 = 
	`·ñl
(
fobj
);

116 
shdr
.
s_Êags
) {

117 
ECOFF_STYP_TEXT
:

118 
ld_ãxt_size
 = ((
shdr
.
s_vaddr
 + shdr.
s_size
Ë- 
MD_TEXT_BASE
)

119 + 
TEXT_TAIL_PADDING
;

121 
p
 = 
	`ˇŒoc
(
shdr
.
s_size
, ());

122 i‡(!
p
)

123 
	`Áèl
("out of virtual memory");

125 i‡(
	`f£ek
(
fobj
, 
shdr
.
s_s˙±r
, 0) == -1)

126 
	`Áèl
("couldÇŸÑód `.ãxt' fromÉxecuèbÀ", 
i
);

127 i‡(
	`‰ód
(
p
, 
shdr
.
s_size
, 1, 
fobj
) < 1)

128 
	`Áèl
("couldÇotÑeadÅext section fromÉxecutable");

131 
	`‰ì
(
p
);

134 
ECOFF_STYP_RDATA
:

139 
ECOFF_STYP_DATA
:

141 
ECOFF_STYP_SDATA
:

144 
ECOFF_STYP_BSS
:

147 
ECOFF_STYP_SBSS
:

155 
ld_ãxt_ba£
 = 
MD_TEXT_BASE
;

156 
ld_¥og_íåy
 = 
ahdr
.
íåy
;

159 i‡(
	`f˛o£
(
fobj
))

160 
	`Áèl
("couldÇŸ clo£ÉxecuèbÀ `%s'", 
‚ame
);

163 i‡(!
ld_ãxt_ba£
 || !
ld_ãxt_size
)

164 
	`Áèl
("executable is missingá `.text' section");

165 i‡(!
ld_¥og_íåy
)

166 
	`Áèl
("programÉntryÖointÇot specified");

167 
	}
}

	@ss/loader.h

52 #i‚de‡
LOADER_H


53 
	#LOADER_H


	)

55 
	~<°dio.h
>

57 
	~"ho°.h
"

58 
	~"misc.h
"

59 
	~"machöe.h
"

101 
md_addr_t
 
ld_ãxt_ba£
;

104 
ld_ãxt_size
;

107 
md_addr_t
 
ld_¥og_íåy
;

112 
ld_lﬂd_¥og
(*
‚ame
);

	@ss/machine.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

55 
	~"ho°.h
"

56 
	~"misc.h
"

57 
	~"machöe.h
"

58 
	~"evÆ.h
"

59 
	~"ªgs.h
"

62 
md_ö°_t
 
	gMD_NOP_INST
 = { 
NOP
, 0 };

65 
md_›code
 
	gmd_mask2›
[
MD_MAX_MASK
+1];

68 *
	gmd_›2«me
[
OP_MAX
] = {

69 
NULL
,

70 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËNAME,

	)

71 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
ËNAME,

	)

72 
	#CONNECT
(
OP
)

	)

73 
	~"machöe.def
"

77 *
	gmd_›2f‹m©
[
OP_MAX
] = {

78 
NULL
,

79 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËOPFORM,

	)

80 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
Ë
NULL
,

	)

81 
	#CONNECT
(
OP
)

	)

82 
	~"machöe.def
"

86 
md_fu_˛ass
 
	gmd_›2fu
[
OP_MAX
] = {

87 
FUCœss_NA
,

88 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËRES,

	)

89 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
Ë
FUCœss_NA
,

	)

90 
	#CONNECT
(
OP
)

	)

91 
	~"machöe.def
"

95 *
	gmd_fu2«me
[
NUM_FU_CLASSES
] = {

96 
NULL
,

111 
	gmd_›2Êags
[
OP_MAX
] = {

112 
NA
,

113 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËFLAGS,

	)

114 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
Ë
NA
,

	)

115 
	#CONNECT
(
OP
)

	)

116 
	~"machöe.def
"

120 
w‹d_t
 
	gmd_Ã_masks
[] = {

121 #ifde‡
BYTES_BIG_ENDIAN


136 *
	gmd_amode_°r
[
md_amode_NUM
] =

147 
md_ªg_«mes_t
 
	gmd_ªg_«mes
[] =

152 { "$r0", 
π_g¥
, 0 },

153 { "$zîo", 
π_g¥
, 0 },

154 { "$r1", 
π_g¥
, 1 },

155 { "$r2", 
π_g¥
, 2 },

156 { "$r3", 
π_g¥
, 3 },

157 { "$r4", 
π_g¥
, 4 },

158 { "$r5", 
π_g¥
, 5 },

159 { "$r6", 
π_g¥
, 6 },

160 { "$r7", 
π_g¥
, 7 },

161 { "$r8", 
π_g¥
, 8 },

162 { "$r9", 
π_g¥
, 9 },

163 { "$r10", 
π_g¥
, 10 },

164 { "$r11", 
π_g¥
, 11 },

165 { "$r12", 
π_g¥
, 12 },

166 { "$r13", 
π_g¥
, 13 },

167 { "$r14", 
π_g¥
, 14 },

168 { "$r15", 
π_g¥
, 15 },

169 { "$r16", 
π_g¥
, 16 },

170 { "$r17", 
π_g¥
, 17 },

171 { "$r18", 
π_g¥
, 18 },

172 { "$r19", 
π_g¥
, 19 },

173 { "$r20", 
π_g¥
, 20 },

174 { "$r21", 
π_g¥
, 21 },

175 { "$r22", 
π_g¥
, 22 },

176 { "$r23", 
π_g¥
, 23 },

177 { "$r24", 
π_g¥
, 24 },

178 { "$r25", 
π_g¥
, 25 },

179 { "$r26", 
π_g¥
, 26 },

180 { "$r27", 
π_g¥
, 27 },

181 { "$r28", 
π_g¥
, 28 },

182 { "$gp", 
π_g¥
, 28 },

183 { "$r29", 
π_g¥
, 29 },

184 { "$•", 
π_g¥
, 29 },

185 { "$r30", 
π_g¥
, 30 },

186 { "$Â", 
π_g¥
, 30 },

187 { "$r31", 
π_g¥
, 31 },

190 { "$f0", 
π_Âr
, 0 },

191 { "$f1", 
π_Âr
, 1 },

192 { "$f2", 
π_Âr
, 2 },

193 { "$f3", 
π_Âr
, 3 },

194 { "$f4", 
π_Âr
, 4 },

195 { "$f5", 
π_Âr
, 5 },

196 { "$f6", 
π_Âr
, 6 },

197 { "$f7", 
π_Âr
, 7 },

198 { "$f8", 
π_Âr
, 8 },

199 { "$f9", 
π_Âr
, 9 },

200 { "$f10", 
π_Âr
, 10 },

201 { "$f11", 
π_Âr
, 11 },

202 { "$f12", 
π_Âr
, 12 },

203 { "$f13", 
π_Âr
, 13 },

204 { "$f14", 
π_Âr
, 14 },

205 { "$f15", 
π_Âr
, 15 },

206 { "$f16", 
π_Âr
, 16 },

207 { "$f17", 
π_Âr
, 17 },

208 { "$f18", 
π_Âr
, 18 },

209 { "$f19", 
π_Âr
, 19 },

210 { "$f20", 
π_Âr
, 20 },

211 { "$f21", 
π_Âr
, 21 },

212 { "$f22", 
π_Âr
, 22 },

213 { "$f23", 
π_Âr
, 23 },

214 { "$f24", 
π_Âr
, 24 },

215 { "$f25", 
π_Âr
, 25 },

216 { "$f26", 
π_Âr
, 26 },

217 { "$f27", 
π_Âr
, 27 },

218 { "$f28", 
π_Âr
, 28 },

219 { "$f29", 
π_Âr
, 29 },

220 { "$f30", 
π_Âr
, 30 },

221 { "$f31", 
π_Âr
, 31 },

224 { "$d0", 
π_d¥
, 0 },

225 { "$d1", 
π_d¥
, 1 },

226 { "$d2", 
π_d¥
, 2 },

227 { "$d3", 
π_d¥
, 3 },

228 { "$d4", 
π_d¥
, 4 },

229 { "$d5", 
π_d¥
, 5 },

230 { "$d6", 
π_d¥
, 6 },

231 { "$d7", 
π_d¥
, 7 },

232 { "$d8", 
π_d¥
, 8 },

233 { "$d9", 
π_d¥
, 9 },

234 { "$d10", 
π_d¥
, 10 },

235 { "$d11", 
π_d¥
, 11 },

236 { "$d12", 
π_d¥
, 12 },

237 { "$d13", 
π_d¥
, 13 },

238 { "$d14", 
π_d¥
, 14 },

239 { "$d15", 
π_d¥
, 15 },

242 { "$l0", 
π_Õr
, 0 },

243 { "$l1", 
π_Õr
, 1 },

244 { "$l2", 
π_Õr
, 2 },

245 { "$l3", 
π_Õr
, 3 },

246 { "$l4", 
π_Õr
, 4 },

247 { "$l5", 
π_Õr
, 5 },

248 { "$l6", 
π_Õr
, 6 },

249 { "$l7", 
π_Õr
, 7 },

250 { "$l8", 
π_Õr
, 8 },

251 { "$l9", 
π_Õr
, 9 },

252 { "$l10", 
π_Õr
, 10 },

253 { "$l11", 
π_Õr
, 11 },

254 { "$l12", 
π_Õr
, 12 },

255 { "$l13", 
π_Õr
, 13 },

256 { "$l14", 
π_Õr
, 14 },

257 { "$l15", 
π_Õr
, 15 },

258 { "$l16", 
π_Õr
, 16 },

259 { "$l17", 
π_Õr
, 17 },

260 { "$l18", 
π_Õr
, 18 },

261 { "$l19", 
π_Õr
, 19 },

262 { "$l20", 
π_Õr
, 20 },

263 { "$l21", 
π_Õr
, 21 },

264 { "$l22", 
π_Õr
, 22 },

265 { "$l23", 
π_Õr
, 23 },

266 { "$l24", 
π_Õr
, 24 },

267 { "$l25", 
π_Õr
, 25 },

268 { "$l26", 
π_Õr
, 26 },

269 { "$l27", 
π_Õr
, 27 },

270 { "$l28", 
π_Õr
, 28 },

271 { "$l29", 
π_Õr
, 29 },

272 { "$l30", 
π_Õr
, 30 },

273 { "$l31", 
π_Õr
, 31 },

276 { "$hi", 
π_˘æ
, 0 },

277 { "$lo", 
π_˘æ
, 1 },

278 { "$fcc", 
π_˘æ
, 2 },

281 { "$pc", 
π_PC
, 0 },

282 { "$≈c", 
π_NPC
, 0 },

285 { 
NULL
, 
π_g¥
, 0 }

290 
	$md_ªg_«me
(
md_ªg_ty≥
 
π
, 
ªg
)

292 
i
;

294 
i
=0; 
md_ªg_«mes
[i].
°r
 !
NULL
; i++)

296 i‡(
md_ªg_«mes
[
i
].
fûe
 =
π
 && md_ªg_«mes[i].
ªg
 ==Ñeg)

297  
md_ªg_«mes
[
i
].
°r
;

301  
NULL
;

302 
	}
}

305 
	$md_ªg_obj
(
ªgs_t
 *
ªgs
,

306 
is_wrôe
,

307 
md_ªg_ty≥
 
π
,

308 
ªg
,

309 
evÆ_vÆue_t
 *
vÆ
)

311 
π
)

313 
π_g¥
:

314 i‡(
ªg
 < 0 ||Ñeg >
MD_NUM_IREGS
)

317 i‡(!
is_wrôe
)

319 
vÆ
->
ty≥
 = 
ë_uöt
;

320 
vÆ
->
vÆue
.
as_uöt
 = 
ªgs
->
ªgs_R
[
ªg
];

323 
ªgs
->
ªgs_R
[
ªg
] = 
	`evÆ_as_uöt
(*
vÆ
);

326 
π_Õr
:

327 i‡(
ªg
 < 0 ||Ñeg >
MD_NUM_FREGS
)

330 i‡(!
is_wrôe
)

332 
vÆ
->
ty≥
 = 
ë_uöt
;

333 
vÆ
->
vÆue
.
as_uöt
 = 
ªgs
->
ªgs_F
.
l
[
ªg
];

336 
ªgs
->
ªgs_F
.
l
[
ªg
] = 
	`evÆ_as_uöt
(*
vÆ
);

339 
π_Âr
:

340 i‡(
ªg
 < 0 ||Ñeg >
MD_NUM_FREGS
)

343 i‡(!
is_wrôe
)

345 
vÆ
->
ty≥
 = 
ë_Êﬂt
;

346 
vÆ
->
vÆue
.
as_Êﬂt
 = 
ªgs
->
ªgs_F
.
f
[
ªg
];

349 
ªgs
->
ªgs_F
.
f
[
ªg
] = 
	`evÆ_as_Êﬂt
(*
vÆ
);

352 
π_d¥
:

353 i‡(
ªg
 < 0 ||Ñeg >
MD_NUM_FREGS
/2)

356 i‡(!
is_wrôe
)

358 
vÆ
->
ty≥
 = 
ë_doubÀ
;

359 
vÆ
->
vÆue
.
as_doubÀ
 = 
ªgs
->
ªgs_F
.
d
[
ªg
];

362 
ªgs
->
ªgs_F
.
d
[
ªg
] = 
	`evÆ_as_doubÀ
(*
vÆ
);

365 
π_˘æ
:

366 
ªg
)

369 i‡(!
is_wrôe
)

371 
vÆ
->
ty≥
 = 
ë_uöt
;

372 
vÆ
->
vÆue
.
as_uöt
 = 
ªgs
->
ªgs_C
.
hi
;

375 
ªgs
->
ªgs_C
.
hi
 = 
	`evÆ_as_uöt
(*
vÆ
);

379 i‡(!
is_wrôe
)

381 
vÆ
->
ty≥
 = 
ë_uöt
;

382 
vÆ
->
vÆue
.
as_uöt
 = 
ªgs
->
ªgs_C
.
lo
;

385 
ªgs
->
ªgs_C
.
lo
 = 
	`evÆ_as_uöt
(*
vÆ
);

389 i‡(!
is_wrôe
)

391 
vÆ
->
ty≥
 = 
ë_öt
;

392 
vÆ
->
vÆue
.
as_öt
 = 
ªgs
->
ªgs_C
.
fcc
;

395 
ªgs
->
ªgs_C
.
fcc
 = 
	`evÆ_as_uöt
(*
vÆ
);

403 
π_PC
:

404 i‡(!
is_wrôe
)

406 
vÆ
->
ty≥
 = 
ë_addr
;

407 
vÆ
->
vÆue
.
as_addr
 = 
ªgs
->
ªgs_PC
;

410 
ªgs
->
ªgs_PC
 = 
	`evÆ_as_addr
(*
vÆ
);

413 
π_NPC
:

414 i‡(!
is_wrôe
)

416 
vÆ
->
ty≥
 = 
ë_addr
;

417 
vÆ
->
vÆue
.
as_addr
 = 
ªgs
->
ªgs_NPC
;

420 
ªgs
->
ªgs_NPC
 = 
	`evÆ_as_addr
(*
vÆ
);

424 
	`∑nic
("bogusÑegister bank");

428  
NULL
;

429 
	}
}

433 
	$md_¥öt_úeg
(
md_g¥_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
)

435 
	`Ârötf
(
°ªam
, "%4s: %12d/0x%08x",

436 
	`md_ªg_«me
(
π_g¥
, 
ªg
), 
ªgs
[reg],Ñegs[reg]);

437 
	}
}

440 
	$md_¥öt_úegs
(
md_g¥_t
 
ªgs
, 
FILE
 *
°ªam
)

442 
i
;

444 
i
=0; i < 
MD_NUM_IREGS
; i += 2)

446 
	`md_¥öt_úeg
(
ªgs
, 
i
, 
°ªam
);

447 
	`Ârötf
(
°ªam
, " ");

448 
	`md_¥öt_úeg
(
ªgs
, 
i
+1, 
°ªam
);

449 
	`Ârötf
(
°ªam
, "\n");

451 
	}
}

455 
	$md_¥öt_Âªg
(
md_Âr_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
)

457 
	`Ârötf
(
°ªam
, "%4s: %12d/0x%08x/%f",

458 
	`md_ªg_«me
(
π_Âr
, 
ªg
), 
ªgs
.
l
[ªg],Ñegs.l[ªg],Ñegs.
f
[reg]);

459 i‡–!(
ªg
 & 1))

461 
	`Ârötf
(
°ªam
, " (%4sás double: %f)",

462 
	`md_ªg_«me
(
π_d¥
, 
ªg
/2), 
ªgs
.
d
[reg/2]);

464 
	}
}

467 
	$md_¥öt_Âªgs
(
md_Âr_t
 
ªgs
, 
FILE
 *
°ªam
)

469 
i
;

472 
i
=0; i < 
MD_NUM_FREGS
; i += 2)

474 
	`md_¥öt_Âªg
(
ªgs
, 
i
, 
°ªam
);

475 
	`Ârötf
(
°ªam
, "\n");

477 
	`md_¥öt_Âªg
(
ªgs
, 
i
+1, 
°ªam
);

478 
	`Ârötf
(
°ªam
, "\n");

480 
	}
}

483 
	$md_¥öt_¸eg
(
md_˘æ_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
)

486 
ªg
)

489 
	`Ârötf
(
°ªam
, "HI: 0x%08x", 
ªgs
.
hi
);

493 
	`Ârötf
(
°ªam
, "LO: 0x%08x", 
ªgs
.
lo
);

497 
	`Ârötf
(
°ªam
, "FCC: 0x%08x", 
ªgs
.
fcc
);

501 
	`∑nic
("bogus controlÑegister index");

503 
	}
}

506 
	$md_¥öt_¸egs
(
md_˘æ_t
 
ªgs
, 
FILE
 *
°ªam
)

508 
	`md_¥öt_¸eg
(
ªgs
, 0, 
°ªam
);

509 
	`Ârötf
(
°ªam
, " ");

510 
	`md_¥öt_¸eg
(
ªgs
, 1, 
°ªam
);

511 
	`Ârötf
(
°ªam
, " ");

512 
	`md_¥öt_¸eg
(
ªgs
, 2, 
°ªam
);

513 
	`Ârötf
(
°ªam
, "\n");

514 
	}
}

517 
w‹d_t


518 
	$md_¸c_ªgs
(
ªgs_t
 *
ªgs
)

520 
i
;

521 
w‹d_t
 
¸c_accum
 = 0;

523 
i
=0; i < 
MD_NUM_IREGS
; i++)

524 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_R
[
i
]);

526 
i
=0; i < 
MD_NUM_FREGS
; i++)

527 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_F
.
l
[
i
]);

529 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_C
.
hi
);

530 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_C
.
lo
);

531 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_C
.
fcc
);

532 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_PC
);

533 
¸c_accum
 = 
	`¸c
(¸c_accum, 
ªgs
->
ªgs_NPC
);

535  
¸c_accum
;

536 
	}
}

539 
w‹d_t


540 
	$md_x‹_ªgs
(
ªgs_t
 *
ªgs
)

542 
i
;

543 
w‹d_t
 
checksum
 = 0;

545 
i
=0; i < 
MD_NUM_IREGS
; i++)

546 
checksum
 ^
ªgs
->
ªgs_R
[
i
];

548 
i
=0; i < 
MD_NUM_FREGS
; i++)

549 
checksum
 ^
ªgs
->
ªgs_F
.
l
[
i
];

551 
checksum
 ^
ªgs
->
ªgs_C
.
hi
;

552 
checksum
 ^
ªgs
->
ªgs_C
.
lo
;

553 
checksum
 ^
ªgs
->
ªgs_C
.
fcc
;

554 
checksum
 ^
ªgs
->
ªgs_PC
;

555 
checksum
 ^
ªgs
->
ªgs_NPC
;

557  
checksum
;

558 
	}
}

562 
	$md_öô_decodî
()

565 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
Ë\

	)

566 i‡(
md_mask2›
[(
MSK
)]Ë
	`Áèl
("doubly defined mask value"); \

567 i‡((
MSK
Ë>
MD_MAX_MASK
Ë
	`Áèl
("mask value isÅooÜarge"); \

568 
md_mask2›
[(
MSK
)]=(
OP
);

570 
	~"machöe.def
"

571 
	}
}

575 
	$md_¥öt_ö¢
(
md_ö°_t
 
ö°
,

576 
md_addr_t
 
pc
,

577 
FILE
 *
°ªam
)

579 
md_›code
 
›
;

582 i‡(!
°ªam
)

583 
°ªam
 = 
°dîr
;

586 
	`MD_SET_OPCODE
(
›
, 
ö°
);

589 i‡(
›
 =
OP_NA
 || o∞>
OP_MAX
)

592 
	`Ârötf
(
°ªam
, "<övÆid in°: 0x%08x:%08x>", 
ö°
.
a
, in°.
b
);

596 *
s
;

598 
	`Ârötf
(
°ªam
, "%-10s", 
	`MD_OP_NAME
(
›
));

600 
s
 = 
	`MD_OP_FORMAT
(
›
);

601 *
s
) {

602 *
s
) {

604 
	`Ârötf
(
°ªam
, "r%d", 
RD
);

607 
	`Ârötf
(
°ªam
, "r%d", 
RS
);

610 
	`Ârötf
(
°ªam
, "r%d", 
RT
);

613 
	`Ârötf
(
°ªam
, "r%d", 
BS
);

616 
	`Ârötf
(
°ªam
, "f%d", 
FD
);

619 
	`Ârötf
(
°ªam
, "f%d", 
FS
);

622 
	`Ârötf
(
°ªam
, "f%d", 
FT
);

625 
	`Ârötf
(
°ªam
, "0x%x", (
pc
 + 8 + (
OFS
 << 2)));

629 
	`Ârötf
(
°ªam
, "%d", 
IMM
);

632 
	`Ârötf
(
°ªam
, "%d", 
SHAMT
);

635 
	`Ârötf
(
°ªam
, "%u", 
UIMM
);

638 
	`Ârötf
(
°ªam
, "0x%x", 
UIMM
);

641 
	`Ârötf
(
°ªam
, "0x%x", ((
pc
 & 036000000000Ë| (
TARG
 << 2)));

644 
	`Ârötf
(
°ªam
, "0x%x", 
BCODE
);

649 i‡(
SS_COMP_OP
 =
SS_COMP_NOP
)

650 
	`Ârötf
(
°ªam
, ")");

651 i‡(
SS_COMP_OP
 =
SS_COMP_POST_INC
)

652 
	`Ârötf
(
°ªam
, ")+");

653 i‡(
SS_COMP_OP
 =
SS_COMP_POST_DEC
)

654 
	`Ârötf
(
°ªam
, ")-");

655 i‡(
SS_COMP_OP
 =
SS_COMP_PRE_INC
)

656 
	`Ârötf
(
°ªam
, ")^+");

657 i‡(
SS_COMP_OP
 =
SS_COMP_PRE_DEC
)

658 
	`Ârötf
(
°ªam
, ")^-");

659 i‡(
SS_COMP_OP
 =
SS_COMP_POST_DBL_INC
)

660 
	`Ârötf
(
°ªam
, ")++");

661 i‡(
SS_COMP_OP
 =
SS_COMP_POST_DBL_DEC
)

662 
	`Ârötf
(
°ªam
, ")--");

663 i‡(
SS_COMP_OP
 =
SS_COMP_PRE_DBL_INC
)

664 
	`Ârötf
(
°ªam
, ")^++");

665 i‡(
SS_COMP_OP
 =
SS_COMP_PRE_DBL_DEC
)

666 
	`Ârötf
(
°ªam
, ")^--");

668 
	`∑nic
("bogus SS_COMP_OP");

673 
	`Âutc
(*
s
, 
°ªam
);

675 
s
++;

678 
	}
}

687 
	#XX
 0x6bababab

	)

690 
	gss_f‹e_èb
[ 8][ 5] = {

694  { 
XX
, XX, XX, XX, XX, },

696  { 
XX
, XX, XX, XX, XX, },

697  { 
XX
, XX, XX, XX, XX, },

698  { 
XX
, XX, XX, XX, XX, },

703 
	gss_a·_èb
[ 8][ 5] = {

707  { 
XX
, XX, XX, XX, XX, },

709  { 
XX
, XX, XX, XX, XX, },

710  { 
XX
, XX, XX, XX, XX, },

711  { 
XX
, XX, XX, XX, XX, },

716 
md_addr_t
 
	gss_Ã_ãmp
;

719 
md_addr_t
 
	gãmp_bs
, 
	gãmp_rd
;

	@ss/machine.h

52 #i‚de‡
PISA_H


53 
	#PISA_H


	)

55 
	~<°dio.h
>

57 
	~"ho°.h
"

58 
	~"misc.h
"

67 
	#TARGET_PISA


	)

69 #i‚de‡
TARGET_PISA_BIG


70 #i‚de‡
TARGET_PISA_LITTLE


72 #ifde‡
BYTES_BIG_ENDIAN


73 
	#TARGET_PISA_BIG


	)

75 
	#TARGET_PISA_LITTLE


	)

81 #i‡
deföed
(
BYTES_BIG_ENDIAN
Ë&& deföed(
TARGET_PISA_LITTLE
)

82 
	#MD_CROSS_ENDIAN


	)

84 #i‡
deföed
(
BYTES_LITTLE_ENDIAN
Ë&& deföed(
TARGET_PISA_BIG
)

85 
	#MD_CROSS_ENDIAN


	)

89 
	#NA
 0

	)

96 #unde‡
MD_QWORD_ADDRS


99 
w‹d_t
 
	tmd_addr_t
;

107 
	#MD_PAGE_SIZE
 4096

	)

108 
	#MD_LOG_PAGE_SIZE
 12

	)

115 
	emd_Áu…_ty≥
 {

116 
	mmd_Áu…_n⁄e
 = 0,

117 
	mmd_Áu…_ac˚ss
,

118 
	mmd_Áu…_Æignmít
,

119 
	mmd_Áu…_ovîÊow
,

120 
	mmd_Áu…_div0
,

121 
	mmd_Áu…_bªak
,

122 
	mmd_Áu…_unim∂
,

123 
	mmd_Áu…_öã∫Æ


132 
	#MD_NUM_IREGS
 32

	)

135 
	#MD_NUM_FREGS
 32

	)

138 
	#MD_NUM_CREGS
 3

	)

141 
	#MD_TOTAL_REGS
 \

	)

145 
sw‹d_t
 
	tmd_g¥_t
[
MD_NUM_IREGS
];

149 
sw‹d_t
 
	ml
[
MD_NUM_FREGS
];

150 
sÊﬂt_t
 
	mf
[
MD_NUM_FREGS
];

151 
dÊﬂt_t
 
	md
[
MD_NUM_FREGS
/2];

152 } 
	tmd_Âr_t
;

156 
sw‹d_t
 
	mhi
, 
	mlo
;

157 
	mfcc
;

158 } 
	tmd_˘æ_t
;

161 
	emd_ªg_«mes
 {

162 
	mMD_REG_ZERO
 = 0,

163 
	mMD_REG_GP
 = 28,

164 
	mMD_REG_SP
 = 29,

165 
	mMD_REG_FP
 = 30

175 
w‹d_t
 
	ma
;

176 
w‹d_t
 
	mb
;

177 } 
	tmd_ö°_t
;

180 
md_ö°_t
 
MD_NOP_INST
;

183 #ifde‡
MD_CROSS_ENDIAN


185 
	#MD_SWAPH
(
X
Ë
	`SWAP_HALF
(X)

	)

186 
	#MD_SWAPW
(
X
Ë
	`SWAP_WORD
(X)

	)

187 
	#MD_SWAPQ
(
X
Ë
	`SWAP_QWORD
(X)

	)

188 
	#MD_SWAPI
(
X
Ë((X).
a
 = 
	`SWAP_WORD
((X).a), \

	)

189 (
	gX
).
	gb
 = 
SWAP_WORD
((
X
).
b
))

193 
	#MD_SWAPH
(
X
Ë(X)

	)

194 
	#MD_SWAPW
(
X
Ë(X)

	)

195 
	#MD_SWAPQ
(
X
Ë(X)

	)

196 
	#MD_SWAPD
(
X
Ë(X)

	)

197 
	#MD_SWAPI
(
X
Ë(X)

	)

202 
	#MD_FETCH_INST
(
INST
, 
MEM
, 
PC
Ë\

	)

203 { 
	gö°
.
	ga
 = 
MEM_READ_WORD
(
mem
, (
PC
)); \

204 
	gö°
.
	gb
 = 
MEM_READ_WORD
(
mem
, (
PC
Ë+ (
w‹d_t
)); }

211 
	#MD_TEXT_BASE
 0x00400000

	)

212 
	#MD_DATA_BASE
 0x10000000

	)

213 
	#MD_STACK_BASE
 0x7fffc000

	)

216 
	#MD_MAX_ENVIRON
 16384

	)

224 
	#MD_OPFIELD
(
INST
Ë(INST.
a
 & 0xff)

	)

225 
	#MD_SET_OPCODE
(
OP
, 
INST
Ë((OPË((INST).
a
 & 0xff))

	)

229 
	#MD_MAX_MASK
 255

	)

232 
	emd_›code
 {

233 
	mOP_NA
 = 0,

234 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËOP,

	)

235 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
ËOP,

	)

236 
	#CONNECT
(
OP
)

	)

237 
	~"machöe.def
"

238 
	mOP_MAX


242 
	#MD_OP_ENUM
(
MSK
Ë(
md_mask2›
[MSK])

	)

243 
md_›code
 
md_mask2›
[];

246 
	#MD_OP_NAME
(
OP
Ë(
md_›2«me
[OP])

	)

247 *
md_›2«me
[];

250 
	#MD_OP_FORMAT
(
OP
Ë(
md_›2f‹m©
[OP])

	)

251 *
md_›2f‹m©
[];

254 
	emd_fu_˛ass
 {

255 
	mFUCœss_NA
 = 0,

256 
	mI¡ALU
,

257 
	mI¡MULT
,

258 
	mI¡DIV
,

259 
	mFlﬂtADD
,

260 
	mFlﬂtCMP
,

261 
	mFlﬂtCVT
,

262 
	mFlﬂtMULT
,

263 
	mFlﬂtDIV
,

264 
	mFlﬂtSQRT
,

265 
	mRdP‹t
,

266 
	mWrP‹t
,

267 
	mNUM_FU_CLASSES


271 
	#MD_OP_FUCLASS
(
OP
Ë(
md_›2fu
[OP])

	)

272 
md_fu_˛ass
 
md_›2fu
[];

275 
	#MD_FU_NAME
(
FU
Ë(
md_fu2«me
[FU])

	)

276 *
md_fu2«me
[];

279 
	#F_ICOMP
 0x00000001

	)

280 
	#F_FCOMP
 0x00000002

	)

281 
	#F_CTRL
 0x00000004

	)

282 
	#F_UNCOND
 0x00000008

	)

283 
	#F_COND
 0x00000010

	)

284 
	#F_MEM
 0x00000020

	)

285 
	#F_LOAD
 0x00000040

	)

286 
	#F_STORE
 0x00000080

	)

287 
	#F_DISP
 0x00000100

	)

288 
	#F_RR
 0x00000200

	)

289 
	#F_DIRECT
 0x00000400

	)

290 
	#F_TRAP
 0x00000800

	)

291 
	#F_LONGLAT
 0x00001000

	)

292 
	#F_DIRJMP
 0x00002000

	)

293 
	#F_INDIRJMP
 0x00004000

	)

294 
	#F_CALL
 0x00008000

	)

295 
	#F_FPCOND
 0x00010000

	)

296 
	#F_IMM
 0x00020000

	)

299 
	#MD_OP_FLAGS
(
OP
Ë(
md_›2Êags
[OP])

	)

300 
md_›2Êags
[];

303 #unde‡
RS


304 
	#RS
 (
ö°
.
b
 >> 24Ë

	)

305 
	#RT
 ((
ö°
.
b
 >> 16Ë& 0xffË

	)

306 
	#RD
 ((
ö°
.
b
 >> 8Ë& 0xffË

	)

309 
	#SHAMT
 (
ö°
.
b
 & 0xff)

	)

312 
	#FS
 
RS


	)

313 
	#FT
 
RT


	)

314 
	#FD
 
RD


	)

317 
	#IMM
 (()(–)(
ö°
.
b
 & 0xffff)))

	)

320 
	#UIMM
 (
ö°
.
b
 & 0xffff)

	)

323 
	#TARG
 (
ö°
.
b
 & 0x3ffffff)

	)

326 
	#BCODE
 (
ö°
.
b
 & 0xfffff)

	)

329 
	#OFS
 
IMM


	)

332 
	#BS
 
RS


	)

335 
	#MAXINT_VAL
 0x7fffffff

	)

338 
	#OVER
(
X
,
Y
Ë\

	)

339 ((((
	gX
Ë> 0Ë&& ((
	gY
Ë> 0Ë&& (
	gMAXINT_VAL
 - (X) < (Y))) \

340 || (((
	gX
Ë< 0Ë&& ((
	gY
Ë< 0Ë&& (-
	gMAXINT_VAL
 - (X) > (Y))))

343 
	#UNDER
(
X
,
Y
Ë\

	)

344 ((((
	gX
Ë> 0Ë&& ((
	gY
Ë< 0Ë&& (
	gMAXINT_VAL
 + (Y) < (X))) \

345 || (((
	gX
Ë< 0Ë&& ((
	gY
Ë> 0Ë&& (-
	gMAXINT_VAL
 + (Y) > (X))))

348 #i‚de‡
SET_TPC


349 
	#SET_TPC
(
PC
Ë()0

	)

352 #ifde‡
BYTES_BIG_ENDIAN


354 
	#WL_SIZE
(
ADDR
Ë((ADDRË& 0x03)

	)

355 
	#WL_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

356 
	#WL_PROT_MASK
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

357 
	#WL_PROT_MASK1
(
ADDR
Ë(
md_Ã_masks
[
	`WL_SIZE
(ADDR)])

	)

358 
	#WL_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

361 
	#WR_SIZE
(
ADDR
Ë(((ADDRË& 0x03)+1)

	)

362 
	#WR_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

363 
	#WR_PROT_MASK
(
ADDR
Ë(~(
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

364 
	#WR_PROT_MASK1
(
ADDR
Ë((
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

365 
	#WR_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WR_SIZE
(ADDR)])

	)

368 
	#WL_SIZE
(
ADDR
Ë(4-((ADDRË& 0x03))

	)

369 
	#WL_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

370 
	#WL_PROT_MASK
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

371 
	#WL_PROT_MASK1
(
ADDR
Ë(
md_Ã_masks
[
	`WL_SIZE
(ADDR)])

	)

372 
	#WL_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

375 
	#WR_SIZE
(
ADDR
Ë(((ADDRË& 0x03)+1)

	)

376 
	#WR_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

377 
	#WR_PROT_MASK
(
ADDR
Ë(~(
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

378 
	#WR_PROT_MASK1
(
ADDR
Ë((
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

379 
	#WR_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WR_SIZE
(ADDR)])

	)

383 
w‹d_t
 
md_Ã_masks
[];

387 
	#WL_SIZE
(
ADDR
Ë(4-((ADDRË& 0x03))

	)

388 
	#WL_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

389 
	#WL_PROT_MASK
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

392 
	#WR_SIZE
(
ADDR
Ë(((ADDRË& 0x03)+1)

	)

393 
	#WR_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

394 
	#WR_PROT_MASK
(
ADDR
Ë(~(
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

397 
	#WL_SIZE
(
ADDR
Ë((ADDRË& 0x03)

	)

398 
	#WL_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

399 
	#WL_PROT_MASK1
(
ADDR
Ë(
md_Ã_masks
[
	`WL_SIZE
(ADDR)])

	)

400 
	#WL_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WL_SIZE
(ADDR)])

	)

403 
	#WR_SIZE
(
ADDR
Ë(((ADDRË& 0x03)+1)

	)

404 
	#WR_BASE
(
ADDR
Ë((ADDRË& ~0x03)

	)

405 
	#WR_PROT_MASK1
(
ADDR
Ë((
md_Ã_masks
[
	`WR_SIZE
(ADDR)]))

	)

406 
	#WR_PROT_MASK2
(
ADDR
Ë(
md_Ã_masks
[4-
	`WR_SIZE
(ADDR)])

	)

415 
	#SS_SYS_exô
 1

	)

416 
	#MD_EXIT_SYSCALL
(
REGS
Ë((REGS)->
ªgs_R
[2] =
SS_SYS_exô
)

	)

419 
	#SS_SYS_wrôe
 4

	)

420 
	#MD_OUTPUT_SYSCALL
(
REGS
Ë\

	)

421 ((
	gREGS
)->
	gªgs_R
[2] =
SS_SYS_wrôe
 \

422 && ((
REGS
)->
ªgs_R
[4] == 1 \

423 || (
REGS
)->
ªgs_R
[4] == 2))

426 
	#MD_STREAM_FILENO
(
REGS
Ë((REGS)->
ªgs_R
[4])

	)

429 
	#MD_IS_CALL
(
OP
Ë\

	)

430 ((
MD_OP_FLAGS
(
OP
Ë& (
F_CTRL
|
F_CALL
)) == (F_CTRL|F_CALL))

433 
	#MD_IS_RETURN
(
OP
Ë((OPË=
JR
 && (
RS
Ë=31)

	)

436 
	#MD_IS_INDIR
(
OP
Ë((OPË=
JR
)

	)

439 
	emd_amode_ty≥
 {

440 
md_amode_imm
,

441 
md_amode_gp
,

442 
md_amode_•
,

443 
md_amode_Â
,

444 
md_amode_di•
,

445 
md_amode_º
,

446 
md_amode_NUM


448 *
md_amode_°r
[
md_amode_NUM
];

451 
	#MD_AMODE_PREPROBE
(
OP
, 
FSM
Ë\

	)

452 { i‡((
	gOP
Ë=
LUI
Ë(
FSM
Ë(
RT
); }

455 
	#MD_AMODE_PROBE
(
AM
, 
OP
, 
FSM
Ë\

	)

457 i‡(
MD_OP_FLAGS
(
OP
Ë& 
	gF_DISP
) \

459 i‡((
	gBS
Ë=(
FSM
)) \

460 (
AM
Ë
md_amode_imm
; \

461 i‡((
	gBS
Ë=
MD_REG_GP
) \

462 (
AM
Ë
md_amode_gp
; \

463 i‡((
	gBS
Ë=
MD_REG_SP
) \

464 (
AM
Ë
md_amode_•
; \

465 i‡((
	gBS
Ë=
MD_REG_FP
) \

466 (
AM
Ë
md_amode_Â
; \

468 (
	gAM
Ë
md_amode_di•
; \

470 i‡(
MD_OP_FLAGS
(
OP
Ë& 
	gF_RR
) \

471 (
	gAM
Ë
md_amode_º
; \

473 
∑nic
("cannot decodeáddressing mode"); \

477 
	#MD_AMODE_POSTPROBE
(
FSM
Ë\

	)

478 { (
	gFSM
Ë
MD_REG_ZERO
; }

486 
	#MD_EIO_FILE_FORMAT
 
EIO_PISA_FORMAT


	)

488 
	#MD_MISC_REGS_TO_EXO
(
REGS
Ë\

	)

489 
exo_√w
(
ec_li°
, \

490  
exo_√w
(
ec_öãgî
, (
exo_öãgî_t
)
sim_num_ö¢
), \

491  
exo_√w
(
ec_addªss
, (
exo_öãgî_t
)(
REGS
)->
ªgs_PC
), \

492  
exo_√w
(
ec_addªss
, (
exo_öãgî_t
)(
REGS
)->
ªgs_NPC
), \

493  
exo_√w
(
ec_öãgî
, (
exo_öãgî_t
)(
REGS
)->
ªgs_C
.
hi
), \

494  
exo_√w
(
ec_öãgî
, (
exo_öãgî_t
)(
REGS
)->
ªgs_C
.
lo
), \

495  
exo_√w
(
ec_öãgî
, (
exo_öãgî_t
)(
REGS
)->
ªgs_C
.
fcc
),\

496 
NULL
)

498 
	#MD_IREG_TO_EXO
(
REGS
, 
IDX
Ë\

	)

499 
exo_√w
(
ec_addªss
, (
exo_öãgî_t
)(
REGS
)->
ªgs_R
[
IDX
])

501 
	#MD_FREG_TO_EXO
(
REGS
, 
IDX
Ë\

	)

502 
exo_√w
(
ec_addªss
, (
exo_öãgî_t
)(
REGS
)->
ªgs_F
.
l
[
IDX
])

504 
	#MD_EXO_TO_MISC_REGS
(
EXO
, 
ICNT
, 
REGS
Ë\

	)

506 i‡(!
	gexo
 \

507 || 
	gexo
->
	gec
 !
ec_li°
 \

508 || !
exo
->
as_li°
.
hód
 \

509 || 
exo
->
as_li°
.
hód
->
ec
 !
ec_öãgî
 \

510 || !
exo
->
as_li°
.
hód
->
√xt
 \

511 || 
exo
->
as_li°
.
hód
->
√xt
->
ec
 !
ec_addªss
 \

512 || !
exo
->
as_li°
.
hód
->
√xt
->next \

513 || 
exo
->
as_li°
.
hód
->
√xt
->√xt->
ec
 !
ec_addªss
 \

514 || !
exo
->
as_li°
.
hód
->
√xt
->next->next \

515 || 
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->
ec
 !
ec_öãgî
 \

516 || !
exo
->
as_li°
.
hód
->
√xt
->next->next->next \

517 || 
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->√xt->
ec
 !
ec_öãgî
 \

518 || !
exo
->
as_li°
.
hód
->
√xt
->next->next->next->next \

519 || 
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->√xt->√xt->
ec
 !
ec_öãgî
\

520 || 
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->√xt->√xt->√xà!
NULL
) \

521 
Áèl
("couldÇotÑead EIO miscÑegs"); \

522 (
	gICNT
Ë(
cou¡î_t
)
exo
->
as_li°
.
hód
->
as_öãgî
.
vÆ
; \

523 (
	gREGS
)->
	gªgs_PC
 = (
md_addr_t
)
exo
->
as_li°
.
hód
->
√xt
->
as_addªss
.
vÆ
; \

524 (
	gREGS
)->
	gªgs_NPC
 = \

525 (
md_addr_t
)
exo
->
as_li°
.
hód
->
√xt
->√xt->
as_addªss
.
vÆ
; \

526 (
	gREGS
)->
	gªgs_C
.
	ghi
 = \

527 (
w‹d_t
)
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->
as_öãgî
.
vÆ
; \

528 (
	gREGS
)->
	gªgs_C
.
	glo
 = \

529 (
w‹d_t
)
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->√xt->
as_öãgî
.
vÆ
; \

530 (
	gREGS
)->
	gªgs_C
.
	gfcc
 = \

531 ()
exo
->
as_li°
.
hód
->
√xt
->√xt->√xt->√xt->√xt->
as_öãgî
.
vÆ
;

533 
	#MD_EXO_TO_IREG
(
EXO
, 
REGS
, 
IDX
Ë\

	)

534 ((
	gREGS
)->
	gªgs_R
[
IDX
] = (
w‹d_t
)(
EXO
)->
as_öãgî
.
vÆ
)

536 
	#MD_EXO_TO_FREG
(
EXO
, 
REGS
, 
IDX
Ë\

	)

537 ((
	gREGS
)->
	gªgs_F
.
	gl
[
IDX
] = (
w‹d_t
)(
EXO
)->
as_öãgî
.
vÆ
)

539 
	#MD_EXO_CMP_IREG
(
EXO
, 
REGS
, 
IDX
Ë\

	)

540 ((
	gREGS
)->
	gªgs_R
[
IDX
] !(
sw‹d_t
)(
EXO
)->
as_öãgî
.
vÆ
)

542 
	#MD_FIRST_IN_REG
 2

	)

543 
	#MD_LAST_IN_REG
 7

	)

545 
	#MD_FIRST_OUT_REG
 2

	)

546 
	#MD_LAST_OUT_REG
 7

	)

554 
qw‹d_t
 
	texo_addªss_t
;

557 
qw‹d_t
 
	texo_öãgî_t
;

560 
	texo_Êﬂt_t
;

568 #ifde‡
HOST_HAS_QWORD


569 
	#°©_ªg_cou¡î
 
°©_ªg_sqw‹d


	)

570 
	#sc_cou¡î
 
sc_sqw‹d


	)

571 
	#f‹_cou¡î
 
f‹_sqw‹d


	)

573 
	#°©_ªg_cou¡î
 
°©_ªg_doubÀ


	)

574 
	#sc_cou¡î
 
sc_doubÀ


	)

575 
	#f‹_cou¡î
 
f‹_doubÀ


	)

579 
	#°©_ªg_addr
 
°©_ªg_uöt


	)

587 
	emd_ªg_ty≥
 {

588 
	mπ_g¥
,

589 
	mπ_Õr
,

590 
	mπ_Âr
,

591 
	mπ_d¥
,

592 
	mπ_˘æ
,

593 
	mπ_PC
,

594 
	mπ_NPC
,

595 
	mπ_NUM


599 
	smd_ªg_«mes_t
 {

600 *
	m°r
;

601 
md_ªg_ty≥
 
	mfûe
;

602 
	mªg
;

606 
md_ªg_«mes_t
 
md_ªg_«mes
[];

609 *
md_ªg_«me
(
md_ªg_ty≥
 
π
, 
ªg
);

612 
	gevÆ_vÆue_t
;

613 
	gªgs_t
;

615 
md_ªg_obj
(
ªgs_t
 *
ªgs
,

616 
is_wrôe
,

617 
md_ªg_ty≥
 
π
,

618 
ªg
,

619 
evÆ_vÆue_t
 *
vÆ
);

622 
md_¥öt_úeg
(
md_g¥_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
);

623 
md_¥öt_úegs
(
md_g¥_t
 
ªgs
, 
FILE
 *
°ªam
);

626 
md_¥öt_Âªg
(
md_Âr_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
);

627 
md_¥öt_Âªgs
(
md_Âr_t
 
ªgs
, 
FILE
 *
°ªam
);

630 
md_¥öt_¸eg
(
md_˘æ_t
 
ªgs
, 
ªg
, 
FILE
 *
°ªam
);

631 
md_¥öt_¸egs
(
md_˘æ_t
 
ªgs
, 
FILE
 *
°ªam
);

634 
w‹d_t
 
md_¸c_ªgs
(
ªgs_t
 *
ªgs
);

637 
w‹d_t
 
md_x‹_ªgs
(
ªgs_t
 *
ªgs
);

645 
	#MD_AGEN_OP
 
ADD


	)

648 
	#MD_NOP_OP
 
NOP


	)

652 
	#MD_VALID_ADDR
(
ADDR
Ë\

	)

653 (((
	gADDR
Ë>
ld_ãxt_ba£
 && (
ADDR
Ë< (ld_ãxt_ba£ + 
ld_ãxt_size
)) \

654 || ((
ADDR
Ë>
ld_d©a_ba£
 && (ADDRË< 
ld_°ack_ba£
))

663 
	#MD_BR_SHIFT
 3

	)

671 
md_öô_decodî
();

675 
md_¥öt_ö¢
(
md_ö°_t
 
ö°
,

676 
md_addr_t
 
pc
,

677 
FILE
 *
°ªam
);

700 
	#SS_PAGE_SIZE
 4096

	)

703 
	#SS_NUM_REGS
 32

	)

706 
	#SS_TOTAL_REGS
 \

	)

707 (
	gSS_NUM_REGS
+SS_NUM_REGS+ 1+ 1+ 1+ 1+ \

711 
	#SS_COMP_OP
 ((
ö°
.
a
 & 0xff00Ë>> 8)

	)

714 
	#SS_COMP_NOP
 0x00

	)

715 
	#SS_COMP_POST_INC
 0x01

	)

716 
	#SS_COMP_POST_DEC
 0x02

	)

717 
	#SS_COMP_PRE_INC
 0x03

	)

718 
	#SS_COMP_PRE_DEC
 0x04

	)

719 
	#SS_COMP_POST_DBL_INC
 0x05

	)

720 
	#SS_COMP_POST_DBL_DEC
 0x06

	)

721 
	#SS_COMP_PRE_DBL_INC
 0x07

	)

722 
	#SS_COMP_PRE_DBL_DEC
 0x08

	)

729 
	#INC_DEC
(
EXPR
, 
REG
, 
SIZE
Ë\

	)

730 (
SET_GPR
((
REG
), 
GPR
(REGË+ 
ss_f‹e_èb
[(
SIZE
)-1][
SS_COMP_OP
]), \

731 (
	gEXPR
), \

732 
SET_GPR
((
REG
), 
GPR
(REGË+ 
ss_a·_èb
[(
SIZE
)-1][
SS_COMP_OP
]))

735 
ss_f‹e_èb
[8][5];

736 
ss_a·_èb
[8][5];

739 
	#Rgp
 28

	)

740 
	#R•
 29

	)

741 
	#RÂ
 30

	)

744 
SS_ADDR_TYPE
 
ss_Ã_ãmp
;

747 
SS_ADDR_TYPE
 
ãmp_bs
, 
ãmp_rd
;

753 #i‚de‡
IFAIL


754 
	#IFAIL
(
S
Ë
	`Áèl
(S)

	)

758 
	#DIV0
(
N
Ë(((NË=0Ë? 
	`IFAIL
("dividêby 0"Ë: ()0)

	)

761 
	#INTALIGN
(
N
Ë(((NË& 01Ë\

	)

762 ? 
IFAIL
("bad INTÑegisterálignment") : ()0)

765 
	#FPALIGN
(
N
Ë(((NË& 01Ë\

	)

766 ? 
IFAIL
("bad FPÑegisterálignment") : ()0)

769 
	#TALIGN
(
TARG
Ë(((TARGË& 0x7Ë\

	)

770 ? 
IFAIL
("bad jumpálignment") : ()0)

772 
	#OVER
(
X
,
Y
Ë(()0)

	)

773 
	#UNDER
(
X
,
Y
Ë(()0)

	)

774 
	#DIV0
(
N
Ë(()0)

	)

775 
	#INTALIGN
(
N
Ë(()0)

	)

776 
	#FPALIGN
(
N
Ë(()0)

	)

777 
	#TALIGN
(
TARG
Ë(()0)

	)

782 
	#IDIV
(
A
, 
B
Ë((AË/ (B))

	)

783 
	#IMOD
(
A
, 
B
Ë((AË% (B))

	)

784 
	#FDIV
(
A
, 
B
Ë((AË/ (B))

	)

785 
	#FINT
(
A
Ë(()A)

	)

	@ss/misc.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

54 
	~<°d¨g.h
>

55 
	~<°rög.h
>

56 
	~<˘y≥.h
>

57 
	~<î∫o.h
>

59 #i‡
deföed
(
__Æpha
Ë|| deföed(
löux
)

60 
	~<uni°d.h
>

63 
	~"ho°.h
"

64 
	~"misc.h
"

65 
	~"machöe.h
"

68 
	gvîbo£
 = 
FALSE
;

70 #ifde‡
DEBUG


72 
	gdebuggög
 = 
FALSE
;

77 (*
hook_‚
)(
FILE
 *
°ªam
Ë
NULL
;

81 
	`Áèl_hook
((*
‚
)(
FILE
 *
°ªam
))

83 
hook_‚
 = 
‚
;

84 
	}
}

90 
	$_Áèl
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

93 
	$Áèl
(*
fmt
, ...)

96 
va_li°
 
v
;

97 
	`va_°¨t
(
v
, 
fmt
);

99 
	`Ârötf
(
°dîr
, "fatal: ");

100 
	`myvÂrötf
(
°dîr
, 
fmt
, 
v
);

103 i‡(
vîbo£
)

104 
	`Ârötf
(
°dîr
, " [%s:%s,Üöê%d]", 
func
, 
fûe
, 
löe
);

106 
	`Ârötf
(
°dîr
, "\n");

107 i‡(
hook_‚
)

108 (*
hook_‚
)(
°dîr
);

109 
	`exô
(1);

110 
	}
}

116 
	$_∑nic
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

119 
	$∑nic
(*
fmt
, ...)

122 
va_li°
 
v
;

123 
	`va_°¨t
(
v
, 
fmt
);

125 
	`Ârötf
(
°dîr
, "panic: ");

126 
	`myvÂrötf
(
°dîr
, 
fmt
, 
v
);

129 
	`Ârötf
(
°dîr
, " [%s:%s,Üöê%d]", 
func
, 
fûe
, 
löe
);

131 
	`Ârötf
(
°dîr
, "\n");

132 i‡(
hook_‚
)

133 (*
hook_‚
)(
°dîr
);

134 
	`ab‹t
();

135 
	}
}

138 #ifde‡
__GNUC__


140 
	$_w¨n
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

143 
	$w¨n
(*
fmt
, ...)

146 
va_li°
 
v
;

147 
	`va_°¨t
(
v
, 
fmt
);

149 
	`Ârötf
(
°dîr
, "warning: ");

150 
	`myvÂrötf
(
°dîr
, 
fmt
, 
v
);

151 #ifde‡
__GNUC__


152 i‡(
vîbo£
)

153 
	`Ârötf
(
°dîr
, " [%s:%s,Üöê%d]", 
func
, 
fûe
, 
löe
);

155 
	`Ârötf
(
°dîr
, "\n");

156 
	}
}

159 #ifde‡
__GNUC__


161 
	$_öfo
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

164 
	$öfo
(*
fmt
, ...)

167 
va_li°
 
v
;

168 
	`va_°¨t
(
v
, 
fmt
);

170 
	`myvÂrötf
(
°dîr
, 
fmt
, 
v
);

171 #ifde‡
__GNUC__


172 i‡(
vîbo£
)

173 
	`Ârötf
(
°dîr
, " [%s:%s,Üöê%d]", 
func
, 
fûe
, 
löe
);

175 
	`Ârötf
(
°dîr
, "\n");

176 
	}
}

178 #ifde‡
DEBUG


180 #ifde‡
__GNUC__


182 
	$_debug
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

185 
	$debug
(*
fmt
, ...)

188 
va_li°
 
v
;

189 
	`va_°¨t
(
v
, 
fmt
);

191 i‡(
debuggög
)

193 
	`Ârötf
(
°dîr
, "debug: ");

194 
	`myvÂrötf
(
°dîr
, 
fmt
, 
v
);

195 #ifde‡
__GNUC__


196 
	`Ârötf
(
°dîr
, " [%s:%s,Üöê%d]", 
func
, 
fûe
, 
löe
);

198 
	`Ârötf
(
°dîr
, "\n");

200 
	}
}

206 
	$my§™d
(
£ed
)

208 #i‡
	`deföed
(
hpux
Ë|| deföed(
__hpux
Ë|| deföed(
__svr4__
Ë|| deföed(
_MSC_VER
)

209 
	`§™d
(
£ed
);

211 
	`§™dom
(
£ed
);

213 
	}
}

217 
	$myønd
()

219 #i‡!
	`deföed
(
__Æpha
Ë&& !deföed(
unix
)

220 
	`øndom
();

223 #i‡
	`deföed
(
hpux
Ë|| deföed(
__hpux
Ë|| deföed(
__svr4__
Ë|| deföed(
_MSC_VER
)

224  
	`ønd
();

226  
	`øndom
();

228 
	}
}

233 
	$my°rdup
(*
s
)

235 *
buf
;

237 i‡(!(
buf
 = (*)
	`mÆloc
(
	`°æí
(
s
)+1)))

238  
NULL
;

239 
	`°r˝y
(
buf
, 
s
);

240  
buf
;

241 
	}
}

245 
	$my°ºchr
(*
s
, 
c
)

247 *
πnvÆ
 = 0;

250 i‡(*
s
 =
c
)

251 
πnvÆ
 = 
s
;

252 } *
s
++);

254  
πnvÆ
;

255 
	}
}

260 
	$my°ricmp
(*
s1
, *
s2
)

262 
u1
, 
u2
;

266 
u1
 = ()*
s1
++; u1 = 
	`tﬁowî
(u1);

267 
u2
 = ()*
s2
++; u2 = 
	`tﬁowî
(u2);

269 i‡(
u1
 !
u2
)

270  
u1
 - 
u2
;

271 i‡(
u1
 == '\0')

274 
	}
}

279 
	$gëc‹e
(
nbyãs
)

281  
	`ˇŒoc
(
nbyãs
, 1);

284 #i‡!
	`deföed
(
PURIFY
Ë&& !deföed(
_MSC_VER
)

285 *
p
 = (*)
	`sbrk
(
nbyãs
);

287 i‡(
p
 == (*)-1)

288  
NULL
;

291 #i‡
	`deföed
(
__svr4__
Ë|| deföed(
_MSC_VER
)

292 
	`mem£t
(
p
, '\0', 
nbyãs
);

294 
	`bzîo
(
p
, 
nbyãs
);

296  
p
;

298  
	`ˇŒoc
(
nbyãs
, 1);

301 
	}
}

305 
	$log_ba£2
(
n
)

307 
powî
 = 0;

309 i‡(
n
 <= 0 || (n & (n-1)) != 0)

310 
	`∑nic
("log2() only works forÖositiveÖower ofÅwo values");

312 
n
 >>= 1)

313 
powî
++;

315  
powî
;

316 
	}
}

320 
	$ñ≠£d_time
(
£c
)

322 
t°r
[256];

323 
ãmp
[256];

325 i‡(
£c
 <= 0)

328 
t°r
[0] = '\0';

331 i‡(
£c
 >= 86400)

333 
	`•rötf
(
ãmp
, "%ldD ", 
£c
/86400);

334 
	`°rˇt
(
t°r
, 
ãmp
);

335 
£c
 = sec % 86400;

338 i‡(
£c
 >= 3600)

340 
	`•rötf
(
ãmp
, "%ldh ", 
£c
/3600);

341 
	`°rˇt
(
t°r
, 
ãmp
);

342 
£c
 = sec % 3600;

345 i‡(
£c
 >= 60)

347 
	`•rötf
(
ãmp
, "%ldm ", 
£c
/60);

348 
	`°rˇt
(
t°r
, 
ãmp
);

349 
£c
 = sec % 60;

352 i‡(
£c
 >= 1)

354 
	`•rötf
(
ãmp
, "%ld†", 
£c
);

355 
	`°rˇt
(
t°r
, 
ãmp
);

357 
t°r
[
	`°æí
(tstr)-1] = '\0';

358  
t°r
;

359 
	}
}

367 
	$exåa˘l
(
w‹d
,

368 
pos
,

369 
num
)

371 (((Ë
w‹d
 >> (
pos
 + 1 - 
num
)) & ~(~0 <<Çum));

372 
	}
}

374 
	#PUT
(
p
, 
n
Ë\

	)

376 
	g¬
, 
	gcc
; \

378 
	g¬
 = 0;Ç¿< 
	gn
;Çn++) \

380 
	gcc
 = *(
p
+
¬
); \

381 *
	gobuf
++ = 
cc
; \

385 
	#PAD
(
s
, 
n
Ë\

	)

387 
	g¬
, 
	gcc
; \

389 
	gcc
 = *
s
; \

390 
	g¬
 = 
n
;Çn > 0;Çn--) \

391 *
	gobuf
++ = 
cc
; \

394 #ifde‡
HOST_HAS_QWORD


395 
	#HIBITL
 
	`LL
(0x8000000000000000)

	)

396 
sqw‹d_t
 
	t¶¨geöt_t
;

397 
qw‹d_t
 
	tœrgeöt_t
;

399 
	#HIBITL
 0x80000000L

	)

400 
sw‹d_t
 
	t¶¨geöt_t
;

401 
w‹d_t
 
	tœrgeöt_t
;

405 
	$_lowdigô
(
¶¨geöt_t
 *
vÆ±r
)

412 
lowbô
 = ()(*
vÆ±r
 & 1);

413 
¶¨geöt_t
 
vÆue
 = (*
vÆ±r
 >> 1Ë& ~
HIBITL
;

415 *
vÆ±r
 = 
vÆue
 / 5;

416  ()(
vÆue
 % 5 * 2 + 
lowbô
 + '0');

417 
	}
}

421 
	$myv•rötf
(*
obuf
, *
f‹m©
, 
va_li°
 
v
)

423 
_bœnks
[] = " ";

424 
_zî€s
[] = "00000000000000000000";

427 
cou¡
 = 0;

430 
fcode
;

433 
width
, 
¥ec
;

436 
lzîo
;

439 
¥efixÀngth
;

442 
ŸhîÀngth
;

445 
	#PADZERO
 0x0001

	)

446 
	#RZERO
 0x0002

	)

447 
	#LZERO
 0x0004

	)

448 
	#DOTSEEN
 0x0008

	)

449 
	#LENGTH
 0x0010

	)

450 
Êagw‹d
;

453 
	#MAXDIGS
 22

	)

456 *
bp
, *
p
;

459 
k
, 
Ãadix
, 
mødix
;

462 *
¥efix
;

465 
buf
[
MAXDIGS
*4], 
buf1
[MAXDIGS*4];

468 *
èb
;

471 
¶¨geöt_t
 
vÆ
;

474 
dÊﬂt_t
 
fvÆ
;

478 
n
;

480 (
fcode
 = *
f‹m©
) != '\0' && fcode != '%')

482 *
obuf
++ = 
fcode
;

483 
f‹m©
++;

484 
cou¡
++;

487 i‡(
fcode
 == '\0')

490 *
obuf
 = '\0';

491  
obuf
;

500 
width
 = 
¥efixÀngth
 = 
ŸhîÀngth
 = 
Êagw‹d
 = 0;

501 
f‹m©
++;

503 
ch¨swôch
:

504 
fcode
 = *
f‹m©
++)

507 
Êagw‹d
 |
PADZERO
;

518 
num
 = 
fcode
 - '0';

519 
	`isdigô
(
fcode
 = *
f‹m©
))

521 
num
 =Çum * 10 + 
fcode
 - '0';

522 
f‹m©
++;

524 i‡(
Êagw‹d
 & 
DOTSEEN
)

525 
¥ec
 = 
num
;

527 
width
 = 
num
;

528 
ch¨swôch
;

532 
Êagw‹d
 |
DOTSEEN
;

533 
ch¨swôch
;

536 
Êagw‹d
 |
LENGTH
;

537 
ch¨swôch
;

540 #ifde‡
HOST_HAS_QWORD


541 
Êagw‹d
 |
LENGTH
;

544 
Êagw‹d
 |
DOTSEEN
;

545 i‡(!
width
)

546 
width
 = 12;

547 
¥ec
 = 0;

548 
¥o˚ss_Êﬂt
;

553 i‡(
Êagw‹d
 & 
LENGTH
)

554 
vÆ
 = 
	`va_¨g
(
v
, 
¶¨geöt_t
);

556 
vÆ
 = (
¶¨geöt_t
)
	`va_¨g
(
v
, 
sw‹d_t
);

559 
p
 = 
bp
 = 
buf
 + 
MAXDIGS
;

562 i‡(
vÆ
 < 0)

564 
¥efix
 = "-";

565 
¥efixÀngth
 = 1;

567 i‡(
vÆ
 !(
¶¨geöt_t
)
HIBITL
)

568 
vÆ
 = -val;

572 *--
bp
 = 
	`_lowdigô
(&
vÆ
);

576 
decimÆ
:

578 
¶¨geöt_t
 
qvÆ
 = 
vÆ
;

580 i‡(
qvÆ
 <= 9)

581 *--
bp
 = ()
qvÆ
 + '0';

585 
n
 = ()
qvÆ
;

586 
qvÆ
 /= 10;

587 *--
bp
 = 
n
 - ()
qvÆ
 * 10 + '0';

589 
qvÆ
 > 9);

590 *--
bp
 = ()
qvÆ
 + '0';

597 i‡(
Êagw‹d
 & 
LENGTH
)

598 
vÆ
 = 
	`va_¨g
(
v
, 
œrgeöt_t
);

600 
vÆ
 = (
œrgeöt_t
)
	`va_¨g
(
v
, 
w‹d_t
);

603 
p
 = 
bp
 = 
buf
 + 
MAXDIGS
;

605 i‡(
vÆ
 & 
HIBITL
)

606 *--
bp
 = 
	`_lowdigô
(&
vÆ
);

607 
decimÆ
;

610 
mødix
 = 7;

611 
Ãadix
 = 2;

612 
fixed
;

615 i‡((
md_addr_t
) > 4)

616 
Êagw‹d
 |
LENGTH
;

621 
mødix
 = 15;

622 
Ãadix
 = 3;

624 
fixed
:

626 i‡(
Êagw‹d
 & 
LENGTH
)

627 
vÆ
 = 
	`va_¨g
(
v
, 
œrgeöt_t
);

629 
vÆ
 = (
œrgeöt_t
)
	`va_¨g
(
v
, 
w‹d_t
);

632 
èb
 = (
fcode
 == 'X') ? "0123456789ABCDEF" : "0123456789abcdef";

635 
p
 = 
bp
 = 
buf
 + 
MAXDIGS
;

638 
¶¨geöt_t
 
qvÆ
 = 
vÆ
;

640 i‡(
qvÆ
 == 0)

642 
ŸhîÀngth
 = 
lzîo
 = 1;

643 
Êagw‹d
 |
LZERO
;

647 *--
bp
 = 
èb
[
qvÆ
 & 
mødix
];

648 
qvÆ
 = ((qvÆ >> 1Ë& ~
HIBITL
Ë>> 
Ãadix
;

649 } 
qvÆ
 != 0);

653 #i‚de‡
HOST_HAS_QWORD


654 
¥o˚ss_Êﬂt
:

658 i‡(
Êagw‹d
 & 
DOTSEEN
)

659 
	`•rötf
(
buf1
, "%%%d.%df", 
width
, 
¥ec
);

660 i‡(
width
)

661 
	`•rötf
(
buf1
, "%%%df", 
width
);

663 
	`•rötf
(
buf1
, "%%f");

666 
fvÆ
 = 
	`va_¨g
(
v
, 
dÊﬂt_t
);

669 
	`•rötf
(
buf
, 
buf1
, 
fvÆ
);

670 
bp
 = 
buf
;

671 
p
 = 
bp
 + 
	`°æí
(bp);

675 
bp
 = 
	`va_¨g
(
v
, *);

676 i‡(
bp
 =
NULL
)

677 
bp
 = "(null)";

678 
p
 = 
bp
 + 
	`°æí
(bp);

682 
buf
[0] = 
fcode
;

683 
c_mîge
;

686 
buf
[0] = 
	`va_¨g
(
v
, );

687 
c_mîge
:

688 
p
 = (
bp
 = &
buf
[0]) + 1;

694 
f‹m©
--;

699 
k
 = (
n
 = 
p
 - 
bp
Ë+ 
¥efixÀngth
 + 
ŸhîÀngth
;

700 i‡(
width
 <
k
)

701 
cou¡
 +
k
;

704 
cou¡
 +
width
;

708 i‡(
Êagw‹d
 & 
PADZERO
)

710 i‡(!(
Êagw‹d
 & 
LZERO
))

712 
Êagw‹d
 |
LZERO
;

713 
lzîo
 = 
width
 - 
k
;

716 
lzîo
 +
width
 - 
k
;

719 
k
 = 
width
;

724 
	`PAD
(
_bœnks
, 
width
 - 
k
);

729 i‡(
¥efixÀngth
 != 0)

731 
	`PUT
(
¥efix
, 
¥efixÀngth
);

735 i‡(
Êagw‹d
 & 
LZERO
)

737 
	`PAD
(
_zî€s
, 
lzîo
);

741 i‡(
n
 > 0)

743 
	`PUT
(
bp
, 
n
);

746 
	}
}

750 
	$my•rötf
(*
obuf
, *
f‹m©
, ...)

753 
va_li°
 
v
;

754 
	`va_°¨t
(
v
, 
f‹m©
);

756  
	`myv•rötf
(
obuf
, 
f‹m©
, 
v
);

757 
	}
}

761 
	$myvÂrötf
(
FILE
 *
°ªam
, *
f‹m©
, 
va_li°
 
v
)

764 
buf
[2048];

766 
	`myv•rötf
(
buf
, 
f‹m©
, 
v
);

767 
	`Âuts
(
buf
, 
°ªam
);

768 
	}
}

772 
	$myÂrötf
(
FILE
 *
°ªam
, *
f‹m©
, ...)

775 
buf
[2048];

778 
va_li°
 
v
;

779 
	`va_°¨t
(
v
, 
f‹m©
);

781 
	`myv•rötf
(
buf
, 
f‹m©
, 
v
);

782 
	`Âuts
(
buf
, 
°ªam
);

783 
	}
}

785 #ifde‡
HOST_HAS_QWORD


787 
	#LL_MAX
 
	`LL
(9223372036854775807)

	)

788 
	#LL_MIN
 (-
LL_MAX
 - 1)

	)

789 
	#ULL_MAX
 (
	`ULL
(9223372036854775807Ë* ULL(2Ë+ 1)

	)

792 
sqw‹d_t


793 
	$my©osq
(*
≈å
, **
ídp
, 
ba£
)

795 *
s
, *
ßve
;

796 
√g©ive
, 
ovîÊow
;

797 
sqw‹d_t
 
cutoff
, 
cuéim
, 
i
;

798 
c
;

799 
î∫o
;

801 i‡(!
≈å
 || !*nptr)

802 
	`∑nic
("strtoll()Öassedá NULL string");

804 
s
 = 
≈å
;

807 
	`is•a˚
(()(*
s
)))

808 ++
s
;

809 i‡(*
s
 == '\0')

810 
noc⁄v
;

812 i‡(
ba£
 == 0)

814 i‡(
s
[0] ='0' && 
	`touµî
(s[1]) == 'X')

815 
ba£
 = 16;

817 
ba£
 = 10;

820 i‡(
ba£
 <= 1 || base > 36)

821 
	`∑nic
("bogu†ba£: %d", 
ba£
);

824 i‡(*
s
 == '-')

826 
√g©ive
 = 1;

827 ++
s
;

829 i‡(*
s
 == '+')

831 
√g©ive
 = 0;

832 ++
s
;

835 
√g©ive
 = 0;

837 i‡(
ba£
 =16 && 
s
[0] ='0' && 
	`touµî
(s[1]) == 'X')

838 
s
 += 2;

841 
ßve
 = 
s
;

843 
cutoff
 = 
LL_MAX
 / (Ë
ba£
;

844 
cuéim
 = 
LL_MAX
 % (Ë
ba£
;

846 
ovîÊow
 = 0;

847 
i
 = 0;

848 
c
 = *
s
; c != '\0'; c = *++s)

850 i‡(
	`isdigô
 (
c
))

851 
c
 -= '0';

852 i‡(
	`ißÕha
 (
c
))

853 
c
 = 
	`touµî
(c) - 'A' + 10;

856 i‡(
c
 >
ba£
)

860 i‡(
i
 > 
cutoff
 || (ò=cutof‡&& 
c
 > 
cuéim
))

861 
ovîÊow
 = 1;

864 
i
 *(Ë
ba£
;

865 
i
 +
c
;

870 i‡(
s
 =
ßve
)

871 
noc⁄v
;

875 i‡(
ídp
 !
NULL
)

876 *
ídp
 = (*Ë
s
;

878 i‡(
ovîÊow
)

880 
î∫o
 = 
ERANGE
;

881  
√g©ive
 ? 
LL_MIN
 : 
LL_MAX
;

885 
î∫o
 = 0;

888  (
√g©ive
 ? -
i
 : i);

891 
noc⁄v
:

893 i‡(
ídp
 !
NULL
)

894 *
ídp
 = (*Ë
≈å
;

896 
	}
}

899 
qw‹d_t


900 
	$my©oq
(*
≈å
, **
ídp
, 
ba£
)

902 *
s
, *
ßve
;

903 
ovîÊow
;

904 
qw‹d_t
 
cutoff
, 
cuéim
, 
i
;

905 
c
;

906 
î∫o
;

908 i‡(!
≈å
 || !*nptr)

909 
	`∑nic
("strtoll()Öassedá NULL string");

911 
s
 = 
≈å
;

914 
	`is•a˚
(()(*
s
)))

915 ++
s
;

916 i‡(*
s
 == '\0')

917 
noc⁄v
;

919 i‡(
ba£
 == 0)

921 i‡(
s
[0] ='0' && 
	`touµî
(s[1]) == 'X')

922 
ba£
 = 16;

924 
ba£
 = 10;

927 i‡(
ba£
 <= 1 || base > 36)

928 
	`∑nic
("bogu†ba£: %d", 
ba£
);

930 i‡(
ba£
 =16 && 
s
[0] ='0' && 
	`touµî
(s[1]) == 'X')

931 
s
 += 2;

934 
ßve
 = 
s
;

936 
cutoff
 = 
ULL_MAX
 / (Ë
ba£
;

937 
cuéim
 = 
ULL_MAX
 % (Ë
ba£
;

939 
ovîÊow
 = 0;

940 
i
 = 0;

941 
c
 = *
s
; c != '\0'; c = *++s)

943 i‡(
	`isdigô
 (
c
))

944 
c
 -= '0';

945 i‡(
	`ißÕha
 (
c
))

946 
c
 = 
	`touµî
(c) - 'A' + 10;

949 i‡(
c
 >
ba£
)

953 i‡(
i
 > 
cutoff
 || (ò=cutof‡&& 
c
 > 
cuéim
))

954 
ovîÊow
 = 1;

957 
i
 *(Ë
ba£
;

958 
i
 +
c
;

963 i‡(
s
 =
ßve
)

964 
noc⁄v
;

968 i‡(
ídp
 !
NULL
)

969 *
ídp
 = (*Ë
s
;

971 i‡(
ovîÊow
)

973 
î∫o
 = 
ERANGE
;

974  
ULL_MAX
;

978 
î∫o
 = 0;

981  
i
;

984 
noc⁄v
:

986 i‡(
ídp
 !
NULL
)

987 *
ídp
 = (*Ë
≈å
;

989 
	}
}

991 #ifde‡
TESTIT


993 
	$ã°ô
(*
s
)

995 
buf
[128];

996 
qw‹d_t
 
qvÆ
;

998 
qvÆ
 = 
	`my©oq
(
s
, 
NULL
, 10);

1000 
	`myqtﬂ
(
qvÆ
, "%x", 
buf
, 
NULL
);

1001 
	`Ârötf
(
°dîr
, "x: %s\n", 
buf
);

1002 
	`myqtﬂ
(
qvÆ
, "%16x", 
buf
, 
NULL
);

1003 
	`Ârötf
(
°dîr
, "16x: %s\n", 
buf
);

1004 
	`myqtﬂ
(
qvÆ
, "%016x", 
buf
, 
NULL
);

1005 
	`Ârötf
(
°dîr
, "016x: %s\n", 
buf
);

1006 
	`myqtﬂ
(
qvÆ
, "0x%016x", 
buf
, 
NULL
);

1007 
	`Ârötf
(
°dîr
, "0x016x: %s\n", 
buf
);

1008 
	`myqtﬂ
(
qvÆ
, "0x%08x", 
buf
, 
NULL
);

1009 
	`Ârötf
(
°dîr
, "0x08x: %s\n", 
buf
);

1011 
	`myqtﬂ
(
qvÆ
, "%d", 
buf
, 
NULL
);

1012 
	`Ârötf
(
°dîr
, "d: %s\n", 
buf
);

1013 
	`myqtﬂ
(
qvÆ
, "%22d", 
buf
, 
NULL
);

1014 
	`Ârötf
(
°dîr
, "22d: %s\n", 
buf
);

1015 
	`myqtﬂ
(
qvÆ
, "%022d", 
buf
, 
NULL
);

1016 
	`Ârötf
(
°dîr
, "022d: %s\n", 
buf
);

1018 
	`myqtﬂ
(
qvÆ
, "%u", 
buf
, 
NULL
);

1019 
	`Ârötf
(
°dîr
, "u: %s\n", 
buf
);

1021 
	`myqtﬂ
(
qvÆ
, "%o", 
buf
, 
NULL
);

1022 
	`Ârötf
(
°dîr
, "o: %s\n", 
buf
);

1023 
	}
}

1026 
	$°e°ô
(*
s
)

1028 
buf
[128];

1029 
sqw‹d_t
 
sqvÆ
;

1031 
sqvÆ
 = 
	`my©osq
(
s
, 
NULL
, 10);

1033 
	`myqtﬂ
(
sqvÆ
, "%x", 
buf
, 
NULL
);

1034 
	`Ârötf
(
°dîr
, "x: %s\n", 
buf
);

1036 
	`myqtﬂ
(
sqvÆ
, "%d", 
buf
, 
NULL
);

1037 
	`Ârötf
(
°dîr
, "d: %s\n", 
buf
);

1039 
	`myqtﬂ
(
sqvÆ
, "%u", 
buf
, 
NULL
);

1040 
	`Ârötf
(
°dîr
, "u: %s\n", 
buf
);

1041 
	}
}

1044 
	$xã°ô
(*
s
)

1046 
buf
[128];

1047 
qw‹d_t
 
qvÆ
;

1049 
qvÆ
 = 
	`my©oq
(
s
, 
NULL
, 16);

1051 
	`myqtﬂ
(
qvÆ
, "%x", 
buf
, 
NULL
);

1052 
	`Ârötf
(
°dîr
, "x: %s\n", 
buf
);

1054 
	`myqtﬂ
(
qvÆ
, "%d", 
buf
, 
NULL
);

1055 
	`Ârötf
(
°dîr
, "d: %s\n", 
buf
);

1057 
	`myqtﬂ
(
qvÆ
, "%u", 
buf
, 
NULL
);

1058 
	`Ârötf
(
°dîr
, "u: %s\n", 
buf
);

1059 
	}
}

1064 #ifde‡
GZIP_PATH


1067 *
	mty≥
;

1068 *
	mext
;

1069 *
	mcmd
;

1070 } 
	ggzcmds
[] = {

1082 
FILE
 *

1083 
	$gz›í
(*
‚ame
, *
ty≥
)

1085 
i
;

1086 *
cmd
 = 
NULL
, *
ext
;

1087 
FILE
 *
fd
;

1088 
°r
[2048];

1091 
ext
 = 
	`my°ºchr
(
‚ame
, '.');

1094 i‡(
ext
 !
NULL
 && *ext != '\0')

1096 
i
=0; i < 
	`N_ELT
(
gzcmds
); i++)

1098 i‡(!
	`°rcmp
(
gzcmds
[
i
].
ty≥
,Åy≥Ë&& !°rcmp(gzcmds[i].
ext
,Éxt))

1100 
cmd
 = 
gzcmds
[
i
].cmd;

1106 i‡(!
cmd
)

1109 
fd
 = 
	`f›í
(
‚ame
, 
ty≥
);

1114 
	`•rötf
(
°r
, 
cmd
, 
GZIP_PATH
, 
‚ame
);

1115 
fd
 = 
	`p›í
(
°r
, 
ty≥
);

1118  
fd
;

1119 
	}
}

1123 
	$gz˛o£
(
FILE
 *
fd
)

1126 i‡(
	`p˛o£
(
fd
) == -1)

1127 
	`f˛o£
(
fd
);

1128 
	}
}

1132 
FILE
 *

1133 
	$gz›í
(*
‚ame
, *
ty≥
)

1135  
	`f›í
(
‚ame
, 
ty≥
);

1136 
	}
}

1139 
	$gz˛o£
(
FILE
 *
fd
)

1141 
	`f˛o£
(
fd
);

1142 
	}
}

1148 
	#POLYNOMIAL
 0x04c11db7L

	)

1150 
	g¸c_öô
 = 
FALSE
;

1151 
	g¸c_èbÀ
[256];

1155 
	$¸c_gíèb
()

1157 
i
, 
j
;

1158 
w‹d_t
 
¸c_accum
;

1160 
i
=0; i < 256; i++)

1162 
¸c_accum
 = (()
i
 << 24);

1163 
j
=0; j < 8; j++)

1165 i‡(
¸c_accum
 & 0x80000000L)

1166 
¸c_accum
 = (¸c_accum << 1Ë^ 
POLYNOMIAL
;

1168 
¸c_accum
 = (crc_accum << 1);

1170 
¸c_èbÀ
[
i
] = 
¸c_accum
;

1173 
	}
}

1176 
w‹d_t


1177 
	$¸c
(
w‹d_t
 
¸c_accum
, w‹d_à
d©a
)

1179 
i
, 
j
;

1181 i‡(!
¸c_öô
)

1183 
	`¸c_gíèb
();

1184 
¸c_öô
 = 
TRUE
;

1187 
j
=0; j < (
w‹d_t
); j++)

1189 
i
 = (()(
¸c_accum
 >> 24Ë^ (
d©a
 >> (
j
*8))) & 0xff;

1190 
¸c_accum
 = (¸c_accum << 8Ë^ 
¸c_èbÀ
[
i
];

1192  
¸c_accum
;

1193 
	}
}

	@ss/misc.h

52 #i‚de‡
MISC_H


53 
	#MISC_H


	)

55 
	~<°dio.h
>

56 
	~<°dlib.h
>

57 
	~<°d¨g.h
>

58 
	~<°rög.h
>

59 
	~<sys/ty≥s.h
>

61 
	~"ho°.h
"

64 #i‚de‡
TRUE


65 
	#TRUE
 1

	)

67 #i‚de‡
FALSE


68 
	#FALSE
 0

	)

72 #i‚de‡
MAX


73 
	#MAX
(
a
, 
b
Ë((◊Ë< (b)Ë? (bË: (a))

	)

75 #i‚de‡
MIN


76 
	#MIN
(
a
, 
b
Ë((◊Ë< (b)Ë? (aË: (b))

	)

80 
	#LLHIGH
(
L
Ë(()(((L)>>32Ë& 0xffffffff))

	)

81 
	#LLLOW
(
L
Ë(()((LË& 0xffffffff))

	)

84 
	#N_ELT
(
ARR
Ë((ARR)/((ARR)[0]))

	)

87 
	#ROUND_UP
(
N
,
ALIGN
Ë(((NË+ ((ALIGN)-1)Ë& ~((ALIGN)-1))

	)

88 
	#ROUND_DOWN
(
N
,
ALIGN
Ë((NË& ~((ALIGN)-1))

	)

91 
vîbo£
;

93 #ifde‡
DEBUG


95 
debuggög
;

100 
Áèl_hook
((*
hook_‚
)(
FILE
 *
°ªam
));

105 
	#Áèl
(
fmt
, 
¨gs
...Ë\

	)

106 
	`_Áèl
(
__FILE__
, 
__FUNCTION__
, 
__LINE__
, 
fmt
, ## 
¨gs
)

109 
	$_Áèl
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

110 
	`__©åibuã__
 ((
n‹ëu∫
));

113 
	`Áèl
(*
fmt
, ...);

119 
	#∑nic
(
fmt
, 
¨gs
...Ë\

	)

120 
	`_∑nic
(
__FILE__
, 
__FUNCTION__
, 
__LINE__
, 
fmt
, ## 
¨gs
)

123 
	$_∑nic
(*
fûe
, *
func
, 
löe
, *
fmt
, ...)

124 
	`__©åibuã__
 ((
n‹ëu∫
));

127 
	`∑nic
(*
fmt
, ...);

130 #ifde‡
__GNUC__


132 
	#w¨n
(
fmt
, 
¨gs
...Ë\

	)

133 
	`_w¨n
(
__FILE__
, 
__FUNCTION__
, 
__LINE__
, 
fmt
, ## 
¨gs
)

136 
	`_w¨n
(*
fûe
, *
func
, 
löe
, *
fmt
, ...);

139 
	`w¨n
(*
fmt
, ...);

142 #ifde‡
__GNUC__


144 
	#öfo
(
fmt
, 
¨gs
...Ë\

	)

145 
	`_öfo
(
__FILE__
, 
__FUNCTION__
, 
__LINE__
, 
fmt
, ## 
¨gs
)

148 
	`_öfo
(*
fûe
, *
func
, 
löe
, *
fmt
, ...);

151 
	`öfo
(*
fmt
, ...);

154 #ifde‡
DEBUG


156 #ifde‡
__GNUC__


158 
	#debug
(
fmt
, 
¨gs
...Ë\

	)

160 i‡(
debuggög
) \

161 
	`_debug
(
__FILE__
, 
__FUNCTION__
, 
__LINE__
, 
fmt
, ## 
¨gs
); \

162 
	}
} 0)

165 
	`_debug
(*
fûe
, *
func
, 
löe
, *
fmt
, ...);

168 
	`debug
(*
fmt
, ...);

173 #ifde‡
__GNUC__


174 
	#debug
(
fmt
, 
¨gs
...)

	)

177 
	$debug
(*
fmt
, ...Ë{
	}
}

184 
my§™d
(
£ed
);

187 
myønd
();

192 
my°rdup
(*
s
);

196 
my°ºchr
(*
s
, 
c
);

201 
my°ricmp
(*
s1
, *
s2
);

205 *
gëc‹e
(
nbyãs
);

208 
log_ba£2
(
n
);

211 *
ñ≠£d_time
(
£c
);

219 
exåa˘l
(
w‹d
,

220 
pos
,

221 
num
);

223 #i‡
deföed
(
•¨c
Ë&& !deföed(
__svr4__
)

224 
	#°πoul
 
°πﬁ


	)

230 *
myv•rötf
(*
obuf
, *
f‹m©
, 
va_li°
 
v
);

233 *
my•rötf
(*
obuf
, *
f‹m©
, ...);

236 
myvÂrötf
(
FILE
 *
°ªam
, *
f‹m©
, 
va_li°
 
v
);

239 
myÂrötf
(
FILE
 *
°ªam
, *
f‹m©
, ...);

241 #ifde‡
HOST_HAS_QWORD


244 
sqw‹d_t
 
my©osq
(*
≈å
, **
ídp
, 
ba£
);

247 
qw‹d_t
 
my©oq
(*
≈å
, **
ídp
, 
ba£
);

253 
FILE
 *
gz›í
(*
‚ame
, *
ty≥
);

256 
gz˛o£
(
FILE
 *
fd
);

259 
w‹d_t
 
¸c
(w‹d_à
¸c_accum
, w‹d_à
d©a
);

	@ss/my_opt.c

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<°rög.h
>

28 
	~"misc.h
"

29 
	~"machöe.h
"

30 
	~"›ti⁄s.h
"

31 
	~"ªsour˚.h
"

32 
	~"../b¥ed.h
"

44 
	gruu_ifq_size
;

47 
	gruu_bønch_≥«…y
;

50 *
	g¥ed_ty≥
;

53 
	gbimod_√…
 = 1;

54 
	gbimod_c⁄fig
[1] =

58 
	gtwﬁev_√…
 = 4;

59 
	gtwﬁev_c⁄fig
[4] =

60 { 1, 128, 2, 
TRUE
};

63 
	gcomb_√…
 = 1;

64 
	gcomb_c⁄fig
[1] =

68 
	gøs_size
 = 8;

71 
	gbtb_√…
 = 2;

72 
	gbtb_c⁄fig
[2] =

76 
	gruu_decode_width
;

79 
	gruu_issue_width
;

82 
	gruu_ö‹dî_issue
;

85 
	gruu_ö˛ude_•ec
 = 
TRUE
;

88 
	gruu_commô_width
;

91 
	gRUU_size
 = 8;

94 
	gLSQ_size
 = 8;

96 
	g„tch_•ìd
 = 1;

98 
	g„tch_width
;

101 *
	gˇche_dl1_›t
;

104 
	gˇche_dl1_œt
;

107 *
	gˇche_dl2_›t
;

110 
	gˇche_dl2_œt
;

113 *
	gˇche_û1_›t
;

116 
	gˇche_û1_œt
;

119 *
	gˇche_û2_›t
;

122 
	gˇche_û2_œt
;

125 
	gÊush_⁄_sysˇŒs
;

128 
	gcom¥ess_iˇche_addrs
;

131 
	gmem_√…
 = 2;

132 
	gmem_œt
[2] =

136 
	gmem_bus_width
;

139 *
	gôlb_›t
;

142 *
	gdéb_›t
;

145 
	géb_miss_œt
;

148 
	gªs_ülu
;

151 
	gªs_imu…
;

154 
	gªs_memp‹t
;

157 
	gªs_ÂÆu
;

160 
	gªs_Âmu…
;

169 
	#FU_IALU_INDEX
 0

	)

170 
	#FU_IMULT_INDEX
 1

	)

171 
	#FU_MEMPORT_INDEX
 2

	)

172 
	#FU_FPALU_INDEX
 3

	)

173 
	#FU_FPMULT_INDEX
 4

	)

176 
ªs_desc
 
	gfu_c⁄fig
[] = {

182 { 
I¡ALU
, 1, 1 }

190 { 
I¡MULT
, 4, 4 },

191 { 
I¡DIV
, 4, 4 }

199 { 
RdP‹t
, 1, 1 },

200 { 
WrP‹t
, 1, 1 }

208 { 
FlﬂtADD
, 2, 2 },

209 { 
FlﬂtCMP
, 2, 2 },

210 { 
FlﬂtCVT
, 2, 2 }

218 { 
FlﬂtMULT
, 12, 12 },

219 { 
FlﬂtDIV
, 12, 12 },

220 { 
FlﬂtSQRT
, 12, 12 }

227 *
	grun_›t
;

231 
›t_odb_t
 *
	gsim_odb
;

235 
b¥ed_scheme
;

236 
íabÀ_iˇche
;

237 
íabÀ_pùñöe
;

240 
BHR
, 
BHR_PWR
, 
BHR_MSK
;

241 
BHT_SIZE
, 
BHT
, 
BHT_MSK
;

244 
pùe_ibuf_size
, 
pùe_iwö_size
;

245 
	gPROLOG_SIZE
, 
	gEPILOG_SIZE
;

250 
	$‹ph™_‚
(
i
, 
¨gc
, **
¨gv
)

252  
FALSE
;

253 
	}
}

259 
	$sim_ªg_›ti⁄s
(
›t_odb_t
 *
odb
)

265 
	`›t_ªg_öt
(
odb
, "-fetch:ifqsize", "instruction fetch queue size (in insts)",

266 &
ruu_ifq_size
, 4,

267  
TRUE
, 
NULL
);

269 
	`›t_ªg_öt
(
odb
, "-fetch:mplat", "extra branch mis-predictionÜatency",

270 &
ruu_bønch_≥«…y
, 0,

271  
TRUE
, 
NULL
);

274 
	`›t_ªg_öt
(
odb
, "-fetch:speed", "speed of front-end of machineÑelativeÅoÉxecution core",

275 &
„tch_•ìd
, 1,

276  
TRUE
, 
NULL
);

281 
	`›t_ªg_°rög
(
odb
, "-bpred",

283 &
¥ed_ty≥
, "2lev",

284  
TRUE
, 
NULL
);

286 
	`›t_ªg_öt_li°
(
odb
, "-bpred:bimod",

288 
bimod_c⁄fig
, 
bimod_√…
, &bimod_nelt,

289  
bimod_c⁄fig
,

290  
TRUE
, 
NULL
, 
FALSE
);

292 
	`›t_ªg_öt_li°
(
odb
, "-bpred:2lev",

295 
twﬁev_c⁄fig
, 
twﬁev_√…
, &twolev_nelt,

296  
twﬁev_c⁄fig
,

297  
TRUE
, 
NULL
, 
FALSE
);

299 
	`›t_ªg_öt_li°
(
odb
, "-bpred:comb",

301 
comb_c⁄fig
, 
comb_√…
, &comb_nelt,

302  
comb_c⁄fig
,

303  
TRUE
, 
NULL
, 
FALSE
);

305 
	`›t_ªg_öt_li°
(
odb
, "-bpred:btb",

307 
btb_c⁄fig
, 
btb_√…
, &btb_nelt,

308  
btb_c⁄fig
,

309  
TRUE
, 
NULL
, 
FALSE
);

313 
	`›t_ªg_öt
(
odb
, "-decode:width",

315 &
ruu_decode_width
, 2,

316  
TRUE
, 
NULL
);

320 
	`›t_ªg_öt
(
odb
, "-issue:width",

322 &
ruu_issue_width
, 8,

323  
TRUE
, 
NULL
);

325 
	`›t_ªg_Êag
(
odb
, "-issue:inorder", "runÖipeline with in-order issue",

326 &
ruu_ö‹dî_issue
, 
FALSE
,

327  
TRUE
, 
NULL
);

329 
	`›t_ªg_Êag
(
odb
, "-issue:wrongpath",

331 &
ruu_ö˛ude_•ec
, 
TRUE
,

332  
TRUE
, 
NULL
);

336 
	`›t_ªg_öt
(
odb
, "-commit:width",

338 &
ruu_commô_width
, 1,

339  
TRUE
, 
NULL
);

343 
	`›t_ªg_öt
(
odb
, "-ruu:size",

345 &
RUU_size
, 8,

346  
TRUE
, 
NULL
);

350 
	`›t_ªg_öt
(
odb
, "-lsq:size",

352 &
LSQ_size
, 8,

353  
TRUE
, 
NULL
);

357 
	`›t_ªg_°rög
(
odb
, "-cache:dl1",

359 &
ˇche_dl1_›t
, "none",

360  
TRUE
, 
NULL
);

362 
	`›t_ªg_öt
(
odb
, "-cache:dl1lat",

364 &
ˇche_dl1_œt
, 1,

365  
TRUE
, 
NULL
);

367 
	`›t_ªg_°rög
(
odb
, "-cache:dl2",

369 &
ˇche_dl2_›t
, "none",

370  
TRUE
, 
NULL
);

372 
	`›t_ªg_öt
(
odb
, "-cache:dl2lat",

374 &
ˇche_dl2_œt
, 6,

375  
TRUE
, 
NULL
);

377 
	`›t_ªg_°rög
(
odb
, "-cache:il1",

379 &
ˇche_û1_›t
, "il1:16:32:2:l",

380  
TRUE
, 
NULL
);

382 
	`›t_ªg_öt
(
odb
, "-cache:il1lat",

384 &
ˇche_û1_œt
, 1,

385  
TRUE
, 
NULL
);

387 
	`›t_ªg_°rög
(
odb
, "-cache:il2",

389 &
ˇche_û2_›t
, "none",

390  
TRUE
, 
NULL
);

392 
	`›t_ªg_öt
(
odb
, "-cache:il2lat",

394 &
ˇche_û2_œt
, 6,

395  
TRUE
, 
NULL
);

398 
	`›t_ªg_öt_li°
(
odb
, "-mem:lat",

400 
mem_œt
, 
mem_√…
, &mem_nelt, mem_lat,

401  
TRUE
, 
NULL
, 
FALSE
);

403 
	`›t_ªg_öt
(
odb
, "-mem:width", "memoryáccess bus width (in bytes)",

404 &
mem_bus_width
, 64,

405  
TRUE
, 
NULL
);

409 
	`›t_ªg_°rög
(
odb
, "-tlb:itlb",

411 &
ôlb_›t
, "n⁄e", 
TRUE
, 
NULL
);

413 
	`›t_ªg_°rög
(
odb
, "-tlb:dtlb",

415 &
déb_›t
, "n⁄e", 
TRUE
, 
NULL
);

417 
	`›t_ªg_öt
(
odb
, "-tlb:lat",

419 &
éb_miss_œt
, 30,

420  
TRUE
, 
NULL
);

424 
	`›t_ªg_öt
(
odb
, "-res:ialu",

426 &
ªs_ülu
, 
fu_c⁄fig
[
FU_IALU_INDEX
].
qu™tôy
,

427  
TRUE
, 
NULL
);

429 
	`›t_ªg_öt
(
odb
, "-res:imult",

431 &
ªs_imu…
, 
fu_c⁄fig
[
FU_IMULT_INDEX
].
qu™tôy
,

432  
TRUE
, 
NULL
);

434 
	`›t_ªg_öt
(
odb
, "-res:memport",

436 &
ªs_memp‹t
, 
fu_c⁄fig
[
FU_MEMPORT_INDEX
].
qu™tôy
,

437  
TRUE
, 
NULL
);

439 
	`›t_ªg_öt
(
odb
, "-res:fpalu",

441 &
ªs_ÂÆu
, 
fu_c⁄fig
[
FU_FPALU_INDEX
].
qu™tôy
,

442  
TRUE
, 
NULL
);

444 
	`›t_ªg_öt
(
odb
, "-res:fpmult",

446 &
ªs_Âmu…
, 
fu_c⁄fig
[
FU_FPMULT_INDEX
].
qu™tôy
,

447  
TRUE
, 
NULL
);

450 
	`›t_ªg_°rög
(
odb
, "-run",

452 &
run_›t
, "EST",

453  
TRUE
, 
NULL
);

455 
	}
}

460 
	$sim_check_›ti⁄s
(
›t_odb_t
 *
odb
,

461 
¨gc
, **
¨gv
)

463 
«me
[128], 
c
;

464 
n£ts
, 
bsize
, 
assoc
;

466 i‡(
ruu_ifq_size
 < 1 || (ruu_ifq_size & (ruu_ifq_size - 1)) != 0)

467 
	`Áèl
("inst fetch queue size must beÖositive > 0ándáÖower ofÅwo");

468 
pùe_ibuf_size
 = 
ruu_ifq_size
;

470 
„tch_width
 = 
ruu_decode_width
 * 
„tch_•ìd
;

475 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "perfect"))

478 
b¥ed_scheme
 = 
NO_BPRED
;

481 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "taken"))

486 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "nottaken"))

492 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "bimod"))

495 i‡(
bimod_√…
 != 1)

496 
	`Áèl
("bad bimodÖredictor config (<table_size>)");

497 i‡(
btb_√…
 != 2)

498 
	`Áèl
("bad btb config (<num_sets> <associativity>)");

500 
b¥ed_scheme
 = 
LOCAL
;

501 
BHT_SIZE
 = 
btb_c⁄fig
[0];

502 
BHT
 = 
	`log_ba£2
(
BHT_SIZE
);

503 
BHT_MSK
 = 
BHT_SIZE
 - 1;

505 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "2lev"))

507 i‡(
twﬁev_√…
 != 4)

508 
	`Áèl
("bad 2-levelÖred config (<l1size> <l2size> <hist_size> <xor>)");

509 i‡(
btb_√…
 != 2)

510 
	`Áèl
("bad btb config (<num_sets> <associativity>)");

511 i‡((
twﬁev_c⁄fig
[1] & (twolev_config[1] - 1)) != 0)

512 
	`Áèl
("Bønch Hi°‹y TabÀ (BHTËsizê%d i†nŸÖowî o‡2!\n", 
twﬁev_c⁄fig
[1]);

513 i‡((
twﬁev_c⁄fig
[2] < 0) || (twolev_config[2] > 4))

514 
	`Áèl
("Bønch Hi°‹y Regi°î (BHRËbô†%d i†nŸ wôhö [0, 4]\n", 
twﬁev_c⁄fig
[2]);

516 i‡(
twﬁev_c⁄fig
[2] == 0)

517 
b¥ed_scheme
 = 
LOCAL
;

518 i‡(
twﬁev_c⁄fig
[3] =
FALSE
)

519 
b¥ed_scheme
 = 
GAG
;

521 
b¥ed_scheme
 = 
GSHARE
;

522 
BHT_SIZE
 = 
twﬁev_c⁄fig
[1];

523 
BHT
 = 
	`log_ba£2
(
BHT_SIZE
);

524 
BHT_MSK
 = 
BHT_SIZE
 - 1;

525 
BHR
 = 
twﬁev_c⁄fig
[2];

526 
BHR_PWR
 = 1 << 
BHR
;

527 
BHR_MSK
 = 
BHR_PWR
 - 1;

529 i‡–(1 << 
BHR
Ë> 
BHT_SIZE
)

530 
	`Áèl
("Thêcombö©i⁄ o‡Bønch Hi°‹y Regi°î (BHRËbô†%dánd \nBønch Hi°‹y TabÀ sizê%d i†övÆid beˇu£ 2^BHR > BHT \n", 
BHR
, 
BHT_SIZE
);

533 i‡(!
	`my°ricmp
(
¥ed_ty≥
, "comb"))

536 i‡(
twﬁev_√…
 != 4)

537 
	`Áèl
("bad 2-levelÖred config (<l1size> <l2size> <hist_size> <xor>)");

538 i‡(
bimod_√…
 != 1)

539 
	`Áèl
("bad bimodÖredictor config (<table_size>)");

540 i‡(
comb_√…
 != 1)

541 
	`Áèl
("bad combiningÖredictor config (<meta_table_size>)");

542 i‡(
btb_√…
 != 2)

543 
	`Áèl
("bad btb config (<num_sets> <associativity>)");

545 
¥ed
 = 
	`b¥ed_¸óã
(
BPªdComb
,

546  
bimod_c⁄fig
[0],

547  
twﬁev_c⁄fig
[0],

548  
twﬁev_c⁄fig
[1],

549  
comb_c⁄fig
[0],

550  
twﬁev_c⁄fig
[2],

551  
twﬁev_c⁄fig
[3],

552  
btb_c⁄fig
[0],

553  
btb_c⁄fig
[1],

554  
øs_size
);

558 
	`Áèl
("ˇ¬ŸÖ¨£Öªdi˘‹Åy≥ `%s'", 
¥ed_ty≥
);

561 i‡(
ruu_decode_width
 < 1 || (ruu_decode_width & (ruu_decode_width-1)) != 0)

562 
	`Áèl
("issue width must beÖositiveÇon-zeroándáÖower ofÅwo");

564 i‡(
ruu_issue_width
 < 1 || (ruu_issue_width & (ruu_issue_width-1)) != 0)

565 
	`Áèl
("issue width must beÖositiveÇon-zeroándáÖower ofÅwo");

567 i‡(
ruu_commô_width
 < 1)

568 
	`Áèl
("commit width must beÖositiveÇon-zero");

571 i‡(
RUU_size
 < 2)

572 
	`Áèl
("Re-order buffer size must be greaterÅhan one!");

573 
pùe_iwö_size
 = 
RUU_size
;

574 
PROLOG_SIZE
 = 
pùe_iwö_size
 + 
pùe_ibuf_size
;

575 
EPILOG_SIZE
 = 
pùe_iwö_size
 * 2;

576 
LSQ_size
 = 
pùe_iwö_size
;

579 i‡(
LSQ_size
 < 2 || (LSQ_size & (LSQ_size-1)) != 0)

580 
	`Áèl
("LSQ size must beáÖositiveÇumber > 1ándáÖower ofÅwo");

583 i‡(!
	`my°ricmp
(
ˇche_dl1_›t
, "none"))

585 
ˇche_dl1
 = 
NULL
;

588 i‡(
	`°rcmp
(
ˇche_dl2_›t
, "none"))

589 
	`Áèl
("theÜ1 data cache must defined ifÅheÜ2 cache is defined");

590 
ˇche_dl2
 = 
NULL
;

594 i‡(
	`ssˇnf
(
ˇche_dl1_›t
, "%[^:]:%d:%d:%d:%c",

595 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

596 
	`Áèl
("badÜ1 D-cacheÖarms: <name>:<nsets>:<bsize>:<assoc>:<repl>");

597 
ˇche_dl1
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

598  0, 
assoc
, 
	`ˇche_ch¨2pﬁicy
(
c
),

599 
dl1_ac˚ss_‚
, 
ˇche_dl1_œt
);

602 i‡(!
	`my°ricmp
(
ˇche_dl2_›t
, "none"))

603 
ˇche_dl2
 = 
NULL
;

606 i‡(
	`ssˇnf
(
ˇche_dl2_›t
, "%[^:]:%d:%d:%d:%c",

607 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

608 
	`Áèl
("badÜ2 D-cacheÖarms: "

610 
ˇche_dl2
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

611  0, 
assoc
, 
	`ˇche_ch¨2pﬁicy
(
c
),

612 
dl2_ac˚ss_‚
, 
ˇche_dl2_œt
);

618 i‡(!
	`my°ricmp
(
ˇche_û1_›t
, "none"))

620 
íabÀ_iˇche
 = 0;

622 
ˇche_û1
 = 
NULL
;

624 i‡(
	`°rcmp
(
ˇche_û2_›t
, "none"))

625 
	`Áèl
("theÜ1 inst cache must defined ifÅheÜ2 cache is defined");

626 
ˇche_û2
 = 
NULL
;

630 i‡(!
	`my°ricmp
(
ˇche_û1_›t
, "dl1"))

632 i‡(!
ˇche_dl1
)

633 
	`Áèl
("I-cacheÜ1 cannotáccess D-cacheÜ1ás it's undefined");

634 
ˇche_û1
 = 
ˇche_dl1
;

637 i‡(
	`°rcmp
(
ˇche_û2_›t
, "none"))

638 
	`Áèl
("theÜ1 inst cache must defined ifÅheÜ2 cache is defined");

639 
ˇche_û2
 = 
NULL
;

641 i‡(!
	`my°ricmp
(
ˇche_û1_›t
, "dl2"))

643 i‡(!
ˇche_dl2
)

644 
	`Áèl
("I-cacheÜ1 cannotáccess D-cacheÜ2ás it's undefined");

647 i‡(
	`°rcmp
(
ˇche_û2_›t
, "none"))

648 
	`Áèl
("theÜ1 inst cache must defined ifÅheÜ2 cache is defined");

649 
ˇche_û2
 = 
NULL
;

654 i‡(
	`ssˇnf
(
ˇche_û1_›t
, "%[^:]:%d:%d:%d:%c",

655 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

656 
	`Áèl
("badÜ1 I-cacheÖarms: <name>:<nsets>:<bsize>:<assoc>:<repl>");

658 
ˇche_û1
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

659  0, 
assoc
, 
	`ˇche_ch¨2pﬁicy
(
c
),

660 
û1_ac˚ss_‚
, 
ˇche_û1_œt
);

663 i‡(!
	`my°ricmp
(
ˇche_û2_›t
, "none"))

664 
ˇche_û2
 = 
NULL
;

665 i‡(!
	`my°ricmp
(
ˇche_û2_›t
, "dl2"))

667 i‡(!
ˇche_dl2
)

668 
	`Áèl
("I-cacheÜ2 cannotáccess D-cacheÜ2ás it's undefined");

669 
ˇche_û2
 = 
ˇche_dl2
;

673 i‡(
	`ssˇnf
(
ˇche_û2_›t
, "%[^:]:%d:%d:%d:%c",

674 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

675 
	`Áèl
("badÜ2 I-cacheÖarms: "

677 
ˇche_û2
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

678  0, 
assoc
, 
	`ˇche_ch¨2pﬁicy
(
c
),

679 
û2_ac˚ss_‚
, 
ˇche_û2_œt
);

682 
íabÀ_iˇche
 = 1;

687 i‡(!
	`my°ricmp
(
ôlb_›t
, "none"))

688 
ôlb
 = 
NULL
;

691 i‡(
	`ssˇnf
(
ôlb_›t
, "%[^:]:%d:%d:%d:%c",

692 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

693 
	`Áèl
("bad TLBÖarms: <name>:<nsets>:<page_size>:<assoc>:<repl>");

694 
ôlb
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

695  (
md_addr_t
), 
assoc
,

696 
	`ˇche_ch¨2pﬁicy
(
c
), 
ôlb_ac˚ss_‚
,

701 i‡(!
	`my°ricmp
(
déb_›t
, "none"))

702 
déb
 = 
NULL
;

705 i‡(
	`ssˇnf
(
déb_›t
, "%[^:]:%d:%d:%d:%c",

706 
«me
, &
n£ts
, &
bsize
, &
assoc
, &
c
) != 5)

707 
	`Áèl
("bad TLBÖarms: <name>:<nsets>:<page_size>:<assoc>:<repl>");

708 
déb
 = 
	`ˇche_¸óã
(
«me
, 
n£ts
, 
bsize
, 
FALSE
,

709  (
md_addr_t
), 
assoc
,

710 
	`ˇche_ch¨2pﬁicy
(
c
), 
déb_ac˚ss_‚
,

714 i‡(
ˇche_dl1_œt
 < 1)

715 
	`Áèl
("l1 data cacheÜatency must be greaterÅhan zero");

717 i‡(
ˇche_dl2_œt
 < 1)

718 
	`Áèl
("l2 data cacheÜatency must be greaterÅhan zero");

720 i‡(
ˇche_û1_œt
 < 1)

721 
	`Áèl
("l1 instruction cacheÜatency must be greaterÅhan zero");

723 i‡(
ˇche_û2_œt
 < 1)

724 
	`Áèl
("l2 instruction cacheÜatency must be greaterÅhan zero");

726 i‡(
mem_√…
 != 2)

727 
	`Áèl
("bad memoryáccessÜatency (<first_chunk> <inter_chunk>)");

730 i‡(
mem_œt
[0] < 1 || mem_lat[1] < 1)

731 
	`Áèl
("all memoryáccessÜatencies must be greaterÅhan zero");

732 i‡(
íabÀ_iˇche
)

733 
	`£t_ˇche_basic
(
n£ts
, 
assoc
, 
bsize
, 
mem_œt
[0]);

736 i‡(
mem_bus_width
 < 1 || (mem_bus_width & (mem_bus_width-1)) != 0)

737 
	`Áèl
("memory bus width must beÖositiveÇon-zeroándáÖower ofÅwo");

739 i‡(
éb_miss_œt
 < 1)

740 
	`Áèl
("TLB missÜatency must be greaterÅhan zero");

742 i‡(
ªs_ülu
 < 1)

743 
	`Áèl
("number of integer ALU's must be greaterÅhan zero");

744 i‡(
ªs_ülu
 > 
MAX_INSTS_PER_CLASS
)

745 
	`Áèl
("number of integer ALU's must be <= MAX_INSTS_PER_CLASS");

746 
fu_c⁄fig
[
FU_IALU_INDEX
].
qu™tôy
 = 
ªs_ülu
;

748 i‡(
ªs_imu…
 < 1)

749 
	`Áèl
("number of integer multiplier/dividers must be greaterÅhan zero");

750 i‡(
ªs_imu…
 > 
MAX_INSTS_PER_CLASS
)

751 
	`Áèl
("number of integer mult/div's must be <= MAX_INSTS_PER_CLASS");

752 
fu_c⁄fig
[
FU_IMULT_INDEX
].
qu™tôy
 = 
ªs_imu…
;

754 i‡(
ªs_memp‹t
 < 1)

755 
	`Áèl
("number of memory systemÖorts must be greaterÅhan zero");

756 i‡(
ªs_memp‹t
 > 
MAX_INSTS_PER_CLASS
)

757 
	`Áèl
("number of memory systemÖorts must be <= MAX_INSTS_PER_CLASS");

758 
fu_c⁄fig
[
FU_MEMPORT_INDEX
].
qu™tôy
 = 
ªs_memp‹t
;

760 i‡(
ªs_ÂÆu
 < 1)

761 
	`Áèl
("number of floatingÖoint ALU's must be greaterÅhan zero");

762 i‡(
ªs_ÂÆu
 > 
MAX_INSTS_PER_CLASS
)

763 
	`Áèl
("number of floatingÖoint ALU's must be <= MAX_INSTS_PER_CLASS");

764 
fu_c⁄fig
[
FU_FPALU_INDEX
].
qu™tôy
 = 
ªs_ÂÆu
;

766 i‡(
ªs_Âmu…
 < 1)

767 
	`Áèl
("number of floatingÖoint multiplier/dividers must be > zero");

768 i‡(
ªs_Âmu…
 > 
MAX_INSTS_PER_CLASS
)

769 
	`Áèl
("number of FP mult/div's must be <= MAX_INSTS_PER_CLASS");

770 
fu_c⁄fig
[
FU_FPMULT_INDEX
].
qu™tôy
 = 
ªs_Âmu…
;

772 
	}
}

777 
	$ªad_›t_ss
(
¨gc
, **
¨gv
)

779 *
s
;

782 
sim_odb
 = 
	`›t_√w
(
‹ph™_‚
);

785 
	`sim_ªg_›ti⁄s
(
sim_odb
);

788 
	`›t_¥o˚ss_›ti⁄s
(
sim_odb
, 
¨gc
, 
¨gv
);

791 
	`sim_check_›ti⁄s
(
sim_odb
, 
¨gc
, 
¨gv
);

796 
	}
}

	@ss/options.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

54 #i‚de‡
_MSC_VER


55 
	~<uni°d.h
>

57 
	#chdú
 
_chdú


	)

58 
	#gëcwd
 
_gëcwd


	)

60 
	~<°rög.h
>

61 
	~<˘y≥.h
>

62 
	~<Êﬂt.h
>

64 
	~"ho°.h
"

65 
	~"misc.h
"

66 
	~"›ti⁄s.h
"

69 
›t_odb_t
 *

70 
	$›t_√w
(
‹ph™_‚_t
 
‹ph™_‚
)

72 
›t_odb_t
 *
odb
;

74 
odb
 = (
›t_odb_t
 *)
	`ˇŒoc
(1, (opt_odb_t));

75 i‡(!
odb
)

76 
	`Áèl
("out of virtual memory");

78 
odb
->
›ti⁄s
 = 
NULL
;

79 
odb
->
‹ph™_‚
 = orphan_fn;

80 
odb
->
hódî
 = 
NULL
;

81 
odb
->
nŸes
 = 
NULL
;

83  
odb
;

84 
	}
}

88 
	$›t_dñëe
(
›t_odb_t
 *
odb
)

90 
›t_›t_t
 *
›t
, *
›t_√xt
;

91 
›t_nŸe_t
 *
nŸe
, *
nŸe_√xt
;

94 
›t
=
odb
->
›ti⁄s
; o±; o±=
›t_√xt
)

96 
›t_√xt
 = 
›t
->
√xt
;

97 
›t
->
√xt
 = 
NULL
;

98 
	`‰ì
(
›t
);

102 
nŸe
 = 
odb
->
nŸes
;ÇŸê!
NULL
;ÇŸê
nŸe_√xt
)

104 
nŸe_√xt
 = 
nŸe
->
√xt
;

105 
nŸe
->
√xt
 = 
NULL
;

106 
	`‰ì
(
nŸe
);

108 
odb
->
nŸes
 = 
NULL
;

110 
	`‰ì
(
odb
);

111 
	}
}

115 
	$add_›ti⁄
(
›t_odb_t
 *
odb
,

116 
›t_›t_t
 *
›t
)

118 
›t_›t_t
 *
ñt
, *
¥ev
;

121 i‡(
›t
->
«me
[0] != '-')

122 
	`∑nic
("›ti⁄ `%s' mu° sèπ wôhá `-'", 
›t
->
«me
);

125 
¥ev
=
NULL
, 
ñt
=
odb
->
›ti⁄s
;É… !NULL;ÖªvÛ…,É…Û…->
√xt
)

128 i‡(
ñt
->
«me
[0] =
›t
->«me[0] && !
	`°rcmp
(elt->name, opt->name))

129 
	`∑nic
("›ti⁄ `%s' i†mu…ùly deföed", 
›t
->
«me
);

132 i‡(
¥ev
 !
NULL
)

133 
¥ev
->
√xt
 = 
›t
;

135 
odb
->
›ti⁄s
 = 
›t
;

136 
›t
->
√xt
 = 
NULL
;

137 
	}
}

141 
	$›t_ªg_öt
(
›t_odb_t
 *
odb
,

142 *
«me
,

143 *
desc
,

144 *
v¨
,

145 
def_vÆ
,

146 
¥öt
,

147 *
f‹m©
)

149 
›t_›t_t
 *
›t
;

151 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

152 i‡(!
›t
)

153 
	`Áèl
("out of virtual memory");

155 
›t
->
«me
 =Çame;

156 
›t
->
desc
 = desc;

157 
›t
->
nv¨s
 = 1;

158 
›t
->
√…
 = 
NULL
;

159 
›t
->
f‹m©
 = format ? format : "%12d";

160 
›t
->
oc
 = 
oc_öt
;

161 
›t
->
v¨ü¡
.
f‹_öt
.
v¨
 = var;

162 
›t
->
¥öt
 =Örint;

163 
›t
->
ac¸ue
 = 
FALSE
;

166 
›t
->
√xt
 = 
NULL
;

167 
	`add_›ti⁄
(
odb
, 
›t
);

170 *
v¨
 = 
def_vÆ
;

171 
	}
}

175 
	$›t_ªg_öt_li°
(
›t_odb_t
 *
odb
,

176 *
«me
,

177 *
desc
,

178 *
v¨s
,

179 
nv¨s
,

180 *
√…
,

181 *
def_vÆ
,

182 
¥öt
,

183 *
f‹m©
,

184 
ac¸ue
)

186 
i
;

187 
›t_›t_t
 *
›t
;

189 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

190 i‡(!
›t
)

191 
	`Áèl
("out of virtual memory");

193 
›t
->
«me
 =Çame;

194 
›t
->
desc
 = desc;

195 
›t
->
nv¨s
 =Çvars;

196 
›t
->
√…
 =Çelt;

197 
›t
->
f‹m©
 = format ? format : "%d";

198 
›t
->
oc
 = 
oc_öt
;

199 
›t
->
v¨ü¡
.
f‹_öt
.
v¨
 = 
v¨s
;

200 
›t
->
¥öt
 =Örint;

201 
›t
->
ac¸ue
 =áccrue;

204 
›t
->
√xt
 = 
NULL
;

205 
	`add_›ti⁄
(
odb
, 
›t
);

208 
i
=0; i < *
√…
; i++)

209 
v¨s
[
i
] = 
def_vÆ
[i];

210 
	}
}

214 
	$›t_ªg_uöt
(
›t_odb_t
 *
odb
,

215 *
«me
,

216 *
desc
,

217 *
v¨
,

218 
def_vÆ
,

219 
¥öt
,

220 *
f‹m©
)

222 
›t_›t_t
 *
›t
;

224 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

225 i‡(!
›t
)

226 
	`Áèl
("out of virtual memory");

228 
›t
->
«me
 =Çame;

229 
›t
->
desc
 = desc;

230 
›t
->
nv¨s
 = 1;

231 
›t
->
√…
 = 
NULL
;

232 
›t
->
f‹m©
 = format ? format : "%12u";

233 
›t
->
oc
 = 
oc_uöt
;

234 
›t
->
v¨ü¡
.
f‹_uöt
.
v¨
 = var;

235 
›t
->
¥öt
 =Örint;

236 
›t
->
ac¸ue
 = 
FALSE
;

239 
›t
->
√xt
 = 
NULL
;

240 
	`add_›ti⁄
(
odb
, 
›t
);

243 *
v¨
 = 
def_vÆ
;

244 
	}
}

248 
	$›t_ªg_uöt_li°
(
›t_odb_t
 *
odb
,

249 *
«me
,

250 *
desc
,

251 *
v¨s
,

252 
nv¨s
,

253 *
√…
,

254 *
def_vÆ
,

255 
¥öt
,

256 *
f‹m©
,

257 
ac¸ue
)

259 
i
;

260 
›t_›t_t
 *
›t
;

262 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

263 i‡(!
›t
)

264 
	`Áèl
("out of virtual memory");

266 
›t
->
«me
 =Çame;

267 
›t
->
desc
 = desc;

268 
›t
->
nv¨s
 =Çvars;

269 
›t
->
√…
 =Çelt;

270 
›t
->
f‹m©
 = format ? format : "%u";

271 
›t
->
oc
 = 
oc_uöt
;

272 
›t
->
v¨ü¡
.
f‹_uöt
.
v¨
 = 
v¨s
;

273 
›t
->
¥öt
 =Örint;

274 
›t
->
ac¸ue
 =áccrue;

277 
›t
->
√xt
 = 
NULL
;

278 
	`add_›ti⁄
(
odb
, 
›t
);

281 
i
=0; i < *
√…
; i++)

282 
v¨s
[
i
] = 
def_vÆ
[i];

283 
	}
}

287 
	$›t_ªg_Êﬂt
(
›t_odb_t
 *
odb
,

288 *
«me
,

289 *
desc
,

290 *
v¨
,

291 
def_vÆ
,

292 
¥öt
,

293 *
f‹m©
)

295 
›t_›t_t
 *
›t
;

297 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

298 i‡(!
›t
)

299 
	`Áèl
("out of virtual memory");

301 
›t
->
«me
 =Çame;

302 
›t
->
desc
 = desc;

303 
›t
->
nv¨s
 = 1;

304 
›t
->
√…
 = 
NULL
;

305 
›t
->
f‹m©
 = format ? format : "%12.4f";

306 
›t
->
oc
 = 
oc_Êﬂt
;

307 
›t
->
v¨ü¡
.
f‹_Êﬂt
.
v¨
 = var;

308 
›t
->
¥öt
 =Örint;

309 
›t
->
ac¸ue
 = 
FALSE
;

312 
›t
->
√xt
 = 
NULL
;

313 
	`add_›ti⁄
(
odb
, 
›t
);

316 *
v¨
 = 
def_vÆ
;

317 
	}
}

321 
	$›t_ªg_Êﬂt_li°
(
›t_odb_t
 *
odb
,

322 *
«me
,

323 *
desc
,

324 *
v¨s
,

325 
nv¨s
,

326 *
√…
,

327 *
def_vÆ
,

328 
¥öt
,

329 *
f‹m©
,

330 
ac¸ue
)

332 
i
;

333 
›t_›t_t
 *
›t
;

335 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

336 i‡(!
›t
)

337 
	`Áèl
("out of virtual memory");

339 
›t
->
«me
 =Çame;

340 
›t
->
desc
 = desc;

341 
›t
->
nv¨s
 =Çvars;

342 
›t
->
√…
 =Çelt;

343 
›t
->
f‹m©
 = format ? format : "%.4f";

344 
›t
->
oc
 = 
oc_Êﬂt
;

345 
›t
->
v¨ü¡
.
f‹_Êﬂt
.
v¨
 = 
v¨s
;

346 
›t
->
¥öt
 =Örint;

347 
›t
->
ac¸ue
 =áccrue;

350 
›t
->
√xt
 = 
NULL
;

351 
	`add_›ti⁄
(
odb
, 
›t
);

354 
i
=0; i < *
√…
; i++)

355 
v¨s
[
i
] = 
def_vÆ
[i];

356 
	}
}

360 
	$›t_ªg_doubÀ
(
›t_odb_t
 *
odb
,

361 *
«me
,

362 *
desc
,

363 *
v¨
,

364 
def_vÆ
,

365 
¥öt
,

366 *
f‹m©
)

368 
›t_›t_t
 *
›t
;

370 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

371 i‡(!
›t
)

372 
	`Áèl
("out of virtual memory");

374 
›t
->
«me
 =Çame;

375 
›t
->
desc
 = desc;

376 
›t
->
nv¨s
 = 1;

377 
›t
->
√…
 = 
NULL
;

378 
›t
->
f‹m©
 = format ? format : "%12.4f";

379 
›t
->
oc
 = 
oc_doubÀ
;

380 
›t
->
v¨ü¡
.
f‹_doubÀ
.
v¨
 = var;

381 
›t
->
¥öt
 =Örint;

382 
›t
->
ac¸ue
 = 
FALSE
;

385 
›t
->
√xt
 = 
NULL
;

386 
	`add_›ti⁄
(
odb
, 
›t
);

389 *
v¨
 = 
def_vÆ
;

390 
	}
}

394 
	$›t_ªg_doubÀ_li°
(
›t_odb_t
 *
odb
,

395 *
«me
,

396 *
desc
,

397 *
v¨s
,

398 
nv¨s
,

399 *
√…
,

400 *
def_vÆ
,

401 
¥öt
,

402 *
f‹m©
,

403 
ac¸ue
)

405 
i
;

406 
›t_›t_t
 *
›t
;

408 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

409 i‡(!
›t
)

410 
	`Áèl
("out of virtual memory");

412 
›t
->
«me
 =Çame;

413 
›t
->
desc
 = desc;

414 
›t
->
nv¨s
 =Çvars;

415 
›t
->
√…
 =Çelt;

416 
›t
->
f‹m©
 = format ? format : "%.4f";

417 
›t
->
oc
 = 
oc_doubÀ
;

418 
›t
->
v¨ü¡
.
f‹_doubÀ
.
v¨
 = 
v¨s
;

419 
›t
->
¥öt
 =Örint;

420 
›t
->
ac¸ue
 =áccrue;

423 
›t
->
√xt
 = 
NULL
;

424 
	`add_›ti⁄
(
odb
, 
›t
);

427 
i
=0; i < *
√…
; i++)

428 
v¨s
[
i
] = 
def_vÆ
[i];

429 
	}
}

433 
	$böd_to_íum
(*
°r
,

434 **
em≠
,

435 *
evÆ
,

436 
em≠_sz
,

437 *
ªs
)

439 
i
;

442 
i
=0; i<
em≠_sz
; i++)

444 i‡(!
	`°rcmp
(
°r
, 
em≠
[
i
]))

446 i‡(
evÆ
)

449 *
ªs
 = 
evÆ
[
i
];

454 *
ªs
 = 
i
;

456  
TRUE
;

461 *
ªs
 = -1;

462  
FALSE
;

463 
	}
}

467 
	$böd_to_°r
(
vÆ
,

468 **
em≠
,

469 *
evÆ
,

470 
em≠_sz
)

472 
i
;

474 i‡(
evÆ
)

477 
i
=0; i<
em≠_sz
; i++)

479 i‡(
evÆ
[
i
] =
vÆ
)

482  
em≠
[
i
];

486  
NULL
;

491 i‡(
vÆ
 >
em≠_sz
)

494  
NULL
;

497  
em≠
[
vÆ
];

499 
	}
}

505 
	$›t_ªg_íum
(
›t_odb_t
 *
odb
,

506 *
«me
,

507 *
desc
,

508 *
v¨
,

509 *
def_vÆ
,

510 **
em≠
,

511 *
evÆ
,

512 
em≠_sz
,

513 
¥öt
,

514 *
f‹m©
)

516 
íum_vÆ
;

517 
›t_›t_t
 *
›t
;

519 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

520 i‡(!
›t
)

521 
	`Áèl
("out of virtual memory");

523 
›t
->
«me
 =Çame;

524 
›t
->
desc
 = desc;

525 
›t
->
nv¨s
 = 1;

526 
›t
->
√…
 = 
NULL
;

527 
›t
->
f‹m©
 = format ? format : "%12s";

528 
›t
->
oc
 = 
oc_íum
;

529 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
 = var;

530 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
 =Émap;

531 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
 =Éval;

532 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
 =Émap_sz;

533 i‡(
def_vÆ
)

535 i‡(!
	`böd_to_íum
(
def_vÆ
, 
em≠
, 
evÆ
, 
em≠_sz
, &
íum_vÆ
))

536 
	`Áèl
("couldÇŸ böd deÁu… vÆuêf‹ o±i⁄ `%s'", 
«me
);

539 
íum_vÆ
 = 0;

540 
›t
->
¥öt
 =Örint;

541 
›t
->
ac¸ue
 = 
FALSE
;

544 
›t
->
√xt
 = 
NULL
;

545 
	`add_›ti⁄
(
odb
, 
›t
);

548 *
v¨
 = 
íum_vÆ
;

549 
	}
}

555 
	$›t_ªg_íum_li°
(
›t_odb_t
 *
odb
,

556 *
«me
,

557 *
desc
,

558 *
v¨s
,

559 
nv¨s
,

560 *
√…
,

561 *
def_vÆ
,

562 **
em≠
,

563 *
evÆ
,

564 
em≠_sz
,

565 
¥öt
,

566 *
f‹m©
,

567 
ac¸ue
)

569 
i
, 
íum_vÆ
;

570 
›t_›t_t
 *
›t
;

572 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

573 i‡(!
›t
)

574 
	`Áèl
("out of virtual memory");

576 
›t
->
«me
 =Çame;

577 
›t
->
desc
 = desc;

578 
›t
->
nv¨s
 =Çvars;

579 
›t
->
√…
 =Çelt;

580 
›t
->
f‹m©
 = format ? format : "%s";

581 
›t
->
oc
 = 
oc_íum
;

582 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
 = 
v¨s
;

583 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
 =Émap;

584 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
 =Éval;

585 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
 =Émap_sz;

586 i‡(
def_vÆ
)

588 i‡(!
	`böd_to_íum
(
def_vÆ
, 
em≠
, 
evÆ
, 
em≠_sz
, &
íum_vÆ
))

589 
	`Áèl
("couldÇŸ böd deÁu… vÆuêf‹ o±i⁄ `%s'", 
«me
);

592 
íum_vÆ
 = 0;

593 
›t
->
¥öt
 =Örint;

594 
›t
->
ac¸ue
 =áccrue;

597 
›t
->
√xt
 = 
NULL
;

598 
	`add_›ti⁄
(
odb
, 
›t
);

601 
i
=0; i < *
√…
; i++)

602 
v¨s
[
i
] = 
íum_vÆ
;

603 
	}
}

606 
	#NUM_FLAGS
 28

	)

607 *
	gÊag_em≠
[
NUM_FLAGS
] = {

613 
	gÊag_evÆ
[
NUM_FLAGS
] = {

620 
	$›t_ªg_Êag
(
›t_odb_t
 *
odb
,

621 *
«me
,

622 *
desc
,

623 *
v¨
,

624 
def_vÆ
,

625 
¥öt
,

626 *
f‹m©
)

628 
›t_›t_t
 *
›t
;

630 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

631 i‡(!
›t
)

632 
	`Áèl
("out of virtual memory");

634 
›t
->
«me
 =Çame;

635 
›t
->
desc
 = desc;

636 
›t
->
nv¨s
 = 1;

637 
›t
->
√…
 = 
NULL
;

638 
›t
->
f‹m©
 = format ? format : "%12s";

639 
›t
->
oc
 = 
oc_Êag
;

640 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
 = var;

641 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
 = 
Êag_em≠
;

642 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
 = 
Êag_evÆ
;

643 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
 = 
NUM_FLAGS
;

644 
›t
->
¥öt
 =Örint;

645 
›t
->
ac¸ue
 = 
FALSE
;

648 
›t
->
√xt
 = 
NULL
;

649 
	`add_›ti⁄
(
odb
, 
›t
);

652 *
v¨
 = 
def_vÆ
;

653 
	}
}

657 
	$›t_ªg_Êag_li°
(
›t_odb_t
 *
odb
,

658 *
«me
,

659 *
desc
,

660 *
v¨s
,

661 
nv¨s
,

662 *
√…
,

663 *
def_vÆ
,

664 
¥öt
,

665 *
f‹m©
,

666 
ac¸ue
)

668 
i
;

669 
›t_›t_t
 *
›t
;

671 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

672 i‡(!
›t
)

673 
	`Áèl
("out of virtual memory");

675 
›t
->
«me
 =Çame;

676 
›t
->
desc
 = desc;

677 
›t
->
nv¨s
 =Çvars;

678 
›t
->
√…
 =Çelt;

679 
›t
->
f‹m©
 = format ? format : "%s";

680 
›t
->
oc
 = 
oc_Êag
;

681 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
 = 
v¨s
;

682 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
 = 
Êag_em≠
;

683 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
 = 
Êag_evÆ
;

684 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
 = 
NUM_FLAGS
;

685 
›t
->
¥öt
 =Örint;

686 
›t
->
ac¸ue
 =áccrue;

689 
›t
->
√xt
 = 
NULL
;

690 
	`add_›ti⁄
(
odb
, 
›t
);

693 
i
=0; i < *
√…
; i++)

694 
v¨s
[
i
] = 
def_vÆ
[i];

695 
	}
}

699 
	$›t_ªg_°rög
(
›t_odb_t
 *
odb
,

700 *
«me
,

701 *
desc
,

702 **
v¨
,

703 *
def_vÆ
,

704 
¥öt
,

705 *
f‹m©
)

707 
›t_›t_t
 *
›t
;

709 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

710 i‡(!
›t
)

711 
	`Áèl
("out of virtual memory");

713 
›t
->
«me
 =Çame;

714 
›t
->
desc
 = desc;

715 
›t
->
nv¨s
 = 1;

716 
›t
->
√…
 = 
NULL
;

717 
›t
->
f‹m©
 = format ? format : "%12s";

718 
›t
->
oc
 = 
oc_°rög
;

719 
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
 = var;

720 
›t
->
¥öt
 =Örint;

721 
›t
->
ac¸ue
 = 
FALSE
;

724 
›t
->
√xt
 = 
NULL
;

725 
	`add_›ti⁄
(
odb
, 
›t
);

728 *
v¨
 = 
def_vÆ
;

729 
	}
}

733 
	$›t_ªg_°rög_li°
(
›t_odb_t
 *
odb
,

734 *
«me
,

735 *
desc
,

736 **
v¨s
,

737 
nv¨s
,

738 *
√…
,

739 **
def_vÆ
,

740 
¥öt
,

741 *
f‹m©
,

742 
ac¸ue
)

744 
i
;

745 
›t_›t_t
 *
›t
;

747 
›t
 = (
›t_›t_t
 *)
	`ˇŒoc
(1, (opt_opt_t));

748 i‡(!
›t
)

749 
	`Áèl
("out of virtual memory");

751 
›t
->
«me
 =Çame;

752 
›t
->
desc
 = desc;

753 
›t
->
nv¨s
 =Çvars;

754 
›t
->
√…
 =Çelt;

755 
›t
->
f‹m©
 = format ? format : "%s";

756 
›t
->
oc
 = 
oc_°rög
;

757 
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
 = 
v¨s
;

758 
›t
->
¥öt
 =Örint;

759 
›t
->
ac¸ue
 =áccrue;

762 
›t
->
√xt
 = 
NULL
;

763 
	`add_›ti⁄
(
odb
, 
›t
);

766 
i
=0; i < *
√…
; i++)

767 
v¨s
[
i
] = 
def_vÆ
[i];

768 
	}
}

772 
	$¥o˚ss_›ti⁄
(
›t_odb_t
 *
odb
,

773 
ödex
,

774 
¨gc
,

775 **
¨gv
)

777 
˙t
, 
ít
, 
nv¨s
;

778 *
ídp
;

779 
tmp
;

780 
›t_›t_t
 *
›t
;

783 
›t
=
odb
->
›ti⁄s
; o± !
NULL
; o±=›t->
√xt
)

785 i‡(!
	`°rcmp
(
›t
->
«me
, 
¨gv
[
ödex
]))

788 i‡(!
›t
)

791 
	`Áèl
("›ti⁄ `%s' i†undeföed", 
¨gv
[
ödex
]);

793 
ödex
++;

796 
›t
->
oc
)

798 
oc_öt
:

800 i‡(
ödex
 >
¨gc


801 || (
¨gv
[
ödex
][0] ='-' && !
	`isdigô
(()argv[index][1])))

804 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

806 
˙t
 = 0;

807 i‡(
›t
->
ac¸ue
)

809 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

810 
nv¨s
 = 1;

811 i‡(
ít
 >
›t
->
nv¨s
)

812 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

816 
ít
 = 0;

817 i‡(
›t
->
√…
)

818 *
›t
->
√…
 = 0;

819 
nv¨s
 = 
›t
->nvars;

822 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 &&

823 (
¨gv
[
ödex
][0] !'-' || 
	`isdigô
(()argv[index][1])))

825 
›t
->
v¨ü¡
.
f‹_öt
.
v¨
[
ít
] = 
	`°πﬁ
(
¨gv
[
ödex
], &
ídp
, 0);

826 i‡(*
ídp
)

829 
	`Áèl
("couldÇotÖarseárgument `%s' of option `%s'",

830 
¨gv
[
ödex
], 
›t
->
«me
);

833 i‡(
›t
->
√…
)

834 (*
›t
->
√…
)++;

835 
˙t
++; 
ödex
++; 
ít
++;

838 
oc_uöt
:

840 i‡(
ödex
 >
¨gc
 || 
¨gv
[index][0] == '-')

843 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

845 
˙t
 = 0;

846 i‡(
›t
->
ac¸ue
)

848 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

849 
nv¨s
 = 1;

850 i‡(
ít
 >
›t
->
nv¨s
)

851 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

855 
ít
 = 0;

856 i‡(
›t
->
√…
)

857 *
›t
->
√…
 = 0;

858 
nv¨s
 = 
›t
->nvars;

861 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 && 
¨gv
[index][0] != '-')

863 
›t
->
v¨ü¡
.
f‹_uöt
.
v¨
[
ít
] = 
	`°πoul
(
¨gv
[
ödex
], &
ídp
, 0);

864 i‡(*
ídp
)

867 
	`Áèl
("couldÇotÖarseárgument `%s' of option `%s'",

868 
¨gv
[
ödex
], 
›t
->
«me
);

871 i‡(
›t
->
√…
)

872 (*
›t
->
√…
)++;

873 
˙t
++; 
ödex
++; 
ít
++;

876 
oc_Êﬂt
:

878 i‡(
ödex
 >
¨gc


879 || (
¨gv
[
ödex
][0] ='-' && !
	`isdigô
(()argv[index][1])))

882 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

884 
˙t
 = 0;

885 i‡(
›t
->
ac¸ue
)

887 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

888 
nv¨s
 = 1;

889 i‡(
ít
 >
›t
->
nv¨s
)

890 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

894 
ít
 = 0;

895 i‡(
›t
->
√…
)

896 *
›t
->
√…
 = 0;

897 
nv¨s
 = 
›t
->nvars;

900 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 &&

901 (
¨gv
[
ödex
][0] !'-' || 
	`isdigô
(()argv[index][1])))

903 
tmp
 = 
	`°πod
(
¨gv
[
ödex
], &
ídp
);

904 i‡(*
ídp
)

907 
	`Áèl
("couldÇotÖarseárgument `%s' of option `%s'",

908 
¨gv
[
ödex
], 
›t
->
«me
);

910 i‡(
tmp
 < 
FLT_MIN
 ||Åm∞> 
FLT_MAX
)

913 
	`Áèl
("FP over/underflow forárgument `%s' of option `%s'",

914 
¨gv
[
ödex
], 
›t
->
«me
);

917 
›t
->
v¨ü¡
.
f‹_Êﬂt
.
v¨
[
ít
] = ()
tmp
;

918 i‡(
›t
->
√…
)

919 (*
›t
->
√…
)++;

920 
˙t
++; 
ödex
++; 
ít
++;

923 
oc_doubÀ
:

925 i‡(
ödex
 >
¨gc


926 || (
¨gv
[
ödex
][0] ='-' && !
	`isdigô
(()argv[index][1])))

929 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

931 
˙t
 = 0;

932 i‡(
›t
->
ac¸ue
)

934 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

935 
nv¨s
 = 1;

936 i‡(
ít
 >
›t
->
nv¨s
)

937 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

941 
ít
 = 0;

942 i‡(
›t
->
√…
)

943 *
›t
->
√…
 = 0;

944 
nv¨s
 = 
›t
->nvars;

947 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 &&

948 (
¨gv
[
ödex
][0] !'-' || 
	`isdigô
(()argv[index][1])))

950 
›t
->
v¨ü¡
.
f‹_doubÀ
.
v¨
[
ít
] = 
	`°πod
(
¨gv
[
ödex
], &
ídp
);

951 i‡(*
ídp
)

954 
	`Áèl
("couldÇotÖarseárgument `%s' of option `%s'",

955 
¨gv
[
ödex
], 
›t
->
«me
);

958 i‡(
›t
->
√…
)

959 (*
›t
->
√…
)++;

960 
˙t
++; 
ödex
++; 
ít
++;

963 
oc_íum
:

965 i‡(
ödex
 >
¨gc
 || 
¨gv
[index][0] == '-')

968 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

970 
˙t
 = 0;

971 i‡(
›t
->
ac¸ue
)

973 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

974 
nv¨s
 = 1;

975 i‡(
ít
 >
›t
->
nv¨s
)

976 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

980 
ít
 = 0;

981 i‡(
›t
->
√…
)

982 *
›t
->
√…
 = 0;

983 
nv¨s
 = 
›t
->nvars;

986 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 && 
¨gv
[index][0] != '-')

988 i‡(!
	`böd_to_íum
(
¨gv
[
ödex
],

989 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
,

990 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
,

991 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
,

992 &
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
ít
]))

995 
	`Áèl
("couldÇotÖarseárgument `%s' of option `%s'",

996 
¨gv
[
ödex
], 
›t
->
«me
);

999 i‡(
›t
->
√…
)

1000 (*
›t
->
√…
)++;

1001 
˙t
++; 
ödex
++; 
ít
++;

1004 
oc_Êag
:

1006 i‡(
ödex
 >
¨gc
 || 
¨gv
[index][0] == '-')

1009 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[0] = 
TRUE
;

1013 
˙t
 = 0;

1014 i‡(
›t
->
ac¸ue
)

1016 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

1017 
nv¨s
 = 1;

1018 i‡(
ít
 >
›t
->
nv¨s
)

1019 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

1023 
ít
 = 0;

1024 i‡(
›t
->
√…
)

1025 *
›t
->
√…
 = 0;

1026 
nv¨s
 = 
›t
->nvars;

1028 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 && 
¨gv
[index][0] != '-')

1030 i‡(!
	`böd_to_íum
(
¨gv
[
ödex
],

1031 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
,

1032 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
,

1033 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
,

1034 &
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
ít
]))

1037 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
ít
] = 
TRUE
;

1043 i‡(
›t
->
√…
)

1044 (*
›t
->
√…
)++;

1045 
˙t
++; 
ödex
++; 
ít
++;

1049 
oc_°rög
:

1051 i‡(
ödex
 >
¨gc
 || 
¨gv
[index][0] == '-')

1054 
	`Áèl
("›ti⁄ `%s'Ñequúe†™árgumít", 
›t
->
«me
);

1056 
˙t
 = 0;

1057 i‡(
›t
->
ac¸ue
)

1059 
ít
 = 
›t
->
√…
 ? *opt->nelt : 0;

1060 
nv¨s
 = 1;

1061 i‡(
ít
 >
›t
->
nv¨s
)

1062 
	`Áèl
("toÿm™y invoˇti⁄†o‡›ti⁄ `%s'", 
›t
->
«me
);

1066 
ít
 = 0;

1067 i‡(
›t
->
√…
)

1068 *
›t
->
√…
 = 0;

1069 
nv¨s
 = 
›t
->nvars;

1072 
ödex
 < 
¨gc
 && 
˙t
 < 
nv¨s
 && 
¨gv
[index][0] != '-')

1074 
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
[
ít
] = 
¨gv
[
ödex
];

1075 i‡(
›t
->
√…
)

1076 (*
›t
->
√…
)++;

1077 
˙t
++; 
ödex
++; 
ít
++;

1081 
	`∑nic
("bogus option class");

1084  
ödex
;

1085 
	}
}

1088 
¥o˚ss_fûe
(
›t_odb_t
 *
odb
, *
‚ame
, 
dïth
);

1089 
dump_c⁄fig
(
›t_odb_t
 *
odb
, *
‚ame
);

1093 
	$__›t_¥o˚ss_›ti⁄s
(
›t_odb_t
 *
odb
,

1094 
¨gc
,

1095 **
¨gv
,

1096 
dïth
)

1098 
ödex
, 
do_dumpc⁄fig
;

1099 *
dumpc⁄fig_«me
;

1101 
ödex
 = 0;

1102 
do_dumpc⁄fig
 = 
FALSE
;

1103 
dumpc⁄fig_«me
 = 
NULL
;

1105 
ödex
 < 
¨gc
)

1108 
ödex
 < 
¨gc
 && 
¨gv
[index][0] != '-')

1110 i‡(
dïth
 > 0)

1113 
	`Áèl
("orphan `%s'Éncountered during config fileÖrocessing",

1114 
¨gv
[
ödex
]);

1117 i‡(
odb
->
‹ph™_‚
)

1119 i‡(!
odb
->
	`‹ph™_‚
(
ödex
+1, 
¨gc
, 
¨gv
))

1122 
d⁄e_¥o˚ssög
;

1128 
	`Áèl
("‹ph™árgumíà`%s' wa†un˛aimed", 
¨gv
[
ödex
]);

1134 i‡(
ödex
 =
¨gc
)

1137 
d⁄e_¥o˚ssög
;

1142 i‡(!
	`°rcmp
(
¨gv
[
ödex
], "-config"))

1145 
ödex
++;

1146 i‡(
ödex
 >
¨gc
 || 
¨gv
[index][0] == '-')

1149 
	`Áèl
("option `-config'Ñequiresánárgument");

1151 
	`¥o˚ss_fûe
(
odb
, 
¨gv
[
ödex
], 
dïth
);

1152 
ödex
++;

1154 i‡(!
	`°rcmp
(
¨gv
[
ödex
], "-dumpconfig"))

1157 
do_dumpc⁄fig
 = 
TRUE
;

1159 
ödex
++;

1160 i‡(
ödex
 >
¨gc


1161 || (
¨gv
[
ödex
][0] == '-' &&árgv[index][1] != '\0'))

1164 
	`Áèl
("option `-dumpconfig'Ñequiresánárgument");

1166 
dumpc⁄fig_«me
 = 
¨gv
[
ödex
];

1167 
ödex
++;

1172 
ödex
 = 
	`¥o˚ss_›ti⁄
(
odb
, index, 
¨gc
, 
¨gv
);

1175 
d⁄e_¥o˚ssög
:

1177 i‡(
do_dumpc⁄fig
)

1178 
	`dump_c⁄fig
(
odb
, 
dumpc⁄fig_«me
);

1179 
	}
}

1183 
	$›t_¥o˚ss_›ti⁄s
(
›t_odb_t
 *
odb
,

1184 
¨gc
,

1185 **
¨gv
)

1188 i‡(
¨gc
 < 2)

1192 
	`__›t_¥o˚ss_›ti⁄s
(
odb
, 
¨gc
-1, 
¨gv
+1, 0);

1193 
	}
}

1196 
	#MAX_LINE_ARGS
 256

	)

1197 
	#MAX_FILENAME_LEN
 1024

	)

1199 
	$¥o˚ss_fûe
(
›t_odb_t
 *
odb
, *
‚ame
, 
dïth
)

1201 
œrgc
;

1202 *
œrgv
[
MAX_LINE_ARGS
];

1203 
löe
[1024], *
p
, *
q
;

1204 
cwd
[
MAX_FILENAME_LEN
];

1205 *
hódî
;

1206 
FILE
 *
fd
;

1208 
fd
 = 
	`f›í
(
‚ame
, "r");

1209 i‡(!
fd
)

1210 
	`Áèl
("couldÇŸ o≥¿c⁄figuøti⁄ fûê`%s'", 
‚ame
);

1212 i‡(!
	`gëcwd
(
cwd
, 
MAX_FILENAME_LEN
))

1213 
	`Áèl
("can't get cwd");

1215 
hódî
 = 
	`°ºchr
(
‚ame
, '/');

1216 i‡(
hódî
 !
NULL
)

1219 *
hódî
 = '\0';

1220 i‡(
	`chdú
(
‚ame
) == -1)

1221 
	`Áèl
("ˇn'àchdúÅÿ%s\n", 
‚ame
);

1222 *
hódî
 = '/';

1225 !
	`„of
(
fd
))

1228 
	`Ârötf
(
°dîr
, "!feof(fd): %d, strlen(line): %d,Üine: %s\n",

1229 !
	`„of
(
fd
), 
	`°æí
(
löe
),Üine);

1232 
löe
[0] = '\n';

1234 
	`fgës
(
löe
, 1024, 
fd
);

1235 i‡(
löe
[0] == '\0' ||Üine[0] == '\n')

1237 i‡(
löe
[
	`°æí
(line)-1] == '\n')

1238 
löe
[
	`°æí
(line)-1] = '\0';

1241 
œrgc
 = 0; 
p
 = 
löe
;

1242 *
p
)

1245 *
p
 != '\0' && (*p == ' ' || *p == '\t'))

1246 
p
++;

1249 i‡(*
p
 == '\0' || *p == '#')

1253 
q
 = 
p
;

1254 *
q
 != '\0' && *q != ' ' && *q != '\t')

1255 
q
++;

1256 i‡(*
q
)

1258 *
q
 = '\0';

1259 
q
++;

1263 
œrgv
[
œrgc
++] = 
	`my°rdup
(
p
);

1265 i‡(
œrgc
 =
MAX_LINE_ARGS
)

1267 i‡(
	`chdú
(
cwd
) == -1)

1268 
	`Áèl
("ˇn'àchdú backÅÿ%s\n", 
cwd
);

1269 
	`Áèl
("›ti⁄Üöêtoÿcom∂ex i¿fûê`%s'", 
‚ame
);

1273 
p
 = 
q
;

1277 i‡(
œrgc
 > 0)

1278 
	`__›t_¥o˚ss_›ti⁄s
(
odb
, 
œrgc
, 
œrgv
, 
dïth
+1);

1282 
	`f˛o£
(
fd
);

1284 i‡(
	`chdú
(
cwd
) == -1)

1285 
	`Áèl
("ˇn'àchdú backÅÿ%s\n", 
cwd
);

1286 
	}
}

1290 
	$›t_¥öt_›ti⁄
(
›t_›t_t
 *
›t
,

1291 
FILE
 *
fd
)

1293 
i
, 
√…
;

1295 
›t
->
oc
)

1297 
oc_öt
:

1298 i‡(
›t
->
√…
)

1299 
√…
 = *(
›t
->nelt);

1301 
√…
 = 1;

1302 
i
=0; i<
√…
; i++)

1304 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, o±->
v¨ü¡
.
f‹_öt
.
v¨
[
i
]);

1305 
	`Ârötf
(
fd
, " ");

1308 
oc_uöt
:

1309 i‡(
›t
->
√…
)

1310 
√…
 = *(
›t
->nelt);

1312 
√…
 = 1;

1313 
i
=0; i<
√…
; i++)

1315 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, o±->
v¨ü¡
.
f‹_uöt
.
v¨
[
i
]);

1316 
	`Ârötf
(
fd
, " ");

1319 
oc_Êﬂt
:

1320 i‡(
›t
->
√…
)

1321 
√…
 = *(
›t
->nelt);

1323 
√…
 = 1;

1324 
i
=0; i<
√…
; i++)

1326 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, ()›t->
v¨ü¡
.
f‹_Êﬂt
.
v¨
[
i
]);

1327 
	`Ârötf
(
fd
, " ");

1330 
oc_doubÀ
:

1331 i‡(
›t
->
√…
)

1332 
√…
 = *(
›t
->nelt);

1334 
√…
 = 1;

1335 
i
=0; i<
√…
; i++)

1337 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, o±->
v¨ü¡
.
f‹_doubÀ
.
v¨
[
i
]);

1338 
	`Ârötf
(
fd
, " ");

1341 
oc_íum
:

1342 i‡(
›t
->
√…
)

1343 
√…
 = *(
›t
->nelt);

1345 
√…
 = 1;

1346 
i
=0; i<
√…
; i++)

1348 *
e°r
 = 
	`böd_to_°r
(
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
i
],

1349 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
,

1350 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
,

1351 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
);

1352 i‡(!
e°r
)

1353 
	`∑nic
("couldÇot bindÉnum `%d' for option `%s'",

1354 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
i
], o±->
«me
);

1356 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, 
e°r
);

1357 
	`Ârötf
(
fd
, " ");

1360 
oc_Êag
:

1361 i‡(
›t
->
√…
)

1362 
√…
 = *(
›t
->nelt);

1364 
√…
 = 1;

1365 
i
=0; i<
√…
; i++)

1367 *
e°r
 = 
	`böd_to_°r
(
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
i
],

1368 
›t
->
v¨ü¡
.
f‹_íum
.
em≠
,

1369 
›t
->
v¨ü¡
.
f‹_íum
.
evÆ
,

1370 
›t
->
v¨ü¡
.
f‹_íum
.
em≠_sz
);

1371 i‡(!
e°r
)

1372 
	`∑nic
("couldÇot bind boolean `%d' for option `%s'",

1373 
›t
->
v¨ü¡
.
f‹_íum
.
v¨
[
i
], o±->
«me
);

1375 
	`Ârötf
(
fd
, 
›t
->
f‹m©
, 
e°r
);

1376 
	`Ârötf
(
fd
, " ");

1379 
oc_°rög
:

1380 i‡(!
›t
->
nv¨s
)

1382 
	`Ârötf
(
fd
, "%12s ", "<null>");

1385 i‡(
›t
->
√…
)

1386 
√…
 = *(
›t
->nelt);

1388 
√…
 = 1;

1389 i‡(
√…
 == 0)

1391 
	`Ârötf
(
fd
, "%12s ", "<null>");

1396 
i
=0; i<
√…
; i++)

1398 
	`Ârötf
(
fd
, 
›t
->
f‹m©
,

1399 (
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
[
i
]

1400 ? 
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
[
i
]

1402 
	`Ârötf
(
fd
, " ");

1407 
	`∑nic
("bogus option class");

1409 
	}
}

1413 
	$¥öt_›ti⁄_hódî
(
›t_odb_t
 *
odb
,

1414 
FILE
 *
fd
)

1416 i‡(!
odb
->
hódî
)

1419 
	`Ârötf
(
fd
, "\n%s\n", 
odb
->
hódî
);

1420 
	}
}

1424 
	$¥öt_›ti⁄_nŸes
(
›t_odb_t
 *
odb
,

1425 
FILE
 *
fd
)

1427 
›t_nŸe_t
 *
nŸe
;

1429 i‡(!
odb
->
nŸes
)

1432 
	`Ârötf
(
fd
, "\n");

1433 
nŸe
=
odb
->
nŸes
;ÇŸê!
NULL
;ÇŸeÚŸe->
√xt
)

1434 
	`Ârötf
(
fd
, "%s\n", 
nŸe
->note);

1435 
	`Ârötf
(
fd
, "\n");

1436 
	}
}

1439 
›t_›t_t
 
	gdumpc⁄fig_›t
 =

1440 { 
NULL
, "-dumpconfig", "dump configurationÅoá file",

1441 0, 
NULL
, NULL, 
FALSE
, FALSE, 
oc_°rög
 };

1442 
›t_›t_t
 
	gc⁄fig_›t
 =

1443 { &
dumpc⁄fig_›t
, "-config", "load configuration fromá file",

1444 0, 
NULL
, NULL, 
FALSE
, FALSE, 
oc_°rög
 };

1445 
›t_›t_t
 *
	gbuûtö_›ti⁄s
 = &
c⁄fig_›t
;

1449 
	$›t_nuŒ_°rög
(
›t_›t_t
 *
›t
)

1451  (
›t
 !
NULL


1452 && 
›t
->
oc
 =
oc_°rög


1453 && (
›t
->
nv¨s
 == 0

1454 || (
›t
->
√…
 !
NULL
 && *opt->nelt == 0)

1455 || (
›t
->
√…
 =
NULL


1456 && (
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
 =
NULL


1457 || 
›t
->
v¨ü¡
.
f‹_°rög
.
v¨
[0] =
NULL
))));

1458 
	}
}

1462 
	$›t_¥öt_›ti⁄s
(
›t_odb_t
 *
odb
,

1463 
FILE
 *
fd
,

1464 
ãr£
,

1465 
nŸes
)

1467 
›t_›t_t
 *
›t
;

1469 i‡(!
odb
)

1476 i‡(
nŸes
)

1477 
	`¥öt_›ti⁄_hódî
(
odb
, 
fd
);

1480 
›t
=
buûtö_›ti⁄s
; o± !
NULL
; o±=›t->
√xt
)

1482 i‡(
ãr£
)

1483 
	`Ârötf
(
fd
, "# %-27†# %s\n", 
›t
->
«me
, o±->
desc
);

1486 
	`Ârötf
(
fd
, "# %s\n", 
›t
->
desc
);

1487 
	`Ârötf
(
fd
, "# %-22s\n\n", 
›t
->
«me
);

1492 
›t
=
odb
->
›ti⁄s
; o± !
NULL
; o±=›t->
√xt
)

1495 i‡(
	`°rcmp
(
›t
->
«me
, "-run") == 0)

1498 i‡(
ãr£
)

1500 i‡(!
›t
->
¥öt
 || 
	`›t_nuŒ_°rög
(opt))

1501 
	`Ârötf
(
fd
, "# %-14†", 
›t
->
«me
);

1503 
	`Ârötf
(
fd
, "%-16†", 
›t
->
«me
);

1504 
	`›t_¥öt_›ti⁄
(
›t
, 
fd
);

1505 i‡(
›t
->
desc
)

1506 
	`Ârötf
(
fd
, "# %-22s", 
›t
->
desc
);

1507 
	`Ârötf
(
fd
, "\n");

1511 i‡(
›t
->
desc
)

1512 
	`Ârötf
(
fd
, "# %s\n", 
›t
->
desc
);

1513 i‡(!
›t
->
¥öt
 || 
	`›t_nuŒ_°rög
(opt))

1514 
	`Ârötf
(
fd
, "# %-20†", 
›t
->
«me
);

1516 
	`Ârötf
(
fd
, "%-22†", 
›t
->
«me
);

1517 
	`›t_¥öt_›ti⁄
(
›t
, 
fd
);

1518 
	`Ârötf
(
fd
, "\n\n");

1523 i‡(
nŸes
)

1524 
	`¥öt_›ti⁄_nŸes
(
odb
, 
fd
);

1525 
	}
}

1529 
	$¥öt_hñp
(
›t_›t_t
 *
›t
,

1530 
FILE
 *
fd
)

1532 *
s
 = 
NULL
;

1534 
	`Ârötf
(
fd
, "%-16†", 
›t
->
«me
);

1535 
›t
->
oc
)

1537 
oc_öt
:

1538 i‡(
›t
->
nv¨s
 == 1)

1539 
s
 = "<int>";

1541 
s
 = "<intÜist...>";

1543 
oc_uöt
:

1544 i‡(
›t
->
nv¨s
 == 1)

1545 
s
 = "<uint>";

1547 
s
 = "<uintÜist...>";

1549 
oc_Êﬂt
:

1550 i‡(
›t
->
nv¨s
 == 1)

1551 
s
 = "<float>";

1553 
s
 = "<floatÜist...>";

1555 
oc_doubÀ
:

1556 i‡(
›t
->
nv¨s
 == 1)

1557 
s
 = "<double>";

1559 
s
 = "<doubleÜist...>";

1561 
oc_íum
:

1562 i‡(
›t
->
nv¨s
 == 1)

1563 
s
 = "<enum>";

1565 
s
 = "<enumÜist...>";

1567 
oc_Êag
:

1568 i‡(
›t
->
nv¨s
 == 1)

1569 
s
 = "<true|false>";

1571 
s
 = "<true|falseÜist...>";

1573 
oc_°rög
:

1574 i‡(
›t
->
nv¨s
 == 0 || opt->nvars == 1)

1575 
s
 = "<string>";

1577 
s
 = "<stringÜist...>";

1580 
	`∑nic
("bogus option class");

1582 
	`Ârötf
(
fd
, "%-16†# ", 
s
);

1583 
	`›t_¥öt_›ti⁄
(
›t
, 
fd
);

1584 
	`Ârötf
(
fd
, "# %-22s\n", 
›t
->
desc
);

1585 
	}
}

1589 
	$›t_¥öt_hñp
(
›t_odb_t
 *
odb
,

1590 
FILE
 *
fd
)

1592 
›t_›t_t
 *
›t
;

1595 
	`¥öt_›ti⁄_hódî
(
odb
, 
fd
);

1597 
	`Ârötf
(
fd
, "#\n");

1598 
	`Ârötf
(
fd
, "%-16s %-16s # %12s # %-22s\n",

1600 
	`Ârötf
(
fd
, "#\n");

1603 
›t
=
buûtö_›ti⁄s
; o± !
NULL
; o±=›t->
√xt
)

1604 
	`¥öt_hñp
(
›t
, 
fd
);

1607 
›t
=
odb
->
›ti⁄s
; o± !
NULL
; o±=›t->
√xt
)

1608 
	`¥öt_hñp
(
›t
, 
fd
);

1611 
	`¥öt_›ti⁄_nŸes
(
odb
, 
fd
);

1612 
	}
}

1616 
	$dump_c⁄fig
(
›t_odb_t
 *
odb
,

1617 *
‚ame
)

1619 
FILE
 *
fd
;

1622 i‡(!
	`°rcmp
(
‚ame
, "-"))

1623 
fd
 = 
°dîr
;

1626 
fd
 = 
	`f›í
(
‚ame
, "w");

1627 i‡(!
fd
)

1628 
	`Áèl
("couldÇŸ o≥¿fûê`%s'", 
‚ame
);

1632 
	`›t_¥öt_›ti⁄s
(
odb
, 
fd
, 
FALSE
, FALSE);

1635 i‡(
fd
 !
°dout
 && fd !
°dîr
)

1636 
	`f˛o£
(
fd
);

1637 
	}
}

1640 
›t_›t_t
 *

1641 
	$›t_föd_›ti⁄
(
›t_odb_t
 *
odb
,

1642 *
›t_«me
)

1644 
›t_›t_t
 *
›t
;

1647 
›t
 = 
buûtö_›ti⁄s
; o± !
NULL
; o± = o±->
√xt
)

1649 i‡(!
	`°rcmp
(
›t
->
«me
, 
›t_«me
))

1652  
›t
;

1657 
›t
 = 
odb
->
›ti⁄s
; o± !
NULL
; o± = o±->
√xt
)

1659 i‡(!
	`°rcmp
(
›t
->
«me
, 
›t_«me
))

1662  
›t
;

1666  
NULL
;

1667 
	}
}

1671 
	$›t_ªg_hódî
(
›t_odb_t
 *
odb
,

1672 *
hódî
)

1674 
odb
->
hódî
 = header;

1675 
	}
}

1679 
	$›t_ªg_nŸe
(
›t_odb_t
 *
odb
,

1680 *
nŸe_°r
)

1682 
›t_nŸe_t
 *
nŸe
, *
ñt
, *
¥ev
;

1684 
nŸe
 = (
›t_nŸe_t
 *)
	`ˇŒoc
(1, (opt_note_t));

1685 i‡(!
nŸe
)

1686 
	`Áèl
("out of virtual memory");

1689 
nŸe
->
√xt
 = 
NULL
;

1690 
nŸe
->nŸê
nŸe_°r
;

1693 
¥ev
=
NULL
, 
ñt
=
odb
->
nŸes
;É… !NULL;ÖªvÛ…,É…Û…->
√xt
)

1696 i‡(
¥ev
 !
NULL
)

1697 
¥ev
->
√xt
 = 
nŸe
;

1699 
odb
->
nŸes
 = 
nŸe
;

1700 
nŸe
->
√xt
 = 
NULL
;

1701 
	}
}

1704 #ifde‡
TEST


1707 
	$f_‹ph™_‚
(
i
, 
¨gc
, **
¨gv
)

1709 
	`Ârötf
(
°dout
, "‹ph™†dëe˘edáàödex %d,árg = `%s'...\n", 
i
, 
¨gv
[i]);

1712  
FALSE
;

1713 
	}
}

1715 
	#MAX_VARS
 4

	)

1717 
	$maö
(
¨gc
, **
¨gv
)

1719 
›t_odb_t
 *
odb
;

1721 
n_öt_v¨s
, 
n_uöt_v¨s
, 
n_Êﬂt_v¨s
, 
n_doubÀ_v¨s
;

1722 
n_íum_v¨s
, 
n_íum_evÆ_v¨s
, 
n_Êag_v¨s
, 
n_°rög_v¨s
;

1723 
öt_v¨
, 
öt_v¨s
[
MAX_VARS
];

1724 
uöt_v¨
, 
uöt_v¨s
[
MAX_VARS
];

1725 
Êﬂt_v¨
, 
Êﬂt_v¨s
[
MAX_VARS
];

1726 
doubÀ_v¨
, 
doubÀ_v¨s
[
MAX_VARS
];

1727 
Êag_v¨
, 
Êag_v¨s
[
MAX_VARS
];

1728 *
°rög_v¨
, *
°rög_v¨s
[
MAX_VARS
];

1730 
	eëe°_t
 { 
íum_a
, 
íum_b
, 
íum_c
, 
íum_d
, 
íum_NUM
 };

1731 *
íum_em≠
[
íum_NUM
] =

1733 
íum_evÆ
[
íum_NUM
] =

1734 { 
íum_d
, 
íum_c
, 
íum_b
, 
íum_a
 };

1735 
íum_v¨
, 
íum_v¨s
[
MAX_VARS
];

1736 
íum_evÆ_v¨
, 
íum_evÆ_v¨s
[
MAX_VARS
];

1739 
odb
 = 
	`›t_√w
(
f_‹ph™_‚
);

1742 
	`›t_ªg_öt
(
odb
, "-opt:int", "This isán integer option.",

1743 &
öt_v¨
, 1, 
TRUE
, 
NULL
);

1744 
	`›t_ªg_öt_li°
(
odb
, "-opt:int:list", "This isán integerÜist option.",

1745 
öt_v¨s
, 
MAX_VARS
, &
n_öt_v¨s
, 2,

1746  
TRUE
, 
NULL
);

1747 
	`›t_ªg_uöt
(
odb
, "-opt:uint", "This isán unsigned integer option.",

1748 &
uöt_v¨
, 3, 
TRUE
, 
NULL
);

1749 
	`›t_ªg_uöt_li°
(
odb
, "-opt:uint:list",

1751 
uöt_v¨s
, 
MAX_VARS
, &
n_uöt_v¨s
, 4,

1752  
TRUE
, 
NULL
);

1753 
	`›t_ªg_Êﬂt
(
odb
, "-opt:float", "This isá float option.",

1754 &
Êﬂt_v¨
, 5.0, 
TRUE
, 
NULL
);

1755 
	`›t_ªg_Êﬂt_li°
(
odb
, "-opt:float:list", "This isá floatÜist option.",

1756 
Êﬂt_v¨s
, 
MAX_VARS
, &
n_Êﬂt_v¨s
, 6.0,

1757  
TRUE
, 
NULL
);

1758 
	`›t_ªg_doubÀ
(
odb
, "-opt:double", "This isá double option.",

1759 &
doubÀ_v¨
, 7.0, 
TRUE
, 
NULL
);

1760 
	`›t_ªg_doubÀ_li°
(
odb
, "-opt:double:list", "This isá doubleÜist option.",

1761 
doubÀ_v¨s
, 
MAX_VARS
, &
n_doubÀ_v¨s
, 8.0,

1762  
TRUE
, 
NULL
);

1763 
	`›t_ªg_íum
(
odb
, "-opt:enum", "This isánÉnumeration option.",

1764 &
íum_v¨
, "íum_a", 
íum_em≠
, 
NULL
, 
íum_NUM
,

1765  
TRUE
, 
NULL
);

1766 
	`›t_ªg_íum_li°
(
odb
, "-opt:enum:list", "This isáÉnumÜist option.",

1767 
íum_v¨s
, 
MAX_VARS
, &
n_íum_v¨s
, "enum_b",

1768 
íum_em≠
, 
NULL
, 
íum_NUM
,

1769  
TRUE
, 
NULL
);

1770 
	`›t_ªg_íum
(
odb
, "-opt:enum:eval", "This isánÉnumeration option w/eval.",

1771 &
íum_evÆ_v¨
, "íum_b", 
íum_em≠
, 
íum_evÆ
, 
íum_NUM
,

1772  
TRUE
, 
NULL
);

1773 
	`›t_ªg_íum_li°
(
odb
, "-opt:enum:eval:list",

1775 
íum_evÆ_v¨s
, 
MAX_VARS
, &
n_íum_evÆ_v¨s
, "enum_a",

1776 
íum_em≠
, 
íum_evÆ
, 
íum_NUM
,

1777  
TRUE
, 
NULL
);

1778 
	`›t_ªg_Êag
(
odb
, "-opt:flag", "This isá boolean flag option.",

1779 &
Êag_v¨
, 
FALSE
, 
TRUE
, 
NULL
);

1780 
	`›t_ªg_Êag_li°
(
odb
, "-opt:flag:list",

1782 
Êag_v¨s
, 
MAX_VARS
, &
n_Êag_v¨s
, 
TRUE
,

1783  
TRUE
, 
NULL
);

1784 
	`›t_ªg_°rög
(
odb
, "-opt:string", "This isá string option.",

1785 &
°rög_v¨
, "a:string",

1786  
TRUE
, 
NULL
);

1787 
	`›t_ªg_°rög_li°
(
odb
, "-opt:string:list", "This isá stringÜist option.",

1788 
°rög_v¨s
, 
MAX_VARS
, &
n_°rög_v¨s
, "another:string",

1789  
TRUE
, 
NULL
);

1792 
	`›t_¥o˚ss_›ti⁄s
(
odb
, 
¨gc
, 
¨gv
);

1795 
	`Ârötf
(
°dout
, "## Current Option Values ##\n");

1796 
	`›t_¥öt_›ti⁄s
(
odb
, 
°dout
, 
FALSE
, 
TRUE
);

1799 
	`›t_dñëe
(
odb
);

1800 
	`exô
(0);

1801 
	}
}

	@ss/options.h

52 #i‚de‡
OPTIONS_H


53 
	#OPTIONS_H


	)

67 
	e›t_˛ass_t
 {

68 
	moc_öt
 = 0,

69 
	moc_uöt
,

70 
	moc_Êﬂt
,

71 
	moc_doubÀ
,

72 
	moc_íum
,

73 
	moc_Êag
,

74 
	moc_°rög
,

75 
	moc_NUM


79 
	s›t_›t_t
 {

80 
›t_›t_t
 *
	m√xt
;

81 *
	m«me
;

82 *
	mdesc
;

83 
	mnv¨s
;

84 *
	m√…
;

85 *
	mf‹m©
;

86 
	m¥öt
;

87 
	mac¸ue
;

88 
›t_˛ass_t
 
	moc
;

89 
	u›t_v¨ü¡_t
 {

91 
	s›t_f‹_öt_t
 {

92 *
	mv¨
;

93 } 
	mf‹_öt
;

95 
	s›t_f‹_uöt_t
 {

96 *
	mv¨
;

97 } 
	mf‹_uöt
;

99 
	s›t_f‹_Êﬂt_t
 {

100 *
	mv¨
;

101 } 
	mf‹_Êﬂt
;

103 
	s›t_f‹_doubÀ_t
 {

104 *
	mv¨
;

105 } 
	mf‹_doubÀ
;

107 
	s›t_f‹_íum_t
 {

108 *
	mv¨
;

109 **
	mem≠
;

110 *
	mevÆ
;

111 
	mem≠_sz
;

112 } 
	mf‹_íum
;

114 
	s›t_f‹_°rög_t
 {

115 **
	mv¨
;

116 } 
	mf‹_°rög
;

117 } 
	mv¨ü¡
;

123 (*
	t‹ph™_‚_t
)(
	ti
,

124 
	t¨gc
,

125 **
	t¨gv
);

129 
	s›t_nŸe_t
 {

130 
›t_nŸe_t
 *
	m√xt
;

131 *
	mnŸe
;

135 
	s›t_odb_t
 {

136 
›t_›t_t
 *
	m›ti⁄s
;

137 
‹ph™_‚_t
 
	m‹ph™_‚
;

138 *
	mhódî
;

139 
›t_nŸe_t
 *
	mnŸes
;

143 
›t_odb_t
 *

144 
›t_√w
(
‹ph™_‚_t
 
‹ph™_‚
);

148 
›t_dñëe
(
›t_odb_t
 *
odb
);

152 
›t_ªg_öt
(
›t_odb_t
 *
odb
,

153 *
«me
,

154 *
desc
,

155 *
v¨
,

156 
def_vÆ
,

157 
¥öt
,

158 *
f‹m©
);

162 
›t_ªg_öt_li°
(
›t_odb_t
 *
odb
,

163 *
«me
,

164 *
desc
,

165 *
v¨s
,

166 
nv¨s
,

167 *
√…
,

168 *
def_vÆ
,

169 
¥öt
,

170 *
f‹m©
,

171 
ac¸ue
);

175 
›t_ªg_uöt
(
›t_odb_t
 *
odb
,

176 *
«me
,

177 *
desc
,

178 *
v¨
,

179 
def_vÆ
,

180 
¥öt
,

181 *
f‹m©
);

185 
›t_ªg_uöt_li°
(
›t_odb_t
 *
odb
,

186 *
«me
,

187 *
desc
,

188 *
v¨s
,

189 
nv¨s
,

190 *
√…
,

191 *
def_vÆ
,

192 
¥öt
,

193 *
f‹m©
,

194 
ac¸ue
);

198 
›t_ªg_Êﬂt
(
›t_odb_t
 *
odb
,

199 *
«me
,

200 *
desc
,

201 *
v¨
,

202 
def_vÆ
,

203 
¥öt
,

204 *
f‹m©
);

208 
›t_ªg_Êﬂt_li°
(
›t_odb_t
 *
odb
,

209 *
«me
,

210 *
desc
,

211 *
v¨s
,

212 
nv¨s
,

213 *
√…
,

214 *
def_vÆ
,

215 
¥öt
,

216 *
f‹m©
,

217 
ac¸ue
);

221 
›t_ªg_doubÀ
(
›t_odb_t
 *
odb
,

222 *
«me
,

223 *
desc
,

224 *
v¨
,

225 
def_vÆ
,

226 
¥öt
,

227 *
f‹m©
);

231 
›t_ªg_doubÀ_li°
(
›t_odb_t
 *
odb
,

232 *
«me
,

233 *
desc
,

234 *
v¨s
,

235 
nv¨s
,

236 *
√…
,

237 *
def_vÆ
,

238 
¥öt
,

239 *
f‹m©
,

240 
ac¸ue
);

246 
›t_ªg_íum
(
›t_odb_t
 *
odb
,

247 *
«me
,

248 *
desc
,

249 *
v¨
,

250 *
def_vÆ
,

251 **
em≠
,

252 *
evÆ
,

253 
em≠_sz
,

254 
¥öt
,

255 *
f‹m©
);

261 
›t_ªg_íum_li°
(
›t_odb_t
 *
odb
,

262 *
«me
,

263 *
desc
,

264 *
v¨s
,

265 
nv¨s
,

266 *
√…
,

267 *
def_vÆ
,

268 **
em≠
,

269 *
evÆ
,

270 
em≠_sz
,

271 
¥öt
,

272 *
f‹m©
,

273 
ac¸ue
);

277 
›t_ªg_Êag
(
›t_odb_t
 *
odb
,

278 *
«me
,

279 *
desc
,

280 *
v¨
,

281 
def_vÆ
,

282 
¥öt
,

283 *
f‹m©
);

287 
›t_ªg_Êag_li°
(
›t_odb_t
 *
odb
,

288 *
«me
,

289 *
desc
,

290 *
v¨s
,

291 
nv¨s
,

292 *
√…
,

293 *
def_vÆ
,

294 
¥öt
,

295 *
f‹m©
,

296 
ac¸ue
);

300 
›t_ªg_°rög
(
›t_odb_t
 *
odb
,

301 *
«me
,

302 *
desc
,

303 **
v¨
,

304 *
def_vÆ
,

305 
¥öt
,

306 *
f‹m©
);

310 
›t_ªg_°rög_li°
(
›t_odb_t
 *
odb
,

311 *
«me
,

312 *
desc
,

313 **
v¨s
,

314 
nv¨s
,

315 *
√…
,

316 **
def_vÆ
,

317 
¥öt
,

318 *
f‹m©
,

319 
ac¸ue
);

323 
›t_¥o˚ss_›ti⁄s
(
›t_odb_t
 *
odb
,

324 
¨gc
,

325 **
¨gv
);

329 
›t_¥öt_›ti⁄
(
›t_›t_t
 *
›t
,

330 
FILE
 *
fd
);

334 
›t_¥öt_›ti⁄s
(
›t_odb_t
 *
odb
,

335 
FILE
 *
fd
,

336 
ãr£
,

337 
nŸes
);

341 
›t_¥öt_hñp
(
›t_odb_t
 *
odb
,

342 
FILE
 *
fd
);

345 
›t_›t_t
 *

346 
›t_föd_›ti⁄
(
›t_odb_t
 *
odb
,

347 *
›t_«me
);

351 
›t_ªg_hódî
(
›t_odb_t
 *
odb
,

352 *
hódî
);

356 
›t_ªg_nŸe
(
›t_odb_t
 *
odb
,

357 *
nŸe
);

	@ss/regs.h

52 #i‚de‡
REGS_H


53 
	#REGS_H


	)

55 
	~"ho°.h
"

56 
	~"misc.h
"

57 
	~"machöe.h
"

100 
	sªgs_t
 {

101 
md_g¥_t
 
	mªgs_R
;

102 
md_Âr_t
 
	mªgs_F
;

103 
md_˘æ_t
 
	mªgs_C
;

104 
md_addr_t
 
	mªgs_PC
;

105 
md_addr_t
 
	mªgs_NPC
;

109 
ªgs_t
 *
ªgs_¸óã
();

113 
ªgs_öô
(
ªgs_t
 *
ªgs
);

117 
ªgs_dump
(
ªgs_t
 *
ªgs
,

118 
FILE
 *
°ªam
);

122 
ªgs_de°roy
(
ªgs_t
 *
ªgs
);

	@ss/resource.h

52 #i‚de‡
RESOURCE_H


53 
	#RESOURCE_H


	)

55 
	~<°dio.h
>

58 
	#MAX_RES_CLASSES
 16

	)

61 
	#MAX_INSTS_PER_CLASS
 8

	)

64 
	sªs_desc
 {

65 *
	m«me
;

66 
	mqu™tôy
;

67 
	mbusy
;

68 
	sªs_ãm∂©e
 {

69 
	m˛ass
;

72 
	m›œt
;

74 
	missuñ©
;

77 
ªs_desc
 *
	mma°î
;

78 } 
	mx
[
MAX_RES_CLASSES
];

82 
	sªs_poﬁ
 {

83 *
	m«me
;

84 
	mnum_ªsour˚s
;

85 
ªs_desc
 *
	mªsour˚s
;

87 
	m√¡s
[
MAX_RES_CLASSES
];

88 
ªs_ãm∂©e
 *
	mèbÀ
[
MAX_RES_CLASSES
][
MAX_INSTS_PER_CLASS
];

92 
ªs_poﬁ
 *
ªs_¸óã_poﬁ
(*
«me
, 
ªs_desc
 *
poﬁ
, 
ndesc
);

100 
ªs_ãm∂©e
 *
ªs_gë
(
ªs_poﬁ
 *
poﬁ
, 
˛ass
);

103 
ªs_dump
(
ªs_poﬁ
 *
poﬁ
, 
FILE
 *
°ªam
);

	@ss/ss_exegraph.c

23 
	~<°dlib.h
>

24 
	~"../tcfg.h
"

25 
	~"../lo›s.h
"

26 
	~"../b¥ed.h
"

27 
	~"../ˇche.h
"

28 
	~"../pùñöe.h
"

29 
	~"../exegøph.h
"

30 
	~"machöe.h
"

31 
	~"ss_machöe.h
"

35 *
num_mp_ö°s
;

36 
pùe_°ages
;

37 
ss_pfu_˛ass
 
fu2pfu
[];

40 
tcfg_node_t
 **
tcfg
;

41 
mas_ö°_t
 **
eg_ö°s
;

42 
egøph_node_t
 **
egøph
;

43 
eg_Àn
, 
∂og_Àn
, 
ñog_Àn
, 
body_Àn
;

44 
egøph_edge_t
 *
egøph_edges
;

45 
num_eg_edges
;

46 
ønge16_t
 *
c€xi°
;

47 
eg_chaö_t
 *
eg_chaö
;

48 
b¥ed_ty≥
;

49 
lo›_t
 *
body_lo›
;

51 
ˇche_t
 
ˇche
;

55 
LSQ_size
;

56 
RUU_size
;

57 
„tch_width
;

58 
ruu_decode_width
;

59 
ruu_issue_width
;

60 
ruu_commô_width
;

61 
ruu_ö‹dî_issue
;

62 
ruu_ifq_size
;

63 
ruu_bønch_≥«…y
;

65 
íabÀ_iˇche
;

68 **
	gd©a_dï
;

69 *
	geg_ö°s_ty≥
;

70 *
	geg_mem_ö°s
, 
	gnum_mem_ö°s
;

74 
ønge16_t
 
	gfu_œt
[] = {

92 
dump_d©a_dï
();

97 
	$ss_Æloc_mem
()

99 
eg_ö°s_ty≥
 = (*Ë
	`ˇŒoc
(
MAX_EG_LEN
, ());

100 
eg_mem_ö°s
 = (*Ë
	`ˇŒoc
(
MAX_EG_LEN
, ());

101 
	}
}

106 
	$Æloc_dï_mem
()

108 
i
;

110 
d©a_dï
 = (**Ë
	`ˇŒoc
(
eg_Àn
, (*));

111 
i
 = 1; i < 
eg_Àn
; i++)

112 
d©a_dï
[
i
] = (*Ë
	`ˇŒoc
(ò- 
c€xi°
[i].
lo
 + 1, ());

113 
	}
}

118 
	$dóŒoc_dï_mem
()

120 
i
;

122 
i
 = 1; i < 
eg_Àn
; i++)

123 
	`‰ì
(
d©a_dï
[
i
]);

124 
	`‰ì
(
d©a_dï
);

125 
	}
}

130 
	$sˇn_¥ed_n‹mÆ
(
cuº
)

132 
ö°
;

134 
ö°
 = 
cuº
-1; inst >= 0; inst--) {

135 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
) {

136 
eg_chaö
[
cuº
].
¥ed
 = 
ö°
;

137 
eg_chaö
[
ö°
].
succ
 = 
cuº
;

138 i‡(
cuº
 - 
ö°
 > 1)

139 
eg_chaö
[
cuº
-1].
succ
 = -1;

144 
eg_chaö
[
cuº
].
¥ed
 = -1;

145 
eg_chaö
[
cuº
-1].
succ
 = -1;

146 
	}
}

151 
	$sˇn_¥ed_m¥ed
(
cuº
)

153 
eg_chaö
[
cuº
].
¥ed
 = curr - 1;

154 i‡(
eg_ö°s
[
cuº
-1]->
bp_Êag
 !
BP_CPRED
)

155 
eg_chaö
[
cuº
-1].
succ
 = curr;

156 
	}
}

161 
	$sˇn_¥ed
()

163 
ö°
;

165 
eg_chaö
[0].
¥ed
 = -1;

166 
ö°
 = 1; in° < 
eg_Àn
; inst++) {

167 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
)

168 
	`sˇn_¥ed_n‹mÆ
(
ö°
);

170 
	`sˇn_¥ed_m¥ed
(
ö°
);

172 
eg_chaö
[
eg_Àn
-1].
succ
 = -1;

173 
	}
}

178 
	$ö°_c€xi°s
(
cuº
)

180 
ö°
, 
rob_num
 = 1, 
lsq_num
 = 0;

182 i‡((
eg_ö°s_ty≥
[
cuº
] =
INST_LOAD
Ë|| (eg_ö°s_ty≥[cuº] =
INST_STORE
))

183 
lsq_num
 = 1;

185 
ö°
 = 
eg_chaö
[
cuº
].
succ
; inst >= 0; inst =Ég_chain[inst].succ) {

187 i‡((
eg_ö°s_ty≥
[
cuº
] =
INST_LOAD
Ë|| (eg_ö°s_ty≥[cuº] =
INST_STORE
)) {

189 i‡(++
lsq_num
 > 
LSQ_size
)

193 i‡(++
rob_num
 >
RUU_size
)

196 i‡(
ö°
 < 0) {

197 
c€xi°
[
cuº
].
hi
 = 
eg_Àn
 - 1;

198 i‡(
cuº
 == 0)

199 
c€xi°
[
eg_Àn
-1].
lo
 = 0;

201 
c€xi°
[
cuº
].
hi
 = 
ö°
;

202 
c€xi°
[
ö°
].
lo
 = 
cuº
;

204 
	}
}

210 
	$mpö°_c€xi°s
(
cuº
, 
br_ö°
)

212 
i
, 
ö°
, 
br_succ
;

214 
br_succ
 = 
eg_chaö
[
br_ö°
].
succ
;

215 i‡(
br_succ
 - 
cuº
 >
RUU_size
)

216 
c€xi°
[
cuº
].
hi
 = cuº + 
RUU_size
 - 1;

218 
c€xi°
[
cuº
].
hi
 = 
br_succ
 - 1;

220 i‡(
cuº
 - 
br_ö°
 >
RUU_size
)

221 
c€xi°
[
cuº
].
lo
 = cuº - 
RUU_size
 + 1;

222 i‡(
cuº
 - 
br_ö°
 =
RUU_size
 - 1)

223 
c€xi°
[
cuº
].
lo
 = 
br_ö°
;

225 
c€xi°
[
cuº
].
lo
 = 
	`max
(0, 
eg_chaö
[c€xi°[cuº+1].lo].
¥ed
);

227 
	}
}

232 
	$sˇn_c€xi°s
()

234 
ö°
, 
br_ö°
;

236 
ö°
 = 0; in° >0; in° = 
eg_chaö
[ö°].
succ
) {

237 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
) {

238 
c€xi°
[
ö°
].
lo
 = 0;

242 
ö°
 = 0; in° >0; in° = 
eg_chaö
[ö°].
succ
) {

243 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
) {

244 
	`ö°_c€xi°s
(
ö°
);

247 
ö°
 = 
eg_Àn
 - 1; inst > 0; inst--) {

248 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 !
BP_CPRED
) {

249 i‡(
eg_ö°s
[
ö°
+1]->
bp_Êag
 =
BP_CPRED
)

250 
br_ö°
 = 
eg_chaö
[
ö°
 + 1].
¥ed
;

251 
	`mpö°_c€xi°s
(
ö°
, 
br_ö°
);

254 
	}
}

259 
	$add_ö°
(
ö°
)

261 
°age
, 
fu
, 
lo
 ,
hi
, 
ic_Êag
, 
bbi_id
, 
mblk_id
;

262 
egøph_node_t
 *
node
;

263 
lo›_t
 *
Õ
;

265 
ic_Êag
 = 
eg_ö°s
[
ö°
]->ic_flag;

266 i‡((
ic_Êag
 !
IC_HIT
Ë&& (
ö°
 < 
∂og_Àn
 || in° >’log_À¿+ 
body_Àn
) )) {

267 
bbi_id
 = 
eg_ö°s
[
ö°
]->bbi_id;

268 
mblk_id
 = 
eg_ö°s
[
ö°
]->mblk_id;

269 i‡(
íabÀ_iˇche
 =0 || 
	`gë_mblk_hômiss
(
tcfg
[
bbi_id
], 
mblk_id
, 
body_lo›
Ë=
IC_HIT
)

270 
ic_Êag
 = 
IC_HIT
;

273 
eg_ö°s_ty≥
[
ö°
] = 
	`ö°_ty≥
(
eg_ö°s
[inst]->inst);

274 i‡((
eg_ö°s_ty≥
[
ö°
] =
INST_LOAD
Ë|| (eg_ö°s_ty≥[ö°] =
INST_STORE
))

275 
eg_mem_ö°s
[
num_mem_ö°s
++] = 
ö°
;

276 
°age
 = 0; sègê< 
pùe_°ages
; stage++) {

277 
node
 = &
egøph
[
ö°
][
°age
];

278 
node
->
ö°
 = inst;

279 
node
->
°age
 = stage;

280 i‡((
°age
 =
STAGE_EX
)) {

281 
fu
 = 
	`ss_ö°_fu
(
eg_ö°s
[
ö°
]->inst);

282 
node
->
fu
 = fu;

285 i‡((
fu
 =
I¡ALU
Ë|| (fu =
RdP‹t
Ë|| (fu =
WrP‹t
)) {

286 
node
->
num_fu
 = 2;

288 
node
->
num_fu
 = 1;

289 
node
->
œt
.
hi
 = 
fu_œt
[
fu
].hi;Çode->œt.
lo
 = fu_lat[fu].lo;

290 } i‡(
°age
 =
STAGE_IF
) {

291 
node
->
fu
 =Çode->
num_fu
 = 0;

292 i‡(
ic_Êag
 =
IC_HIT
) {

293 
node
->
œt
.
lo
 =Çode->œt.
hi
 = 1;

294 } i‡(
ic_Êag
 =
IC_MISS
) {

295 
node
->
œt
.
lo
 =Çode->œt.
hi
 = 
ˇche
.
cmp
 + 1;

297 
node
->
œt
.
lo
 = 1;Çode->œt.
hi
 = 
ˇche
.
cmp
 + 1;

300 
node
->
fu
 =Çode->
num_fu
 = 0;

301 
node
->
œt
.
hi
 =Çode->œt.
lo
 = 1;

303 
node
->
bp_ty≥
 = 
eg_ö°s
[
ö°
]->
bp_Êag
;

304 
node
->
Êag
 = 0;

305 
node
->
ö
 =Çode->
out
 = 
NULL
;

306 
node
->
e_c⁄td
 =Çode->
l_c⁄td
 = 
NULL
;

308 
	}
}

313 
	$√w_dïíd
(
egøph_node_t
 *
§c
,Égøph_node_à*
d°
, 
low
, 
high
, 
n‹mÆ
)

315 
egøph_edge_t
 *
edge
;

317 
edge
 = &
egøph_edges
[
num_eg_edges
];

318 
num_eg_edges
++;

320 
edge
->
§c
 = src;Édge->
d°
 = dst;

321 
edge
->
œt
.
lo
 = 
low
;Édge->œt.
hi
 = 
high
;

322 
edge
->
√xt_out
 = 
§c
->
out
; src->out =Édge;

323 
edge
->
√xt_ö
 = 
d°
->
ö
; dst->in =Édge;

324 
edge
->
n‹mÆ
 =Çormal;

325 
edge
->
c⁄td_ty≥
 = 0;

326 
	}
}

331 
	$°age_‹dî_dïíds
()

333 
ö°
, 
°age
;

334 
egøph_node_t
 *
§c
, *
d°
;

336 
ö°
 = 0; in° < 
eg_Àn
; inst++) {

337 
°age
 = 0; sègê< 
pùe_°ages
-1; stage++) {

338 
§c
 = &
egøph
[
ö°
][
°age
];

339 
d°
 = &
egøph
[
ö°
][
°age
+1];

340 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

343 
	}
}

348 
	$succ_„tch_dïíds
(
ö°
)

350 
succ
, 
edge_ty≥
, 
lo
, 
hi
;

351 
egøph_node_t
 *
§c
, *
d°
;

353 
succ
 = 
eg_chaö
[
ö°
].succ;

354 i‡(
succ
 < 0)

357 
§c
 = &
egøph
[
ö°
][
STAGE_IF
];

359 i‡((
„tch_width
 =1Ë|| (
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_MISS
)) {

360 
lo
 = 
§c
->
œt
.lo; 
hi
 = src->lat.hi;

361 } i‡(
eg_ö°s
[
ö°
]->
ic_Êag
 =
IC_UNCLEAR
) {

362 
lo
 = 0; 
hi
 = 
§c
->
œt
.hi;

364 
lo
 = 
hi
 = 0;

368 
d°
 = &
egøph
[
succ
][
STAGE_IF
];

369 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
EG_NORM_EDGE
);

370 i‡(
succ
 =(
ö°
+1))

373 
d°
 = &
egøph
[
ö°
+1][
STAGE_IF
];

374 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
EG_NORM_EDGE
);

376 
	}
}

381 
	$succ_decode_dïíds
(
ö°
)

383 
succ
, 
edge_ty≥
, 
lo
, 
hi
;

384 
egøph_node_t
 *
§c
, *
d°
;

386 
succ
 = 
eg_chaö
[
ö°
].succ;

387 i‡(
succ
 < 0)

390 
§c
 = &
egøph
[
ö°
][
STAGE_ID
];

392 
d°
 = &
egøph
[
succ
][
STAGE_ID
];

393 i‡(
ruu_decode_width
 == 1)

394 
lo
 = 
hi
 = 1;

396 
lo
 = 
hi
 = 0;

397 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
EG_NORM_EDGE
);

398 i‡(
succ
 =(
ö°
+1))

401 
d°
 = &
egøph
[
ö°
+1][
STAGE_ID
];

402 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
EG_NORM_EDGE
);

403 
	}
}

409 
	$succ_issue_dïíds
(
ö°
)

411 
succ
, 
edge_ty≥
, 
fu
;

412 
egøph_node_t
 *
§c
, *
d°
;

414 
succ
 = 
eg_chaö
[
ö°
].succ;

415 i‡(
succ
 < 0)

418 
fu
 = 
	`ss_ö°_fu
(
eg_ö°s
[
ö°
]->inst);

419 i‡((
fu
 =
RdP‹t
Ë|| (fu =
WrP‹t
))

420 
§c
 = &
egøph
[
ö°
][
STAGE_WB
];

422 
§c
 = &
egøph
[
ö°
][
STAGE_EX
];

424 
d°
 = &
egøph
[
succ
][
STAGE_ID
];

425 
	`√w_dïíd
(
§c
, 
d°
, 0, 0, 
EG_NORM_EDGE
);

426 i‡(
succ
 =(
ö°
+1))

429 
d°
 = &
egøph
[
ö°
+1][
STAGE_ID
];

430 
	`√w_dïíd
(
§c
, 
d°
, 0, 0, 
EG_NORM_EDGE
);

431 
	}
}

436 
	$succ_commô_dïíds
(
ö°
)

438 
succ
, 
lo
, 
hi
;

439 
egøph_node_t
 *
§c
, *
d°
;

441 
succ
 = 
eg_chaö
[
ö°
].succ;

442 i‡(
succ
 < 0)

445 i‡(
ruu_commô_width
 == 1)

446 
lo
 = 
hi
 = 1;

448 
lo
 = 
hi
 = 0;

449 
§c
 = &
egøph
[
ö°
][
STAGE_CM
];

450 
d°
 = &
egøph
[
succ
][
STAGE_CM
];

451 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
EG_NORM_EDGE
);

452 
	}
}

457 
	$„tch_width_dïíds_n
(
ö°
, 
succ
)

459 
i
, 
succ1
, 
èg£t0
, 
èg£t
;

460 
egøph_node_t
 *
§c
, *
d°
;

463 
§c
 = &
egøph
[
ö°
][
STAGE_IF
];

464 
èg£t0
 = 
	`TAGSET
(
eg_ö°s
[
ö°
]->ö°->
addr
);

467 
succ1
 = 
ö°
;

468 
i
 = 0; i < 
„tch_width
; i++) {

469 
succ1
 = 
eg_chaö
[succ1].
succ
;

470 
èg£t
 = 
	`TAGSET
(
eg_ö°s
[
succ1
]->
ö°
->
addr
);

471 i‡(
èg£t0
 !
èg£t
)

474 
d°
 = &
egøph
[
succ1
][
STAGE_IF
];

475 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

476 
	}
}

481 
	$„tch_width_dïíds_m
(
ö°
)

483 
succ
 = 
ö°
 + 
„tch_width
, 
èg£t0
, 
èg£t
;

484 
egøph_node_t
 *
§c
, *
d°
;

486 i‡(
eg_ö°s
[
succ
]->
bp_Êag
 =
BP_CPRED
)

489 
§c
 = &
egøph
[
ö°
][
STAGE_IF
];

490 
èg£t0
 = 
	`TAGSET
(
eg_ö°s
[
ö°
]->ö°->
addr
);

491 
succ
 = 
ö°
 + 1; suc¯< in° + 
„tch_width
; succ++) {

492 
èg£t
 = 
	`TAGSET
(
eg_ö°s
[
succ
]->
ö°
->
addr
);

493 i‡(
èg£t0
 !
èg£t
)

496 
d°
 = &
egøph
[
succ
][
STAGE_IF
];

497 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

498 
	}
}

503 
	$„tch_width_dïíds
(
ö°
, 
succ
)

505 
	`„tch_width_dïíds_n
(
ö°
, 
succ
);

506 i‡((
eg_ö°s
[
ö°
]->
bp_Êag
 !
BP_CPRED
Ë|| (
succ
 =(ö° + 
„tch_width
)))

510 
	`„tch_width_dïíds_m
(
ö°
);

511 
	}
}

516 
	$decode_width_dïíds_n
(
ö°
, 
succ
)

518 
egøph_node_t
 *
§c
, *
d°
;

520 
§c
 = &
egøph
[
ö°
][
STAGE_ID
];

521 
d°
 = &
egøph
[
succ
][
STAGE_ID
];

522 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

523 
	}
}

528 
	$decode_width_dïíds_m
(
ö°
)

530 
succ
;

531 
egøph_node_t
 *
§c
, *
d°
;

533 
succ
 = 
ö°
 + 
ruu_decode_width
;

534 i‡(
eg_ö°s
[
succ
]->
bp_Êag
 =
BP_CPRED
)

536 
§c
 = &
egøph
[
ö°
][
STAGE_ID
];

537 
d°
 = &
egøph
[
succ
][
STAGE_ID
];

538 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

539 
	}
}

544 
	$decode_width_dïíds
(
ö°
, 
succ
)

547 
	`decode_width_dïíds_n
(
ö°
, 
succ
);

548 i‡((
eg_ö°s
[
ö°
]->
bp_Êag
 !
BP_CPRED
Ë|| (
succ
 =(ö° + 
ruu_decode_width
)))

552 
	`decode_width_dïíds_m
(
ö°
);

553 
	}
}

558 
	$issue_width_dïíds_n
(
ö°
, 
succ
)

560 
egøph_node_t
 *
§c
, *
d°
;

562 
§c
 = &
egøph
[
ö°
][
STAGE_EX
];

563 
d°
 = &
egøph
[
succ
][
STAGE_EX
];

564 
	`√w_dïíd
(
§c
, 
d°
, 1, 1, 
EG_NORM_EDGE
);

565 
	}
}

570 
	$issue_width_dïíds_m
(
ö°
)

572 
succ
;

573 
egøph_node_t
 *
§c
, *
d°
;

575 
succ
 = 
ö°
 + 
ruu_decode_width
;

576 i‡(
eg_ö°s
[
succ
]->
bp_Êag
 =
BP_CPRED
)

578 
§c
 = &
egøph
[
ö°
][
STAGE_EX
];

579 
d°
 = &
egøph
[
succ
][
STAGE_EX
];

580 
	`√w_dïíd
(
§c
, 
d°
, 1, 1, 
EG_NORM_EDGE
);

581 
	}
}

586 
	$issue_width_dïíds
(
ö°
, 
succ
)

589 
	`issue_width_dïíds_n
(
ö°
, 
succ
);

590 i‡((
eg_ö°s
[
ö°
]->
bp_Êag
 !
BP_CPRED
Ë|| (
succ
 =(ö° + 
ruu_issue_width
)))

594 
	`issue_width_dïíds_m
(
ö°
);

595 
	}
}

600 
	$commô_width_dïíds
(
ö°
, 
succ
)

602 
egøph_node_t
 *
§c
, *
d°
;

604 
§c
 = &
egøph
[
ö°
][
STAGE_CM
];

605 
d°
 = &
egøph
[
succ
][
STAGE_CM
];

606 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

607 
	}
}

612 
	$ö‹dî_dïíds
()

614 
i
, 
ö°
, 
succ
, 
msucc
;

616 
ö°
 = 0; in° < 
eg_Àn
 - 1; inst++) {

618 
	`succ_„tch_dïíds
(
ö°
);

619 
	`succ_decode_dïíds
(
ö°
);

620 
	`succ_commô_dïíds
(
ö°
);

621 i‡(
ruu_ö‹dî_issue
 =
TRUE
)

622 
	`succ_issue_dïíds
(
ö°
);

624 i‡(
„tch_width
 == 1)

627 
succ
 = 0;

628 
i
 = 0; i < 
„tch_width
; i++)

629 
succ
 = 
eg_chaö
[succ].succ;

631 
ö°
 = 0; in° < 
eg_Àn
 - 
„tch_width
; inst++) {

632 i‡(
succ
 < 0)

635 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
) {

636 
	`„tch_width_dïíds
(
ö°
, 
succ
);

637 
	`decode_width_dïíds
(
ö°
, 
succ
);

638 
	`commô_width_dïíds
(
ö°
, 
succ
);

639 
succ
 = 
eg_chaö
[succ].succ;

641 
msucc
 = 
eg_chaö
[
ö°
-1].
succ
 - 
„tch_width
;

642 
ö°
 < 
msucc
) {

643 
	`„tch_width_dïíds_m
(
ö°
);

644 
	`decode_width_dïíds_m
(
ö°
);

645 
ö°
++;

647 
ö°
 = 
msucc
 + 
„tch_width
 - 1;

650 i‡(
ö°
 < 
eg_Àn
 - 
„tch_width
) {

651 ; 
ö°
 < 
eg_Àn
 - 
„tch_width
; inst++) {

652 
	`„tch_width_dïíds_m
(
ö°
);

653 
	`decode_width_dïíds_m
(
ö°
);

656 
	}
}

663 
	$ibuf_n‹mÆ_dïíds
(
ö°
, 
succ
)

665 
egøph_node_t
 *
§c
, *
d°
;

668 
§c
 = &
egøph
[
ö°
][
STAGE_ID
];

669 
d°
 = &
egøph
[
succ
][
STAGE_IF
];

670 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

671 i‡((
§c
->
bp_ty≥
 !
BP_CPRED
Ë|| (
succ
 =(
ö°
+
ruu_ifq_size
)))

675 
succ
 = 
ö°
 + 
ruu_ifq_size
;

676 i‡(
succ
 >
eg_chaö
[
ö°
].succ)

678 
d°
 = &
egøph
[
succ
][
STAGE_IF
];

679 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

680 
	}
}

685 
	$ibuf_m¥ed_dïíds
(
ö°
, 
succ
)

687 
egøph_node_t
 *
§c
, *
d°
;

689 
§c
 = &
egøph
[
ö°
][
STAGE_ID
];

690 
d°
 = &
egøph
[
succ
][
STAGE_IF
];

691 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

692 
	}
}

700 
	$fifo_ibuf_dïíds
()

702 
i
, 
ö°
, 
succ
, 
msucc
;

704 
succ
 = 0;

705 
i
 = 0; i < 
ruu_ifq_size
; i++)

706 
succ
 = 
eg_chaö
[succ].succ;

708 
ö°
 = 0; in° < 
eg_Àn
 - 
ruu_ifq_size
; inst++) {

709 i‡(
succ
 < 0)

711 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
) {

712 
	`ibuf_n‹mÆ_dïíds
(
ö°
, 
succ
);

713 
succ
 = 
eg_chaö
[succ].succ;

715 
msucc
 = 
eg_chaö
[
ö°
-1].
succ
 - 
ruu_ifq_size
;

716 
ö°
 < 
msucc
) {

717 
	`ibuf_m¥ed_dïíds
(
ö°
, in° + 
ruu_ifq_size
);

718 
ö°
++;

720 
ö°
 = 
msucc
 + 
ruu_ifq_size
 - 1;

723 i‡(
ö°
 < 
eg_Àn
 - 
ruu_ifq_size
) {

724 ; 
ö°
 < 
eg_Àn
 - 
ruu_ifq_size
; inst++) {

725 
succ
 = 
ö°
 + 
ruu_ifq_size
;

726 i‡(
eg_ö°s
[
succ
]->
bp_Êag
 =
BP_CPRED
)

728 i‡(
eg_ö°s
[
ö°
]->
bp_Êag
 =
BP_CPRED
)

729 
	`ibuf_n‹mÆ_dïíds
(
ö°
, 
succ
);

731 
	`ibuf_m¥ed_dïíds
(
ö°
, 
succ
);

734 
	}
}

739 
	$rob_dïíds
(
ö°
, 
succ
)

741 
egøph_node_t
 *
§c
, *
d°
;

743 
§c
 = &
egøph
[
ö°
][
STAGE_CM
];

744 
d°
 = &
egøph
[
succ
][
STAGE_ID
];

745 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

746 
	}
}

754 
	$fifo_rob_dïíds
()

756 
i
, 
ö°
, 
succ
;

758 i‡(
eg_Àn
 <
RUU_size
)

760 
succ
 = 0;

761 
i
 = 0; i < 
RUU_size
; i++) {

762 
succ
 = 
eg_chaö
[succ].succ;

763 i‡(
succ
 < 0)

766 
ö°
 = 0; (ö° >0Ë&& (
succ
 >0); in° = 
eg_chaö
[inst].succ) {

767 
	`rob_dïíds
(
ö°
, 
succ
);

768 
succ
 = 
eg_chaö
[succ].succ;

770 
	}
}

776 
	$m¨k_d©a_dï
(
§c_id
, 
d°_id
)

778 
ö°
, 
lbound
;

780 i‡(
§c_id
 < 
c€xi°
[
d°_id
].
lo
)

783 
d©a_dï
[
d°_id
][d°_id - 
§c_id
] = 1;

785 
lbound
 = 
	`max
(0, 
c€xi°
[
d°_id
].
lo
);

786 
ö°
 = 
eg_chaö
[
§c_id
].
¥ed
; in° >
c€xi°
[
d°_id
].
lo
; inst =Ég_chain[inst].pred) {

787 i‡(
d©a_dï
[
§c_id
][§c_id - 
ö°
])

788 
d©a_dï
[
d°_id
][d°_id - 
ö°
] = 1;

790 
	}
}

795 
	$¸óã_b¥ed_dïíd
(
§c_id
, 
d°_id
, 
n‹mÆ
)

797 
lo
, 
hi
;

798 
egøph_node_t
 *
§c
, *
d°
;

800 
§c
 = &
egøph
[
§c_id
][
STAGE_WB
];

801 
d°
 = &
egøph
[
d°_id
][
STAGE_IF
];

802 
lo
 = 
ruu_bønch_≥«…y
 + 
§c
->
œt
.lo;

803 
hi
 = 
ruu_bønch_≥«…y
 + 
§c
->
œt
.hi;

804 
	`√w_dïíd
(
§c
, 
d°
, 
lo
, 
hi
, 
n‹mÆ
);

805 
	}
}

810 
	$¸óã_d©a_dïíd
(
§c_id
, 
d°_id
, 
n‹mÆ
)

812 
egøph_node_t
 *
§c
, *
d°
;

814 i‡((
eg_ö°s_ty≥
[
§c_id
] =
INST_ICOMP
Ë|| (eg_ö°s_ty≥[§c_id] =
INST_FCOMP
))

815 
§c
 = &
egøph
[
§c_id
][
STAGE_EX
];

816 i‡(
eg_ö°s_ty≥
[
§c_id
] =
INST_LOAD
)

817 
§c
 = &
egøph
[
§c_id
][
STAGE_WB
];

820 
d°
 = &
egøph
[
d°_id
][
STAGE_EX
];

821 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
n‹mÆ
);

822 
	`m¨k_d©a_dï
(
§c_id
, 
d°_id
);

823 
	}
}

828 
	$d©a_dïíds
()

830 
i
, 
j
, 
r
, 
br_ö°
, 
bp_Êag
, 
§c_id
;

831 
ªgs
[
MD_TOTAL_REGS
], 
mp_ªgs
[MD_TOTAL_REGS];

832 
de_ö°_t
 *
ö°
;

834 
i
 = 0; i < 
MD_TOTAL_REGS
; i++) {

835 
ªgs
[
i
] = 
mp_ªgs
[i] = -1;

838 
bp_Êag
 = 
eg_ö°s
[0]->bp_flag;

839 
ö°
 = 
eg_ö°s
[0]->inst;

841 
j
 = 0; j < 
ö°
->
num_out
; j++) {

842 
r
 = 
ö°
->
out
[
j
];

843 
ªgs
[
r
] = 0;

845 i‡(
eg_ö°s_ty≥
[0] =
INST_COND
)

846 
	`¸óã_b¥ed_dïíd
(0, 
eg_chaö
[0].
succ
, 
EG_COND_EDGE
);

848 
i
 = 1; i < 
eg_Àn
; i++) {

849 
ö°
 = 
eg_ö°s
[
i
]->inst;

850 
bp_Êag
 = 
eg_ö°s
[
i
]->bp_flag;

852 
j
 = 0; j < 
ö°
->
num_ö
; j++) {

853 
r
 = 
ö°
->
ö
[
j
];

854 i‡((
bp_Êag
 !
BP_CPRED
Ë&& (
mp_ªgs
[
r
] > 
br_ö°
))

855 
§c_id
 = 
mp_ªgs
[
r
];

857 
§c_id
 = 
ªgs
[
r
];

859 i‡(
§c_id
 >
c€xi°
[
i
].
lo
)

860 
	`¸óã_d©a_dïíd
(
§c_id
, 
i
, 
EG_NORM_EDGE
);

863 
j
 = 0; j < 
ö°
->
num_out
; j++) {

864 
r
 = 
ö°
->
out
[
j
];

865 i‡(
bp_Êag
 =
BP_CPRED
)

866 
ªgs
[
r
] = 
i
;

868 
mp_ªgs
[
r
] = 
i
;

870 i‡(
eg_ö°s_ty≥
[
i
] !
INST_COND
)

872 i‡(
eg_chaö
[
i
].
succ
 < 0)

875 i‡(
eg_chaö
[
i
].
succ
 =
∂og_Àn
) {

876 i‡(
b¥ed_ty≥
 =
BP_MPRED
) {

877 
	`¸óã_b¥ed_dïíd
(
i
, 
eg_chaö
[i].
succ
, 
EG_NORM_EDGE
);

878 
	`m¨k_d©a_dï
(
i
, 
eg_chaö
[i].
succ
);

881 
	`¸óã_b¥ed_dïíd
(
i
, 
eg_chaö
[i].
succ
, 
EG_COND_EDGE
);

884 
	}
}

889 
	$lﬂd_waô_°‹e
()

891 
i
, 
j
, 
ty≥
;

892 
de_ö°_t
 *
ö°
;

893 
egøph_node_t
 *
§c
, *
d°
;

895 
i
 = 1; i < 
num_mem_ö°s
; i++) {

896 i‡(
eg_ö°s_ty≥
[
eg_mem_ö°s
[
i
]] =
INST_STORE
)

898 
d°
 = &
egøph
[
eg_mem_ö°s
[
i
]][
STAGE_WB
];

899 
j
 = 
i
 - 1; j >= 0; j--) {

900 i‡(
eg_mem_ö°s
[
j
] < 
c€xi°
[
i
].
lo
)

902 i‡(
eg_ö°s_ty≥
[
eg_mem_ö°s
[
j
]] =
INST_STORE
) {

903 
§c
 = &
egøph
[
eg_mem_ö°s
[
j
]][
STAGE_EX
];

904 
	`√w_dïíd
(
§c
, 
d°
, src->
œt
.
lo
, src->œt.
hi
, 
EG_NORM_EDGE
);

908 
	}
}

913 
	$buûd_dïíds
()

915 
	`°age_‹dî_dïíds
();

917 
	`ö‹dî_dïíds
();

919 
	`fifo_ibuf_dïíds
();

920 
	`fifo_rob_dïíds
();

922 
	`d©a_dïíds
();

925 
	`lﬂd_waô_°‹e
();

926 
	}
}

931 
	$ªady_óæõr
(
ö°1
, 
ö°2
)

933 
egøph_node_t
 *
v1
, *
v2
;

934 
egøph_edge_t
 *
e1
, *
e2
;

935 
óæõr
 = 1, 
num_dïs
 = 0;

937 i‡(
ö°1
 > 
ö°2
)

939 i‡(
ö°1
 =
ö°2
)

941 i‡(
c€xi°
[
ö°2
].
lo
 >
ö°1
)

943 i‡(
d©a_dï
[
ö°2
][ö°2 - 
ö°1
])

946 
v1
 = &
egøph
[
ö°1
][
STAGE_EX
];

947 
v2
 = &
egøph
[
ö°2
][
STAGE_EX
];

948 i‡(
fu2pfu
[
v1
->
fu
] !fu2pfu[
v2
->fu]) {

949 
e2
 = 
v2
->
ö
;É2 !
NULL
;É2 =É2->
√xt_ö
) {

950 i‡((
e2
->
§c
->
°age
 !
STAGE_EX
Ë&& (e2->§c->°agê!
STAGE_WB
))

952 
óæõr
 = 
	`ªady_óæõr
(
ö°1
, 
e2
->
§c
->
ö°
);

953 i‡(
óæõr
)

956  
óæõr
;

959 
e1
 = 
v1
->
ö
;É1 !
NULL
;É1 =É1->
√xt_ö
) {

960 i‡((
e1
->
§c
->
°age
 !
STAGE_EX
Ë&& (e1->§c->°agê!
STAGE_WB
))

962 
num_dïs
++;

963 
e2
 = 
v2
->
ö
;É2 !
NULL
;É2 =É2->
√xt_ö
) {

964 i‡((
e2
->
§c
->
°age
 !
STAGE_EX
Ë&& (e2->§c->°agê!
STAGE_WB
))

966 
óæõr
 = 
	`ªady_óæõr
(
e1
->
§c
->
ö°
, 
e2
->src->inst);

967 i‡(
óæõr
)

970 i‡(!
óæõr
)

973 i‡((
c€xi°
[
ö°2
].
lo
 =0Ë&& (
num_dïs
 < 2))

976  
óæõr
;

977 
	}
}

982 
	$dñay_ty≥
(
egøph_edge_t
 *
˚
)

984 
óæõr
;

986 
óæõr
 = 
	`ªady_óæõr
(
˚
->
§c
->
ö°
, ce->
d°
->inst);

987 i‡(
óæõr
)

988  
UNI_DELAY
;

990  
BI_DELAY
;

991 
	}
}

996 
	$√w_c⁄ãnd
(
egøph_node_t
 *
§c
,Égøph_node_à*
d°
, 
n‹mÆ
)

998 
egøph_edge_t
 *
edge
;

1000 
edge
 = &
egøph_edges
[
num_eg_edges
];

1001 
num_eg_edges
++;

1003 
edge
->
§c
 = src;

1004 
edge
->
d°
 = dst;

1005 
edge
->
√xt_out
 = 
§c
->
l_c⁄td
;

1006 
§c
->
l_c⁄td
 = 
edge
;

1007 
edge
->
√xt_ö
 = 
d°
->
e_c⁄td
;

1008 
d°
->
e_c⁄td
 = 
edge
;

1013 i‡((
eg_ö°s
[
d°
->
ö°
]->
bp_Êag
 =
BP_UNCLEAR
Ë&& (eg_ö°s[
§c
->ö°]->bp_Êag =
BP_CPRED
))

1014 
n‹mÆ
 = 
EG_COND_EDGE
;

1015 
edge
->
n‹mÆ
 =Çormal;

1018 i‡(
edge
->
d°
->
œt
.
hi
 <= 1)

1019 
edge
->
c⁄td_ty≥
 = 
UNI_DELAY
;

1021 
edge
->
c⁄td_ty≥
 = 
	`dñay_ty≥
(edge);

1022 
	}
}

1027 
	$ö°_c⁄ãnds
(
cuº
)

1029 
ö°
, 
n‹mÆ
;

1030 
egøph_node_t
 *
§c
, *
d°
;

1032 
d°
 = &
egøph
[
cuº
][
STAGE_EX
];

1033 
ö°
 = 
eg_chaö
[
cuº
].
¥ed
; inst >= 0; inst =Ég_chain[inst].pred) {

1034 i‡(
c€xi°
[
cuº
].
lo
 > 
ö°
)

1036 i‡(
d©a_dï
[
cuº
][cuº-
ö°
] =
EG_DEP_NORM
)

1038 i‡(
d©a_dï
[
cuº
][cuº-
ö°
] =
EG_DEP_COND
)

1039 
n‹mÆ
 = 
EG_COND_EDGE
;

1041 
n‹mÆ
 = 
EG_NORM_EDGE
;

1042 
§c
 = &
egøph
[
ö°
][
STAGE_EX
];

1043 i‡(
fu2pfu
[
§c
->
fu
] =fu2pfu[
d°
->fu])

1044 
	`√w_c⁄ãnd
(
§c
, 
d°
, 
n‹mÆ
);

1045 i‡(((
§c
->
fu
 =
I¡ALU
Ë|| (§c->fu =
RdP‹t
Ë|| (§c->fu =
WrP‹t
))

1046 && (
d°
->
fu
 =
I¡ALU
 || (d°->fu =
RdP‹t
Ë|| (d°->fu =
WrP‹t
))) {

1048 
	`√w_c⁄ãnd
(
§c
, 
d°
, 
n‹mÆ
);

1051 
	}
}

1056 
	$buûd_c⁄ãnds
()

1058 
ö°
;

1060 
ö°
 = 1; in° < 
eg_Àn
; inst++)

1061 
	`ö°_c⁄ãnds
(
ö°
);

1062 
	}
}

1067 
	$¸óã_egøph_ss
()

1069 
i
;

1070 
fú°
 = 1;

1072 i‡(
fú°
) {

1073 
	`ss_Æloc_mem
();

1074 
fú°
 = 0;

1076 
num_eg_edges
 = 0;

1077 
num_mem_ö°s
 = 0;

1078 
	`sˇn_¥ed
();

1079 
	`sˇn_c€xi°s
();

1080 
i
 = 0; i < 
eg_Àn
; i++)

1081 
	`add_ö°
(
i
);

1082 
	`Æloc_dï_mem
();

1083 
	`buûd_dïíds
();

1084 
	`buûd_c⁄ãnds
();

1085 
	`dóŒoc_dï_mem
();

1086 
	}
}

1091 
	$dump_c€xi°
(
fú°
, 
œ°
)

1093 
i
;

1095 
i
 = 
fú°
; i < 
œ°
; i++)

1096 
	`¥ötf
("c€xi°[%d]/%d: [%d, %d]\n", 
i
, 
eg_ö°s
[i]->
bp_Êag
, 
c€xi°
[i].
lo
, c€xi°[i].
hi
);

1097 
	}
}

1102 
	$dump_d©a_dï
()

1104 
i
, 
j
;

1106 
	`¥ötf
("data dependences\n");

1107 
i
 = 1; i < 
eg_Àn
; i++) {

1108 
	`¥ötf
("%d(%x): ", 
i
, 
eg_ö°s
[i]->
ö°
->
addr
 & 0xffff);

1109 
j
;

1110 
j
 = 
c€xi°
[
i
].
lo
; j < i; j++)

1111 i‡(
d©a_dï
[
i
][i-
j
] != 0)

1112 
	`¥ötf
("%d(%xË", 
j
, 
eg_ö°s
[j]->
ö°
->
addr
 & 0xffff);

1113 
	`¥ötf
("\n");

1115 
	}
}

	@ss/ss_isa.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~"../comm⁄.h
"

27 
	~"../iß.h
"

28 
	~"ss_iß.h
"

29 
	~"machöe.h
"

33 
iß_t
 *
iß
;

34 
num_iß
;

45 *
	gmd_›2«me
[
OP_MAX
] = {

46 
NULL
,

47 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËNAME,

	)

48 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
ËNAME,

	)

49 
	#CONNECT
(
OP
)

	)

50 
	~"machöe.def
"

56 
	gmd_›2Êags
[
OP_MAX
] = {

57 
NA
,

58 
	#DEFINST
(
OP
,
MSK
,
NAME
,
OPFORM
,
RES
,
FLAGS
,
O1
,
O2
,
I1
,
I2
,
I3
ËFLAGS,

	)

59 
	#DEFLINK
(
OP
,
MSK
,
NAME
,
MASK
,
SHIFT
Ë
NA
,

	)

60 
	#CONNECT
(
OP
)

	)

61 
	~"machöe.def
"

66 *
md_›2«me
[];

67 
md_›2Êags
[];

77 
	$öô_iß_ss
()

79 
i
, 
Àn
;

81 
num_iß
 = 
OP_MAX
 - 1;

83 
iß
 = (
iß_t
 *Ë
	`ˇŒoc
(
OP_MAX
 - 1, (isa_t));

84 
	`CHECK_MEM
(
iß
);

85 
i
 = 1; i < 
OP_MAX
 - 1; i++) {

86 
iß
[
i
].
›code
 = i;

87 i‡(
md_›2«me
[
i
] !
NULL
) {

88 
Àn
 = 
	`°æí
(
md_›2«me
[
i
]) + 1;

89 
iß
[
i
].
«me
 = (*Ë
	`mÆloc
(
Àn
);

90 
	`CHECK_MEM
(
iß
[
i
].
«me
);

91 
	`°r˝y
(
iß
[
i
].
«me
, 
md_›2«me
[i]);

93 i‡(
md_›2Êags
[
i
] & 
F_ICOMP
)

94 
iß
[
i
].
ty≥
 = 
INST_ICOMP
;

95 i‡(
md_›2Êags
[
i
] & 
F_FCOMP
)

96 
iß
[
i
].
ty≥
 = 
INST_FCOMP
;

97 i‡(
md_›2Êags
[
i
] & 
F_LOAD
)

98 
iß
[
i
].
ty≥
 = 
INST_LOAD
;

99 i‡(
md_›2Êags
[
i
] & 
F_STORE
)

100 
iß
[
i
].
ty≥
 = 
INST_STORE
;

101 i‡(
md_›2Êags
[
i
] & 
F_COND
)

102 
iß
[
i
].
ty≥
 = 
INST_COND
;

103 i‡(
md_›2Êags
[
i
] & 
F_CALL
)

104 
iß
[
i
].
ty≥
 = 
INST_CALL
;

105 i‡((
md_›2Êags
[
i
] & (
F_CTRL
|
F_UNCOND
|
F_DIRJMP
))

106 =(
F_CTRL
|
F_UNCOND
|
F_DIRJMP
))

107 
iß
[
i
].
ty≥
 = 
INST_UNCOND
;

108 i‡((
md_›2Êags
[
i
] & (
F_CTRL
|
F_UNCOND
|
F_INDIRJMP
))

109 =(
F_CTRL
|
F_UNCOND
|
F_INDIRJMP
))

110 
iß
[
i
].
ty≥
 = 
INST_RET
;

111 i‡(
md_›2Êags
[
i
] & 
F_TRAP
)

112 
iß
[
i
].
ty≥
 = 
INST_TRAP
;

114 
	`Ârötf
(
°dîr
, "%s: unidítifõd in°ru˘i⁄Åy≥!\n", 
iß
[
i
].
«me
);

115 
	`exô
(1);

118 
	}
}

124 
	$decode_ö°
(
de_ö°_t
 *
de_ö°
, 
md_ö°_t
 
ö°
)

126 
›
, 
ty≥
, 
off£t
, 
i
, 
ö¸
;

127 
ö
[3], 
out
[2];

128 
num_ö
 = 0, 
num_out
 = 0;

129 * 
ö°_f‹m©
;

130 
md_›code
 
m›
;

133 
	`MD_SET_OPCODE
(
m›
, 
ö°
);

134 
›
 = 
	`MD_OP_ENUM
(
m›
);

135 
de_ö°
->
›_íum
 = 
›
;

136 
de_ö°
->
size
 = (
md_ö°_t
);

137 
ty≥
 = 
iß
[
›
].type;

140 
ö°_f‹m©
 = 
	`MD_OP_FORMAT
(
›
);

144 *
ö°_f‹m©
) {

145 *
ö°_f‹m©
)

149 #ifde‡
_DEBUG


150 
	`¥ötf
("Immedüã vÆuê%d\n", 
IMM
);

152 
de_ö°
->
imm
 = 
IMM
;

155 #ifde‡
_DEBUG


156 
	`¥ötf
("Immedüã vÆuê%d\n", 
SHAMT
);

158 
de_ö°
->
imm
 = 
SHAMT
;

161 #ifde‡
_DEBUG


162 
	`¥ötf
("Immedüã vÆuê%u\n", 
UIMM
);

164 
de_ö°
->
imm
 = 
UIMM
;

167 #ifde‡
_DEBUG


168 
	`¥ötf
("Immedüã vÆuê%d\n", 
UIMM
);

170 
de_ö°
->
imm
 = 
UIMM
;

178 
ö°_f‹m©
++;

182 i‡(
ty≥
 =
INST_COND
) {

183 
off£t
 = (()(()(
ö°
.
b
 & 0xffff))) << 2;

184 
de_ö°
->
èrgë
 = de_ö°->
addr
 + (
md_ö°_t
Ë+ 
off£t
;

185 } i‡((
ty≥
 =
INST_UNCOND
Ë|| (ty≥ =
INST_CALL
)) {

186 
off£t
 = (
ö°
.
b
 & 0x3ffffff) << 2;

187 
de_ö°
->
èrgë
 = (de_ö°->
addr
 & 0xf0000000Ë| 
off£t
;

191 
›
) {

192 
	#DEFINST
(
OP
, 
MSK
, 
NAME
, 
FMT
, 
FU
, 
CLASS
, 
O1
,
O2
, 
IN1
, 
IN2
, 
IN3
Ë\

	)

193 
OP
: \

194 
ö
[0] = 
IN1
; in[1] = 
IN2
; in[2] = 
IN3
; \

195 
out
[0] = 
O1
; out[1] = 
O2
; \

197 
	~"machöe.def
"

198 #unde‡
DEFINST


200 
ö
[0] = in[1] = in[2] = 
NA
;

201 
out
[0] = out[1] = 
NA
;

203 
ö¸
 = 0;

204 
i
 = 0; i <= 2; i++) {

205 i‡(
ö
[
i
] !
NA
) {

206 
num_ö
++;

210 
ö¸
 = 0;

211 
i
 = 0; i <= 1; i++) {

212 i‡(
out
[
i
] !
NA
) {

213 
num_out
++;

217 if(!
	`°rcmp
(
iß
[
›
].
«me
, "lb") || !strcmp(isa[op].name, "lh") ||

218 !
	`°rcmp
(
iß
[
›
].
«me
, "lw") || !strcmp(isa[op].name, "lhu") ||

219 !
	`°rcmp
(
iß
[
›
].
«me
, "lwl") || !strcmp(isa[op].name, "lwr") ||

220 !
	`°rcmp
(
iß
[
›
].
«me
, "l.d") || !strcmp(isa[op].name, "l.s"))

222 if(
ö
[2] !
NA
)

223 
num_ö
 = 2;

225 
num_ö
 = 1;

227 if(!
	`°rcmp
(
iß
[
›
].
«me
, "sb") || !strcmp(isa[op].name, "sh") ||

228 !
	`°rcmp
(
iß
[
›
].
«me
, "sw") || !strcmp(isa[op].name, "swl") ||

229 !
	`°rcmp
(
iß
[
›
].
«me
, "swr") || !strcmp(isa[op].name, "s.d") ||

230 !
	`°rcmp
(
iß
[
›
].
«me
, "s.s"))

232 if(
ö
[2] !
NA
)

233 
num_ö
 = 3;

235 
num_ö
 = 2;

238 
de_ö°
->
ö
 = (*Ë
	`ˇŒoc
(
num_ö
, ());

239 
	`CHECK_MEM
(
de_ö°
->
ö
);

240 
de_ö°
->
num_ö
 = 0;

241 if(!
	`°rcmp
(
iß
[
›
].
«me
, "lb") || !strcmp(isa[op].name, "lh") ||

242 !
	`°rcmp
(
iß
[
›
].
«me
, "lw") || !strcmp(isa[op].name, "lhu") ||

243 !
	`°rcmp
(
iß
[
›
].
«me
, "lwl") || !strcmp(isa[op].name, "lwr") ||

244 !
	`°rcmp
(
iß
[
›
].
«me
, "l.d") || !strcmp(isa[op].name, "l.s"))

246 
i
 = 0; i < 
num_ö
; i++)

247 
de_ö°
->
ö
[de_ö°->
num_ö
++] = in[
i
+1];

249 if(!
	`°rcmp
(
iß
[
›
].
«me
, "sb") || !strcmp(isa[op].name, "sh") ||

250 !
	`°rcmp
(
iß
[
›
].
«me
, "sw") || !strcmp(isa[op].name, "swl") ||

251 !
	`°rcmp
(
iß
[
›
].
«me
, "swr") || !strcmp(isa[op].name, "s.d") ||

252 !
	`°rcmp
(
iß
[
›
].
«me
, "s.s"))

254 
i
 = 0; i < 
num_ö
; i++)

255 
de_ö°
->
ö
[de_ö°->
num_ö
++] = in[
i
];

259 
i
 = 0; i <= 2; i++) {

261 
de_ö°
->
ö
[de_ö°->
num_ö
++] = in[
i
];

264 
de_ö°
->
out
 = (*Ë
	`ˇŒoc
(
num_out
, ());

265 
	`CHECK_MEM
(
de_ö°
->
out
);

266 
de_ö°
->
num_out
 = 0;

267 
i
 = 0; i <= 1; i++) {

269 
de_ö°
->
out
[de_ö°->
num_out
++] = out[
i
];

271 
	}
}

274 
	$ss_ö°_fu
(
de_ö°_t
 *
ö°
)

276  
	`MD_OP_FUCLASS
(
ö°
->
›_íum
);

277 
	}
}

281 
ønge_t
 
fu_œt
[];

283 
	$ss_max_ö°_œt
(
de_ö°_t
 *
ö°
)

285 
fu
;

287 
fu
 = 
	`ss_ö°_fu
(
ö°
);

288  
fu_œt
[
fu
].
hi
;

289 
	}
}

	@ss/ss_isa.h

22 #i‚de‡
ISA_SS_H


23 
	#ISA_SS_H


	)

31 
	#DNA
 (0)

	)

34 
	#DGPR
(
N
Ë(N)

	)

35 
	#DGPR_D
(
N
Ë((NË&~1)

	)

38 
	#DFPR_L
(
N
Ë(((N)+32)&~1)

	)

39 
	#DFPR_F
(
N
Ë(((N)+32)&~1)

	)

40 
	#DFPR_D
(
N
Ë(((N)+32)&~1)

	)

43 
	#DHI
 (0+32+32)

	)

44 
	#DLO
 (1+32+32)

	)

45 
	#DFCC
 (2+32+32)

	)

46 
	#DTMP
 (3+32+32)

	)

48 #ñi‡
deföed
(
TARGET_ALPHA
)

51 
	#DGPR
(
N
Ë(31 - (N)Ë

	)

54 
	#DFPR
(
N
Ë(((NË=31Ë? 
DNA
 : ((N)+32))

	)

57 
	#DFPCR
 (0+32+32)

	)

58 
	#DUNIQ
 (1+32+32)

	)

59 
	#DTMP
 (2+32+32)

	)

	@ss/ss_machine.c

25 
	~"../comm⁄.h
"

26 
	~"ss_machöe.h
"

28 
pùe_ibuf_size
, 
pùe_iwö_size
;

34 
	gpfu_qu™t
[] = {

45 
ss_pfu_˛ass
 
	gfu2pfu
[] = {

46 
P_FUCœss_NA
,

47 
P_I¡ALU
,

48 
P_I¡_Mu…_Div
,

49 
P_I¡_Mu…_Div
,

50 
P_FP_Addî
,

51 
P_FP_Addî
,

52 
P_FP_Addî
,

53 
P_FP_Mu…_Div
,

54 
P_FP_Mu…_Div
,

55 
P_FP_Mu…_Div
,

56 
P_Mem_P‹t
,

57 
P_Mem_P‹t


79 
ønge_t
 
	gfu_œt
[] = {

98 
	$ö°_wö_size_ss
()

100  
pùe_ibuf_size
 + 
pùe_iwö_size
;

101 
	}
}

	@ss/ss_machine.h

22 #i‚de‡
SS_MACHINE_H


23 
	#SS_MaCHINE_H


	)

25 
	~"../comm⁄.h
"

28 íum { 
	mSTAGE_IF
, 
	mSTAGE_ID
, 
	mSTAGE_EX
, 
	mSTAGE_WB
, 
	mSTAGE_CM
 };

31 
	ess_pfu_˛ass
 {

32 
	mP_FUCœss_NA
 = 0,

33 
	mP_I¡ALU
,

34 
	mP_I¡_Mu…_Div
,

35 
	mP_Mem_P‹t
,

36 
	mP_FP_Addî
,

37 
	mP_FP_Mu…_Div
,

38 
	mNUM_PFU_CLASSES


	@ss/ss_readfile.c

22 
	~<°dio.h
>

23 
	~"ecoff.h
"

24 
	~"symbﬁ.h
"

25 
	~"../cfg.h
"

26 
	~"../comm⁄.h
"

30 
¥og_t
 
¥og
;

31 
addr_t
 *
	g¥ocs_addr
;

32 
	gnum_¥ocs
;

37 
	#TEXT_TAIL_PADDING
 128

	)

40 
md_addr_t
 
	gld_ãxt_ba£
 = 0;

42 
	gld_ãxt_size
 = 0;

43 
	gãxt_íåy
;

44 
	gãxt_off£t
;

45 
sym_sym_t
 **
sym_ãxtsyms
;

46 
sym_¡extsyms
;

53 
	$is_lib_func
(*
func_«me
)

55 i‡((
	`°rcmp
(
func_«me
, "__do_global_dtors") == 0)

56 || (
	`°rcmp
(
func_«me
, "__libc_init") == 0))

60 
	}
}

67 
	$lookup_addr
(*
‚ame
)

69 
i
, 
size
 = 0, 
max_num_¥ocs
 = 16;

70 
sym_sym_t
 *
sym
;

72 
	`sym_lﬂdsyms
(
‚ame
, 1);

74 
¥og
.
°¨t_addr
 = 
sym_ãxtsyms
[0]->
addr
;

75 
¥ocs_addr
 = (
md_addr_t
 *Ë
	`ˇŒoc
(
max_num_¥ocs
, (md_addr_t));

76 
i
=0; i < 
sym_¡extsyms
; i++) {

77 
sym
 = 
sym_ãxtsyms
[
i
];

78 i‡(
	`is_lib_func
(
sym
->
«me
))

80 i‡(
	`°rcmp
(
sym
->
«me
, "main") == 0)

81 
¥og
.
maö_addr
 = 
sym
->
addr
;

82 i‡(
num_¥ocs
 >
max_num_¥ocs
) {

83 
max_num_¥ocs
 *= 2;

84 
¥ocs_addr
 = (
md_addr_t
 *Ë
	`ªÆloc
(procs_addr,

85 
max_num_¥ocs
 * (
md_addr_t
));

87 
¥ocs_addr
[
num_¥ocs
++] = 
sym
->
addr
;

88 
¥og
.
code_size
 +
sym
->
size
;

90 
¥og
.
íd_addr
 =Örog.
°¨t_addr
 +Örog.
code_size
;

91 
	}
}

97 
	$ªad_ãxt_hód
(
FILE
 *
Â
)

99 
pos
;

100 
ecoff_fûehdr
 
fhdr
;

101 
ecoff_aouthdr
 
ahdr
;

102 
ecoff_s˙hdr
 
shdr
;

103 
ãxt_size
;

104 
i
;

105 
md_›code
 
›
;

107 
	`md_öô_decodî
();

110 
	`f£ek
(
Â
, 0, 
SEEK_SET
);

111 
	`‰ód
(&
fhdr
, (fhdr), 1, 
Â
);

112 
	`‰ód
(&
ahdr
, ◊hdr), 1, 
Â
);

113 
i
=0; i<
fhdr
.
f_ns˙s
; i++) {

114 
	`‰ód
(&
shdr
, (shdr), 1, 
Â
);

115 i‡(
shdr
.
s_Êags
 !
ECOFF_STYP_TEXT
)

117 
ãxt_size
 = 
shdr
.
s_size
;

118 
ãxt_off£t
 = 
shdr
.
s_s˙±r
;

119 
ãxt_íåy
 = 
shdr
.
s_vaddr
;

120 
ld_ãxt_size
 = ((
shdr
.
s_vaddr
 + shdr.
s_size
Ë- 
MD_TEXT_BASE
)

121 + 
TEXT_TAIL_PADDING
;

123 
ãxt_off£t
 +
¥og
.
°¨t_addr
 - 
ãxt_íåy
;

124 
ld_ãxt_ba£
 = 
MD_TEXT_BASE
;

125 
	}
}

132 
	$ªad_ö°
(
FILE
 *
Â
, 
addr_t
 
addr
, 
i
)

134 
md_ö°_t
 
ö°
;

135 
›
;

137 
	`‰ód
(&
ö°
, (ö°), 1, 
Â
);

138 
¥og
.
code
[
i
].
addr
 =áddr;

139 
¥og
.
code
[
i
].
size
 = (
md_ö°_t
);

140 
	`MD_SET_OPCODE
(
›
, 
ö°
);

141 
¥og
.
code
[
i
].
›_íum
 = 
	`MD_OP_ENUM
(
›
);

142 
	`decode_ö°
(&
¥og
.
code
[
i
], 
ö°
);

143 
	}
}

149 
	$ªad_code_ss
(*
‚ame
)

151 
FILE
 *
Â
;

152 
i
;

153 
addr_t
 
addr
;

155 
	`lookup_addr
(
‚ame
);

157 
Â
 = 
	`f›í
(
‚ame
, "r");

158 
	`ªad_ãxt_hód
(
Â
);

159 
¥og
.
num_ö°
 =Örog.
code_size
 / (
md_ö°_t
);

160 
¥og
.
code
 = (
de_ö°_t
 *Ë
	`ˇŒoc
’rog.
num_ö°
, (de_inst_t));

161 
	`CHECK_MEM
(
¥og
.
code
);

162 
addr
 = 
¥og
.
°¨t_addr
;

164 
	`f£ek
(
Â
, 
ãxt_off£t
, 
SEEK_SET
);

165 
i
 = 0; i < 
¥og
.
num_ö°
; i++) {

166 
	`ªad_ö°
(
Â
, 
addr
, 
i
);

167 
addr
 +(
md_ö°_t
);

173 i‡(
¥og
.
code
[¥og.
num_ö°
-1].
›_íum
 =
NOP
) {

174 
¥og
.
num_ö°
--;

175 
¥og
.
code_size
 -(
md_ö°_t
);

176 
¥og
.
íd_addr
 -(
md_ö°_t
);

179 
	`f˛o£
(
Â
);

180 
	}
}

	@ss/symbol.c

52 
	~<°dio.h
>

53 
	~<°dlib.h
>

55 
	~"ho°.h
"

57 #ifde‡
BFD_LOADER


58 
	~<bfd.h
>

60 
	~"ecoff.h
"

63 
	~"symbﬁ.h
"

68 
sym_sym_t
 *
	gsym_db
 = 
NULL
;

71 
	gsym_nsyms
 = 0;

72 
sym_sym_t
 **
	gsym_syms
 = 
NULL
;

75 
sym_sym_t
 **
	gsym_syms_by_«me
 = 
NULL
;

78 
	gsym_¡extsyms
 = 0;

79 
sym_sym_t
 **
	gsym_ãxtsyms
 = 
NULL
;

82 
sym_sym_t
 **
	gsym_ãxtsyms_by_«me
 = 
NULL
;

85 
	gsym_nd©asyms
 = 0;

86 
sym_sym_t
 **
	gsym_d©asyms
 = 
NULL
;

89 
sym_sym_t
 **
	gsym_d©asyms_by_«me
 = 
NULL
;

92 
	gsyms_lﬂded
 = 
FALSE
;

94 
ld_ãxt_ba£
, 
ld_ãxt_size
;

96 #ifde‡
PRINT_SYMS


99 
	$Êags2°r
(
Êags
)

101 
buf
[256];

102 *
p
;

104 i‡(!
Êags
)

107 
p
 = 
buf
;

108 *
p
 = '\0';

110 i‡(
Êags
 & 
BSF_LOCAL
)

112 *
p
++ = 'L';

113 *
p
++ = '|';

115 i‡(
Êags
 & 
BSF_GLOBAL
)

117 *
p
++ = 'G';

118 *
p
++ = '|';

120 i‡(
Êags
 & 
BSF_DEBUGGING
)

122 *
p
++ = 'D';

123 *
p
++ = '|';

125 i‡(
Êags
 & 
BSF_FUNCTION
)

127 *
p
++ = 'F';

128 *
p
++ = '|';

130 i‡(
Êags
 & 
BSF_KEEP
)

132 *
p
++ = 'K';

133 *
p
++ = '|';

135 i‡(
Êags
 & 
BSF_KEEP_G
)

137 *
p
++ = 'k'; *p++ = '|';

139 i‡(
Êags
 & 
BSF_WEAK
)

141 *
p
++ = 'W';

142 *
p
++ = '|';

144 i‡(
Êags
 & 
BSF_SECTION_SYM
)

146 *
p
++ = 'S'; *p++ = '|';

148 i‡(
Êags
 & 
BSF_OLD_COMMON
)

150 *
p
++ = 'O';

151 *
p
++ = '|';

153 i‡(
Êags
 & 
BSF_NOT_AT_END
)

155 *
p
++ = 'N';

156 *
p
++ = '|';

158 i‡(
Êags
 & 
BSF_CONSTRUCTOR
)

160 *
p
++ = 'C';

161 *
p
++ = '|';

163 i‡(
Êags
 & 
BSF_WARNING
)

165 *
p
++ = 'w';

166 *
p
++ = '|';

168 i‡(
Êags
 & 
BSF_INDIRECT
)

170 *
p
++ = 'I';

171 *
p
++ = '|';

173 i‡(
Êags
 & 
BSF_FILE
)

175 *
p
++ = 'f';

176 *
p
++ = '|';

179 i‡(
p
 =
buf
)

180 
	`∑nic
("no flags detected");

182 *--
p
 = '\0';

183  
buf
;

184 
	}
}

189 
	$acmp
(
sym_sym_t
 **
sym1
, sym_sym_à**
sym2
)

191  ()((*
sym1
)->
addr
 - (*
sym2
)->addr);

192 
	}
}

196 
	$ncmp
(
sym_sym_t
 **
sym1
, sym_sym_à**
sym2
)

198  
	`°rcmp
((*
sym1
)->
«me
, (*
sym2
)->name);

199 
	}
}

201 
	#RELEVANT_SCOPE
(
SYM
Ë\

	)

203 ((
	gSYM
)->
	gÊags
 & 
	gBSF_GLOBAL
) \

205 (((
	gSYM
)->
	gÊags
 & (
	gBSF_LOCAL
|
	gBSF_DEBUGGING
)Ë=
BSF_LOCAL
) \

206 && (
SYM
)->
«me
[0] != '$') \

208 
lﬂd_loˇls
 \

210 ((
SYM
)->
Êags
&(
BSF_LOCAL
|
BSF_DEBUGGING
))==(BSF_LOCAL|BSF_DEBUGGING)\

211 && (
SYM
)->
«me
[0] == '$') \

213 ((
SYM
)->
Êags
 & (
BSF_LOCAL
|
BSF_DEBUGGING
)) == (BSF_LOCAL) \

214 && (
SYM
)->
«me
[0] == '$'))))

219 
	$sym_lﬂdsyms
(*
‚ame
,

220 
lﬂd_loˇls
)

222 
i
, 
debug_˙t
;

223 
Àn
;

224 
FILE
 *
fobj
;

225 
ecoff_fûehdr
 
fhdr
;

226 
ecoff_aouthdr
 
ahdr
;

227 
ecoff_symhdr_t
 
symhdr
;

228 *
°πab
 = 
NULL
;

229 
ecoff_EXTR
 *
exå
;

231 i‡(
syms_lﬂded
)

238 
fobj
 = 
	`f›í
(
‚ame
, "r");

239 i‡(!
fobj
)

240 
	`Áèl
("ˇ¬Ÿ o≥¿execuèbÀ `%s'", 
‚ame
);

242 i‡(
	`‰ód
(&
fhdr
, (
ecoff_fûehdr
), 1, 
fobj
) < 1)

243 
	`Áèl
("ˇ¬ŸÑód hódî fromÉxecuèbÀ `%s'", 
‚ame
);

246 i‡(
fhdr
.
f_magic
 !
ECOFF_EB_MAGIC
 && fhdr.f_magi¯!
ECOFF_EL_MAGIC
)

247 
	`Áèl
("bad magi¯numbî i¿execuèbÀ `%s'", 
‚ame
);

249 i‡(
	`‰ód
(&
ahdr
, (
ecoff_aouthdr
), 1, 
fobj
) < 1)

250 
	`Áèl
("ˇ¬ŸÑód AOUT hódî fromÉxecuèbÀ `%s'", 
‚ame
);

253 
	`f£ek
(
fobj
, 
fhdr
.
f_sym±r
, 0);

255 i‡(
	`‰ód
(&
symhdr
, (
ecoff_symhdr_t
), 1, 
fobj
) < 1)

256 
	`Áèl
("couldÇŸÑód symbﬁi¯hódî fromÉxecuèbÀ `%s'", 
‚ame
);

258 i‡(
symhdr
.
magic
 !
ECOFF_magicSym
)

259 
	`Áèl
("bad magi¯numbî (0x%xËö symbﬁi¯hódî", 
symhdr
.
magic
);

262 
Àn
 = 
symhdr
.
issMax
 + symhdr.
issExtMax
;

263 
°πab
 = (*)
	`ˇŒoc
(
Àn
, ());

264 i‡(!
°πab
)

265 
	`Áèl
("out of virtual memory");

268 
	`f£ek
(
fobj
, 
symhdr
.
cbSsOff£t
, 0);

269 i‡(
	`‰ód
(
°πab
, 
Àn
, 1, 
fobj
) < 0)

270 
	`Áèl
("error whileÑeading symbolÅableÇames");

273 
Àn
 = 
symhdr
.
isymMax
 + symhdr.
õxtMax
;

274 i‡(
Àn
 <= 0)

275 
	`Áèl
("`%s' ha†nÿãxà‹ d©®symbﬁs", 
‚ame
);

276 
sym_db
 = (
sym_sym_t
 *)
	`ˇŒoc
(
Àn
, (sym_sym_t));

277 i‡(!
sym_db
)

278 
	`Áèl
("out of virtual memory");

281 
exå
 =

282 (
ecoff_EXTR
 *)
	`ˇŒoc
(
symhdr
.
õxtMax
, (ecoff_EXTR));

283 i‡(!
exå
)

284 
	`Áèl
("out of virtual memory");

286 
	`f£ek
(
fobj
, 
symhdr
.
cbExtOff£t
, 0);

287 i‡(
	`‰ód
(
exå
, (
ecoff_EXTR
), 
symhdr
.
õxtMax
, 
fobj
) < 0)

288 
	`Áèl
("errorÑeadingÉxternal symbolÉntries");

290 
sym_nsyms
 = 0; 
sym_nd©asyms
 = 0; 
sym_¡extsyms
 = 0;

293 
i
=0; i < 
symhdr
.
õxtMax
; i++)

295 
°r_off£t
;

297 
°r_off£t
 = 
symhdr
.
issMax
 + 
exå
[
i
].
asym
.
iss
;

299 
exå
[
i
].
asym
.
°
)

301 
ECOFF_°GlobÆ
:

302 
ECOFF_°Sètic
:

304 
sym_db
[
sym_nsyms
].
«me
 = 
	`my°rdup
(&
°πab
[
°r_off£t
]);

305 
sym_db
[
sym_nsyms
].
£g
 = 
ss_d©a
;

306 
sym_db
[
sym_nsyms
].
öôülized
 = 
TRUE
;

307 
sym_db
[
sym_nsyms
].
pub
 = 
TRUE
;

308 
sym_db
[
sym_nsyms
].
loˇl
 = 
FALSE
;

309 
sym_db
[
sym_nsyms
].
addr
 = 
exå
[
i
].
asym
.
vÆue
;

310 
sym_nsyms
++;

311 
sym_nd©asyms
++;

314 
ECOFF_°Proc
:

315 
ECOFF_°SèticProc
:

316 
ECOFF_°Labñ
:

318 
sym_db
[
sym_nsyms
].
«me
 = 
	`my°rdup
(&
°πab
[
°r_off£t
]);

319 
sym_db
[
sym_nsyms
].
£g
 = 
ss_ãxt
;

320 
sym_db
[
sym_nsyms
].
öôülized
 = 
TRUE
;

321 
sym_db
[
sym_nsyms
].
pub
 = 
TRUE
;

322 
sym_db
[
sym_nsyms
].
loˇl
 = 
FALSE
;

323 
sym_db
[
sym_nsyms
].
addr
 = 
exå
[
i
].
asym
.
vÆue
;

324 
sym_nsyms
++;

325 
sym_¡extsyms
++;

332 
	`‰ì
(
exå
);

335 i‡(
	`f˛o£
(
fobj
))

336 
	`Áèl
("couldÇŸ clo£ÉxecuèbÀ `%s'", 
‚ame
);

343 
sym_syms
 =

344 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_nsyms
, (sym_sym_t *));

345 i‡(!
sym_syms
)

346 
	`Áèl
("out of virtual memory");

348 
sym_syms_by_«me
 =

349 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_nsyms
, (sym_sym_t *));

350 i‡(!
sym_syms_by_«me
)

351 
	`Áèl
("out of virtual memory");

353 
debug_˙t
=0, 
i
=0; i<
sym_nsyms
; i++)

355 
sym_syms
[
debug_˙t
] = &
sym_db
[
i
];

356 
sym_syms_by_«me
[
debug_˙t
] = &
sym_db
[
i
];

357 
debug_˙t
++;

360 i‡(
debug_˙t
 !
sym_nsyms
)

361 
	`∑nic
("couldÇotÜocateáll symbols");

364 
	`qs‹t
(
sym_syms
, 
sym_nsyms
, (
sym_sym_t
 *), (*)
acmp
);

367 
	`qs‹t
(
sym_syms_by_«me
, 
sym_nsyms
, (
sym_sym_t
 *), (*)
ncmp
);

370 
sym_ãxtsyms
 =

371 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_¡extsyms
, (sym_sym_t *));

372 i‡(!
sym_ãxtsyms
)

373 
	`Áèl
("out of virtual memory");

375 
sym_ãxtsyms_by_«me
 =

376 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_¡extsyms
, (sym_sym_t *));

377 i‡(!
sym_ãxtsyms_by_«me
)

378 
	`Áèl
("out of virtual memory");

380 
debug_˙t
=0, 
i
=0; i<
sym_nsyms
; i++)

382 i‡(
sym_db
[
i
].
£g
 =
ss_ãxt
)

384 
sym_ãxtsyms
[
debug_˙t
] = &
sym_db
[
i
];

385 
sym_ãxtsyms_by_«me
[
debug_˙t
] = &
sym_db
[
i
];

386 
debug_˙t
++;

390 i‡(
debug_˙t
 !
sym_¡extsyms
)

391 
	`∑nic
("couldÇotÜocateállÅext symbols");

394 
	`qs‹t
(
sym_ãxtsyms
, 
sym_¡extsyms
, (
sym_sym_t
 *), (*)
acmp
);

397 
	`qs‹t
(
sym_ãxtsyms_by_«me
, 
sym_¡extsyms
,

398 (
sym_sym_t
 *), (*)
ncmp
);

401 
sym_d©asyms
 =

402 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_nd©asyms
, (sym_sym_t *));

403 i‡(!
sym_d©asyms
)

404 
	`Áèl
("out of virtual memory");

406 
sym_d©asyms_by_«me
 =

407 (
sym_sym_t
 **)
	`ˇŒoc
(
sym_nd©asyms
, (sym_sym_t *));

408 i‡(!
sym_d©asyms_by_«me
)

409 
	`Áèl
("out of virtual memory");

411 
debug_˙t
=0, 
i
=0; i<
sym_nsyms
; i++)

413 i‡(
sym_db
[
i
].
£g
 =
ss_d©a
)

415 
sym_d©asyms
[
debug_˙t
] = &
sym_db
[
i
];

416 
sym_d©asyms_by_«me
[
debug_˙t
] = &
sym_db
[
i
];

417 
debug_˙t
++;

421 i‡(
debug_˙t
 !
sym_nd©asyms
)

422 
	`∑nic
("couldÇotÜocateáll data symbols");

425 
	`qs‹t
(
sym_d©asyms
, 
sym_nd©asyms
, (
sym_sym_t
 *), (*)
acmp
);

428 
	`qs‹t
(
sym_d©asyms_by_«me
, 
sym_nd©asyms
,

429 (
sym_sym_t
 *), (*)
ncmp
);

432 
i
=0; i<
sym_¡extsyms
; i++)

434 
sym_ãxtsyms
[
i
]->
size
 =

435 (
i
 !(
sym_¡extsyms
 - 1)

436 ? (
sym_ãxtsyms
[
i
+1]->
addr
 - sym_textsyms[i]->addr)

437 : ((
ld_ãxt_ba£
 + 
ld_ãxt_size
Ë- 
sym_ãxtsyms
[
i
]->
addr
));

441 
i
=0; i<
sym_nd©asyms
; i++)

443 
sym_d©asyms
[
i
]->
size
 =

444 (
i
 !(
sym_nd©asyms
 - 1)

445 ? (
sym_d©asyms
[
i
+1]->
addr
 - sym_datasyms[i]->addr)

446 : ((
ld_d©a_ba£
 + 
ld_d©a_size
Ë- 
sym_d©asyms
[
i
]->
addr
));

451 
syms_lﬂded
 = 
TRUE
;

452 
	}
}

456 
	$sym_dumpsym
(
sym_sym_t
 *
sym
,

457 
FILE
 *
fd
)

459 
	`Ârötf
(
fd
,

461 
sym
->
«me
,

462 
sym
->
£g
 =
ss_d©a
 ? "data" : "text",

463 
sym
->
öôülized
 ? "y" : "n",

464 
sym
->
pub
 ? "y" : "n",

465 
sym
->
loˇl
 ? "y" : "n",

466 
sym
->
addr
,

467 
sym
->
size
);

468 
	}
}

472 
	$sym_dumpsyms
(
FILE
 *
fd
)

474 
i
;

476 
i
=0; i < 
sym_nsyms
; i++)

477 
	`sym_dumpsym
(
sym_syms
[
i
], 
fd
);

478 
	}
}

482 
	$sym_dum±extsyms
(
FILE
 *
fd
)

484 
i
;

486 
i
=0; i < 
sym_¡extsyms
; i++)

487 
	`sym_dumpsym
(
sym_ãxtsyms
[
i
], 
fd
);

488 
	}
}

492 
	$sym_dump°©e
(
FILE
 *
fd
)

494 
i
;

496 i‡(
fd
 =
NULL
)

497 
fd
 = 
°dîr
;

499 
	`Ârötf
(
fd
, "** All symbols sorted byáddress:\n");

500 
i
=0; i < 
sym_nsyms
; i++)

501 
	`sym_dumpsym
(
sym_syms
[
i
], 
fd
);

503 
	`Ârötf
(
fd
, "\n** All symbols sorted byÇame:\n");

504 
i
=0; i < 
sym_nsyms
; i++)

505 
	`sym_dumpsym
(
sym_syms_by_«me
[
i
], 
fd
);

507 
	`Ârötf
(
fd
, "** Text symbols sorted byáddress:\n");

508 
i
=0; i < 
sym_¡extsyms
; i++)

509 
	`sym_dumpsym
(
sym_ãxtsyms
[
i
], 
fd
);

511 
	`Ârötf
(
fd
, "\n** Text symbols sorted byÇame:\n");

512 
i
=0; i < 
sym_¡extsyms
; i++)

513 
	`sym_dumpsym
(
sym_ãxtsyms_by_«me
[
i
], 
fd
);

515 
	`Ârötf
(
fd
, "** Data symbols sorted byáddress:\n");

516 
i
=0; i < 
sym_nd©asyms
; i++)

517 
	`sym_dumpsym
(
sym_d©asyms
[
i
], 
fd
);

519 
	`Ârötf
(
fd
, "\n** Data symbols sorted byÇame:\n");

520 
i
=0; i < 
sym_nd©asyms
; i++)

521 
	`sym_dumpsym
(
sym_d©asyms_by_«me
[
i
], 
fd
);

522 
	}
}

528 
sym_sym_t
 *

529 
	$sym_böd_addr
(
md_addr_t
 
addr
,

530 *
pödex
,

531 
exa˘
,

532 
sym_db_t
 
db
)

534 
nsyms
, 
low
, 
high
, 
pos
;

535 
sym_sym_t
 **
syms
;

537 
db
)

539 
sdb_™y
:

540 
syms
 = 
sym_syms
;

541 
nsyms
 = 
sym_nsyms
;

543 
sdb_ãxt
:

544 
syms
 = 
sym_ãxtsyms
;

545 
nsyms
 = 
sym_¡extsyms
;

547 
sdb_d©a
:

548 
syms
 = 
sym_d©asyms
;

549 
nsyms
 = 
sym_nd©asyms
;

552 
	`∑nic
("bogus symbol database");

556 i‡(!
nsyms
)

558 i‡(
pödex
)

559 *
pödex
 = -1;

560  
NULL
;

564 
low
 = 0;

565 
high
 = 
nsyms
-1;

566 
pos
 = (
low
 + 
high
) >> 1;

568 (
exa˘
 && 
syms
[
pos
]->
addr
 ==áddr)

570 || (!
exa˘


571 && 
syms
[
pos
]->
addr
 <=áddr

572 && 
addr
 < (
syms
[
pos
]->add∏+ 
	`MAX
(1, syms[pos]->
size
)))))

574 i‡(
addr
 < 
syms
[
pos
]->addr)

575 
high
 = 
pos
 - 1;

577 
low
 = 
pos
 + 1;

578 i‡(
high
 >
low
)

579 
pos
 = (
low
 + 
high
) >> 1;

582 i‡(
pödex
)

583 *
pödex
 = -1;

584  
NULL
;

589 i‡(
pödex
)

590 *
pödex
 = 
pos
;

591  
syms
[
pos
];

592 
	}
}

597 
sym_sym_t
 *

598 
	$sym_böd_«me
(*
«me
,

599 *
pödex
,

600 
sym_db_t
 
db
)

602 
nsyms
, 
low
, 
high
, 
pos
, 
cmp
;

603 
sym_sym_t
 **
syms
;

605 
db
)

607 
sdb_™y
:

608 
syms
 = 
sym_syms_by_«me
;

609 
nsyms
 = 
sym_nsyms
;

611 
sdb_ãxt
:

612 
syms
 = 
sym_ãxtsyms_by_«me
;

613 
nsyms
 = 
sym_¡extsyms
;

615 
sdb_d©a
:

616 
syms
 = 
sym_d©asyms_by_«me
;

617 
nsyms
 = 
sym_nd©asyms
;

620 
	`∑nic
("bogus symbol database");

624 i‡(!
nsyms
)

626 i‡(
pödex
)

627 *
pödex
 = -1;

628  
NULL
;

632 
low
 = 0;

633 
high
 = 
nsyms
-1;

634 
pos
 = (
low
 + 
high
) >> 1;

635 !–!(
cmp
 = 
	`°rcmp
(
syms
[
pos
]->
«me
,Çame))))

637 i‡(
cmp
 > 0)

638 
high
 = 
pos
 - 1;

640 
low
 = 
pos
 + 1;

641 i‡(
high
 >
low
)

642 
pos
 = (
low
 + 
high
) >> 1;

645 i‡(
pödex
)

646 *
pödex
 = -1;

647  
NULL
;

652 i‡(
pödex
)

653 *
pödex
 = 
pos
;

654  
syms
[
pos
];

655 
	}
}

	@ss/symbol.h

52 #i‚de‡
SYMBOL_H


53 
	#SYMBOL_H


	)

55 
	~<°dio.h
>

57 
	~"ho°.h
"

59 
	~"machöe.h
"

61 
	esym_£g_t
 {

62 
	mss_d©a
,

63 
	mss_ãxt
,

64 
	mss_NUM


68 
	ssym_sym_t
 {

69 *
	m«me
;

70 
sym_£g_t
 
	m£g
;

71 
	möôülized
;

72 
	mpub
;

73 
	mloˇl
;

74 
md_addr_t
 
	maddr
;

75 
	msize
;

79 
sym_sym_t
 *
sym_db
;

82 
sym_nsyms
;

83 
sym_sym_t
 **
sym_syms
;

86 
sym_sym_t
 **
sym_syms_by_«me
;

89 
sym_¡extsyms
;

90 
sym_sym_t
 **
sym_ãxtsyms
;

93 
sym_sym_t
 **
sym_ãxtsyms_by_«me
;

96 
sym_nd©asyms
;

97 
sym_sym_t
 **
sym_d©asyms
;

100 
sym_sym_t
 **
sym_d©asyms_by_«me
;

104 
sym_lﬂdsyms
(*
‚ame
,

105 
lﬂd_loˇls
);

109 
sym_dumpsym
(
sym_sym_t
 *
sym
,

110 
FILE
 *
fd
);

114 
sym_dumpsyms
(
FILE
 *
fd
);

118 
sym_dump°©e
(
FILE
 *
fd
);

121 
	esym_db_t
 {

122 
	msdb_™y
,

123 
	msdb_ãxt
,

124 
	msdb_d©a
,

125 
	msdb_NUM


132 
sym_sym_t
 *

133 
sym_böd_addr
(
md_addr_t
 
addr
,

134 *
pödex
,

135 
exa˘
,

136 
sym_db_t
 
db
);

141 
sym_sym_t
 *

142 
sym_böd_«me
(*
«me
,

143 *
pödex
,

144 
sym_db_t
 
db
);

	@symexec.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~"cfg.h
"

27 
	~"ö„asibÀ.h
"

31 
	$addAssign
–
dîôªe
[], 
cfg_node_t
 *
bb
, 
löío
, 
rhs
, 
rhs_v¨
 ) {

33 
i
;

34 
assign_t
 *
assg
;

35 
öf_node_t
 *
ib
;

37 
ib
 = &(
öf_¥ocs
[
bb
->
¥oc
->
id
].
öf_cfg
[bb->id]);

40  
i
 = 0; i < 
ib
->
num_assign
; i++ ) {

41 
assg
 = 
ib
->
assig∆i°
[
i
];

43 if–
	`°ªq
–
assg
->
dîôªe
, deritree )) {

45 
assg
->
löío
 =Üineno;

46 
assg
->
rhs
 =Ñhs;

47 
assg
->
rhs_v¨
 =Ñhs_var;

55 
assg
 = (
assign_t
*Ë
	`mÆloc
( (assign_t) );

56 
	`°r˝y
–
assg
->
dîôªe
, deritree );

57 
assg
->
rhs
 =Ñhs;

58 
assg
->
rhs_v¨
 =Ñhs_var;

59 
assg
->
bb
 = bb;

60 
assg
->
löío
 =Üineno;

62 
ib
->
num_assign
++;

64 
i
 = 
ib
->
num_assign
;

65 
ib
->
assig∆i°
 = (
assign_t
**Ë
	`ªÆloc
–ib->assig∆i°, 
i
 * (assign_t*) );

66 
ib
->
assig∆i°
[
i
-1] = 
assg
;

70 
	}
}

72 
	$addBønch
–
dîôªe
[], 
cfg_node_t
 *
bb
, 
rhs
, 
rhs_v¨
, 
jump_c⁄d
 ) {

74 
i
;

75 
bønch_t
 *
br
;

77 
numbb
 = 
¥og
.
¥ocs
[
bb
->
¥oc
->
id
].
num_bb
;

79 
br
 = (
bønch_t
*Ë
	`mÆloc
( (branch_t) );

80 
	`°r˝y
–
br
->
dîôªe
, deritree );

81 
br
->
rhs
 =Ñhs;

82 
br
->
rhs_v¨
 =Ñhs_var;

83 
br
->
jump_c⁄d
 = jump_cond;

84 
br
->
bb
 = bb;

86 
br
->
num_BA_c⁄Êi˘s
 = 0;

87 
br
->
BA_c⁄Êi˘_li°
 = 
NULL
;

88 
br
->
num_BB_c⁄Êi˘s
 = 0;

89 
br
->
BB_c⁄Êi˘_li°
 = 
NULL
;

91 
öf_¥ocs
[
bb
->
¥oc
->
id
].
öf_cfg
[bb->id].
bønch
 = 
br
;

95 
	}
}

102 
	#PROCESS_LOAD
 \

	)

103 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

104 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

106 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

107 
•rötf
–
tmp
, "%d(%s)", 
©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

109 
•rötf
–
tmp
, "%d(%s)", 
©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
«me
 ); \

110 
	gªgvÆ
 = 0; \

111 
	gisC⁄°™t
 = 0; \

112 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

115 
	#PROCESS_LUI
 \

	)

116 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

118 
	gªgvÆ
 = 
©oi
(
ö¢
->
r2
) * 65536; \

119 
	gisC⁄°™t
 = 1; \

120 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

123 
	#PROCESS_ADDI
 \

	)

124 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

125 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

127 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

128 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

129 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
©oi
(
ö¢
->
r3
) ); \

131 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
«me
, 
©oi
(
ö¢
->
r3
) ); \

133 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 + 
©oi
(
ö¢
->
r3
); \

134 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

135 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

138 
	#PROCESS_ORI
 \

	)

139 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

140 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

142 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

143 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

144 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
©oi
(
ö¢
->
r3
) ); \

146 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
«me
, 
©oi
(
ö¢
->
r3
) ); \

148 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 | 
©oi
(
ö¢
->
r3
); \

149 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

150 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

153 
	#PROCESS_XORI
 \

	)

154 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

155 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

157 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

158 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

159 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
©oi
(
ö¢
->
r3
) ); \

161 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
«me
, 
©oi
(
ö¢
->
r3
) ); \

163 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 ^ 
©oi
(
ö¢
->
r3
); \

164 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

165 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

168 
	#PROCESS_ANDI
 \

	)

169 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

170 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

172 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

173 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

174 
•rötf
–
tmp
, "%s&%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
©oi
(
ö¢
->
r3
) ); \

176 
•rötf
–
tmp
, "%s&%d", 
ªgLi°
[
ªgPos2
].
«me
, 
©oi
(
ö¢
->
r3
) ); \

178 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 & 
©oi
(
ö¢
->
r3
); \

179 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

180 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

183 
	#PROCESS_SLL
 \

	)

185 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

186 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

188 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

189 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

190 
•rötf
–
tmp
, "%s<<%s", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
ö¢
->
r3
 ); \

192 
•rötf
–
tmp
, "%s<<%s", 
ªgLi°
[
ªgPos2
].
«me
, 
ö¢
->
r3
 ); \

194 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
; \

195 
	gpowî
 = 
hexVÆue
–
ö¢
->
r3
 ); \

196  
	gm
 = 0; m < 
	gpowî
 ; m++ ) \

197 
	gªgvÆ
 *= 2; \

198 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

199 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

202 
	#PROCESS_SRL
 \

	)

204 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

205 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

207 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

208 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

209 
•rötf
–
tmp
, "%s>>%s", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
ö¢
->
r3
 ); \

211 
•rötf
–
tmp
, "%s>>%s", 
ªgLi°
[
ªgPos2
].
«me
, 
ö¢
->
r3
 ); \

213 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
; \

214 
	gpowî
 = 
hexVÆue
–
ö¢
->
r3
 ); \

215  
	gm
 = 0; m < 
	gpowî
 ; m++ ) \

216 
	gªgvÆ
 /= 2; \

217 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

218 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

221 
	#PROCESS_SLTI
 \

	)

225 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

226 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

228 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

229 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

230 
°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

232 
°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

234 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) == 0 ) \

235 
°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

236 
	gªgvÆ
 = 
©oi
(
ö¢
->
r3
) ; \

237 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

238 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
SLTI
 ); \

241 
	#PROCESS_SLT
 \

	)

242 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

243 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

244 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

246 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 ) { \

247 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

248 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

250 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

251 if–!
	gªgLi°
[
ªgPos3
].
	gvÆid
 ) \

252 
°rˇt
–
tmp
, ":<" ); \

254 if–!
	gªgLi°
[
ªgPos3
].
	gvÆid
 ) { \

255 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

256 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

258 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

260 
	gªgvÆ
 = 
ªgLi°
[
ªgPos3
].
vÆue
 ; \

261 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

262 if–
	gªgLi°
[
ªgPos3
].
	gvÆid
 ) \

263 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
SLT
 ); \

265 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
KO
 ); \

268 
	#PROCESS_ADDU
 \

	)

269 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

270 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

271 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

273 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

274 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

275 
•rötf
–
tmp
, "%s+", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

277 
•rötf
–
tmp
, "%s+", 
ªgLi°
[
ªgPos2
].
«me
 ); \

278 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

279 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

281 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

283 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

284 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

285 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

287 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

289 if–
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

290 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

291 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

293 
•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

295 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 +ÑegLi°[
ªgPos3
].value; \

296 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

297 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

300 
	#PROCESS_SUBU
 \

	)

301 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

302 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

303 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

305 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

306 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

307 
•rötf
–
tmp
, "%s-", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

309 
•rötf
–
tmp
, "%s-", 
ªgLi°
[
ªgPos2
].
«me
 ); \

310 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

311 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

313 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

315 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

316 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

317 
•rötf
–
tmp
, "%s-%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

319 
•rötf
–
tmp
, "%s-%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

321 if–
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

322 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

323 
•rötf
–
tmp
, "%d-%s", 
ªgLi°
[
ªgPos2
].
vÆue
,ÑegLi°[
ªgPos3
].
dîôªe
 ); \

325 
•rötf
–
tmp
, "%d-%s", 
ªgLi°
[
ªgPos2
].
vÆue
,ÑegLi°[
ªgPos3
].
«me
 ); \

327 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 -ÑegLi°[
ªgPos3
].value; \

328 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

329 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

332 
	#PROCESS_OR
 \

	)

333 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

334 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

335 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

337 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

338 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

339 
•rötf
–
tmp
, "%s|", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

341 
•rötf
–
tmp
, "%s|", 
ªgLi°
[
ªgPos2
].
«me
 ); \

342 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

343 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

345 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

347 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

348 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

349 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

351 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

353 if–
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

354 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

355 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

357 
•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

359 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 |ÑegLi°[
ªgPos3
].value; \

360 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

361 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

364 
	#PROCESS_XOR
 \

	)

365 
	gªgPos1
 = 
födReg
–
ö¢
->
r1
 ); \

366 
	gªgPos2
 = 
födReg
–
ö¢
->
r2
 ); \

367 
	gªgPos3
 = 
födReg
–
ö¢
->
r3
 ); \

369 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

370 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

371 
•rötf
–
tmp
, "%s^", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

373 
•rötf
–
tmp
, "%s^", 
ªgLi°
[
ªgPos2
].
«me
 ); \

374 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

375 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

377 
°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

379 if–!
	gªgLi°
[
ªgPos2
].
	gvÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

380 if–
°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

381 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

383 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

385 if–
	gªgLi°
[
ªgPos2
].
	gvÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

386 if–
°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

387 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

389 
•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

391 
	gªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 ^ÑegLi°[
ªgPos3
].value; \

392 
	gisC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

393 
£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

396 
	#ADD_ASSIGN
 \

	)

397 if–!
°ªq
(
ö¢
->
r1
, "$31") && !streq(insn->r1, "$30") && \

398 !
°ªq
(
ö¢
->
r1
, "$29") && !streq(insn->r1, "$28") ) { \

399 if–
	gisC⁄°™t
 ) \

400 
addAssign
–
ö¢
->
r1
, 
ib
->
bb
, 
k
, 
ªgvÆ
, 0 ); \

402 
addAssign
–
ö¢
->
r1
, 
ib
->
bb
, 
k
, 0, 1 ); \

410 
	$execuã
() {

412 
i
, 
j
, 
k
, 
m
, 
id
;

413 
powî
;

414 
dúe˘i⁄
;

416 
ªgPos1
, 
ªgPos2
, 
ªgPos3
;

417 
ªgvÆ
;

418 
isC⁄°™t
;

420 
ö_ã°
;

421 
√wEf„˘
 = 1;

423 
tmp
[ 
DERI_LEN
 ];

424 
off£t
[ 
DERI_LEN
 ];

426 
jÆ
, 
ign‹e
;

428 
öf_¥oc_t
 *
p
;

429 
öf_node_t
 *
ib
;

430 
ö¢_t
 *
ö¢
;

433  
k
 = 0; k < 
num_ö¢_°
; k++ ) {

434 
ö¢
 = &(
ö¢li°_°
[
k
]);

437 
tmp
[0] = '\0';

439 if–
	`°ªq
(
ö¢
->
›
, "lw" ) || streq(insn->op, "lb") || streq(insn->op, "lbu") ||

440 
	`°ªq
(
ö¢
->
›
, "l.d") || streq(insn->op, "lh") )

442 
PROCESS_LOAD
;

444 if–
	`°ªq
(
ö¢
->
›
, "lui") )

446 
PROCESS_LUI
;

448 if–
	`°ªq
(
ö¢
->
›
, "addiu") || streq(insn->op, "addi") )

450 
PROCESS_ADDI
;

452 if–
	`°ªq
(
ö¢
->
›
, "ori") )

454 
PROCESS_ORI
;

456 if–
	`°ªq
(
ö¢
->
›
, "xori") )

458 
PROCESS_XORI
;

460 if–
	`°ªq
(
ö¢
->
›
, "andi") )

462 
PROCESS_ANDI
;

464 if–
	`°ªq
(
ö¢
->
›
, "sll") )

466 
PROCESS_SLL
;

468 if–
	`°ªq
(
ö¢
->
›
, "srl") )

470 
PROCESS_SRL
;

472 if–
	`°ªq
(
ö¢
->
›
, "slti") || streq(insn->op, "sltiu") )

474 
PROCESS_SLTI
;

476 if–
	`°ªq
(
ö¢
->
›
, "slt") || streq(insn->op, "sltu") )

478 
PROCESS_SLT
;

480 if–
	`°ªq
(
ö¢
->
›
, "addu") )

482 
PROCESS_ADDU
;

484 if–
	`°ªq
(
ö¢
->
›
, "subu") )

486 
PROCESS_SUBU
;

488 if–
	`°ªq
(
ö¢
->
›
, "or") )

490 
PROCESS_OR
;

492 if–
	`°ªq
(
ö¢
->
›
, "xor") )

494 
PROCESS_XOR
;

500  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

501 
p
 = &(
öf_¥ocs
[
i
]);

502 
jÆ
 = 0;

507  
j
 = 0; j < 
p
->
num_bb
; j++ ) {

508 
ib
 = &(
p
->
öf_cfg
[
j
]);

511 
	`˛órReg
();

513  
k
 = 0; k < 
ib
->
num_ö¢
; k++ ) {

514 
ö¢
 = &(
ib
->
ö¢li°
[
k
]);

517 
ign‹e
 = 
jÆ
;

518 
jÆ
 = 0;

520 
tmp
[0] = '\0';

523 if–
	`°ªq
(
ö¢
->
›
, "beq") || streq(insn->op, "bne") )

525 if–
ign‹e
 )

528 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

529 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 );

532 if(–
ªgLi°
[
ªgPos1
].
Êag
 =
SLTI
 ||ÑegLi°[ªgPos1].Êag =
SLT
 ) &&

533 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[ªgPos2].
vÆue
 == 0 ) {

536 if–
	`°ªq
(
ö¢
->
›
, "beq") )

538 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
,ÑegLi°[ªgPos1].
vÆue
, 0, 
GE
 );

541 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
,ÑegLi°[ªgPos1].
vÆue
, 0, 
LT
 );

543 if–
ªgLi°
[
ªgPos1
].
Êag
 =
NIL
 &&ÑegLi°[
ªgPos2
].flag == NIL ) {

549 if–
ªgLi°
[
ªgPos1
].
vÆid
 &&ÑegLi°[
ªgPos2
].valid )

552 if–!
ªgLi°
[
ªgPos1
].
vÆid
 && !ªgLi°[
ªgPos2
].valid )

555 if–!
ªgLi°
[
ªgPos1
].
vÆid
 &&ÑegLi°[
ªgPos2
].valid ) {

557 
ö_ã°
 = 
ªgPos1
;

558 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 -ÑegLi°[
ªgPos1
].value;

560 if–
ªgLi°
[
ªgPos1
].
vÆid
 && !ªgLi°[
ªgPos2
].valid ) {

562 
ö_ã°
 = 
ªgPos2
;

563 
ªgvÆ
 = 
ªgLi°
[
ªgPos1
].
vÆue
 -ÑegLi°[
ªgPos2
].value;

565 if–
	`°ªq
(
ö¢
->
›
, "bne") )

566 
	`addBønch
–
ªgLi°
[
ö_ã°
].
dîôªe
, 
ib
->
bb
, 
ªgvÆ
, 0, 
NE
 );

568 
	`addBønch
–
ªgLi°
[
ö_ã°
].
dîôªe
, 
ib
->
bb
, 
ªgvÆ
, 0, 
EQ
 );

571 if–
	`°ªq
(
ö¢
->
›
, "bgez") || streq(insn->op, "blez") || streq(insn->op, "bgtz") )

573 if–
ign‹e
 )

577 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

580 if–
	`°æí
(
ªgLi°
[
ªgPos1
].
dîôªe
) > 0 ) {

581 if–
	`°ªq
(
ö¢
->
›
, "bgez") )

582 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
GE
 );

583 if–
	`°ªq
(
ö¢
->
›
, "bgtz") )

584 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
GT
 );

586 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
LE
 );

591 if–
	`°ªq
(
ö¢
->
r1
, "$31") || streq(insn->r1, "$30") || streq(insn->r1, "$29") ||

592 
	`°ªq
(
ö¢
->
r1
, "$28"Ë|| såeq(ö¢->
r3
, "$29") )

596 if–
	`°ªq
(
ö¢
->
›
, "sw") || streq(insn->op, "sb" ) || streq(insn->op, "sh") || streq(insn->op, "sbu") )

598 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

599 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 );

603 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 )

604 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
dîôªe
 );

606 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
«me
 );

608 if–
ign‹e
 && 
	`°ªq
(
ö¢
->
r1
, 
REG_RETURN
) )

610 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 0, 1 );

612 if–
ªgLi°
[
ªgPos1
].
vÆid
 )

614 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 
ªgLi°
[
ªgPos1
].
vÆue
, 0 );

616 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 0, 1 );

618 if–
	`°ªq
(
ö¢
->
›
, "lw" ) || streq(insn->op, "lb") || streq(insn->op, "lbu") ||

619 
	`°ªq
(
ö¢
->
›
, "l.d") || streq(insn->op, "lh") )

621 
PROCESS_LOAD
;

622 
ADD_ASSIGN
;

624 if–
	`°ªq
(
ö¢
->
›
, "lui") )

626 
PROCESS_LUI
;

627 
ADD_ASSIGN
;

629 if–
	`°ªq
(
ö¢
->
›
, "addiu") || streq(insn->op, "addi") )

631 
PROCESS_ADDI
;

632 
ADD_ASSIGN
;

634 if–
	`°ªq
(
ö¢
->
›
, "ori") )

636 
PROCESS_ORI
;

637 
ADD_ASSIGN
;

639 if–
	`°ªq
(
ö¢
->
›
, "xori") )

641 
PROCESS_XORI
;

642 
ADD_ASSIGN
;

644 if–
	`°ªq
(
ö¢
->
›
, "andi") )

646 
PROCESS_ANDI
;

647 
ADD_ASSIGN
;

649 if–
	`°ªq
(
ö¢
->
›
, "sll") )

651 
PROCESS_SLL
;

652 
ADD_ASSIGN
;

654 if–
	`°ªq
(
ö¢
->
›
, "srl") )

656 
PROCESS_SRL
;

657 
ADD_ASSIGN
;

659 if–
	`°ªq
(
ö¢
->
›
, "slti") || streq(insn->op, "sltiu") )

661 
PROCESS_SLTI
;

662 
ADD_ASSIGN
;

664 if–
	`°ªq
(
ö¢
->
›
, "slt") || streq(insn->op, "sltu") )

666 
PROCESS_SLT
;

667 
ADD_ASSIGN
;

669 if–
	`°ªq
(
ö¢
->
›
, "addu") )

671 
PROCESS_ADDU
;

672 
ADD_ASSIGN
;

674 if–
	`°ªq
(
ö¢
->
›
, "subu") )

676 
PROCESS_SUBU
;

677 
ADD_ASSIGN
;

679 if–
	`°ªq
(
ö¢
->
›
, "or") )

681 
PROCESS_OR
;

682 
ADD_ASSIGN
;

684 if–
	`°ªq
(
ö¢
->
›
, "xor") )

686 
PROCESS_XOR
;

687 
ADD_ASSIGN
;

689 if–
	`°ªq
(
ö¢
->
›
, "jal") )

690 
jÆ
 = 1;

692 if–
	`°ªq
(
ö¢
->
›
, "j") );

703 
	}
}

	@symexec.cp.c

23 
	~<°dio.h
>

24 
	~<°dlib.h
>

25 
	~<°rög.h
>

26 
	~"cfg.h
"

27 
	~"ö„asibÀ.h
"

31 
	$addAssign
–
dîôªe
[], 
cfg_node_t
 *
bb
, 
löío
, 
rhs
, 
rhs_v¨
 ) {

33 
i
;

34 
assign_t
 *
assg
;

35 
öf_node_t
 *
ib
;

37 
ib
 = &(
öf_¥ocs
[
bb
->
¥oc
->
id
].
öf_cfg
[bb->id]);

40  
i
 = 0; i < 
ib
->
num_assign
; i++ ) {

41 
assg
 = 
ib
->
assig∆i°
[
i
];

43 if–
	`°ªq
–
assg
->
dîôªe
, deritree )) {

45 
assg
->
löío
 =Üineno;

46 
assg
->
rhs
 =Ñhs;

47 
assg
->
rhs_v¨
 =Ñhs_var;

55 
assg
 = (
assign_t
*Ë
	`mÆloc
( (assign_t) );

56 
	`°r˝y
–
assg
->
dîôªe
, deritree );

57 
assg
->
rhs
 =Ñhs;

58 
assg
->
rhs_v¨
 =Ñhs_var;

59 
assg
->
bb
 = bb;

60 
assg
->
löío
 =Üineno;

62 
ib
->
num_assign
++;

64 
i
 = 
ib
->
num_assign
;

65 
ib
->
assig∆i°
 = (
assign_t
**Ë
	`ªÆloc
–ib->assig∆i°, 
i
 * (assign_t*) );

66 
ib
->
assig∆i°
[
i
-1] = 
assg
;

70 
	}
}

72 
	$addBønch
–
dîôªe
[], 
cfg_node_t
 *
bb
, 
rhs
, 
rhs_v¨
, 
jump_c⁄d
 ) {

74 
i
;

75 
bønch_t
 *
br
;

77 
numbb
 = 
¥og
.
¥ocs
[
bb
->
¥oc
->
id
].
num_bb
;

79 
br
 = (
bønch_t
*Ë
	`mÆloc
( (branch_t) );

80 
	`°r˝y
–
br
->
dîôªe
, deritree );

81 
br
->
rhs
 =Ñhs;

82 
br
->
rhs_v¨
 =Ñhs_var;

83 
br
->
jump_c⁄d
 = jump_cond;

84 
br
->
bb
 = bb;

86 
br
->
num_BA_c⁄Êi˘s
 = 0;

87 
br
->
BA_c⁄Êi˘_li°
 = 
NULL
;

88 
br
->
num_BB_c⁄Êi˘s
 = 0;

89 
br
->
BB_c⁄Êi˘_li°
 = 
NULL
;

91 
öf_¥ocs
[
bb
->
¥oc
->
id
].
öf_cfg
[bb->id].
bønch
 = 
br
;

95 
	}
}

102 
	#PROCESS_LOAD
 \

103 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

104 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

106 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

107 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

109 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
«me
 ); \

110 
ªgvÆ
 = 0; \

111 
isC⁄°™t
 = 0; \

112 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

113 

	)

115 
	#PROCESS_LUI
 \

116 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

118 
ªgvÆ
 = 
	`©oi
(
ö¢
->
r2
) * 65536; \

119 
isC⁄°™t
 = 1; \

120 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

121 

	)

123 
	#PROCESS_ADDI
 \

124 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

125 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

127 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

128 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

129 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
	`©oi
(
ö¢
->
r3
) ); \

131 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
«me
, 
	`©oi
(
ö¢
->
r3
) ); \

133 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 + 
	`©oi
(
ö¢
->
r3
); \

134 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

135 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

136 

	)

138 
	#PROCESS_ORI
 \

139 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

140 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

142 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

143 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

144 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
	`©oi
(
ö¢
->
r3
) ); \

146 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
«me
, 
	`©oi
(
ö¢
->
r3
) ); \

148 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 | 
	`©oi
(
ö¢
->
r3
); \

149 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

150 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

151 

	)

153 
	#PROCESS_XORI
 \

154 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

155 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

157 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

158 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

159 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
	`©oi
(
ö¢
->
r3
) ); \

161 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
«me
, 
	`©oi
(
ö¢
->
r3
) ); \

163 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 ^ 
	`©oi
(
ö¢
->
r3
); \

164 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

165 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

166 

	)

168 
	#PROCESS_ANDI
 \

169 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

170 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

172 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

173 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

174 
	`•rötf
–
tmp
, "%s&%d", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
	`©oi
(
ö¢
->
r3
) ); \

176 
	`•rötf
–
tmp
, "%s&%d", 
ªgLi°
[
ªgPos2
].
«me
, 
	`©oi
(
ö¢
->
r3
) ); \

178 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 & 
	`©oi
(
ö¢
->
r3
); \

179 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

180 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

181 

	)

183 
	#PROCESS_SLL
 \

185 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

186 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

188 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

189 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

190 
	`•rötf
–
tmp
, "%s<<%s", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
ö¢
->
r3
 ); \

192 
	`•rötf
–
tmp
, "%s<<%s", 
ªgLi°
[
ªgPos2
].
«me
, 
ö¢
->
r3
 ); \

194 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
; \

195 
powî
 = 
	`hexVÆue
–
ö¢
->
r3
 ); \

196  
m
 = 0; m < 
powî
 ; m++ ) \

197 
ªgvÆ
 *= 2; \

198 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

199 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

200 

	)

202 
	#PROCESS_SRL
 \

204 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

205 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

207 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

208 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

209 
	`•rötf
–
tmp
, "%s>>%s", 
ªgLi°
[
ªgPos2
].
dîôªe
, 
ö¢
->
r3
 ); \

211 
	`•rötf
–
tmp
, "%s>>%s", 
ªgLi°
[
ªgPos2
].
«me
, 
ö¢
->
r3
 ); \

213 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
; \

214 
powî
 = 
	`hexVÆue
–
ö¢
->
r3
 ); \

215  
m
 = 0; m < 
powî
 ; m++ ) \

216 
ªgvÆ
 /= 2; \

217 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

218 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

219 

	)

221 
	#PROCESS_SLTI
 \

225 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

226 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

228 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

229 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

230 
	`°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

232 
	`°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

234 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) == 0 ) \

235 
	`°r˝y
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

236 
ªgvÆ
 = 
	`©oi
(
ö¢
->
r3
) ; \

237 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
; \

238 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
SLTI
 ); \

239 

	)

241 
	#PROCESS_SLT
 \

242 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

243 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

244 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

246 if–!
ªgLi°
[
ªgPos2
].
vÆid
 ) { \

247 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

248 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

250 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos2
].
«me
 ); \

251 if–!
ªgLi°
[
ªgPos3
].
vÆid
 ) \

252 
	`°rˇt
–
tmp
, ":<" ); \

254 if–!
ªgLi°
[
ªgPos3
].
vÆid
 ) { \

255 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

256 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

258 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

260 
ªgvÆ
 = 
ªgLi°
[
ªgPos3
].
vÆue
 ; \

261 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

262 if–
ªgLi°
[
ªgPos3
].
vÆid
 ) \

263 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
SLT
 ); \

265 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
KO
 ); \

266 

	)

268 
	#PROCESS_ADDU
 \

269 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

270 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

271 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

273 if–!
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

274 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

275 
	`•rötf
–
tmp
, "%s+", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

277 
	`•rötf
–
tmp
, "%s+", 
ªgLi°
[
ªgPos2
].
«me
 ); \

278 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

279 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

281 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

283 if–!
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

284 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

285 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

287 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

289 if–
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

290 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

291 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

293 
	`•rötf
–
tmp
, "%s+%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

295 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 +ÑegLi°[
ªgPos3
].value; \

296 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

297 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

298 

	)

300 
	#PROCESS_SUBU
 \

301 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

302 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

303 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

305 if–!
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

306 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

307 
	`•rötf
–
tmp
, "%s-", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

309 
	`•rötf
–
tmp
, "%s-", 
ªgLi°
[
ªgPos2
].
«me
 ); \

310 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

311 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

313 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

315 if–!
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

316 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

317 
	`•rötf
–
tmp
, "%s-%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

319 
	`•rötf
–
tmp
, "%s-%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

321 if–
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

322 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

323 
	`•rötf
–
tmp
, "%d-%s", 
ªgLi°
[
ªgPos2
].
vÆue
,ÑegLi°[
ªgPos3
].
dîôªe
 ); \

325 
	`•rötf
–
tmp
, "%d-%s", 
ªgLi°
[
ªgPos2
].
vÆue
,ÑegLi°[
ªgPos3
].
«me
 ); \

327 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 -ÑegLi°[
ªgPos3
].value; \

328 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

329 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

330 

	)

332 
	#PROCESS_OR
 \

333 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

334 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

335 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

337 if–!
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

338 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

339 
	`•rötf
–
tmp
, "%s|", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

341 
	`•rötf
–
tmp
, "%s|", 
ªgLi°
[
ªgPos2
].
«me
 ); \

342 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

343 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

345 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

347 if–!
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

348 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

349 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

351 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

353 if–
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

354 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

355 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

357 
	`•rötf
–
tmp
, "%s|%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

359 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 |ÑegLi°[
ªgPos3
].value; \

360 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

361 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

362 

	)

364 
	#PROCESS_XOR
 \

365 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 ); \

366 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 ); \

367 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 ); \

369 if–!
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

370 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

371 
	`•rötf
–
tmp
, "%s^", 
ªgLi°
[
ªgPos2
].
dîôªe
 ); \

373 
	`•rötf
–
tmp
, "%s^", 
ªgLi°
[
ªgPos2
].
«me
 ); \

374 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

375 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
dîôªe
 ); \

377 
	`°rˇt
–
tmp
, 
ªgLi°
[
ªgPos3
].
«me
 ); \

379 if–!
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid ) { \

380 if–
	`°æí
(
ªgLi°
[
ªgPos2
].
dîôªe
) > 0 ) \

381 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
dîôªe
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

383 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos2
].
«me
,ÑegLi°[
ªgPos3
].
vÆue
 ); \

385 if–
ªgLi°
[
ªgPos2
].
vÆid
 && !ªgLi°[
ªgPos3
].valid ) { \

386 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 ) \

387 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos3
].
dîôªe
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

389 
	`•rötf
–
tmp
, "%s^%d", 
ªgLi°
[
ªgPos3
].
«me
,ÑegLi°[
ªgPos2
].
vÆue
 ); \

391 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 ^ÑegLi°[
ªgPos3
].value; \

392 
isC⁄°™t
 = 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[
ªgPos3
].valid; \

393 
	`£tReg
–
ªgPos1
, 
tmp
, 
ªgvÆ
, 
isC⁄°™t
, 
NIL
 ); \

394 

	)

396 
	#ADD_ASSIGN
 \

397 if–!
	`°ªq
(
ö¢
->
r1
, "$31") && !streq(insn->r1, "$30") && \

398 !
	`°ªq
(
ö¢
->
r1
, "$29") && !streq(insn->r1, "$28") ) { \

399 if–
isC⁄°™t
 ) \

400 
	`addAssign
–
ö¢
->
r1
, 
ib
->
bb
, 
k
, 
ªgvÆ
, 0 ); \

402 
	`addAssign
–
ö¢
->
r1
, 
ib
->
bb
, 
k
, 0, 1 ); \

403 }

	)

410 
	$execuã
() {

412 
i
, 
j
, 
k
, 
m
, 
id
;

413 
powî
;

414 
dúe˘i⁄
;

416 
ªgPos1
, 
ªgPos2
, 
ªgPos3
;

417 
ªgvÆ
;

418 
isC⁄°™t
;

420 
ö_ã°
;

421 
√wEf„˘
 = 1;

423 
tmp
[ 
DERI_LEN
 ];

424 
off£t
[ 
DERI_LEN
 ];

426 
jÆ
, 
ign‹e
;

428 
öf_¥oc_t
 *
p
;

429 
öf_node_t
 *
ib
;

430 
ö¢_t
 *
ö¢
;

433  
k
 = 0; k < 
num_ö¢_°
; k++ ) {

434 
ö¢
 = &(
ö¢li°_°
[
k
]);

437 
tmp
[0] = '\0';

439 if–
	`°ªq
(
ö¢
->
›
, "lw" ) || streq(insn->op, "lb") || streq(insn->op, "lbu") ||

440 
	`°ªq
(
ö¢
->
›
, "l.d") || streq(insn->op, "lh") )

442 
PROCESS_LOAD
;

444 if–
	`°ªq
(
ö¢
->
›
, "lui") )

446 
PROCESS_LUI
;

448 if–
	`°ªq
(
ö¢
->
›
, "addiu") || streq(insn->op, "addi") )

450 
PROCESS_ADDI
;

452 if–
	`°ªq
(
ö¢
->
›
, "ori") )

454 
PROCESS_ORI
;

456 if–
	`°ªq
(
ö¢
->
›
, "xori") )

458 
PROCESS_XORI
;

460 if–
	`°ªq
(
ö¢
->
›
, "andi") )

462 
PROCESS_ANDI
;

464 if–
	`°ªq
(
ö¢
->
›
, "sll") )

466 
PROCESS_SLL
;

468 if–
	`°ªq
(
ö¢
->
›
, "srl") )

470 
PROCESS_SRL
;

472 if–
	`°ªq
(
ö¢
->
›
, "slti") || streq(insn->op, "sltiu") )

474 
PROCESS_SLTI
;

476 if–
	`°ªq
(
ö¢
->
›
, "slt") || streq(insn->op, "sltu") )

478 
PROCESS_SLT
;

480 if–
	`°ªq
(
ö¢
->
›
, "addu") )

482 
PROCESS_ADDU
;

484 if–
	`°ªq
(
ö¢
->
›
, "subu") )

486 
PROCESS_SUBU
;

488 if–
	`°ªq
(
ö¢
->
›
, "or") )

490 
PROCESS_OR
;

492 if–
	`°ªq
(
ö¢
->
›
, "xor") )

494 
PROCESS_XOR
;

500  
i
 = 0; i < 
¥og
.
num_¥ocs
; i++ ) {

501 
p
 = &(
öf_¥ocs
[
i
]);

502 
jÆ
 = 0;

505 
	`˛órReg
();

507  
j
 = 0; j < 
p
->
num_bb
; j++ ) {

508 
ib
 = &(
p
->
öf_cfg
[
j
]);

510  
k
 = 0; k < 
ib
->
num_ö¢
; k++ ) {

511 
ö¢
 = &(
ib
->
ö¢li°
[
k
]);

514 
ign‹e
 = 
jÆ
;

515 
jÆ
 = 0;

517 
tmp
[0] = '\0';

520 if–
	`°ªq
(
ö¢
->
›
, "beq") || streq(insn->op, "bne") )

522 if–
ign‹e
 )

525 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

526 
ªgPos2
 = 
	`födReg
–
ö¢
->
r2
 );

529 if(–
ªgLi°
[
ªgPos1
].
Êag
 =
SLTI
 ||ÑegLi°[ªgPos1].Êag =
SLT
 ) &&

530 
ªgLi°
[
ªgPos2
].
vÆid
 &&ÑegLi°[ªgPos2].
vÆue
 == 0 ) {

533 if–
	`°ªq
(
ö¢
->
›
, "beq") )

535 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
,ÑegLi°[ªgPos1].
vÆue
, 0, 
GE
 );

538 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
,ÑegLi°[ªgPos1].
vÆue
, 0, 
LT
 );

540 if–
ªgLi°
[
ªgPos1
].
Êag
 =
NIL
 &&ÑegLi°[
ªgPos2
].flag == NIL ) {

546 if–
ªgLi°
[
ªgPos1
].
vÆid
 &&ÑegLi°[
ªgPos2
].valid )

549 if–!
ªgLi°
[
ªgPos1
].
vÆid
 && !ªgLi°[
ªgPos2
].valid )

552 if–!
ªgLi°
[
ªgPos1
].
vÆid
 &&ÑegLi°[
ªgPos2
].valid ) {

554 
ö_ã°
 = 
ªgPos1
;

555 
ªgvÆ
 = 
ªgLi°
[
ªgPos2
].
vÆue
 -ÑegLi°[
ªgPos1
].value;

557 if–
ªgLi°
[
ªgPos1
].
vÆid
 && !ªgLi°[
ªgPos2
].valid ) {

559 
ö_ã°
 = 
ªgPos2
;

560 
ªgvÆ
 = 
ªgLi°
[
ªgPos1
].
vÆue
 -ÑegLi°[
ªgPos2
].value;

562 if–
	`°ªq
(
ö¢
->
›
, "bne") )

563 
	`addBønch
–
ªgLi°
[
ö_ã°
].
dîôªe
, 
ib
->
bb
, 
ªgvÆ
, 0, 
NE
 );

565 
	`addBønch
–
ªgLi°
[
ö_ã°
].
dîôªe
, 
ib
->
bb
, 
ªgvÆ
, 0, 
EQ
 );

568 if–
	`°ªq
(
ö¢
->
›
, "bgez") || streq(insn->op, "blez") || streq(insn->op, "bgtz") )

570 if–
ign‹e
 )

574 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

577 if–
	`°æí
(
ªgLi°
[
ªgPos1
].
dîôªe
) > 0 ) {

578 if–
	`°ªq
(
ö¢
->
›
, "bgez") )

579 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
GE
 );

580 if–
	`°ªq
(
ö¢
->
›
, "bgtz") )

581 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
GT
 );

583 
	`addBønch
–
ªgLi°
[
ªgPos1
].
dîôªe
, 
ib
->
bb
, 0 -ÑegLi°[ªgPos1].
vÆue
, 0, 
LE
 );

588 if–
	`°ªq
(
ö¢
->
r1
, "$31") || streq(insn->r1, "$30") || streq(insn->r1, "$29") ||

589 
	`°ªq
(
ö¢
->
r1
, "$28"Ë|| såeq(ö¢->
r3
, "$29") )

593 if–
	`°ªq
(
ö¢
->
›
, "sw") || streq(insn->op, "sb" ) || streq(insn->op, "sh") || streq(insn->op, "sbu") )

595 
ªgPos1
 = 
	`födReg
–
ö¢
->
r1
 );

596 
ªgPos3
 = 
	`födReg
–
ö¢
->
r3
 );

600 if–
	`°æí
(
ªgLi°
[
ªgPos3
].
dîôªe
) > 0 )

601 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
dîôªe
 );

603 
	`•rötf
–
tmp
, "%d(%s)", 
	`©oi
(
ö¢
->
r2
), 
ªgLi°
[
ªgPos3
].
«me
 );

605 if–
ign‹e
 && 
	`°ªq
(
ö¢
->
r1
, 
REG_RETURN
) )

607 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 0, 1 );

609 if–
ªgLi°
[
ªgPos1
].
vÆid
 )

611 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 
ªgLi°
[
ªgPos1
].
vÆue
, 0 );

613 
	`addAssign
–
tmp
, 
ib
->
bb
, 
k
, 0, 1 );

615 if–
	`°ªq
(
ö¢
->
›
, "lw" ) || streq(insn->op, "lb") || streq(insn->op, "lbu") ||

616 
	`°ªq
(
ö¢
->
›
, "l.d") || streq(insn->op, "lh") )

618 
PROCESS_LOAD
;

619 
ADD_ASSIGN
;

621 if–
	`°ªq
(
ö¢
->
›
, "lui") )

623 
PROCESS_LUI
;

624 
ADD_ASSIGN
;

626 if–
	`°ªq
(
ö¢
->
›
, "addiu") || streq(insn->op, "addi") )

628 
PROCESS_ADDI
;

629 
ADD_ASSIGN
;

631 if–
	`°ªq
(
ö¢
->
›
, "ori") )

633 
PROCESS_ORI
;

634 
ADD_ASSIGN
;

636 if–
	`°ªq
(
ö¢
->
›
, "xori") )

638 
PROCESS_XORI
;

639 
ADD_ASSIGN
;

641 if–
	`°ªq
(
ö¢
->
›
, "andi") )

643 
PROCESS_ANDI
;

644 
ADD_ASSIGN
;

646 if–
	`°ªq
(
ö¢
->
›
, "sll") )

648 
PROCESS_SLL
;

649 
ADD_ASSIGN
;

651 if–
	`°ªq
(
ö¢
->
›
, "srl") )

653 
PROCESS_SRL
;

654 
ADD_ASSIGN
;

656 if–
	`°ªq
(
ö¢
->
›
, "slti") || streq(insn->op, "sltiu") )

658 
PROCESS_SLTI
;

659 
ADD_ASSIGN
;

661 if–
	`°ªq
(
ö¢
->
›
, "slt") || streq(insn->op, "sltu") )

663 
PROCESS_SLT
;

664 
ADD_ASSIGN
;

666 if–
	`°ªq
(
ö¢
->
›
, "addu") )

668 
PROCESS_ADDU
;

669 
ADD_ASSIGN
;

671 if–
	`°ªq
(
ö¢
->
›
, "subu") )

673 
PROCESS_SUBU
;

674 
ADD_ASSIGN
;

676 if–
	`°ªq
(
ö¢
->
›
, "or") )

678 
PROCESS_OR
;

679 
ADD_ASSIGN
;

681 if–
	`°ªq
(
ö¢
->
›
, "xor") )

683 
PROCESS_XOR
;

684 
ADD_ASSIGN
;

686 if–
	`°ªq
(
ö¢
->
›
, "jal") )

687 
jÆ
 = 1;

689 if–
	`°ªq
(
ö¢
->
›
, "j") );

691 
	`¥ötf
–"Ign‹ög opcode: %s\n", 
ö¢
->
›
 );

700 
	}
}

	@tcfg.c

43 
	~<°dlib.h
>

45 
	~"comm⁄.h
"

47 
	~"tcfg.h
"

51 
¥og_t
 
¥og
;

53 
tcfg_node_t
 **
	gtcfg
;

55 
	gnum_tcfg_nodes
 = 0, 
	gtcfg_size
 = 0;

57 
tcfg_edge_t
 **
	gtcfg_edges
;

59 
	gnum_tcfg_edges
 = 0;

61 
tcfg_∆ök_t
 ***
	gbbi_m≠
;

73 
	$bbi_pid
(
tcfg_node_t
 *
bbi
)

77  
bbi
->
bb
->
¥oc
->
id
;

79 
	}
}

91 
	$bbi_bid
(
tcfg_node_t
 *
bbi
)

95  
bbi
->
bb
->
id
;

97 
	}
}

109 
	$c⁄d_bbi
(
tcfg_node_t
 *
bbi
)

113  (
bbi
->
bb
->
ty≥
 =
CTRL_COND
);

115 
	}
}

127 
	$bbi_backedge
(
tcfg_edge_t
 *
edge
)

131 
¥oc_t
 *
¥oc1
, *
¥oc2
;

133 
bid1
, 
bid2
;

137 
¥oc1
 = 
edge
->
§c
->
bb
->
¥oc
;

139 
¥oc2
 = 
edge
->
d°
->
bb
->
¥oc
;

141 
bid1
 = 
edge
->
§c
->
bb
->
id
;

143 
bid2
 = 
edge
->
d°
->
bb
->
id
;

147 i‡((
¥oc1
 =
¥oc2
Ë&& (
bid1
 >
bid2
))

155 
	}
}

167 
	$bbi_is_lo›back
(
tcfg_edge_t
 *
edge
, 
hód
, 
èû
)

171 i‡((
edge
->
d°
->
bb
->
id
 =
hód
)

173 && (
	`BETWEEN
(
edge
->
§c
->
bb
->
id
, 
hód
, 
èû
))

175 && (
edge
->
d°
->
bb
->
¥oc
 =edge->
§c
->bb->proc))

183 
	}
}

195 
	$bbi_is_ªtu∫
(
tcfg_node_t
 *
bbi
)

199 i‡((
bbi
->
bb
->
out_n
 =
NULL
Ë&& (bbi->bb->
out_t
 == NULL))

207 
	}
}

215 
tcfg_node_t
 *

217 
	$√w_tcfg_node
(
cfg_node_t
 *
bb
)

221 
tcfg_node_t
 *
bbi
;

225 
bbi
 = (
tcfg_node_t
 *Ë
	`ˇŒoc
(1, (tcfg_node_t));

227 
	`CHECK_MEM
(
bbi
);

229 
bbi
->
bb
 = bb;

231 
bbi
->
id
 = 
num_tcfg_nodes
;

235  
bbi
;

237 
	}
}

245 
tcfg_edge_t
 *

247 
	$√w_tcfg_edge
(
tcfg_node_t
 *
§c
,Åcfg_node_à*
d°
, 
bønch
)

251 
tcfg_edge_t
 *
edge
, *
edge1
;

255 
edge
 = (
tcfg_edge_t
 *Ë
	`ˇŒoc
(1, (tcfg_edge_t));

257 
	`CHECK_MEM
(
edge
);

259 
edge
->
§c
 = src;Édge->
d°
 = d°;Édge->
bønch
 = branch;

263 i‡(
§c
->
out
 =
NULL
)

265 
§c
->
out
 = 
edge
;

269 
edge1
 = 
§c
->
out
;

271 
edge1
->
√xt_out
 !
NULL
)

273 
edge1
 =Édge1->
√xt_out
;

275 
edge1
->
√xt_out
 = 
edge
;

279 i‡(
d°
->
ö
 =
NULL
)

281 
d°
->
ö
 = 
edge
;

285 
edge1
 = 
d°
->
ö
;

287 
edge1
->
√xt_ö
 !
NULL
)

289 
edge1
 =Édge1->
√xt_ö
;

291 
edge1
->
√xt_ö
 = 
edge
;

295  
edge
;

297 
	}
}

301 
bdïth
;

302 
ã°_dïth
(
pid
, 
dïth
);

314 
	$¥oc_ölöe
(
¥oc_t
 *
¥oc
, 
tcfg_node_t
 *
ˇŒ_bbi
,Åcfg_node_à*
ªt_bbi
, 
dïth
)

318 
i
;

319 
cfg_node_t
 *
bb
;

320 
tcfg_node_t
 **
sub_tcfg
;

323 
sub_tcfg
 = (
tcfg_node_t
 **Ë
	`ˇŒoc
(
¥oc
->
num_bb
 + 1, (tcfg_node_t *));

325 
	`CHECK_MEM
(
sub_tcfg
);

330 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

332 i‡(
num_tcfg_nodes
 >
tcfg_size
) {

336 
tcfg_size
 += 64;

338 
tcfg
 = (
tcfg_node_t
 **Ë
	`ªÆloc
—cfg, 
tcfg_size
 * (tcfg_node_t *));

341 
sub_tcfg
[
i
] = 
tcfg
[
num_tcfg_nodes
] = 
	`√w_tcfg_node
(&
¥oc
->
cfg
[i]);

343 
num_tcfg_nodes
++;

350 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

352 i‡(
¥oc
->
cfg
[
i
].
ty≥
 =
CTRL_CALL
) {

359 if–
¥oc
->
cfg
[
i
].
ˇŒì
 !=Öroc->cfg[i].proc ){

360 
	`¥oc_ölöe
(
¥oc
->
cfg
[
i
].
ˇŒì
, 
sub_tcfg
[i], sub_tcfg[i+1],0);

364 if(!
bdïth
)

366 if(
	`ã°_dïth
(
¥oc
->
id
, 
dïth
 + 1) ){

368 
	`¥oc_ölöe
(
¥oc
->
cfg
[
i
].
ˇŒì
, 
sub_tcfg
[i], sub_tcfg[i+1], 
dïth
 + 1);

382 i‡(
ˇŒ_bbi
 !
NULL
)

384 
	`√w_tcfg_edge
(
ˇŒ_bbi
, 
sub_tcfg
[0], 
TAKEN
);

386 
i
 = 0; i < 
¥oc
->
num_bb
; i++) {

392 i‡(
¥oc
->
cfg
[
i
].
ty≥
 =
CTRL_CALL
)

398 i‡(
¥oc
->
cfg
[
i
].
ty≥
 =
CTRL_RET
) {

400 i‡(
ªt_bbi
 !
NULL
)

402 
	`√w_tcfg_edge
(
sub_tcfg
[
i
], 
ªt_bbi
, 
TAKEN
);

410 i‡(
¥oc
->
cfg
[
i
].
out_n
 !
NULL
) {

412 
bb
 = 
¥oc
->
cfg
[
i
].
out_n
->
d°
;

414 
	`√w_tcfg_edge
(
sub_tcfg
[
i
], sub_tcfg[
bb
->
id
], 
NOT_TAKEN
);

418 i‡(
¥oc
->
cfg
[
i
].
out_t
 !
NULL
) {

420 
bb
 = 
¥oc
->
cfg
[
i
].
out_t
->
d°
;

422 
	`√w_tcfg_edge
(
sub_tcfg
[
i
], sub_tcfg[
bb
->
id
], 
TAKEN
);

430 
	`‰ì
(
sub_tcfg
);

432 
	}
}

442 
	$cﬁÀ˘_tcfg_edges
()

446 
i
, 
edge_id
 = 0;

448 
tcfg_edge_t
 *
e
;

454 
num_tcfg_edges
 = 0;

456 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

458 
e
 = 
tcfg
[
i
]->
out
;É !
NULL
;É =É->
√xt_out
)

460 
num_tcfg_edges
++;

466 
tcfg_edges
 = (
tcfg_edge_t
 **Ë
	`ˇŒoc
(
num_tcfg_edges
, (tcfg_edge_t *));

468 
	`CHECK_MEM
(
tcfg_edges
);

470 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

472 
e
 = 
tcfg
[
i
]->
out
;É !
NULL
;É =É->
√xt_out
) {

474 
e
->
id
 = 
edge_id
++;

476 
tcfg_edges
[
e
->
id
] =É;

482 
	}
}

492 
	$upd©e_bbi_m≠
(
tcfg_node_t
 *
bbi
)

496 
tcfg_∆ök_t
 *
∆
;

498 
pid
, 
bid
;

502 
∆
 = (
tcfg_∆ök_t
 *Ë
	`ˇŒoc
(1, (tcfg_nlink_t));

504 
∆
->
bbi
 = bbi;

506 
pid
 = 
	`bbi_pid
(
bbi
); 
bid
 = 
	`bbi_bid
(bbi);

508 
∆
->
√xt
 = 
bbi_m≠
[
pid
][
bid
];

510 
bbi_m≠
[
pid
][
bid
] = 
∆
;

512 
	}
}

522 
	$buûd_bbi_m≠
()

526 
i
;

530 
bbi_m≠
 = (
tcfg_∆ök_t
 ***Ë
	`ˇŒoc
(
¥og
.
num_¥ocs
,

532 (
tcfg_∆ök_t
 **));

534 
	`CHECK_MEM
(
bbi_m≠
);

536 
i
 = 0; i < 
¥og
.
num_¥ocs
; i++) {

538 
bbi_m≠
[
i
] = (
tcfg_∆ök_t
 **Ë
	`ˇŒoc
(
¥og
.
¥ocs
[i].
num_bb
,

540 (
tcfg_∆ök_t
 *));

542 
	`CHECK_MEM
(
bbi_m≠
[
i
]);

548 
i
 = 0; i < 
num_tcfg_nodes
; i++)

550 
	`upd©e_bbi_m≠
(
tcfg
[
i
]);

552 
	}
}

564 
	$¥og_å™
()

568 
¥oc_t
 *
¥oc
;

570 
FILE
 *
·cfg
;

572 
¥oc
 = &
¥og
.
¥ocs
[¥og.
maö_¥oc
];

574 
	`¥oc_ölöe
(
¥oc
, 
NULL
, NULL,0);

576 
	`cﬁÀ˘_tcfg_edges
();

578 
·cfg
 = 
	`f›í
( "tcfg.map", "w" );

579 
	`dump_tcfg
–
·cfg
 );

580 
	`f˛o£
–
·cfg
 );

582 
	`buûd_bbi_m≠
();

584 
	}
}

594 
	$˛ór_bbi_Êags
()

598 
i
;

602 
i
 = 0; i < 
num_tcfg_nodes
; i++)

604 
tcfg
[
i
]->
Êags
 = 0;

606 
	}
}

616 
	$˛ór_tcfg_edge_Êags
()

620 
i
;

624 
i
 = 0; i < 
num_tcfg_edges
; i++)

626 
tcfg_edges
[
i
]->
Êags
 = 0;

628 
	}
}

638 
	$bbi_ty≥
(
tcfg_node_t
 *
bbi
)

642  
bbi
->
bb
->
ty≥
;

644 
	}
}

672 
	$dump_tcfg
(
FILE
 *
Â
)

676 
tcfg_node_t
 *
bbi
;

678 
tcfg_edge_t
 *
edge
;

680 
i
;

684 
	`Ârötf
(
Â
, "dumpÅcfg...\n");

686 
i
 = 0; i < 
num_tcfg_nodes
; i++) {

688 
bbi
 = 
tcfg
[
i
];

690 
	`Ârötf
(
Â
, "%d(%d.%d): [ ", 
bbi
->
id
, 
	`bbi_pid
(bbi), 
	`bbi_bid
(bbi));

694 
edge
 = 
bbi
->
out
;Édgê!
NULL
;Édgêedge->
√xt_out
) {

696 
	`Ârötf
(
Â
, "%d ", 
edge
->
d°
->
id
);

700 
	`Ârötf
(
Â
, "]\n");

704 
	`Ârötf
(
Â
, "\n");

706 
	}
}

	@tcfg.h

25 #i‚de‡
TCFG_H


26 
	#TCFG_H


	)

28 
	~"cfg.h
"

33 
	#V_START_ID
 -1

	)

34 
	#V_END_ID
 -2

	)

37 
tcfg_edge_t
 
	ttcfg_edge_t
;

41 
cfg_node_t
 *
	mbb
;

42 
	mid
;

43 
tcfg_edge_t
 *
	mö
, *
	mout
;

44 
	mÊags
;

45 
	mlo›_id
;

46 
	mexec_cou¡
;

47 
	m™Æ_cou¡
;

48 
	mdˇche_dñay
;

49 
	mö°_ˇche_dñay
;

51 
	mn_≥rsi°í˚
;

52 
	mn_d©a_≥rsi°í˚
;

53 
	mn_u1_≥rsi°í˚
;

54 
	mn_u1_d©a_≥rsi°í˚
;

55 
	mn_l2_≥rsi°í˚
;

56 } 
	ttcfg_node_t
;

65 
	stcfg_edge_t
 {

66 
	mid
;

67 
	mbønch
;

68 
tcfg_node_t
 *
	m§c
, *
	md°
;

69 
tcfg_edge_t
 *
	m√xt_out
;

70 
tcfg_edge_t
 *
	m√xt_ö
;

71 
	mÊags
;

76 
tcfg_∆ök_t
 
	ttcfg_∆ök_t
;

77 
	stcfg_∆ök_t
 {

78 
tcfg_node_t
 *
	mbbi
;

79 
tcfg_∆ök_t
 *
	m√xt
;

83 
tcfg_ñök_t
 
	ttcfg_ñök_t
;

85 
	stcfg_ñök_t
 {

86 
tcfg_edge_t
 *
	medge
;

87 
tcfg_ñök_t
 *
	m√xt
;

93 
¥og_å™
();

98 
˛ór_bbi_Êags
();

103 
bbi_ty≥
();

108 
dump_tcfg
(
FILE
 *
Â
);

	@test.c

1 
	~<°dio.h
>

3 
	tticks
;

5 
__ölöe__
 
ticks
 
	$gëticks
()

7 
a
, 
d
;

8 
asm
 vﬁ©ûe("rdtsc" : "˜" (
a
), "=d" (
d
));

9  ((
ticks
)
a
Ë| ((—icks)
d
) << 32);

10 
	}
}

12 
	$maö
()

14 
ticks
 
a
,
b
;

16 
a
 = 
	`gëticks
();

17 
	`¶ìp
(10);

18 
b
 = 
	`gëticks
();

20 
	`¥ötf
("Timê%lf\n", (
b
 - 
a
)/((1.0)*2533821000));

21 
	}
}

	@unicache.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~<as£π.h
>

5 
	~"ˇche.h
"

6 
	~"tcfg.h
"

7 
	~"addªss.h
"

8 
	~"comm⁄.h
"

10 
tcfg_node_t
** 
tcfg
;

11 
num_tcfg_nodes
;

12 
¥og_t
 
¥og
;

15 
iß_t
* 
iß
;

16 
gcd
(
a
, 
b
);

18 
acs_p
 
Dif„ªn˚
◊cs_∞
acs
, 
mem_blk_£t_t
* 
mem_blk
);

19 
buûd_gøph
(
¥oc_t
* 
¥oc
);

20 
ch™ge_œyout
();

21 
ch™ge_addªss
();

22 
	gcou¡
;

23 
gëShi·edBlock
(
tblock
);

24 
Æloˇãd
(
mem_blk_£t_t
* 
¨g
);

25 
addM≠pög
(
mem_blk_£t_t
* 
¨g
, 
«ddr
);

27 #ifde‡
_DEBUG


28 
dumpCacheBB
(
acs_p
** 
acs
, 
FILE
* 
Â
);

29 
	g™Æysis
 = 0;

30 
	gunifõd
 = 0;

32 
	gl1_d1_ps
 = 0;

33 
	gl1_i1_ps
 = 0;

34 
	gi1_u1_ps
 = 0;

35 
	gu1_d1_ps
 = 0;

36 
	g›t
 = 0;

37 
ric_p
 
gëAddrBa£Off£t
(
de_ö°_t
* 
ö°
, 
ba£
, 
off£t
, 
›t
);

38 
ric_p
 
gëAddrBa£Index
(
de_ö°_t
* 
ö°
, 
ba£
, 
ödex
, 
›t
);

39 
	gX
,
	gY
,
	gB
,
	gl1
,
	gl2
;

42 
ovæ_gøph_p
* 
	govr_gøph
;

45 
ovr_m≠_p
 
	govr_m≠
;

47 
	$isSt‹eIn°
(* 
iß_«me
)

49 if(! 
	`°rcmp
(
iß_«me
, "sw") || !strcmp(isa_name, "sh")

50 || !
	`°rcmp
(
iß_«me
, "sb") || !strcmp(isa_name, "swl")

51 || !
	`°rcmp
(
iß_«me
, "swr") || !strcmp(isa_name, "s.s")

52 || !
	`°rcmp
(
iß_«me
, "s.d"))

57 
	}
}

59 
	$isLﬂdIn°
(* 
iß_«me
)

61 if(! 
	`°rcmp
(
iß_«me
, "lw") || !strcmp(isa_name, "lh")

62 || !
	`°rcmp
(
iß_«me
, "lb") || !strcmp(isa_name, "lwl")

63 || !
	`°rcmp
(
iß_«me
, "lwr") || !strcmp(isa_name, "lhu")

64 || !
	`°rcmp
(
iß_«me
, "l.s") || !strcmp(isa_name, "l.d"))

69 
	}
}

72 
acs_p
* 
	$makeCacheSë
()

74 
acs_p
* 
ªt
;

76 
ªt
 = (
acs_p
 *)
	`mÆloc
((
CACHE_SET_SIZE
 + 1) * (acs_p));

77 
	`CHECK_MEM
(
ªt
);

78 
	`mem£t
(
ªt
, 0, (
CACHE_SET_SIZE
 + 1Ë* (
acs_p
));

80  
ªt
;

81 
	}
}

84 
	$‰ìCacheSèã
(
acs_p
* 
acs
)

86 
	}
}

89 
mem_blk_£t_t
* 
	$gëMem‹yBlocks
(
ric_p
 
addr
)

91 
mem_blk_£t_t
* 
mem_£t
 = 
NULL
;

92 
mem_blk_£t_t
* 
ãmp
;

93 
i
;

94 
¥ev
 = -1;

95 
cou¡
 = 0;

97 
i
 = 
addr
->
lowî_bound
; i <addr->
uµî_bound
; i +addr->
°ride
)

99 if(
¥ev
 =
	`GET_MEM
(
i
))

101 
¥ev
 = 
	`GET_MEM
(
i
);

102 
ãmp
 = (
mem_blk_£t_t
 *)
	`mÆloc
((mem_blk_set_t));

103 
	`CHECK_MEM
(
ãmp
);

105 
ãmp
->
block
 = 
¥ev
;

107 if(
›t
)

109 
√wb
;

111 if(
√wb
 = 
	`gëShi·edBlock
(
¥ev
));

113 #ifde‡
_DEBUG


114 
	`¥ötf
("Returning shifted block\n");

116 
ãmp
->
block
 = 
√wb
;

119 
ãmp
->
√xt
 = 
mem_£t
;

120 
mem_£t
 = 
ãmp
;

121 
cou¡
++;

122 if(
cou¡
 > 
MAX_CACHE_SET
 * 
CACHE_SET_SIZE
)

124 if(!
addr
->
°ride
)

128  
mem_£t
;

129 
	}
}

132 
acs_p
 
	$makeEm±y
()

134 
acs_p
 
ªt
;

136 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

137 
	`CHECK_MEM
(
ªt
);

139 
ªt
->
mem_blk_h
 = 
NULL
;

141  
ªt
;

142 
	}
}

146 
	$isResidít
(
mem_blk_£t_t
* 
mem_blk_h
, mem_blk_£t_t* 
ôem
)

148 
mem_blk_£t_t
* 
ôî
;

150 
ôî
 = 
mem_blk_h
; iãr; iã∏ôî->
√xt
)

152 if(
ôî
->
block
 =
ôem
->block)

157 
	}
}

162 
	$checkF‹In˛usi⁄SögÀ
(
acs_p
* 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_£t
)

164 
mem_blk_£t_t
* 
ôî
;

165 
i
;

167 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

169 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

171 if(!
acs_ö
[
i
]) ;

172 if–
	`isResidít
(
acs_ö
[
i
]->
mem_blk_h
, 
ôî
))

175 if–
ôî
) {

177  
i
;

183 
	}
}

187 
	$∑πôi⁄
(
acs_p
* 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_h
,

188 
mem_blk_£t_t
** 
mem_blk_ªsidít
, mem_blk_£t_t** 
mem_blk_ab£¡
)

190 
i
;

191 
found
;

192 
mem_blk_£t_t
* 
ôî
;

193 
mem_blk_£t_t
* 
ãmp
;

195 *
mem_blk_ªsidít
 = *
mem_blk_ab£¡
 = 
NULL
;

197 
ôî
 = 
mem_blk_h
; iãr; iã∏ôî->
√xt
)

199 
found
 = 0;

201 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

203 if(
acs_ö
 &&ács_ö[
i
] && 
	`isResidít
◊cs_ö[i]->
mem_blk_h
, 
ôî
))

205 
ãmp
 = (
mem_blk_£t_t
 *)
	`mÆloc
((mem_blk_set_t));

206 
	`CHECK_MEM
(
ãmp
);

207 
ãmp
->
block
 = 
ôî
->block;

208 
ãmp
->
√xt
 = *
mem_blk_ªsidít
;

209 *
mem_blk_ªsidít
 = 
ãmp
;

210 
found
 = 1;

214 if(!
found
)

216 
ãmp
 = (
mem_blk_£t_t
 *)
	`mÆloc
((mem_blk_set_t));

217 
	`CHECK_MEM
(
ãmp
);

218 
ãmp
->
block
 = 
ôî
->block;

219 
ãmp
->
√xt
 = *
mem_blk_ab£¡
;

220 *
mem_blk_ab£¡
 = 
ãmp
;

223 
	}
}

226 
	$gëC¨döÆôy
(
mem_blk_£t_t
* 
mem_blk_£t
)

228 
mem_blk_£t_t
* 
ôî
;

229 
cou¡
 = 0;

231 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

232 
cou¡
++;

234  
cou¡
;

235 
	}
}

238 
acs_p
 
	$makeC›y
(
acs_p
 
acs_ö
)

240 
acs_p
 
ªt
;

241 
i
;

242 
mem_blk_£t_t
* 
ôî
;

244 if(! 
acs_ö
)

245  
NULL
;

247 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

248 
	`CHECK_MEM
(
ªt
);

249 
	`mem£t
(
ªt
, 0, (
acs_s
));

250 
ªt
->
mem_blk_h
 = 
NULL
;

252 
ôî
 = 
acs_ö
->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

254 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

255 
	`CHECK_MEM
(
ãmp
);

256 
ãmp
->
block
 = 
ôî
->block;

257 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

258 
ªt
->
mem_blk_h
 = 
ãmp
;

261  
ªt
;

262 
	}
}

265 
acs_p
 
	$makeCacheBlock
(
mem_blk_£t_t
* 
mem_blk_£t
)

267 
acs_p
 
ªt
;

268 
i
;

269 
mem_blk_£t_t
* 
ôî
;

271 if(! 
mem_blk_£t
)

272  
NULL
;

274 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

275 
	`CHECK_MEM
(
ªt
);

276 
	`mem£t
(
ªt
, 0, (
acs_s
));

277 
ªt
->
mem_blk_h
 = 
NULL
;

279 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

281 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

282 
	`CHECK_MEM
(
ãmp
);

283 
ãmp
->
block
 = 
ôî
->block;

284 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

285 
ªt
->
mem_blk_h
 = 
ãmp
;

288  
ªt
;

289 
	}
}

293 
acs_p
 
	$I¡î£˘
(
acs_p
 
acs1
,ács_∞
acs2
)

295 
acs_p
 
ªt
;

296 
i
;

297 
mem_blk_£t_t
* 
ôî
;

299 if(!
acs1
 || !
acs2
)

300  
NULL
;

302 
ªt
 = 
	`makeEm±y
();

304 
ôî
 = 
acs2
->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

310 if(
	`isResidít
(
acs1
->
mem_blk_h
, 
ôî
))

312 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

313 
	`CHECK_MEM
(
ãmp
);

314 
ãmp
->
block
 = 
ôî
->block;

315 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

316 
ªt
->
mem_blk_h
 = 
ãmp
;

320  
ªt
;

321 
	}
}

325 
acs_p
 
	$Uni⁄
(
acs_p
 
acs1
,ács_∞
acs2
)

327 
acs_p
 
ªt
;

328 
i
;

329 
mem_blk_£t_t
* 
ôî
;

331 if(! 
acs1
 && !
acs2
)

332  
NULL
;

335 
ªt
 = 
	`makeC›y
(
acs1
);

337 if(!
acs2
)

338  
ªt
;

340 
ôî
 = 
acs2
->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

342 if(!
ªt
)

344 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

345 
	`CHECK_MEM
(
ªt
);

346 
ªt
->
mem_blk_h
 = 
NULL
;

348 if(!
	`isResidít
(
ªt
->
mem_blk_h
, 
ôî
))

350 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

351 
	`CHECK_MEM
(
ãmp
);

352 
ãmp
->
block
 = 
ôî
->block;

353 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

354 
ªt
->
mem_blk_h
 = 
ãmp
;

358  
ªt
;

359 
	}
}

363 
acs_p
 
	$Uni⁄CacheMem
(
acs_p
 
acs1
, 
mem_blk_£t_t
* 
mem_blk_£t
)

365 
acs_p
 
ªt
;

366 
i
;

367 
mem_blk_£t_t
* 
ôî
;

369 if(! 
mem_blk_£t
)

370  
acs1
;

373 
ªt
 = 
	`makeC›y
(
acs1
);

375 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

377 if(! 
ªt
)

379 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

380 
	`mem£t
(
ªt
, 0, (
acs_s
));

382 if(!
	`isResidít
(
ªt
->
mem_blk_h
, 
ôî
))

384 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

385 
	`CHECK_MEM
(
ãmp
);

386 
ãmp
->
block
 = 
ôî
->block;

387 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

388 
ªt
->
mem_blk_h
 = 
ãmp
;

392  
ªt
;

393 
	}
}

398 
	$checkF‹O√Pª£n˚
(
acs_p
** 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_£t
)

400 
mem_blk_£t_t
* 
ôî
;

401 
i
,
k
;

403 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

405 
k
 = 
	`GET_SET
(
ôî
->
block
);

406 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

408 if(
acs_ö
[
k
][
i
] && 
	`isResidít
◊cs_ö[k][i]->
mem_blk_h
, 
ôî
))

414 
	}
}

419 
	$checkF‹Pª£n˚
(
acs_p
** 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_£t
)

421 
mem_blk_£t_t
* 
ôî
;

422 
i
,
k
;

424 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

426 
k
 = 
	`GET_SET
(
ôî
->
block
);

427 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

429 if(
acs_ö
[
k
][
i
] && 
	`isResidít
◊cs_ö[k][i]->
mem_blk_h
, 
ôî
))

432 if(
i
 =
CACHE_SET_SIZE
)

437 
	}
}

442 
	$checkF‹Vi˘im
(
acs_p
** 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_£t
)

444 
mem_blk_£t_t
* 
ôî
;

445 
i
,
k
;

447 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

449 
i
 = 0; i < 
MAX_CACHE_SET
; i++)

451 if(
acs_ö
[
i
][
PSEUDO
] && 
	`isResidít
◊cs_ö[i][PSEUDO]->
mem_blk_h
, 
ôî
))

457 
	}
}

462 
	$checkF‹In˛usi⁄
(
acs_p
* 
acs_ö
, 
mem_blk_£t_t
* 
mem_blk_£t
)

464 
mem_blk_£t_t
* 
ôî
;

465 
i
;

467 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

469 
ôî
 = 
mem_blk_£t
; iãr; iã∏ôî->
√xt
)

471 if(
acs_ö
[
i
] && ! 
	`isResidít
◊cs_ö[i]->
mem_blk_h
, 
ôî
))

474 if(! 
ôî
)

475  
i
;

480 
	}
}

483 
mem_blk_£t_t
* 
	$gëMem‹yBlockOfSë
(
mem_blk_£t_t
* 
mem_blk
, 
£t
)

485 
mem_blk_£t_t
* 
hód
 = 
NULL
;

486 
mem_blk_£t_t
* 
ôî
;

487 
°
;

489 if(!
mem_blk
)

490  
NULL
;

492 
ôî
 = 
mem_blk
; iãr; iã∏ôî->
√xt
)

494 
°
 = 
	`GET_SET
(
ôî
->
block
);

495 if(
°
 =
£t
)

497 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

498 
	`CHECK_MEM
(
ãmp
);

499 
ãmp
->
block
 = 
ôî
->block;

500 
ãmp
->
√xt
 = 
hód
;

501 
hód
 = 
ãmp
;

505  
hód
;

506 
	}
}

509 
acs_p
** 
	$upd©e_mu°
(
acs_p
** 
acs_ö
, 
ric_p
 
addr
, 
ANALYSIS_T
 
ty≥
)

511 
mem_blk_£t_t
* 
mem_blk
, *
mem_blk_ªsidít
, *
mem_blk_ab£¡
, *
ôî
;

512 
acs_p
 
l_t›
;

513 
n_ñems
, 
h
, 
i
;

514 
k
,
j
;

515 
mem_blk_£t_t
* 
Æl_blk
;

516 
mem_blk_£t_t
 
ãmp
;

517 
acs_p
** 
acs_out
;

518 
acs_p
** 
ªt_acs_out
;

519 
Æl_blk
 = 
	`gëMem‹yBlocks
(
addr
);

520 
hﬁd
;

522 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

523 
	`CHECK_MEM
(
acs_out
);

524 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

526 
ªt_acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

527 
	`CHECK_MEM
(
ªt_acs_out
);

528 
	`mem£t
(
ªt_acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

530 
hﬁd
 = 
	`gëC¨döÆôy
(
Æl_blk
);

532 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

534 if(
hﬁd
 > 
MAX_CACHE_SET
 * 
CACHE_SET_SIZE
)

536 
ªt_acs_out
[
k
] = 
	`makeCacheSë
();

537 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

538 
ªt_acs_out
[
k
][
i
] = 
	`makeEm±y
();

542 
mem_blk
 = 
	`gëMem‹yBlockOfSë
(
Æl_blk
, 
k
);

543 
acs_out
[
k
] = 
	`makeCacheSë
();

544 
ªt_acs_out
[
k
] = 
	`makeCacheSë
();

546 if(!
mem_blk
)

548 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

549 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i]);

553 i‡(
	`gëC¨döÆôy
(
Æl_blk
) == 1) {

554 
h
 = 
	`checkF‹In˛usi⁄SögÀ
(
acs_ö
[
k
], 
mem_blk
);

555 #i‡
DBG_PS_UPDATE


558 
	`Ârötf
(
Â
,"Upd©êsögÀ cache, in˛usi⁄ %d\n",
h
);
	`fÊush
(fp);

562 if(
h
 == 0)

564 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

565 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i]);

567 if(
h
 != -1)

569 
ªt_acs_out
[
k
][0] = 
	`makeCacheBlock
(
mem_blk
);

570 
i
 = 1; i < 
h
 - 1; i++)

571 
ªt_acs_out
[
k
][
i
] = 
	`Dif„ªn˚
(
acs_ö
[k][ò- 1],
mem_blk
);

572 
ªt_acs_out
[
k
][
h
] = 
	`Uni⁄
(
acs_out
[k][h], 
acs_ö
[k][h - 1]);

573 
i
 = 
h
 + 1; i < 
CACHE_SET_SIZE
; i++)

574 
ªt_acs_out
[
k
][
i
] = 
	`Dif„ªn˚
(
acs_ö
[k][i],
mem_blk
);

578 
ªt_acs_out
[
k
][0] = 
	`makeCacheBlock
(
mem_blk
);

579 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

580 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i - 1]);

587 
	`∑πôi⁄
(
acs_ö
[
k
], 
mem_blk
, &
mem_blk_ªsidít
, &
mem_blk_ab£¡
);

588 
n_ñems
 = 
	`gëC¨döÆôy
(
mem_blk_ab£¡
);

590 if(
n_ñems
 !0 &&Ç_ñem†<
CACHE_SET_SIZE
)

592 
i
 = 
n_ñems
; i < 
CACHE_SET_SIZE
; i++)

594 
acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][ò- 
n_ñems
]);

596 
i
 = 0; i < 
n_ñems
; i++)

597 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

599 if(
n_ñems
 != 0)

601 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

602 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

605 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

606 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

608 
ôî
 = 
mem_blk_ªsidít
; iãr; iã∏ôî->
√xt
)

610 
ãmp
.
block
 = 
ôî
->block;

611 
ãmp
.
√xt
 = 
NULL
;

612 
h
 = 
	`checkF‹In˛usi⁄
(
acs_ö
[
k
], &
ãmp
);

614 #ifde‡
MEM_FREE


615 
	`‰ìCacheSë
(
ªt_acs_out
[
k
]);

619 if(
h
 == 0)

621 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

623 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

626 if(
h
 != -1)

628 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

629 
i
 = 1; i < 
h
 - 1; i++)

631 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

633 
ªt_acs_out
[
k
][
h
] = 
	`Uni⁄
(
acs_out
[k][h],ács_out[k][h - 1]);

634 
i
 = 
h
 + 1; i < 
CACHE_SET_SIZE
; i++)

636 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

641 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

642 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

643 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

645 #ifde‡
MEM_FREE


646 
	`‰ìCacheSë
(
acs_out
[
k
]);

648 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

649 
acs_out
[
k
][
i
] = 
	`makeC›y
(
ªt_acs_out
[k][i]);

653 #ifde‡
MEM_FREE


654 
	`‰ìMemBlock
(
mem_blk_ªsidít
);

655 
	`‰ìMemBlock
(
mem_blk_ab£¡
);

656 
	`‰ìMemBlock
(
mem_blk
);

657 
	`‰ìMemBlock
(
Æl_blk
);

660  
ªt_acs_out
;

661 
	}
}

664 
	#DBG_PS_UPDATE
 0

	)

665 
acs_p
** 
	$upd©e_Reöhîd
(
acs_p
** 
acs_ö
, 
ric_p
 
addr
)

667 
mem_blk_£t_t
* 
mem_blk
, *
mem_blk_ªsidít
, *
mem_blk_ab£¡
, *
ôî
;

668 
acs_p
 
l_t›
;

669 
n_ñems
, 
h
, 
i
;

670 
k
,
j
;

671 
mem_blk_£t_t
* 
Æl_blk
;

672 
mem_blk_£t_t
 
ãmp
;

673 
acs_p
** 
acs_out
;

674 
acs_p
** 
ªt_acs_out
;

676 #i‡
DBG_PS_UPDATE


677 
	`Ârötf
(
Â
, "Update PS: \n");

678 
	`dumpCacheBB
(
acs_ö
,
Â
);

679 if(
addr
 &&áddr->
uµî_bound
>0) {

680 
	`Ârötf
(
Â
, "(0x%x,0x%x,0x%x) #blk:%d\n",

681 
	`GET_MEM
(
addr
->
lowî_bound
),GET_MEM◊ddr->
uµî_bound
),addr->
°ride
,

682 
	`GET_MEM
(
addr
->
uµî_bound
)-GET_MEM◊ddr->
lowî_bound
)+1);

685 
	`Ârötf
(
Â
, "UNKNOWN, shouldÇotÖass here\n");

688 
Æl_blk
 = 
	`gëMem‹yBlocks
(
addr
);

691 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

692 
	`CHECK_MEM
(
acs_out
);

693 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

695 
ªt_acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

696 
	`CHECK_MEM
(
ªt_acs_out
);

697 
	`mem£t
(
ªt_acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

699 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

701 
mem_blk
 = 
	`gëMem‹yBlockOfSë
(
Æl_blk
, 
k
);

702 
acs_out
[
k
] = 
	`makeCacheSë
();

703 
ªt_acs_out
[
k
] = 
	`makeCacheSë
();

705 if(!
mem_blk
) {

706 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

707 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i]);

711 i‡(
	`gëC¨döÆôy
(
Æl_blk
)==1) {

712 
h
 = 
	`checkF‹In˛usi⁄SögÀ
(
acs_ö
[
k
], 
mem_blk
);

713 #i‡
DBG_PS_UPDATE


716 
	`Ârötf
(
Â
,"Upd©êsögÀ cache, in˛usi⁄ %d\n",
h
);
	`fÊush
(fp);

719 if(
h
 == 0)

721 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

722 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i]);

724 if(
h
 != -1)

726 
ªt_acs_out
[
k
][0] = 
	`makeCacheBlock
(
mem_blk
);

727 
i
 = 1; i < 
h
 - 1; i++)

728 
ªt_acs_out
[
k
][
i
] = 
	`Dif„ªn˚
(
acs_ö
[k][ò- 1],
mem_blk
);

730 
ªt_acs_out
[
k
][
h
] = 
	`Uni⁄
(
acs_out
[k][h], 
acs_ö
[k][h - 1]);

731 
i
 = 
h
 + 1; i < 
CACHE_SET_SIZE
; i++)

732 
ªt_acs_out
[
k
][
i
] = 
	`Dif„ªn˚
(
acs_ö
[k][i],
mem_blk
);

733 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`Dif„ªn˚
(
acs_ö
[k][PSEUDO],
mem_blk
);

740 
ªt_acs_out
[
k
][0] = 
	`makeCacheBlock
(
mem_blk
);

741 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

742 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][i - 1]);

743 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`Uni⁄
(
acs_ö
[k][PSEUDO],

744 
acs_ö
[
k
][
CACHE_SET_SIZE
 - 1]);

752 
	`∑πôi⁄
(
acs_ö
[
k
], 
mem_blk
, &
mem_blk_ªsidít
, &
mem_blk_ab£¡
);

753 
n_ñems
 = 
	`gëC¨döÆôy
(
mem_blk_ab£¡
);

754 #i‡
DBG_PS_UPDATE


755 
	`Ârötf
(
Â
,"Cachê£à%d,Ç_ñem†%d, block së:\¿",
k
,
n_ñems
);

759 if(
n_ñems
 !0 &&Ç_ñem†<
CACHE_SET_SIZE
)

761 
i
 = 
n_ñems
; i < 
CACHE_SET_SIZE
; i++)

763 
acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][ò- 
n_ñems
]);

765 
i
 = 0; i < 
n_ñems
 - 1; i++)

766 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

767 
acs_out
[
k
][
n_ñems
 - 1] = 
	`makeCacheBlock
(
mem_blk_ab£¡
);

768 
l_t›
 = 
	`makeC›y
(
acs_ö
[
k
][
PSEUDO
]);

769 
i
 = 
CACHE_SET_SIZE
 - 
n_ñems
; i <= CACHE_SET_SIZE; i++)

770 
l_t›
 = 
	`Uni⁄
÷_t›, 
acs_ö
[
k
][
i
]);

771 
acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
l_t›
);

772 
	`mem_‰ì
(
l_t›
);

774 if(
n_ñems
 != 0)

776 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

777 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

778 
l_t›
 = 
	`makeC›y
(
acs_ö
[
k
][
PSEUDO
]);

779 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

781 
l_t›
 = 
	`Uni⁄
÷_t›, 
acs_ö
[
k
][
i
]);

783 
l_t›
 = 
	`Uni⁄CacheMem
÷_t›, 
mem_blk_ab£¡
);

785 
	`Ârötf
(
Â
, "l_top cache: \n");

786 
	`dumpMem‹yBlocks
(
l_t›
->
mem_blk_h
,
Â
);

788 
acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
l_t›
);

789 
	`mem_‰ì
(
l_t›
);

793 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

794 
acs_out
[
k
][
i
] = 
acs_ö
[k][i];

797 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

798 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

800 
ôî
 = 
mem_blk_ªsidít
; iãr; iã∏ôî->
√xt
)

802 
ãmp
.
block
 = 
ôî
->block;

803 
ãmp
.
√xt
 = 
NULL
;

804 
h
 = 
	`checkF‹In˛usi⁄
(
acs_ö
[
k
], &
ãmp
);

806 #ifde‡
MEM_FREE


807 
	`‰ìCacheSë
(
ªt_acs_out
[
k
]);

810 if(
h
 == 0)

812 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

813 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

815 if(
h
 != -1)

817 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

818 
i
 = 1; i < 
h
 - 1; i++)

819 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

820 
ªt_acs_out
[
k
][
h
] = 
	`Uni⁄
(
acs_out
[k][h],ács_out[k][h - 1]);

821 
i
 = 
h
 + 1; i < 
CACHE_SET_SIZE
; i++)

822 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

823 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
acs_out
[k][PSEUDO]);

827 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

828 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

829 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

830 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`Uni⁄
(
acs_out
[k][PSEUDO],

831 
acs_out
[
k
][
CACHE_SET_SIZE
 - 1]);

833 #ifde‡
MEM_FREE


834 
	`‰ìCacheSë
(
acs_out
[
k
]);

836 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

837 
acs_out
[
k
][
i
] = 
	`makeC›y
(
ªt_acs_out
[k][i]);

840 #i‡
DBG_PS_UPDATE


841 
	`Ârötf
(
Â
, "After Update PS: \n");

842 
	`dumpCacheBB
(
ªt_acs_out
,
Â
);

845 #ifde‡
MEM_FREE


846 
	`‰ìMemBlock
(
mem_blk_ªsidít
);

847 
	`‰ìMemBlock
(
mem_blk_ab£¡
);

848 
	`‰ìMemBlock
(
mem_blk
);

849 
	`‰ìMemBlock
(
Æl_blk
);

852  
ªt_acs_out
;

853 
	}
}

856 
acs_p
** 
	$upd©e_Reöhîd1
(
acs_p
** 
acs_ö
, 
ric_p
 
addr
)

858 
mem_blk_£t_t
* 
mem_blk
, *
mem_blk_ªsidít
, *
mem_blk_ab£¡
, *
ôî
;

859 
acs_p
 
l_t›
;

860 
n_ñems
, 
h
, 
i
;

861 
k
,
j
;

862 
mem_blk_£t_t
* 
Æl_blk
;

863 
mem_blk_£t_t
 
ãmp
;

864 
acs_p
** 
acs_out
;

865 
acs_p
** 
ªt_acs_out
;

866 
Æl_blk
 = 
	`gëMem‹yBlocks
(
addr
);

868 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

869 
	`CHECK_MEM
(
acs_out
);

870 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

872 
ªt_acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

873 
	`CHECK_MEM
(
ªt_acs_out
);

874 
	`mem£t
(
ªt_acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

876 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

878 
mem_blk
 = 
	`gëMem‹yBlockOfSë
(
Æl_blk
, 
k
);

879 
acs_out
[
k
] = 
	`makeCacheSë
();

880 
ªt_acs_out
[
k
] = 
	`makeCacheSë
();

882 if(!
mem_blk
)

887 
	`∑πôi⁄
(
acs_ö
[
k
], 
mem_blk
, &
mem_blk_ªsidít
, &
mem_blk_ab£¡
);

888 
n_ñems
 = 
	`gëC¨döÆôy
(
mem_blk_ab£¡
);

890 if(
n_ñems
 !0 &&Ç_ñem†<
CACHE_SET_SIZE
)

892 
i
 = 
n_ñems
; i < 
CACHE_SET_SIZE
; i++)

894 
acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_ö
[k][ò- 
n_ñems
]);

896 
i
 = 0; i < 
n_ñems
 - 1; i++)

897 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

898 
acs_out
[
k
][
n_ñems
 - 1] = 
	`makeCacheBlock
(
mem_blk_ab£¡
);

899 
l_t›
 = 
	`makeC›y
(
acs_ö
[
k
][
PSEUDO
]);

900 
i
 = 
CACHE_SET_SIZE
 - 
n_ñems
; i < CACHE_SET_SIZE; i++)

901 
l_t›
 = 
	`Uni⁄
÷_t›, 
acs_ö
[
k
][
i
]);

902 
acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
l_t›
);

903 
	`mem_‰ì
(
l_t›
);

905 if(
n_ñems
 != 0)

907 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

908 
acs_out
[
k
][
i
] = 
	`makeEm±y
();

909 
l_t›
 = 
	`makeC›y
(
acs_ö
[
k
][
PSEUDO
]);

910 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

912 
l_t›
 = 
	`Uni⁄
÷_t›, 
acs_ö
[
k
][
i
]);

914 
l_t›
 = 
	`Uni⁄CacheMem
÷_t›, 
mem_blk_ab£¡
);

915 
acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
l_t›
);

916 
	`mem_‰ì
(
l_t›
);

919 
ôî
 = 
mem_blk_ªsidít
; iãr; iã∏ôî->
√xt
)

921 
ãmp
.
block
 = 
ôî
->block;

922 
ãmp
.
√xt
 = 
NULL
;

923 
h
 = 
	`checkF‹In˛usi⁄
(
acs_ö
[
k
], &
ãmp
);

926 if(
h
 == 0)

928 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

929 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

931 if(
h
 != -1)

933 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

934 
i
 = 1; i < 
h
 - 1; i++)

935 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

936 
ªt_acs_out
[
k
][
h
] = 
	`Uni⁄
(
acs_out
[k][h],ács_out[k][h - 1]);

937 
i
 = 
h
 + 1; i < 
CACHE_SET_SIZE
; i++)

938 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i]);

939 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`makeC›y
(
acs_out
[k][PSEUDO]);

943 
ªt_acs_out
[
k
][0] = 
	`makeEm±y
();

944 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

945 
ªt_acs_out
[
k
][
i
] = 
	`makeC›y
(
acs_out
[k][i - 1]);

946 
ªt_acs_out
[
k
][
PSEUDO
] = 
	`Uni⁄
(
acs_out
[k][PSEUDO],

947 
acs_out
[
k
][
CACHE_SET_SIZE
 - 1]);

949 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

950 
acs_out
[
k
][
i
] = 
	`makeC›y
(
ªt_acs_out
[k][i]);

954  
ªt_acs_out
;

955 
	}
}

957 
acs_p
 
	$Dif„ªn˚
(
acs_p
 
acs
, 
mem_blk_£t_t
* 
mem_blk
)

959 
mem_blk_£t_t
* 
ôî
;

960 
acs_p
 
ªt
;

962 if(!
acs
)

963  
NULL
;

965 
ªt
 = (
acs_p
)
	`mÆloc
((
acs_s
));

966 
	`CHECK_MEM
(
ªt
);

967 
ªt
->
mem_blk_h
 = 
NULL
;

969 
ôî
 = 
acs
->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

971 if(
ôî
->
block
 !
mem_blk
->block)

973 
mem_blk_£t_t
* 
ãmp
 = (mem_blk_£t_à*)
	`mÆloc
((

974 
mem_blk_£t_t
));

975 
	`CHECK_MEM
(
ãmp
);

976 
ãmp
->
block
 = 
ôî
->block;

977 
ãmp
->
√xt
 = 
ªt
->
mem_blk_h
;

978 
ªt
->
mem_blk_h
 = 
ãmp
;

982  
ªt
;

983 
	}
}

986 
acs_p
* 
	$c›y_ˇche
(
acs_p
* 
acs
)

988 
i
;

989 
acs_p
* 
de°
 = 
NULL
;

991 if(! 
acs
)

992  
NULL
;

995 
de°
 = 
	`makeCacheSë
();

997 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

999 
de°
[
i
] = 
	`makeC›y
(
acs
[i]);

1002  
de°
;

1003 
	}
}

1005 
acs_p
* 
	$upd©e_sögÀt⁄
(
acs_p
* 
acs
, 
mem_blk_£t_t
* 
mem_blk_£t
)

1007 
löe
;

1008 
acs_p
* 
ªt
;

1009 
i
, 
j
;

1010 
mem_blk_£t_t
* 
ãmp
;

1012 
ãmp
 = (
mem_blk_£t_t
 *)
	`mÆloc
((mem_blk_set_t));

1013 
	`CHECK_MEM
(
ãmp
);

1014 
ãmp
->
block
 = 
mem_blk_£t
->block;

1015 
ãmp
->
√xt
 = 
NULL
;

1017 
ªt
 = 
	`makeCacheSë
();

1019 
löe
 = 0;Üöê< 
CACHE_SET_SIZE
;Üine++)

1021 if(! 
acs
)

1023 
löe
 = 
CACHE_SET_SIZE
;

1026 if(
acs
[
löe
] && 
	`isResidít
◊cs[löe]->
mem_blk_h
, 
ãmp
))

1030 if(
löe
 < 
CACHE_SET_SIZE
)

1032 
i
 = 1; i < 
löe
; i++)

1033 
ªt
[
i
] = 
	`makeC›y
(
acs
[i - 1]);

1034 if(
löe
 > 0)

1035 
ªt
[
löe
] = 
	`Uni⁄
(
	`Dif„ªn˚
(
acs
[löe], 
ãmp
),ács[line - 1]);

1036 
i
 = 
löe
 + 1; i < 
CACHE_SET_SIZE
; i++)

1037 
ªt
[
i
] = 
	`makeC›y
(
acs
[i]);

1038 
ªt
[0] = 
	`makeCacheBlock
(
ãmp
);

1040 if(
löe
 =0 && 
acs
[0])

1042 
ªt
[1] = 
	`Uni⁄
(
	`Dif„ªn˚
(
acs
[0], 
ãmp
),Ñet[1]);

1048 
i
 = 1; i < 
CACHE_SET_SIZE
; i++)

1049 
ªt
[
i
] = 
	`makeC›y
(
acs
[i - 1]);

1050 
ªt
[0] = 
	`makeCacheBlock
(
ãmp
);

1053 
ªt
[
PSEUDO
] = 
	`Uni⁄
(
acs
[PSEUDO],ács[
CACHE_SET_SIZE
 - 1]);

1055 
	`‰ì
(
ãmp
);

1057  
ªt
;

1058 
	}
}

1062 
acs_p
* 
	$joöCache
(
acs_p
* 
acs1
,ács_p* 
¨g
, 
ANALYSIS_T
 
ty≥
)

1064 
acs_p
 
ãmp
 = 
NULL
;

1065 
acs_p
 
vÆ
 = 
NULL
;

1066 
i
, 
j
;

1067 
acs_p
* 
acs
;

1068 
mem_blk_£t_t
* 
ôî
;

1070 if(!
acs1
)

1071  
	`c›y_ˇche
(
¨g
);

1073 
acs
 = 
	`makeCacheSë
();

1079 if(
ty≥
 =
MUST
)

1081 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

1083 
ãmp
 = 
NULL
;

1084 
vÆ
 = 
NULL
;

1090 
j
 = 
i
; j >= 0; j--)

1092 
vÆ
 = 
ãmp
;

1093 
ãmp
 = 
	`Uni⁄
—emp, 
	`I¡î£˘
(
acs1
[
i
], 
¨g
[
j
]));

1094 #ifde‡
MEM_FREE


1095 if(
vÆ
)

1096 
	`‰ìCacheLöe
(
vÆ
);

1099 
j
 = 
i
; j >= 0; j--)

1101 
vÆ
 = 
ãmp
;

1102 
ãmp
 = 
	`Uni⁄
—emp, 
	`I¡î£˘
(
¨g
[
i
], 
acs1
[
j
]));

1103 #ifde‡
MEM_FREE


1104 if(
vÆ
)

1105 
	`‰ìCacheLöe
(
vÆ
);

1109 
acs
[
i
] = 
ãmp
;

1114 if(
ty≥
 =
MAY
)

1116 
i
 = 0; i < 
CACHE_SET_SIZE
; i++)

1118 
ãmp
 = 
NULL
;

1119 
vÆ
 = 
NULL
;

1121 if(
acs1
[
i
])

1123 
ôî
 = 
acs1
[
i
]->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1125 
j
 = 
i
 - 1; j >=0; j--)

1127 if(
¨g
[
j
] && 
	`isResidít
◊rg[j]->
mem_blk_h
, 
ôî
))

1132 if(
j
 < 0)

1134 
mem_blk_£t_t
* 
cur
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

1135 
cur
->
block
 = 
ôî
->block;

1136 
cur
->
√xt
 = 
NULL
;

1137 
vÆ
 = 
ãmp
;

1138 
ãmp
 = 
	`Uni⁄CacheMem
—emp, 
cur
);

1139 #ifde‡
MEM_FREE


1140 if(
vÆ
)

1141 
	`‰ìCacheLöe
(
vÆ
);

1143 
	`‰ì
(
cur
);

1147 if(
¨g
[
i
])

1149 
ôî
 = 
¨g
[
i
]->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1151 
j
 = 
i
 - 1; j >=0; j--)

1153 if(
acs1
[
j
] && 
	`isResidít
◊cs1[j]->
mem_blk_h
, 
ôî
))

1158 if(
j
 < 0)

1160 
mem_blk_£t_t
* 
cur
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

1161 
cur
->
block
 = 
ôî
->block;

1162 
cur
->
√xt
 = 
NULL
;

1163 
vÆ
 = 
ãmp
;

1164 
ãmp
 = 
	`Uni⁄CacheMem
—emp, 
cur
);

1165 #ifde‡
MEM_FREE


1166 if(
vÆ
)

1167 
	`‰ìCacheLöe
(
vÆ
);

1169 
	`‰ì
(
cur
);

1173 
acs
[
i
] = 
ãmp
;

1178 if(
ty≥
 =
PERSISTENCE
)

1180 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

1182 
ãmp
 = 
NULL
;

1183 
vÆ
 = 
NULL
;

1185 if(
acs1
[
i
])

1187 
ôî
 = 
acs1
[
i
]->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1189 
j
 = 
i
 + 1; j <
CACHE_SET_SIZE
; j++)

1191 if(
¨g
[
j
] && 
	`isResidít
◊rg[j]->
mem_blk_h
, 
ôî
))

1196 if(
j
 > 
CACHE_SET_SIZE
)

1198 
mem_blk_£t_t
* 
cur
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

1199 
cur
->
block
 = 
ôî
->block;

1200 
cur
->
√xt
 = 
NULL
;

1201 
vÆ
 = 
ãmp
;

1202 
ãmp
 = 
	`Uni⁄CacheMem
—emp, 
cur
);

1203 #ifde‡
MEM_FREE


1204 if(
vÆ
)

1205 
	`‰ìCacheLöe
(
vÆ
);

1207 
	`‰ì
(
cur
);

1211 if(
¨g
[
i
])

1213 
ôî
 = 
¨g
[
i
]->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1215 
j
 = 
i
 + 1; j <
CACHE_SET_SIZE
; j++)

1217 if(
acs1
[
j
] && 
	`isResidít
◊cs1[j]->
mem_blk_h
, 
ôî
))

1222 if(
j
 > 
CACHE_SET_SIZE
)

1224 
mem_blk_£t_t
* 
cur
 = (mem_blk_£t_à*)
	`mÆloc
((mem_blk_set_t));

1225 
cur
->
block
 = 
ôî
->block;

1226 
cur
->
√xt
 = 
NULL
;

1227 
vÆ
 = 
ãmp
;

1228 
ãmp
 = 
	`Uni⁄CacheMem
—emp, 
cur
);

1229 #ifde‡
MEM_FREE


1230 if(
vÆ
)

1231 
	`‰ìCacheLöe
(
vÆ
);

1233 
	`‰ì
(
cur
);

1237 
acs
[
i
] = 
ãmp
;

1241  
acs
;

1242 
	}
}

1245 
acs_p
** 
	$upd©e_abs_ö°
(
acs_p
** 
acs_ö
, 
addr
)

1247 
mem_blk_£t_t
 
mem_blk
, *
ôî
;

1248 
acs_p
* 
ãmp
;

1249 
acs_p
** 
acs_out
;

1250 
£t
,
i
;

1252 
mem_blk
.
block
 = 
	`GET_MEM
(
addr
);

1253 
mem_blk
.
√xt
 = 
NULL
;

1255 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1256 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1258 
i
 = 0; i < 
MAX_CACHE_SET
; i++)

1259 
acs_out
[
i
] = 
	`c›y_ˇche
(
acs_ö
[i]);

1263 
£t
 = 
	`GET_SET
(
mem_blk
.
block
);

1264 
ãmp
 = 
	`upd©e_sögÀt⁄
(
acs_ö
[
£t
], &
mem_blk
);

1265 
mem_blk
.
block
 = 
	`GET_MEM
(
addr
 + 
SIZE_OF_WORD
);

1266 
£t
 = 
	`GET_SET
(
mem_blk
.
block
);

1267 
acs_out
[
£t
] = 
	`upd©e_sögÀt⁄
(
ãmp
, &
mem_blk
);

1269 #ifde‡
MEM_FREE


1270 
	`‰ìCacheSë
(
ãmp
);

1273  
acs_out
;

1274 
	}
}

1278 
acs_p
** 
	$upd©e_A
(
acs_p
** 
acs_ö
, 
ric_p
 
addr
, 
ANALYSIS_T
 
ty≥
)

1280 
mem_blk_£t_t
* 
mem_blk
, *
ôî
;

1281 
acs_p
** 
acs_out
;

1282 
£t
;

1283 
acs_p
* 
ãmp
, *
cur
;

1284 
i
;

1288 
mem_blk
 = 
	`gëMem‹yBlocks
(
addr
);

1289 
£t
 = 
	`GET_SET
(
mem_blk
->
block
);

1291 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1292 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1294 
i
 = 0; i < 
MAX_CACHE_SET
; i++)

1295 
acs_out
[
i
] = 
	`c›y_ˇche
(
acs_ö
[i]);

1301 
acs_out
[
£t
] = 
	`upd©e_sögÀt⁄
(
acs_ö
[£t], 
mem_blk
);

1303 if(
	`gëC¨döÆôy
(
mem_blk
) > 1)

1311 
ôî
 = 
mem_blk
->
√xt
; iter; iter = iter->next)

1313 
£t
 = 
	`GET_SET
(
ôî
->
block
);

1314 
ãmp
 = 
	`upd©e_sögÀt⁄
(
acs_ö
[
£t
], 
ôî
);

1315 
cur
 = 
acs_out
[
£t
];

1316 #ifde‡
_DEBUG


1317 
™Æysis
++;

1319 
acs_out
[
£t
] = 
	`joöCache
◊cs_out[£t], 
ãmp
, 
ty≥
);

1321 #ifde‡
MEM_FREE


1322 
	`‰ìCacheSë
(
cur
);

1336 #ifde‡
MEM_FREE


1337 
	`‰ìCacheSë
(
ãmp
);

1342 #ifde‡
MEM_FREE


1343 
	`‰ìMemBlock
(
mem_blk
);

1346  
acs_out
;

1347 
	}
}

1350 
	$is_ßme_ˇche_block
(
acs_p
 
acs1
,ács_∞
acs2
)

1352 
mem_blk_£t_t
* 
ôî
;

1354 if(!
acs1
 && !
acs2
)

1356 if(!
acs1
 || !
acs2
)

1359 
ôî
 = 
acs1
->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1361 if(!
	`isResidít
(
acs2
->
mem_blk_h
, 
ôî
))

1365 if(
	`gëC¨döÆôy
(
acs1
->
mem_blk_h
) ==

1366 
	`gëC¨döÆôy
(
acs2
->
mem_blk_h
))

1370 
	}
}

1373 
	$checkEquÆôy
(
acs_p
* 
acs1
,ács_p* 
acs2
)

1375 
i
;

1377 if(!
acs1
 && !
acs2
)

1379 if(!
acs1
 || !
acs2
)

1381 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

1383 if(! 
acs1
[
i
] && !
acs2
[i])

1385 if(!
acs1
[
i
] || !
acs2
[i])

1387 if(!
	`is_ßme_ˇche_block
(
acs1
[
i
], 
acs2
[i]))

1392 
	}
}

1395 
	$å™sf‹ml2In°CacheSèã
(
tcfg_node_t
* 
bbi
, * 
ch™ge_Êag
, 
ANALYSIS_T
 
ty≥
)

1397 
de_ö°_t
* 
ö°
;

1398 
n_ö°
;

1399 
ba£
, 
imm
, 
ödex
;

1400 * 
iß_«me
;

1401 
ric_p
 
addr
;

1402 
acs_p
** 
acs_out
 = 
NULL
;

1403 
k
;

1405 
	`as£π
(
bbi
);

1406 
	`as£π
(
bbi
->
bb
);

1407 
ö°
 = 
bbi
->
bb
->
code
;

1409 
n_ö°
 = 0;Ç_ö° < 
bbi
->
bb
->
num_ö°
;Ç_inst++)

1411 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1416 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1417 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1419 if(!
ö°
->
acs_out
)

1421 
ö°
->
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1422 
	`mem£t
(
ö°
->
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1425 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1427 
acs_out
[
k
] = 
	`c›y_ˇche
(
ö°
->acs_out[k]);

1429 if(!
ö°
->
acs_out
[
k
])

1431 
ö°
->
acs_out
[
k
] = 
	`makeCacheSë
();

1435 if(
ö°
->
ö°_ac˚ss
 =
ALL_MISS
)

1437 
ö°
->
acs_out
 = 
	`upd©e_abs_ö°
(ö°->
acs_ö
, in°->
addr
);

1439 if(
ö°
->
ö°_ac˚ss
 =
NOT_CLASSIFIED
 ||

1440 
ö°
->
ö°_ac˚ss
 =
PS
)

1442 
ö°
->
acs_out
 = 
	`upd©e_abs_ö°
(ö°->
acs_ö
, in°->
addr
);

1443 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1444 
ö°
->
acs_out
[
k
] = 
	`joöCache
(ö°->
acs_ö
[k], in°->acs_out[k], 
ty≥
);

1450 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1451 
ö°
->
acs_out
[
k
] = 
	`c›y_ˇche
(ö°->
acs_ö
[k]);

1454 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1455 *
ch™ge_Êag
 |!
	`checkEquÆôy
(
ö°
->
acs_out
[
k
],ács_out[k]);

1457 if(
n_ö°
 < 
bbi
->
bb
->
num_ö°
 - 1)

1459 
de_ö°_t
* 
√xt_ö°
 = 
ö°
 + 1;

1460 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1461 
√xt_ö°
->
acs_ö
[
k
] = 
ö°
->
acs_out
[k];

1462 
ö°
++;

1465 
	}
}

1468 
	$å™sf‹mIn°CacheSèã
(
tcfg_node_t
* 
bbi
, * 
ch™ge_Êag
)

1470 
de_ö°_t
* 
ö°
;

1471 
n_ö°
;

1472 
ba£
, 
imm
, 
ödex
;

1473 * 
iß_«me
;

1474 
ric_p
 
addr
;

1475 
acs_p
** 
acs_out
;

1476 
k
;

1478 
	`as£π
(
bbi
);

1479 
	`as£π
(
bbi
->
bb
);

1480 
ö°
 = 
bbi
->
bb
->
code
;

1482 
n_ö°
 = 0;Ç_ö° < 
bbi
->
bb
->
num_ö°
;Ç_inst++)

1484 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1489 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1490 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1491 if(!
ö°
->
acs_out
)

1493 
ö°
->
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1494 
	`mem£t
(
ö°
->
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1496 
k
 = 0; k < 
MAX_CACHE_SET
; k++) {

1497 
acs_out
[
k
] = 
	`c›y_ˇche
(
ö°
->acs_out[k]);

1499 if(!
ö°
->
acs_out
[
k
])

1501 
ö°
->
acs_out
[
k
] = 
	`makeCacheSë
();

1504 
ö°
->
acs_out
 = 
	`upd©e_abs_ö°
(ö°->
acs_ö
, in°->
addr
);

1505 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1506 *
ch™ge_Êag
 |!
	`checkEquÆôy
(
ö°
->
acs_out
[
k
],ács_out[k]);

1508 if(
n_ö°
 < 
bbi
->
bb
->
num_ö°
 - 1)

1510 
de_ö°_t
* 
√xt_ö°
 = 
ö°
 + 1;

1511 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1512 
√xt_ö°
->
acs_ö
[
k
] = 
ö°
->
acs_out
[k];

1513 
ö°
++;

1516 
	}
}

1519 
	$å™sf‹mUnifõdCacheSèã
(
tcfg_node_t
* 
bbi
, * 
ch™ge_Êag
, 
ANALYSIS_T
 
ty≥
)

1521 
de_ö°_t
* 
ö°
;

1522 
n_ö°
;

1523 
ba£
, 
imm
, 
ödex
;

1524 * 
iß_«me
;

1525 
ric_p
 
addr
;

1526 
acs_p
** 
acs_out
;

1527 
acs_p
** 
ãmp
;

1528 
k
;

1530 
	`as£π
(
bbi
);

1531 
	`as£π
(
bbi
->
bb
);

1532 
ö°
 = 
bbi
->
bb
->
code
;

1534 
n_ö°
 = 0;Ç_ö° < 
bbi
->
bb
->
num_ö°
;Ç_inst++)

1536 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1541 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1542 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1544 if(!
ö°
->
acs_out
)

1546 
ö°
->
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1547 
	`mem£t
(
ö°
->
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1550 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1552 
acs_out
[
k
] = 
	`c›y_ˇche
(
ö°
->acs_out[k]);

1554 if(!
ö°
->
acs_out
[
k
])

1556 
ö°
->
acs_out
[
k
] = 
	`makeCacheSë
();

1562 if(
ö°
->
ö°_ac˚ss
 =
ALL_MISS
)

1564 #ifde‡
_DEBUG


1565 
unifõd
++;

1567 
ãmp
 = 
	`upd©e_abs_ö°
(
ö°
->
acs_ö
, in°->
addr
);

1569 if(
ö°
->
ö°_ac˚ss
 =
NOT_CLASSIFIED
 || in°->ö°_ac˚s†=
PS
)

1571 #ifde‡
_DEBUG


1572 
unifõd
++;

1574 
ãmp
 = 
	`upd©e_abs_ö°
(
ö°
->
acs_ö
, in°->
addr
);

1575 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1576 
ãmp
[
k
] = 
	`joöCache
(
ö°
->
acs_ö
[k],Åemp[k], 
ty≥
);

1580 
ãmp
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1581 
	`mem£t
(
ãmp
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1582 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1583 
ãmp
[
k
] = 
	`c›y_ˇche
(
ö°
->
acs_ö
[k]);

1586 if(
	`isSt‹eIn°
(
iß_«me
))

1588 if(
ö°
->
num_ö
 <= 2)

1590 
imm
 = 
ö°
->imm;

1591 
ba£
 = *(
ö°
->
ö
 + 1);

1592 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

1594 if(
ö°
->
num_ö
 == 3)

1596 
ba£
 = *(
ö°
->
ö
 + 1);

1597 
ödex
 = *(
ö°
->
ö
 + 2);

1598 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

1600 if(
ö°
->
d©a_ac˚ss
 =
ALL_MISS
)

1602 #ifde‡
_DEBUG


1603 
unifõd
++;

1605 if(
ty≥
 =
PERSISTENCE
)

1606 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(
ãmp
, 
addr
);

1607 if(
ty≥
 =
MUST
)

1608 
ö°
->
acs_out
 = 
	`upd©e_mu°
(
ãmp
, 
addr
, 
ty≥
);

1609 if(
ty≥
 =
MAY
)

1610 
ö°
->
acs_out
 = 
	`upd©e_A
(
ãmp
, 
addr
, 
MAY
);

1612 if(
ö°
->
d©a_ac˚ss
 =
NOT_CLASSIFIED
 || in°->d©a_ac˚s†=
PS
)

1614 #ifde‡
_DEBUG


1615 
unifõd
++;

1617 if(
ty≥
 =
PERSISTENCE
)

1618 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(
ãmp
, 
addr
);

1619 if(
ty≥
 =
MUST
)

1620 
ö°
->
acs_out
 = 
	`upd©e_mu°
(
ãmp
, 
addr
, 
MUST
);

1621 if(
ty≥
 =
MAY
)

1622 
ö°
->
acs_out
 = 
	`upd©e_A
(
ãmp
, 
addr
, 
MAY
);

1624 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1625 
ö°
->
acs_out
[
k
] = 
	`joöCache
(ö°->acs_out[k], 
ãmp
[k], 
ty≥
);

1629 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1630 
ö°
->
acs_out
[
k
] = 
	`c›y_ˇche
(
ãmp
[k]);

1634 if(
	`isLﬂdIn°
(
iß_«me
))

1636 if(
ö°
->
num_ö
 <= 1)

1638 
imm
 = 
ö°
->imm;

1639 
ba£
 = *(
ö°
->
ö
);

1640 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

1642 if(
ö°
->
num_ö
 == 2)

1644 
ba£
 = *(
ö°
->
ö
);

1645 
ödex
 = *(
ö°
->
ö
 + 1);

1646 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

1648 if(
ö°
->
d©a_ac˚ss
 =
ALL_MISS
)

1650 #ifde‡
_DEBUG


1651 
unifõd
++;

1653 if(
ty≥
 =
PERSISTENCE
)

1654 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(
ãmp
, 
addr
);

1655 if(
ty≥
 =
MUST
)

1656 
ö°
->
acs_out
 = 
	`upd©e_mu°
(
ãmp
, 
addr
, 
MUST
);

1657 if(
ty≥
 =
MAY
)

1658 
ö°
->
acs_out
 = 
	`upd©e_A
(
ãmp
, 
addr
, 
MAY
);

1660 if(
ö°
->
d©a_ac˚ss
 =
NOT_CLASSIFIED
 || in°->d©a_ac˚s†=
PS
)

1662 #ifde‡
_DEBUG


1663 
unifõd
++;

1665 if(
ty≥
 =
PERSISTENCE
)

1666 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(
ãmp
, 
addr
);

1667 if(
ty≥
 =
MUST
)

1668 
ö°
->
acs_out
 = 
	`upd©e_mu°
(
ãmp
, 
addr
, 
MUST
);

1669 if(
ty≥
 =
MAY
)

1670 
ö°
->
acs_out
 = 
	`upd©e_A
(
ãmp
, 
addr
, 
MAY
);

1672 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1673 
ö°
->
acs_out
[
k
] = 
	`joöCache
(ö°->acs_out[k], 
ãmp
[k], 
ty≥
);

1677 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1678 
ö°
->
acs_out
[
k
] = 
	`c›y_ˇche
(
ãmp
[k]);

1685 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1686 
ö°
->
acs_out
[
k
] = 
	`c›y_ˇche
(
ãmp
[k]);

1688 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1689 *
ch™ge_Êag
 |!
	`checkEquÆôy
(
ö°
->
acs_out
[
k
],ács_out[k]);

1690 if(
n_ö°
 < 
bbi
->
bb
->
num_ö°
 - 1)

1692 
de_ö°_t
* 
√xt_ö°
 = 
ö°
 + 1;

1693 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1694 
√xt_ö°
->
acs_ö
[
k
] = 
ö°
->
acs_out
[k];

1695 
ö°
++;

1698 
	}
}

1701 
	$å™sf‹mCacheSèã
(
tcfg_node_t
* 
bbi
, * 
ch™ge_Êag
, 
ANALYSIS_T
 
ty≥
)

1703 
de_ö°_t
* 
ö°
;

1704 
n_ö°
;

1705 
ba£
, 
imm
, 
ödex
;

1706 * 
iß_«me
;

1707 
ric_p
 
addr
;

1708 
acs_p
** 
acs_out
;

1709 
acs_p
** 
ãmp
;

1710 
k
;

1712 
	`as£π
(
bbi
);

1713 
	`as£π
(
bbi
->
bb
);

1714 
ö°
 = 
bbi
->
bb
->
code
;

1716 #ifde‡
_DEBUG


1720 
n_ö°
 = 0;Ç_ö° < 
bbi
->
bb
->
num_ö°
;Ç_inst++)

1722 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

1727 
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1728 
	`mem£t
(
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1730 if(!
ö°
->
acs_out
)

1732 
ö°
->
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1733 
	`mem£t
(
ö°
->
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1736 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1738 
acs_out
[
k
] = 
	`c›y_ˇche
(
ö°
->acs_out[k]);

1739 if(!
ö°
->
acs_out
[
k
])

1741 
ö°
->
acs_out
[
k
] = 
	`makeCacheSë
();

1746 if(
	`isSt‹eIn°
(
iß_«me
))

1748 
ãmp
 = 
ö°
->
acs_out
;

1750 if(
ö°
->
num_ö
 <= 2)

1752 
imm
 = 
ö°
->imm;

1753 
ba£
 = *(
ö°
->
ö
 + 1);

1754 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

1756 if(
ty≥
 =
PERSISTENCE
)

1757 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(ö°->
acs_ö
, 
addr
);

1758 if(
ty≥
 =
MUST
)

1759 
ö°
->
acs_out
 = 
	`upd©e_mu°
(ö°->
acs_ö
, 
addr
, 
MUST
);

1760 if(
ty≥
 =
MAY
)

1761 
ö°
->
acs_out
 = 
	`upd©e_A
(ö°->
acs_ö
, 
addr
, 
MAY
);

1763 if(
ö°
->
num_ö
 == 3)

1765 
ba£
 = *(
ö°
->
ö
 + 1);

1766 
ödex
 = *(
ö°
->
ö
 + 2);

1767 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

1769 if(
ty≥
 =
PERSISTENCE
)

1770 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(ö°->
acs_ö
, 
addr
);

1771 if(
ty≥
 =
MUST
)

1772 
ö°
->
acs_out
 = 
	`upd©e_mu°
(ö°->
acs_ö
, 
addr
, 
MUST
);

1773 if(
ty≥
 =
MAY
)

1774 
ö°
->
acs_out
 = 
	`upd©e_A
(ö°->
acs_ö
, 
addr
, 
MAY
);

1777 #ifde‡
MEM_FREE


1778 
	`‰ìCache
(
ãmp
);

1782 if(
	`isLﬂdIn°
(
iß_«me
))

1784 
ãmp
 = 
ö°
->
acs_out
;

1786 if(
ö°
->
num_ö
 <= 1)

1788 
imm
 = 
ö°
->imm;

1789 
ba£
 = *(
ö°
->
ö
);

1790 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

1792 if(
ty≥
 =
PERSISTENCE
)

1793 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(ö°->
acs_ö
, 
addr
);

1794 if(
ty≥
 =
MUST
)

1795 
ö°
->
acs_out
 = 
	`upd©e_mu°
(ö°->
acs_ö
, 
addr
, 
MUST
);

1796 if(
ty≥
 =
MAY
)

1797 
ö°
->
acs_out
 = 
	`upd©e_A
(ö°->
acs_ö
, 
addr
, 
MAY
);

1799 if(
ö°
->
num_ö
 == 2)

1801 
ba£
 = *(
ö°
->
ö
);

1802 
ödex
 = *(
ö°
->
ö
 + 1);

1803 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

1805 if(
ty≥
 =
PERSISTENCE
)

1806 
ö°
->
acs_out
 = 
	`upd©e_Reöhîd
(ö°->
acs_ö
, 
addr
);

1807 if(
ty≥
 =
MUST
)

1808 
ö°
->
acs_out
 = 
	`upd©e_mu°
(ö°->
acs_ö
, 
addr
, 
MUST
);

1809 if(
ty≥
 =
MAY
)

1810 
ö°
->
acs_out
 = 
	`upd©e_A
(ö°->
acs_ö
, 
addr
, 
MAY
);

1812 #ifde‡
MEM_FREE


1813 
	`‰ìCache
(
ãmp
);

1820 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1821 
ö°
->
acs_out
[
k
] = 
	`c›y_ˇche
(ö°->
acs_ö
[k]);

1823 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1824 *
ch™ge_Êag
 |!
	`checkEquÆôy
(
ö°
->
acs_out
[
k
],ács_out[k]);

1825 if(
n_ö°
 < 
bbi
->
bb
->
num_ö°
 - 1)

1827 
de_ö°_t
* 
√xt_ö°
 = 
ö°
 + 1;

1828 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1829 
√xt_ö°
->
acs_ö
[
k
] = 
ö°
->
acs_out
[k];

1830 
ö°
++;

1832 #ifde‡
MEM_FREE


1833 
	`‰ìCache
(
acs_out
);

1837 #ifde‡
_DEBUG


1841 
	}
}

1846 
	$JoöCacheSèã
(
tcfg_node_t
* 
¥ed
,Åcfg_node_t* 
bbi
, 
ty≥
)

1848 
de_ö°_t
* 
f_ö°
, *
l_ö°
;

1849 
acs_p
* 
acs
[
MAX_CACHE_SET
];

1850 
acs_p
* 
¥ed_acs
[
MAX_CACHE_SET
];

1851 
acs_p
* 
ªt
[
MAX_CACHE_SET
];

1852 
acs_p
 
ãmp
 = 
NULL
;

1853 
mem_blk_£t_t
* 
ôî
;

1854 
acs_p
* 
‰ì_p
;

1855 
i
,
j
,
k
;

1857 if(!
¥ed
)

1861 
f_ö°
 = 
bbi
->
bb
->
code
;

1864 
l_ö°
 = 
¥ed
->
bb
->
code
 +Öªd->bb->
num_ö°
 - 1;

1868 
i
 = 0; i < 
MAX_CACHE_SET
; i++)

1870 if(!
l_ö°
->
acs_out
[
i
])

1872 
‰ì_p
 = 
f_ö°
->
acs_ö
[
i
];

1873 
f_ö°
->
acs_ö
[
i
] = 
	`joöCache
(f_ö°->acs_ö[i], 
l_ö°
->
acs_out
[i], 
ty≥
);

1874 #ifde‡
MEM_FREE


1875 
	`‰ìCacheSë
(
‰ì_p
);

1878 
	}
}

1881 #ifde‡
_DEBUG


1885 
	$dumpCacheBB
(
acs_p
** 
acs
, 
FILE
* 
Â
)

1887 
i
,
k
;

1888 
mem_blk_£t_t
* 
ôî
;

1890 if(!
acs
)

1893 
k
 = 0; k < 
MAX_CACHE_SET
; k++)

1895 
i
 = 0; i <
CACHE_SET_SIZE
; i++)

1897 
	`Ârötf
(
Â
, "*************************************\n");

1898 
	`Ârötf
(
Â
, "Prötög cachê(£t,blockË(%d,%d)\n", 
k
,
i
);

1899 
	`Ârötf
(
Â
, "*************************************\n");

1900 if(!
acs
[
k
][
i
])

1901 
	`Ârötf
(
Â
, "{empty}\n");

1902 if(!
acs
[
k
][
i
]->
mem_blk_h
)

1903 
	`Ârötf
(
Â
, "{empty}\n");

1906 
ôî
 = 
acs
[
k
][
i
]->
mem_blk_h
; iãr; iã∏ôî->
√xt
)

1908 
	`Ârötf
(
Â
, "Mem‹y Block %x,", 
ôî
->
block
);

1910 
	`Ârötf
(
Â
, "\n");

1914 
	}
}

1918 
	$dumpCache
()

1920 
i
;

1921 
FILE
* 
Â
;

1923 
Â
 = 
	`f›í
("cache.dump", "w");

1924 if(!
Â
)

1925 
	`¥ötf
("Internal file opening failed\n");

1927 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1929 
de_ö°_t
* 
l_ö°
;

1931 
l_ö°
 = 
tcfg
[
i
]->
bb
->
code
 +Åcfg[i]->bb->
num_ö°
 - 1;

1932 
	`Ârötf
(
Â
, "=====================================\n");

1933 
	`Ârötf
(
Â
, "Aàtcfg block %d\n", 
i
);

1934 
	`Ârötf
(
Â
, "=====================================\n");

1935 
	`dumpCacheBB
(
l_ö°
->
acs_out
, 
Â
);

1938 
	`f˛o£
(
Â
);

1939 
	}
}

1943 
	$dumpIn°Cache
()

1945 
i
;

1946 
FILE
* 
Â
;

1948 
Â
 = 
	`f›í
("inst_cache.dump", "w");

1949 if(!
Â
)

1950 
	`¥ötf
("Internal file opening failed\n");

1952 
i
 = 0; i < 
num_tcfg_nodes
; i++)

1954 
de_ö°_t
* 
l_ö°
;

1956 
l_ö°
 = 
tcfg
[
i
]->
bb
->
code
 +Åcfg[i]->bb->
num_ö°
 - 1;

1958 
	`Ârötf
(
Â
, "=====================================\n");

1959 
	`Ârötf
(
Â
, "Aàtcfg block %d\n", 
i
);

1960 
	`Ârötf
(
Â
, "=====================================\n");

1961 
	`dumpCacheBB
(
l_ö°
->
acs_ö
, 
Â
);

1964 
	`f˛o£
(
Â
);

1965 
	}
}

1969 
	$öôülize_ˇche
(
tcfg_node_t
* 
bbi
)

1971 
de_ö°_t
* 
ö°
 = 
bbi
->
bb
->
code
;

1972 
i
, 
j
;

1974 
	`as£π
(
ö°
);

1976 
j
 = 0; j < 
bbi
->
bb
->
num_ö°
; j++)

1978 
ö°
->
acs_ö
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1979 
	`mem£t
(
ö°
->
acs_ö
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1980 
ö°
->
acs_out
 = (
acs_p
 **)
	`mÆloc
(
MAX_CACHE_SET
 * (acs_p *));

1981 
	`mem£t
(
ö°
->
acs_out
, 0, 
MAX_CACHE_SET
 * (
acs_p
 *));

1982 
ö°
++;

1984 
ö°
 = 
bbi
->
bb
->
code
;

1985 
i
 = 0; i < 
MAX_CACHE_SET
; i++)

1987 
ö°
->
acs_ö
[
i
] = 
	`makeCacheSë
();

1989 
	}
}

1993 
	$ˇãg‹ize_ö°_Æl_miss
(
de_ö°_t
* 
ö°
)

1995 
mem_blk_£t_t
 
ãmp
;

1996 
h1
, 
h2
;

1998 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
);

1999 
ãmp
.
√xt
 = 
NULL
;

2001 
h1
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2002 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
 + 
SIZE_OF_WORD
);

2003 
h2
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2005 if(!
h1
 || !
h2
)

2007 
ö°
->
ö°_ac˚ss
 = 
ALL_MISS
;

2008 #ifde‡
_DEBUG


2012 if(
ö°
->
ö°_ac˚ss
 !
ALL_HIT
)

2014 
ö°
->
ö°_ac˚ss
 = 
NOT_CLASSIFIED
;

2015 #ifde‡
_DEBUG


2019 
	}
}

2023 
	$ˇãg‹ize_l2_ö°_ps
(
de_ö°_t
* 
ö°
)

2025 
mem_blk_£t_t
 
ãmp
;

2026 
h1
, 
h2
;

2028 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
);

2029 
ãmp
.
√xt
 = 
NULL
;

2032 
h1
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, &
ãmp
);

2033 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
 + 
SIZE_OF_WORD
);

2035 
h2
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, &
ãmp
);

2037 if(
ö°
->
ö°_ac˚ss
 =
ALL_HIT
)

2039 
ö°
->
l2_ö°_ac˚ss
 = 
ALL_X
;

2040 #ifde‡
_DEBUG


2044 if(!
h1
 && !
h2
)

2046 if(
ö°
->
l2_ö°_ac˚ss
 !
ALL_HIT
)

2048 
ö°
->
l2_ö°_ac˚ss
 = 
PS
;

2049 #ifde‡
_DEBUG


2052 
i1_u1_ps
 += 1;

2057 
ö°
->
l2_ö°_ac˚ss
 = 
NOT_CLASSIFIED
;

2058 #ifde‡
_DEBUG


2062 
	}
}

2066 
	$ˇãg‹ize_l2_ö°_hô_miss
(
de_ö°_t
* 
ö°
)

2068 
mem_blk_£t_t
 
ãmp
;

2069 
h1
, 
h2
;

2071 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
);

2072 
ãmp
.
√xt
 = 
NULL
;

2074 
h1
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2076 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
 + 
SIZE_OF_WORD
);

2077 
h2
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2080 if(
ö°
->
ö°_ac˚ss
 =
ALL_HIT
)

2082 
ö°
->
l2_ö°_ac˚ss
 = 
ALL_X
;

2083 #ifde‡
_DEBUG


2087 if(
h1
 && 
h2
)

2089 
ö°
->
l2_ö°_ac˚ss
 = 
ALL_HIT
;

2090 #ifde‡
_DEBUG


2096 
ö°
->
l2_ö°_ac˚ss
 = 
NOT_CLASSIFIED
;

2097 #ifde‡
_DEBUG


2101 
	}
}

2105 
	$ˇãg‹ize_ö°_hô_miss
(
de_ö°_t
* 
ö°
)

2107 
mem_blk_£t_t
 
ãmp
;

2108 
h1
, 
h2
;

2110 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
);

2111 
ãmp
.
√xt
 = 
NULL
;

2113 
h1
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2114 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
 + 
SIZE_OF_WORD
);

2115 
h2
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, &
ãmp
);

2117 if(
h1
 && 
h2
)

2119 
ö°
->
ö°_ac˚ss
 = 
ALL_HIT
;

2120 #ifde‡
_DEBUG


2126 
ö°
->
ö°_ac˚ss
 = 
NOT_CLASSIFIED
;

2127 #ifde‡
_DEBUG


2131 
	}
}

2135 
	$ˇãg‹ize_Æl_miss
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
)

2137 
mem_blk_£t_t
* 
ãmp
 = 
	`gëMem‹yBlocks
(
addr
);

2138 
h
;

2140 
h
 = 
	`checkF‹O√Pª£n˚
(
ö°
->
acs_ö
, 
ãmp
);

2142 if(
h
 == 0)

2144 
ö°
->
d©a_ac˚ss
 = 
ALL_MISS
;

2145 #ifde‡
_DEBUG


2150 
	`‰ì
(
ãmp
);

2151 
	}
}

2155 
	$ˇãg‹ize_u1_ps
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
)

2157 
mem_blk_£t_t
* 
ãmp
 = 
	`gëMem‹yBlocks
(
addr
);

2158 
h
;

2161 
h
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, 
ãmp
);

2163 if(
ö°
->
d©a_ac˚ss
 =
ALL_HIT
 || in°->d©a_ac˚s†=
PS
)

2165 
ö°
->
u1_d©a_ac˚ss
 = 
ALL_X
;

2166 #ifde‡
_DEBUG


2170 if(!
h
)

2172 if(
ö°
->
u1_d©a_ac˚ss
 !
ALL_HIT
)

2173 
ö°
->
u1_d©a_ac˚ss
 = 
PS
;

2174 #ifde‡
_DEBUG


2177 
u1_d1_ps
 += 1;

2181 
ö°
->
u1_d©a_ac˚ss
 = 
NOT_CLASSIFIED
;

2182 #ifde‡
_DEBUG


2187 
	`‰ì
(
ãmp
);

2188 
	}
}

2192 
	$ˇãg‹ize_u1_hô_miss
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
)

2194 
mem_blk_£t_t
* 
ãmp
 = 
	`gëMem‹yBlocks
(
addr
);

2195 
h
;

2197 
h
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, 
ãmp
);

2200 if(
ö°
->
d©a_ac˚ss
 =
ALL_HIT
 || in°->d©a_ac˚s†=
PS
)

2202 
ö°
->
u1_d©a_ac˚ss
 = 
ALL_X
;

2203 #ifde‡
_DEBUG


2207 if(
h
)

2209 
ö°
->
u1_d©a_ac˚ss
 = 
ALL_HIT
;

2210 #ifde‡
_DEBUG


2216 
ö°
->
u1_d©a_ac˚ss
 = 
NOT_CLASSIFIED
;

2217 #ifde‡
_DEBUG


2222 
	`‰ì
(
ãmp
);

2223 
	}
}

2227 
	$ˇãg‹ize_ö°_ps_nc
(
de_ö°_t
* 
ö°
)

2229 
mem_blk_£t_t
 
ãmp
;

2230 
h1
, 
h2
;

2232 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
);

2233 
ãmp
.
√xt
 = 
NULL
;

2235 
h1
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, &
ãmp
);

2236 
ãmp
.
block
 = 
	`GET_MEM
(
ö°
->
addr
 + 
SIZE_OF_WORD
);

2237 
h2
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, &
ãmp
);

2239 if(
ö°
->
ö°_ac˚ss
 !
ALL_HIT
 && in°->ö°_ac˚s†!
ALL_MISS
 && !
h1
 && !
h2
)

2241 
ö°
->
ö°_ac˚ss
 = 
PS
;

2242 #ifde‡
_DEBUG


2245 
l1_i1_ps
 += 1;

2247 if((
h1
 || 
h2
Ë&& 
ö°
->
ö°_ac˚ss
 !
ALL_MISS
)

2249 
ö°
->
ö°_ac˚ss
 = 
NOT_CLASSIFIED
;

2250 #ifde‡
_DEBUG


2254 
	}
}

2258 
	$ˇãg‹ize_hô_miss
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
, 
bb
)

2260 
mem_blk_£t_t
* 
ãmp
 = 
	`gëMem‹yBlocks
(
addr
);

2261 
h
;

2263 
h
 = 
	`checkF‹Pª£n˚
(
ö°
->
acs_ö
, 
ãmp
);

2265 if(
h
 != 0)

2267 
ö°
->
d©a_ac˚ss
 = 
ALL_HIT
;

2268 #ifde‡
_DEBUG


2269 
	`¥ötf
("AŒ hôáàö°ru˘i⁄ %x(BB=%dËªcognized\n", 
ö°
->
addr
, 
bb
);

2274 
ö°
->
d©a_ac˚ss
 = 
NOT_CLASSIFIED
;

2275 #ifde‡
_DEBUG


2276 
	`¥ötf
("Unknow¿d©®ac˚s†© %x(BB=%dËªcognized\n", 
ö°
->
addr
, 
bb
);

2280 
	`‰ì
(
ãmp
);

2281 
	}
}

2285 
	$ˇãg‹ize_ps_d©a
(
de_ö°_t
* 
ö°
, 
ric_p
 
addr
)

2287 
mem_blk_£t_t
* 
ãmp
 = 
	`gëMem‹yBlocks
(
addr
);

2288 
h
;

2290 
h
 = 
	`checkF‹Vi˘im
(
ö°
->
acs_ö
, 
ãmp
);

2292 if(
h
 != 0)

2294 
ö°
->
d©a_ac˚ss
 = 
NOT_CLASSIFIED
;

2295 #ifde‡
_DEBUG


2296 
	`¥ötf
("Unknown dataáccessÑecognized\n");

2299 if(
ö°
->
d©a_ac˚ss
 !
ALL_HIT
 && in°->d©a_ac˚s†!
ALL_MISS
)

2301 
ö°
->
d©a_ac˚ss
 = 
PS
;

2302 #ifde‡
_DEBUG


2303 
	`¥ötf
("Pîsi°í˚ d©®ac˚ss(%xËªcognized\n", 
ö°
->
addr
);

2305 
l1_d1_ps
 += 1;

2308 
	`‰ì
(
ãmp
);

2309 
	}
}

2313 
	$ˇãg‹ize_l2_ö°_ps_ac˚ss
()

2315 
tcfg_node_t
* 
bbi
;

2316 
de_ö°_t
* 
ö°
;

2317 * 
iß_«me
;

2318 
ric_p
 
addr
;

2319 
i
, 
j
;

2320 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2322 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2324 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2326 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2328 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2329 
	`ˇãg‹ize_l2_ö°_ps
(
ö°
);

2332 if(
ö°
->
l2_ö°_ac˚ss
 =
NOT_CLASSIFIED
 &&

2333 (
ö°
->
ö°_ac˚ss
 =
NOT_CLASSIFIED
 ||

2334 
ö°
->
ö°_ac˚ss
 =
ALL_MISS
))

2335 
tcfg
[
i
]->
ö°_ˇche_dñay
 +
L2_MISS_PENALTY
;

2336 if(
ö°
->
l2_ö°_ac˚ss
 =
PS
 || in°->
ö°_ac˚ss
 == PS)

2337 
tcfg
[
i
]->
n_l2_≥rsi°í˚
 += 1;

2338 
ö°
++;

2341 
	}
}

2345 
	$ˇãg‹ize_l2_ö°_ac˚ss
()

2347 
tcfg_node_t
* 
bbi
;

2348 
de_ö°_t
* 
ö°
;

2349 * 
iß_«me
;

2350 
ric_p
 
addr
;

2351 
i
, 
j
;

2352 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2354 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2356 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2358 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2360 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2361 
	`ˇãg‹ize_l2_ö°_hô_miss
(
ö°
);

2366 
ö°
++;

2369 
	}
}

2373 
	$ˇãg‹ize_ö°_ac˚ss
()

2375 
tcfg_node_t
* 
bbi
;

2376 
de_ö°_t
* 
ö°
;

2377 * 
iß_«me
;

2378 
ric_p
 
addr
;

2379 
i
, 
j
;

2380 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2382 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2384 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2386 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2388 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2389 
	`ˇãg‹ize_ö°_hô_miss
(
ö°
);

2394 
ö°
++;

2397 
	}
}

2400 
	$¥öt_˛assifiˇti⁄_d©a
()

2402 
tcfg_node_t
* 
bbi
;

2403 
de_ö°_t
* 
ö°
;

2404 * 
iß_«me
;

2405 
ric_p
 
addr
;

2406 
i
, 
j
;

2407 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2409 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2411 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2413 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2415 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2417 if(
ö°
->
d©a_ac˚ss
 =
ALL_HIT
)

2418 
	`¥ötf
("D©®Ac˚s†AHáà%x\n", 
ö°
->
addr
);

2419 if(
ö°
->
d©a_ac˚ss
 =
ALL_MISS
)

2420 
	`¥ötf
("D©®Ac˚s†AMáà%x\n", 
ö°
->
addr
);

2421 if(
ö°
->
d©a_ac˚ss
 =
PS
)

2422 
	`¥ötf
("D©®Ac˚s†PSáà%x\n", 
ö°
->
addr
);

2423 if(
ö°
->
d©a_ac˚ss
 =
NOT_CLASSIFIED
)

2424 
	`¥ötf
("D©®Ac˚s†NCáà%x\n", 
ö°
->
addr
);

2426 
	`¥ötf
("ShouldÇŸ comêhîê%x\n", 
ö°
->
addr
);

2428 
ö°
++;

2431 
	}
}

2433 
	$¥öt_˛assifiˇti⁄
()

2435 
tcfg_node_t
* 
bbi
;

2436 
de_ö°_t
* 
ö°
;

2437 * 
iß_«me
;

2438 
ric_p
 
addr
;

2439 
i
, 
j
;

2440 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2442 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2444 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2446 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2448 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2450 if(
ö°
->
ö°_ac˚ss
 =
ALL_HIT
)

2451 
	`¥ötf
("In°ru˘i⁄áŒ hôáà%x\n", 
ö°
->
addr
);

2452 if(
ö°
->
ö°_ac˚ss
 =
ALL_MISS
)

2453 
	`¥ötf
("In°ru˘i⁄áŒ mis†© %x\n", 
ö°
->
addr
);

2454 if(
ö°
->
ö°_ac˚ss
 =
PS
)

2455 
	`¥ötf
("In°ru˘i⁄Öîsi°í˚áà%x\n", 
ö°
->
addr
);

2456 if(
ö°
->
ö°_ac˚ss
 =
NOT_CLASSIFIED
)

2457 
	`¥ötf
("In°ru˘i⁄ÇŸ cœssifõdáà%x\n", 
ö°
->
addr
);

2459 
	`¥ötf
("ShouldÇŸ comêhîê%x\n", 
ö°
->
addr
);

2461 
ö°
++;

2463 
	`¥ötf
("tcfgÇodê%d dñay = (I=%d,D=%d)\n", 
tcfg
[
i
]->
id
,

2464 
tcfg
[
i
]->
ö°_ˇche_dñay
 + 
L1_MISS_PENALTY
 *Åcfg[i]->
n_≥rsi°í˚
,

2465 
tcfg
[
i
]->
dˇche_dñay
);

2467 
	}
}

2471 
	$ˇãg‹ize_ö°_ac˚ss_ps
()

2473 
tcfg_node_t
* 
bbi
;

2474 
de_ö°_t
* 
ö°
;

2475 * 
iß_«me
;

2476 
ric_p
 
addr
;

2477 
i
, 
j
;

2478 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2480 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2482 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2484 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2486 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2487 
	`ˇãg‹ize_ö°_ps_nc
(
ö°
);

2489 if(
ö°
->
ö°_ac˚ss
 =
NOT_CLASSIFIED
)

2490 
tcfg
[
i
]->
ö°_ˇche_dñay
 +
L1_MISS_PENALTY
;

2492 if(
ö°
->
ö°_ac˚ss
 =
PS
)

2493 
tcfg
[
i
]->
n_≥rsi°í˚
 += 1;

2494 
ö°
++;

2497 
	}
}

2501 
	$ˇãg‹ize_ö°_ac˚ss_miss
()

2503 
tcfg_node_t
* 
bbi
;

2504 
de_ö°_t
* 
ö°
;

2505 * 
iß_«me
;

2506 
ric_p
 
addr
;

2507 
i
, 
j
;

2508 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2510 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2512 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2514 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2516 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2517 
	`ˇãg‹ize_ö°_Æl_miss
(
ö°
);

2518 if(
ö°
->
ö°_ac˚ss
 =
ALL_MISS
)

2519 
tcfg
[
i
]->
ö°_ˇche_dñay
 +
L1_MISS_PENALTY
;

2520 
ö°
++;

2523 
	}
}

2527 
	$ˇãg‹ize_d©a_ac˚ss_miss
()

2529 
tcfg_node_t
* 
bbi
;

2530 
de_ö°_t
* 
ö°
;

2531 * 
iß_«me
;

2532 
ric_p
 
addr
;

2533 
i
, 
j
;

2534 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2536 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2538 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2540 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2542 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2547 if(
	`isSt‹eIn°
(
iß_«me
))

2549 if(
ö°
->
num_ö
 <= 2)

2551 
imm
 = 
ö°
->imm;

2552 
ba£
 = *(
ö°
->
ö
 + 1);

2553 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2554 
	`ˇãg‹ize_Æl_miss
(
ö°
, 
addr
);

2556 if(
ö°
->
num_ö
 == 3)

2558 
ba£
 = *(
ö°
->
ö
 + 1);

2559 
ödex
 = *(
ö°
->
ö
 + 2);

2560 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2561 
	`ˇãg‹ize_Æl_miss
(
ö°
, 
addr
);

2564 if(
	`isLﬂdIn°
(
iß_«me
))

2566 if(
ö°
->
num_ö
 <= 1)

2568 
imm
 = 
ö°
->imm;

2569 
ba£
 = *(
ö°
->
ö
);

2570 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2571 
	`ˇãg‹ize_Æl_miss
(
ö°
, 
addr
);

2573 if(
ö°
->
num_ö
 == 2)

2575 
ba£
 = *(
ö°
->
ö
);

2576 
ödex
 = *(
ö°
->
ö
 + 1);

2577 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2578 
	`ˇãg‹ize_Æl_miss
(
ö°
, 
addr
);

2583 
ö°
->
d©a_ac˚ss
 = 
ALL_HIT
;

2586 if(
ö°
->
d©a_ac˚ss
 =
ALL_MISS
)

2587 
tcfg
[
i
]->
dˇche_dñay
 +
L1_MISS_PENALTY
;

2588 
ö°
++;

2591 
	}
}

2595 
	$ˇãg‹ize_d©a_ac˚ss_ps
()

2597 
tcfg_node_t
* 
bbi
;

2598 
de_ö°_t
* 
ö°
;

2599 * 
iß_«me
;

2600 
ric_p
 
addr
;

2601 
i
, 
j
;

2602 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2604 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2606 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2608 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2610 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2615 if(
	`isSt‹eIn°
(
iß_«me
))

2617 if(
ö°
->
num_ö
 <= 2)

2619 
imm
 = 
ö°
->imm;

2620 
ba£
 = *(
ö°
->
ö
 + 1);

2621 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2622 
	`ˇãg‹ize_ps_d©a
(
ö°
, 
addr
);

2624 if(
ö°
->
num_ö
 == 3)

2626 
ba£
 = *(
ö°
->
ö
 + 1);

2627 
ödex
 = *(
ö°
->
ö
 + 2);

2628 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2629 
	`ˇãg‹ize_ps_d©a
(
ö°
, 
addr
);

2632 if(
	`isLﬂdIn°
(
iß_«me
))

2634 if(
ö°
->
num_ö
 <= 1)

2636 
imm
 = 
ö°
->imm;

2637 
ba£
 = *(
ö°
->
ö
);

2638 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2639 
	`ˇãg‹ize_ps_d©a
(
ö°
, 
addr
);

2641 if(
ö°
->
num_ö
 == 2)

2643 
ba£
 = *(
ö°
->
ö
);

2644 
ödex
 = *(
ö°
->
ö
 + 1);

2645 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2646 
	`ˇãg‹ize_ps_d©a
(
ö°
, 
addr
);

2651 
ö°
->
d©a_ac˚ss
 = 
ALL_HIT
;

2654 if(
ö°
->
d©a_ac˚ss
 =
NOT_CLASSIFIED
)

2655 
tcfg
[
i
]->
dˇche_dñay
 +
L1_MISS_PENALTY
;

2658 if(
ö°
->
d©a_ac˚ss
 =
PS
)

2659 
tcfg
[
i
]->
n_d©a_≥rsi°í˚
 +
	`gëC¨döÆôy
(

2660 
	`gëMem‹yBlocks
(
addr
));

2661 
ö°
++;

2664 
	}
}

2668 
	$ˇãg‹ize_d©a_ac˚ss
()

2670 
tcfg_node_t
* 
bbi
;

2671 
de_ö°_t
* 
ö°
;

2672 * 
iß_«me
;

2673 
ric_p
 
addr
;

2674 
i
, 
j
;

2675 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2677 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2679 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2681 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2683 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2688 if(
	`isSt‹eIn°
(
iß_«me
))

2690 if(
ö°
->
num_ö
 <= 2)

2692 
imm
 = 
ö°
->imm;

2693 
ba£
 = *(
ö°
->
ö
 + 1);

2694 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2695 
	`ˇãg‹ize_hô_miss
(
ö°
, 
addr
, 
i
);

2697 if(
ö°
->
num_ö
 == 3)

2699 
ba£
 = *(
ö°
->
ö
 + 1);

2700 
ödex
 = *(
ö°
->
ö
 + 2);

2701 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2702 
	`ˇãg‹ize_hô_miss
(
ö°
, 
addr
, 
i
);

2705 if(
	`isLﬂdIn°
(
iß_«me
))

2707 if(
ö°
->
num_ö
 <= 1)

2709 
imm
 = 
ö°
->imm;

2710 
ba£
 = *(
ö°
->
ö
);

2711 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2712 
	`ˇãg‹ize_hô_miss
(
ö°
, 
addr
, 
i
);

2714 if(
ö°
->
num_ö
 == 2)

2716 
ba£
 = *(
ö°
->
ö
);

2717 
ödex
 = *(
ö°
->
ö
 + 1);

2718 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2719 
	`ˇãg‹ize_hô_miss
(
ö°
, 
addr
, 
i
);

2724 
ö°
->
d©a_ac˚ss
 = 
ALL_HIT
;

2731 
ö°
++;

2734 
	}
}

2738 
	$ˇãg‹ize_unifõd_ps_ˇche_ac˚ss
()

2740 
tcfg_node_t
* 
bbi
;

2741 
de_ö°_t
* 
ö°
;

2742 * 
iß_«me
;

2743 
ric_p
 
addr
;

2744 
i
, 
j
;

2745 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2747 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2749 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2751 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2753 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2757 
	`ˇãg‹ize_l2_ö°_ps
(
ö°
);

2762 if(
	`isSt‹eIn°
(
iß_«me
))

2764 if(
ö°
->
num_ö
 <= 2)

2766 
imm
 = 
ö°
->imm;

2767 
ba£
 = *(
ö°
->
ö
 + 1);

2768 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2769 
	`ˇãg‹ize_u1_ps
(
ö°
, 
addr
);

2771 if(
ö°
->
num_ö
 == 3)

2773 
ba£
 = *(
ö°
->
ö
 + 1);

2774 
ödex
 = *(
ö°
->
ö
 + 2);

2775 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2776 
	`ˇãg‹ize_u1_ps
(
ö°
, 
addr
);

2779 if(
	`isLﬂdIn°
(
iß_«me
))

2781 if(
ö°
->
num_ö
 <= 1)

2783 
imm
 = 
ö°
->imm;

2784 
ba£
 = *(
ö°
->
ö
);

2785 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2786 
	`ˇãg‹ize_u1_ps
(
ö°
, 
addr
);

2788 if(
ö°
->
num_ö
 == 2)

2790 
ba£
 = *(
ö°
->
ö
);

2791 
ödex
 = *(
ö°
->
ö
 + 1);

2792 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2793 
	`ˇãg‹ize_u1_ps
(
ö°
, 
addr
);

2798 
ö°
->
u1_d©a_ac˚ss
 = 
ALL_X
;

2802 if(
ö°
->
l2_ö°_ac˚ss
 =
NOT_CLASSIFIED
)

2803 
tcfg
[
i
]->
ö°_ˇche_dñay
 +
L2_MISS_PENALTY
;

2804 if(
ö°
->
l2_ö°_ac˚ss
 =
PS
)

2805 
tcfg
[
i
]->
n_u1_≥rsi°í˚
 += 1;

2807 if(
ö°
->
u1_d©a_ac˚ss
 =
NOT_CLASSIFIED
)

2808 
tcfg
[
i
]->
dˇche_dñay
 +
L2_MISS_PENALTY
;

2809 if(
ö°
->
u1_d©a_ac˚ss
 =
PS
)

2810 
tcfg
[
i
]->
n_u1_d©a_≥rsi°í˚
 +
	`gëC¨döÆôy
(

2811 
	`gëMem‹yBlocks
(
addr
));

2813 
ö°
++;

2816 
	}
}

2820 
	$ˇãg‹ize_unifõd_ˇche_ac˚ss
()

2822 
tcfg_node_t
* 
bbi
;

2823 
de_ö°_t
* 
ö°
;

2824 * 
iß_«me
;

2825 
ric_p
 
addr
;

2826 
i
, 
j
;

2827 
rs
, 
π
, 
d
, 
imm
, 
ba£
, 
off£t
, 
ödex
;

2829 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2831 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2833 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2835 
iß_«me
 = 
iß
[
ö°
->
›_íum
].
«me
;

2839 
	`ˇãg‹ize_l2_ö°_hô_miss
(
ö°
);

2844 if(
	`isSt‹eIn°
(
iß_«me
))

2846 if(
ö°
->
num_ö
 <= 2)

2848 
imm
 = 
ö°
->imm;

2849 
ba£
 = *(
ö°
->
ö
 + 1);

2850 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2851 
	`ˇãg‹ize_u1_hô_miss
(
ö°
, 
addr
);

2853 if(
ö°
->
num_ö
 == 3)

2855 
ba£
 = *(
ö°
->
ö
 + 1);

2856 
ödex
 = *(
ö°
->
ö
 + 2);

2857 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2858 
	`ˇãg‹ize_u1_hô_miss
(
ö°
, 
addr
);

2861 if(
	`isLﬂdIn°
(
iß_«me
))

2863 if(
ö°
->
num_ö
 <= 1)

2865 
imm
 = 
ö°
->imm;

2866 
ba£
 = *(
ö°
->
ö
);

2867 
addr
 = 
	`gëAddrBa£Off£t
(
ö°
, 
ba£
, 
imm
, 
›t
);

2868 
	`ˇãg‹ize_u1_hô_miss
(
ö°
, 
addr
);

2870 if(
ö°
->
num_ö
 == 2)

2872 
ba£
 = *(
ö°
->
ö
);

2873 
ödex
 = *(
ö°
->
ö
 + 1);

2874 
addr
 = 
	`gëAddrBa£Index
(
ö°
, 
ba£
, 
ödex
, 
›t
);

2875 
	`ˇãg‹ize_u1_hô_miss
(
ö°
, 
addr
);

2880 
ö°
->
u1_d©a_ac˚ss
 = 
ALL_X
;

2889 
ö°
++;

2892 
	}
}

2894 
	$˛ónup_ˇche
()

2896 
i
,
j
,
k
;

2897 
de_ö°_t
* 
ö°
;

2899 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2901 
ö°
 = 
tcfg
[
i
]->
bb
->
code
;

2903 
j
 = 0; j < 
tcfg
[
i
]->
bb
->
num_ö°
; j++)

2905 
ö°
->
acs_ö
 = in°->
acs_out
 = 
NULL
;

2906 
ö°
++;

2909 
	}
}

2912 
	$™Æyze_d©a_ˇche_ps
()

2914 
ch™ge_Êag
 = 1;

2915 
tcfg_edge_t
* 
edge
;

2916 
i
;

2917 
ãmp
 = 0;

2919 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

2922 
	`˛ónup_ˇche
();

2926 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2927 
	`öôülize_ˇche
(
tcfg
[
i
]);

2929 
ch™ge_Êag
)

2933 #ifde‡
_DEBUG


2934 
	`¥ötf
("One data cache iteration starts\n");

2936 
ch™ge_Êag
 = 0;

2938 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2942 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

2944 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
PERSISTENCE
);

2946 
	`å™sf‹mCacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
PERSISTENCE
);

2949 #ifde‡
_DEBUG


2950 
	`¥ötf
("One data cache iterationÉnds\n");

2955 #ifde‡
_DEBUG


2956 
	`dumpCache
();

2961 
	`ˇãg‹ize_d©a_ac˚ss_ps
();

2962 
	}
}

2964 
	$™Æyze_d©a_ˇche_mu°
()

2966 
ch™ge_Êag
 = 1;

2967 
tcfg_edge_t
* 
edge
;

2968 
i
;

2969 
ãmp
 = 0;

2971 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

2973 
	`˛ónup_ˇche
();

2977 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2978 
	`öôülize_ˇche
(
tcfg
[
i
]);

2980 
ch™ge_Êag
)

2984 
ch™ge_Êag
 = 0;

2986 
i
 = 0; i < 
num_tcfg_nodes
; i++)

2990 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

2992 #ifde‡
_DEBUG


2993 
	`¥ötf
("Before joining cache\n");

2995 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MUST
);

2996 #ifde‡
_DEBUG


2997 
	`¥ötf
("After joining cache\n");

3000 
	`å™sf‹mCacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
MUST
);

3006 #ifde‡
_DEBUG


3007 
	`dumpCache
();

3012 
	`ˇãg‹ize_d©a_ac˚ss
();

3013 
	}
}

3015 
	$™Æyze_d©a_ˇche_may
()

3017 
ch™ge_Êag
 = 1;

3018 
tcfg_edge_t
* 
edge
;

3019 
i
;

3020 
ãmp
 = 0;

3022 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3024 
	`˛ónup_ˇche
();

3028 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3029 
	`öôülize_ˇche
(
tcfg
[
i
]);

3031 
ch™ge_Êag
)

3035 
ch™ge_Êag
 = 0;

3037 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3041 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3043 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MAY
);

3045 
	`å™sf‹mCacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
MAY
);

3051 #ifde‡
_DEBUG


3052 
	`dumpCache
();

3057 
	`ˇãg‹ize_d©a_ac˚ss_miss
();

3058 
	}
}

3060 
	$™Æyze_d©a_ˇche
()

3062 
X
 = 4; 
Y
 = 32; 
B
 = 32; 
l1
 = 2; 
l2
 = 4;

3063 #ifde‡
_DEBUG


3064 
	`¥ötf
("Data cacheánalysis starts\n");

3067 
	`™Æyze_d©a_ˇche_mu°
();

3069 
	`™Æyze_d©a_ˇche_may
();

3071 
	`™Æyze_d©a_ˇche_ps
();

3075 #ifde‡
_DEBUG


3076 
	`¥ötf
("D©®ˇchê™Æysi†ôî©i⁄ cou¡ = %d\n", 
™Æysis
);

3078 
	}
}

3080 
	$™Æyze_abs_ö°r_ˇche_mu°
()

3082 
ch™ge_Êag
 = 1;

3083 
tcfg_edge_t
* 
edge
;

3084 
i
;

3085 
ãmp
 = 0;

3087 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3089 
	`˛ónup_ˇche
();

3093 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3094 
	`öôülize_ˇche
(
tcfg
[
i
]);

3096 
ch™ge_Êag
)

3100 
ch™ge_Êag
 = 0;

3102 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3106 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3108 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MUST
);

3110 
	`å™sf‹mIn°CacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
);

3116 #ifde‡
_DEBUG


3117 
	`dumpIn°Cache
();

3122 
	`ˇãg‹ize_ö°_ac˚ss
();

3123 
	}
}

3125 
	$™Æyze_abs_l2_ö°r_ˇche_ps
()

3127 
ch™ge_Êag
 = 1;

3128 
tcfg_edge_t
* 
edge
;

3129 
i
;

3130 
ãmp
 = 0;

3132 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3134 
	`˛ónup_ˇche
();

3138 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3139 
	`öôülize_ˇche
(
tcfg
[
i
]);

3141 
ch™ge_Êag
)

3145 
ch™ge_Êag
 = 0;

3147 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3151 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3153 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
PERSISTENCE
);

3155 
	`å™sf‹ml2In°CacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
PERSISTENCE
);

3161 #ifde‡
_DEBUG


3162 
	`dumpIn°Cache
();

3167 
	`ˇãg‹ize_l2_ö°_ps_ac˚ss
();

3168 
	}
}

3170 
	$™Æyze_abs_l2_ö°r_ˇche_mu°
()

3172 
ch™ge_Êag
 = 1;

3173 
tcfg_edge_t
* 
edge
;

3174 
i
;

3175 
ãmp
 = 0;

3177 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3179 
	`˛ónup_ˇche
();

3183 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3184 
	`öôülize_ˇche
(
tcfg
[
i
]);

3186 
ch™ge_Êag
)

3190 
ch™ge_Êag
 = 0;

3192 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3196 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3198 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MUST
);

3200 
	`å™sf‹ml2In°CacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
MUST
);

3206 #ifde‡
_DEBUG


3207 
	`dumpIn°Cache
();

3212 
	`ˇãg‹ize_l2_ö°_ac˚ss
();

3213 
	}
}

3215 
	$™Æyze_abs_ö°r_ˇche_may
()

3217 
ch™ge_Êag
 = 1;

3218 
tcfg_edge_t
* 
edge
;

3219 
i
;

3220 
ãmp
 = 0;

3222 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3224 
	`˛ónup_ˇche
();

3228 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3229 
	`öôülize_ˇche
(
tcfg
[
i
]);

3231 
ch™ge_Êag
)

3235 
ch™ge_Êag
 = 0;

3237 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3241 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3243 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MAY
);

3245 
	`å™sf‹mIn°CacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
);

3251 #ifde‡
_DEBUG


3252 
	`dumpIn°Cache
();

3257 
	`ˇãg‹ize_ö°_ac˚ss_miss
();

3258 
	}
}

3260 
	$™Æyze_abs_ö°r_ˇche_ps
()

3262 
ch™ge_Êag
 = 1;

3263 
tcfg_edge_t
* 
edge
;

3264 
i
;

3265 
ãmp
 = 0;

3267 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3270 
	`˛ónup_ˇche
();

3274 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3275 
	`öôülize_ˇche
(
tcfg
[
i
]);

3277 
ch™ge_Êag
)

3281 
ch™ge_Êag
 = 0;

3283 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3287 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3289 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
PERSISTENCE
);

3291 
	`å™sf‹mIn°CacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
);

3297 #ifde‡
_DEBUG


3298 
	`dumpIn°Cache
();

3303 
	`ˇãg‹ize_ö°_ac˚ss_ps
();

3304 
	}
}

3306 
	$™Æyze_abs_ö°r_ˇche
()

3308 
X
 = 4; 
Y
 = 8; 
B
 = 32; 
l1
 = 2; 
l2
 = 4;

3310 
	`™Æyze_abs_ö°r_ˇche_mu°
();

3312 
	`™Æyze_abs_ö°r_ˇche_may
();

3314 
	`™Æyze_abs_ö°r_ˇche_ps
();

3316 
	`¥öt_˛assifiˇti⁄
();

3323 
	}
}

3325 
	$™Æyze_unifõd_ˇche_ps
()

3327 
ch™ge_Êag
 = 1;

3328 
tcfg_edge_t
* 
edge
;

3329 
i
;

3330 
ãmp
 = 0;

3333 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3337 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3338 
	`öôülize_ˇche
(
tcfg
[
i
]);

3340 
ch™ge_Êag
)

3344 
ch™ge_Êag
 = 0;

3346 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3350 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3352 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
PERSISTENCE
);

3354 
	`å™sf‹mUnifõdCacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
PERSISTENCE
);

3360 #ifde‡
_DEBUG


3361 
	`¥ötf
("Unifõd cachêupd©ed %dÅimes\n", 
unifõd
);

3367 
	`ˇãg‹ize_unifõd_ps_ˇche_ac˚ss
();

3368 
	}
}

3370 
	$™Æyze_unifõd_ˇche_mu°
()

3372 
ch™ge_Êag
 = 1;

3373 
tcfg_edge_t
* 
edge
;

3374 
i
;

3375 
ãmp
 = 0;

3378 
tcfg_node_t
* 
bbi
 = 
tcfg
[0];

3382 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3383 
	`öôülize_ˇche
(
tcfg
[
i
]);

3385 
ch™ge_Êag
)

3389 
ch™ge_Êag
 = 0;

3391 
i
 = 0; i < 
num_tcfg_nodes
; i++)

3395 
edge
 = 
tcfg
[
i
]->
ö
;Édge;Édgêedge->
√xt_ö
)

3397 
	`JoöCacheSèã
(
edge
->
§c
, 
tcfg
[
i
], 
MUST
);

3399 
	`å™sf‹mUnifõdCacheSèã
(
tcfg
[
i
], &
ch™ge_Êag
, 
MUST
);

3405 #ifde‡
_DEBUG


3406 
	`¥ötf
("Unifõd cachêupd©ed %dÅimes\n", 
unifõd
);

3412 
	`ˇãg‹ize_unifõd_ˇche_ac˚ss
();

3413 
	}
}

3415 
	$™Æyze_unifõd_ˇche
()

3417 
X
 = 8; 
Y
 = 32; 
B
 = 64; 
l1
 = 2; 
l2
 = 4;

3418 
	`™Æyze_unifõd_ˇche_mu°
();

3419 
	`™Æyze_unifõd_ˇche_ps
();

3420 
	}
}

	@
1
.
0
61
629
address.c
address.h
bpred.c
bpred.h
bs.c
cache.c
cache.h
cfg.c
cfg.h
common.c
common.h
conflicts.c
estimate.c
exegraph.c
exegraph.h
fir.c
ilp.c
infdump.c
infeasible.c
infeasible.h
isa.c
isa.h
loops.c
loops.h
main.c
options.c
pipeline.c
pipeline.h
qurt.c
readfile.c
reg.c
ss/decode_cfg.h
ss/ecoff.h
ss/eval.c
ss/eval.h
ss/host.h
ss/loader.c
ss/loader.h
ss/machine.c
ss/machine.h
ss/misc.c
ss/misc.h
ss/my_opt.c
ss/options.c
ss/options.h
ss/regs.h
ss/resource.h
ss/ss_exegraph.c
ss/ss_isa.c
ss/ss_isa.h
ss/ss_machine.c
ss/ss_machine.h
ss/ss_readfile.c
ss/symbol.c
ss/symbol.h
symexec.c
symexec.cp.c
tcfg.c
tcfg.h
test.c
unicache.c
